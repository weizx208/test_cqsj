var g_rebirth;!function(e){var t=function(t){function r(){t.apply(this,arguments)}__extends(r,t);var i=(__define,r),l=i.prototype;return l._initProp=function(){t.prototype._initProp.call(this);var e=this;e.registerClassByKey(gd.userCtrl,gc.dsConsts.UserEntity.rebirthExp.toString(),e._refreshUi)},l._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:18}).show()},l._childrenCreated=function(){t.prototype._childrenCreated.call(this),this._refreshUi()},l._refreshUi=function(){var e=this,t=gd.reBirthCtrl.getRebirthLvl(),r=t+1,i=gd.reBirthCtrl.getRebirthCfg(t),l=gd.reBirthCtrl.getRebirthCfg(r),s=["maxHpTemp","attackTemp","defenceTemp","magicDefenceTemp","hitTemp","dodgeTemp","criticalTemp","disCriticalTemp"];l&&(e.label_maxLvl.text=[l.rebirthLvl,l.limitLvl]),e.label_curLvl.text=t+"",e.label_curPropDes.text=t,e.label_nextPropDes.text=r;for(var o="%sï¼š%s[/br]",a="%s+%s[/br]",_="",n="",b=0,h=s.length;h>b;b++){var p=s[b],g=gc.c_prop.heroPropKey[p];g&&(_+=i?mo.STR.format(o,gc.c_prop.heroProp[g],i[p]):mo.STR.format(o,gc.c_prop.heroProp[g],0),l&&(n+=mo.STR.format(a,gc.c_prop.heroProp[g],l[p])))}e.label_curProp.text=_,e.label_nextProp.text=n,l&&(e.label_costExp.text=mo.STR.format("[ubb color=0xFFD400]%s[/ubb]",l.exp)),e.label_curExp.text=mo.STR.format("[ubb color=0xFFD400]%s[/ubb]",gd.reBirthCtrl.getRebirthExp()),l&&(e.label_openNextLvl.text=[l.lvl,l.rebirthLvl]),e.label_curExp2.text=mo.STR.format("[ubb color=0xFFD400]%s[/ubb]",gd.reBirthCtrl.getRebirthExp()),e._checkVisible(i,l)},l._checkVisible=function(e,t){var r=this;r.label_maxLvl.visible=!0,e?(r.img_noReTitle.visible=!1,r.grp_reTitle.visible=!0,r.label_curLvl.visible=!0,r.label_0_propDes.visible=!1,r.label_curPropDes.visible=!0,t?(r.label_no_PropDes.visible=!1,r.label_nextPropDes.visible=!0,gd.userCtrl.getLvl()>=t.lvl?(r.grp_1.visible=!0,r.grp_2.visible=!1):(r.grp_1.visible=!1,r.grp_2.visible=!0)):(r.label_no_PropDes.visible=!0,r.label_nextPropDes.visible=!1,r.grp_1.visible=!1,r.grp_2.visible=!0,r.label_openNextLvl.visible=!1,r.label_maxLvl.visible=!1)):(r.img_noReTitle.visible=!0,r.grp_reTitle.visible=!1,r.label_curLvl.visible=!1,r.label_0_propDes.visible=!0,r.label_curPropDes.visible=!1,r.label_no_PropDes.visible=!1,r.label_nextPropDes.visible=!0)},l._tap_btn_rebirth=function(){var e=this;gd.reBirthCtrl.rebirth(e._refreshUi,e)},l._tap_btn_getExp=function(){e.RebirthExp.create().show()},r}(mo.gui.Dlg);e.Rebirth=t,egret.registerClass(t,"g_rebirth.Rebirth"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var e=new mo.ModuleCfgItem;e.fullScr=!0,e.targetClass=t,e.sysId=gc.id_c_open.rebirth,mo.moduleMgr.registerModule(e)})}(g_rebirth||(g_rebirth={}));var g_rebirth;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var r=(__define,t),i=r.prototype;return i._initProp=function(){e.prototype._initProp.call(this);var t=this;t.registerClassByKey(gd.userCtrl,gc.dsConsts.UserEntity.rebirthExp.toString(),t._refreshUi)},i._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t._refreshUi()},i._refreshUi=function(){var e=this;e._refreshExp(),e._refreshItems()},i._refreshExp=function(){var e=this,t=gd.reBirthCtrl.getRebirthLvl(),r=t+1,i=gd.reBirthCtrl.getRebirthCfg(r);if(i){var l=i.exp,s=gd.reBirthCtrl.getRebirthExp(),o=s/l;o=o>=1?1:o;var a=e.img_exp.height-Math.floor((1-o)*e.img_exp.height);e.img_exp.mask=new egret.Rectangle(0,e.img_exp.height-a,e.img_exp.width,a),e.label_exp.text=[(s/1e4).toFixed(1),(l/1e4).toFixed(1)]}},i._refreshItems=function(){for(var e=this,t=gd.reBirthCtrl.getItems(),r=0;3>r;r++){var i=t[r],l=e["grp_"+r];i?(l.visible=!0,e._updateItem(r,i)):l.visible=!1}},i._updateItem=function(e,t){var r=this,i=r["ico_item"+e];i.setData({itemId:t,count:1}),i.label_text.visible=!1,i.onClick(r._showDetai,r,t);var l=mo.getJSONWithFileNameAndID(gc.cfg_t_item,t),s=l[gc.t_item_name],o=l[gc.t_item_color],a=mo.STR.format("[ubb color=%s]%s[/ubb]",uiHelper.getColorByQuality(o),s),_=r["label_name"+e];_.text=a;var n=r["label_num"+e],b=r["btn_buy"+e],h=r["btn_use"+e],p=gd.reBirthCtrl.getItemBagDataCtrl(t);p?(n.text=p.count,b.visible=!1,h.visible=!0):(n.text=0,b.visible=!0,h.visible=!1)},i._showDetai=function(e,t,r){var i=gd.BagDataCtrl.create(r,null);g_base.BaseItemDetail.create().setData({bdc:i}).show()},i.calUseBtn=function(e){var t=this,r=gd.reBirthCtrl.getItems(),i=gd.reBirthCtrl.getItemBagDataCtrl(r[e]);i&&g_bag.BagOpenBox.create().setData({bdc:i}).show().onClose(t._refreshUi,t)},i.calBuyBtn=function(e){var t=this,r=gd.reBirthCtrl.getItemShopData(e);return r[4]<=0?void mo.showMsg(gc.id_c_msgCode.buyLimitNow):void g_shop.ShopBuy.create().setData({type:gc.c_prop.shopTypeKey.rebirth,shopItem:r,index:e}).show().onClose(t._refreshUi,t)},i._tap_btn_use0=function(){this.calUseBtn(0)},i._tap_btn_use1=function(){this.calUseBtn(1)},i._tap_btn_use2=function(){this.calUseBtn(2)},i._tap_btn_buy0=function(){this.calBuyBtn(0)},i._tap_btn_buy1=function(){this.calBuyBtn(1)},i._tap_btn_buy2=function(){this.calBuyBtn(2)},t}(mo.gui.Dlg);e.RebirthExp=t,egret.registerClass(t,"g_rebirth.RebirthExp")}(g_rebirth||(g_rebirth={}));