var tm;!function(e){var t=function(){function e(t){this.__class=e;var r=this;r._initProp(),r._init(),r.endTime=t}var t=(__define,e),r=t.prototype;return r._initProp=function(){var e=this;e._isInstance=!1,e._hasDtored=!1,e._listenerMap={},e._ctxMap={},e._moreMap={},e._tempArrMap={},e._typeCounter={},e.msPassed=0},r._init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},r.doDtor=function(){var e=this;e._hasDtored||(e._hasDtored=!0,e.dtor())},r.dtor=function(){},r.on=function(e,t,r){t?(this._listenerMap[e]=t,this._ctxMap[e]=r):(delete this._listenerMap[e],delete this._ctxMap[e])},r.un=function(e){this.on(e,null)},r.onMore=function(e,t,r){var n=this._moreMap,a=n[e];a||(a=n[e]=[]);for(var i=0,s=a.length;s>i;i++){var o=a[i];if(o.listener==t&&o.ctx==r)return}a.push({listener:t,ctx:r})},r.unMore=function(e,t,r){var n=this._moreMap,a=n[e];if(a)if(1==arguments.length)delete n[e];else{for(var i=0,s=a.length;s>i;){var o=a[i];o.listener==t&&o.ctx==r?(a.splice(i,1),s--):i++}0==a.length&&delete n[e]}},r._switchToTemp=function(e,t){var r=this._tempArrMap[e];r||(r=this._tempArrMap[e]=[]),r.length=0;for(var n=0,a=t.length;a>n;n++)r[n]=t[n];return r},r._invoke=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this,a=n._listenerMap[e],i=n._ctxMap[e];a&&a.apply(i,arguments);var s=n._moreMap[e];if(s){for(var o=n._switchToTemp(e,s),g=0,u=o.length;u>g;g++){var v=o[g];v.listener&&v.listener.apply(v.ctx,arguments)}o.length=0}},r._update=function(e,t){var r=this,n=r.__class,a=r.beginTime,i=r.endTime;if(!i)return!1;var s=i.getTime();if(t>=s&&!a)return!0;var o=!a;a||(a=r.beginTime=Date.newDate()),o&&r._invoke(n.ON_FIRST,a,i);for(var g=Math.min(s-t,e),u=r.msPassed,v=u%1e3,l=Math.floor((v+g)/1e3),c=0;l>c;c++)r._invoke(n.ON_SECOND,a,i);return r.msPassed+=g,u=r.msPassed,t>=s?(v=u%1e3,l=Math.round((v+g)/1e3),l&&r._invoke(n.ON_SECOND,a,i),r._invoke(n.ON_END,a,i),!0):!1},e.ON_FIRST="onFirst",e.ON_SECOND="onSecond",e.ON_END="onEnd",e}();e.Trigger=t,egret.registerClass(t,"tm.Trigger")}(tm||(tm={}));var tm;!function(e){function t(){var e=new r;return n.push(e),e}var r=function(){function e(){this.__class=e;var t=this;t._initProp(),t._init()}var t=(__define,e),r=t.prototype;return r._initProp=function(){var e=this;e._isInstance=!1,e._hasDtored=!1,e.deltaMs=0,e._triggers=[],e._tempTriggers=[]},r._init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t]},r.doDtor=function(){var e=this;e._hasDtored||(e._hasDtored=!0,e.dtor())},r.dtor=function(){var e=this;e.clear()},r.clear=function(){var e=this;e._triggers.length=0,egret.Ticker.getInstance().unregister(e._update,e),e._tickBegan=!1,e.deltaMs=0},r.setDeltaMs=function(e){if(e){var t=this;t.deltaMs+=e,t._tickBegan||(t._tickBegan=!0,egret.Ticker.getInstance().register(t._update,t))}},r._judgeUpdate=function(){var e=this;0==e._triggers.length?(egret.Ticker.getInstance().unregister(e._update,e),e._tickBegan=!1):e._tickBegan||(egret.Ticker.getInstance().register(e._update,e),e._tickBegan=!0)},r._update=function(e){var t=this,r=t._triggers,n=r.length;if(n>0){for(var a=t.deltaMs,i=Date.newDate().getTime(),s=t._tempTriggers,o=0;n>o;++o)r[o]&&s.push(r[o]);n=s.length;for(var o=0;n>o;++o)s[o]._update(e+a,i)&&t.remove(s[o]);s.length=0}t.deltaMs=0,t._judgeUpdate()},r.add=function(e){var t=this._triggers;t.indexOf(e)<0&&t.push(e),this._judgeUpdate()},r.remove=function(e){var t=this._triggers,r=t.indexOf(e);r>=0&&t.splice(r,1),this._judgeUpdate()},e}();e.Timer=r,egret.registerClass(r,"tm.Timer");var n=[],a=function(){for(var e=egret.getTimer(),t=0,r=n.length;r>t;t++){var a=n[t];a.setDeltaMs(e)}},i=function(){var t=egret.MainContext.instance.stage;t.removeEventListener(egret.Event.ACTIVATE,a,e),t.addEventListener(egret.Event.ACTIVATE,a,e)};e.newTimer=t,e.timer=t(),egret.Boot.once(egret.Boot.AFTER_CONFIG,i)}(tm||(tm={}));var tm;!function(e){function t(e){for(var t=[],r=3;r<arguments.length;r++)t[r-3]=arguments[r];var n=o++,a=c.apply(null,arguments),i=a[1],s=a[2],g=a[3];return 0==s?e.apply(i,g):(a.push(0,!0),u[n]=a),n}function r(e){for(var t=[],r=3;r<arguments.length;r++)t[r-3]=arguments[r];var n=o++,a=c.apply(null,arguments),i=a[1],s=a[2],g=a[3];return 0==s?e.apply(i,g):(a.push(0,!1),u[n]=a),n}function n(e){delete u[e]}function a(e){for(var t=[],r=3;r<arguments.length;r++)t[r-3]=arguments[r];var n=g++,a=c.apply(null,arguments),i=a[1],s=a[2],o=a[3];return 0==s&&e.apply(i,o),a.push(0,!0),v[n]=a,n}function i(e){for(var t=[],r=3;r<arguments.length;r++)t[r-3]=arguments[r];var n=g++,a=c.apply(null,arguments),i=a[1],s=a[2],o=a[3];return 0==s&&e.apply(i,o),a.push(0,!1),v[n]=a,n}function s(e){delete v[e]}e.log,e.debug,e.info,e.warn,e.error,logger.initLogger(e,"tm");var o=1,g=1,u={},v={},l=!1,c=function(e,t,r){for(var n=[],a=3;a<arguments.length;a++)n[a-3]=arguments[a];var i=t,s=r,o=n,g=arguments.length;if("number"==typeof t)i=null,s=t,g>2&&o.splice(0,0,r);else if(2==g&&"number"!=typeof t||g>2&&"number"!=typeof r)throw"参数有误";return[e,i,s,o]};e.setTimeout=t,e.setTimeout4Tick=r,e.clearTimeout=n,e.setInterval=a,e.setInterval4Tick=i,e.clearInterval=s;var f=function(){if(!l){l=!0,egret.Ticker.getInstance().register(function(e){var t=u;for(var r in t){var n=t[r],a=n[0],i=n[1],s=n[2],o=n[3],g=n[4]+e;g>=s?(a.apply(i,o),delete t[r]):n[4]=g}var l=v;for(var c in l){var n=l[c],a=n[0],i=n[1],f=n[2]||1,o=n[3],g=n[4]+e,p=g-f;if(p>=0){for(;p>=0;)a.apply(i,o),p-=f;n[4]=p+f}else n[4]=g}},e);var t=egret.MainContext.instance.stage,r={deactivateTime:0};t.addEventListener(egret.Event.DEACTIVATE,function(){this.deactivateTime=egret.getTimer()},r),t.addEventListener(egret.Event.ACTIVATE,function(){var t=egret.getTimer()-this.deactivateTime;e.debug("休眠了 %d 毫秒",t);var r=u,n=[];for(var a in r){var i=r[a],s=i[0],o=i[1],g=i[2],l=i[3],c=i[4]+t,f=i[5];f&&(c>=g?n.push([s,o,g,l,g-i[4],1,a]):i[4]=c)}var p=v;for(var _ in p){var i=p[_],s=i[0],o=i[1],m=i[2]||1,l=i[3],f=i[5];if(f){var h=m-i[4];if(t>=h){for(;t>=h;)n.push([s,o,g,l,h,2,_]),h+=m;i[4]=h-m}else i[4]+=t}}n.sort(function(e,t){var r=e[4],n=t[4];return r>n?1:r==n?0:-1});for(var d=0,T=n.length;T>d;d++){var i=n[d],s=i[0],o=i[1],g=i[2],l=i[3],M=i[5],E=i[6];if(1==M){if(!u[E])continue;delete u[E]}else if(!v[E])continue;s.apply(o,l)}},r)}};egret.Boot.once(egret.Boot.AFTER_CONFIG,f)}(tm||(tm={}));