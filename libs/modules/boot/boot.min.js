var _thisGlobal=this,egret;!function(t){t.isNative=t.MainContext.runtimeType==t.MainContext.RUNTIME_NATIVE}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){a.push(t)}function n(t,r,n){var i=e[r],o=t[r];null==o?e[r]=i:(o=n?!!o:o,e[r]=o)}function i(t){for(var e=0,r=a.length;r>e;e++){var n=a[e];n(t)}}function o(e,r){u[e]=r;var n=new t.URLLoader;n.addEventListener(t.Event.COMPLETE,l,n),n.addEventListener(t.IOErrorEvent.IO_ERROR,l,n),n.dataFormat=t.URLLoaderDataFormat.TEXT,n.load(new t.URLRequest(e))}var s=t.registerClass;t.registerClass=function(e,r){var n=e.prototype,i=r.split(".");e.__className=n.__className=i[i.length-1],n.__class=e,s&&s.apply(t,arguments)};var a=[];e.registerValueHandler=r,e.setValue=n,e._parse=i;var u={},l=function(e){var r=this,n=e.target,i=n._request.url;r.removeEventListener(t.Event.COMPLETE,l,t),r.removeEventListener(t.IOErrorEvent.IO_ERROR,l,t);var o=u[i];if(delete u[i],e._type==t.IOErrorEvent.IO_ERROR)o&&o("配置文件读取失败");else{var s=JSON.parse(r.data);o&&o(null,s)}};e.load=o,e.version="0.0.1",e["package"]="com.modo7game",e.projName="mo",e.appName="摩多游戏",e.logLvl={},e.renderMode=1,e.showFPS=!1,e.frameRate=60,e.design={width:960,height:640},e.resolution={width:0,height:0},e.option={},r(function(t){n(t,"version"),n(t,"package"),n(t,"projName"),n(t,"appName"),n(t,"logLvl"),n(t,"renderMode"),n(t,"showFPS",!0),n(t,"frameRate"),n(t,"design"),n(t,"resolution"),n(t,"option"),n(t,"scaleMode")})}(e=t.project||(t.project={}))}(egret||(egret={}));var logger;!function(t){function e(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=t.length;if(1>r)return"";var n=t[0],i=!0;"object"==typeof n&&(n=JSON.stringify(n),i=!1),null==n&&(n="null"),n+="";var o=1;if(i){for(var s=n.replace(/(%d)|(%i)|(%s)|(%f)|(%o)/g,function(e){if(t.length<=o)return e;var r=t[o++];return"%d"==e||"%i"==e?parseInt(r):r}),a=t.length;a>o;o++)s+="    "+t[o];return s}for(var u=1;r>u;++u){var l=t[u];l="object"==typeof l?JSON.stringify(l):l,n+="    "+l}return n}function r(r,n){i[n]=r,egret.isNative?(r.log=function(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];console.log(n+".log: "+e.apply(t,r))},r.debug=function(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];console.debug(n+".debug: "+e.apply(t,r))},r.info=function(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];console.debug(n+".info: "+e.apply(t,r))},r.warn=function(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];console.warn(n+".warn: "+e.apply(t,r))},r.error=function(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];console.error(n+".error: "+e.apply(t,r))}):(r.log=console.log.bind(console),r.debug=console.debug.bind(console),r.info=console.info.bind(console),r.warn=console.warn.bind(console),r.error=console.error.bind(console))}function n(t,e){if("default"==t){for(var n in i)if("default"!=n){var o=i[n];o&&(r(o,n),e>1&&(o.log=function(){},o.debug=function(){}),e>2&&(o.info=function(){}),e>3&&(o.warn=function(){}),e>4&&(o.error=function(){}))}}else{var o=i[t];if(!o)return;r(o,t),e>1&&(o.log=function(){},o.debug=function(){}),e>2&&(o.info=function(){}),e>3&&(o.warn=function(){}),e>4&&(o.error=function(){})}}t.formatStr=e;var i={};t.initLogger=r,t.setLvl=n,r(t,"logger")}(logger||(logger={}));var logger;!function(t){var e;!function(e){t.initLogger(e,"evt"),t.setLvl("evt",4)}(e=t.evt||(t.evt={}))}(logger||(logger={}));var egret;!function(t){function e(){t.Ticker.getInstance().register(function(){if(f.length=0,g.length>0){for(var t=0,e=g.length;e>t;t++){var r=g[t],n=r._store,i=n.valuePool,s=i[o];for(var u in s)p.push(r),h.push(u),v.push(s[u]),delete s[u]}g.length=0;for(var t=0,e=p.length;e>t;t++){var l,c,r=p[t],u=h[t],m=v[t];l=n.getSingle(o,u),r._emitByListenerInfoArr(o,u,l,m),c=n.getTempArr(a,u),n.clear(a,u),r._emitByListenerInfoArr(a,u,c,m),c=n.getTempArr(o,u),r._emitByListenerInfoArr(o,u,c,m),n=r.__class._store,l=n.getSingle(o,u),r._emitByListenerInfoArr(o,u,l,m),c=n.getTempArr(a,u),n.clear(a,u),r._emitByListenerInfoArr(a,u,c,m),c=n.getTempArr(o,u),r._emitByListenerInfoArr(o,u,c,m)}p.length=0,h.length=0,v.length=0}},null)}var r=function(){function e(t,e,r,n,i){this._srcObj=null,this._limit=0,this._pool=[],this._iterator=null,this._iteratorCtx=null,this._onEnd=null,this._onEndCtx=null,this._results=null,this._isErr=!1,this.size=0,this.finishedSize=0,this._workingSize=0;var o=this;o._srcObj=t,o._iterator=r,o._iteratorCtx=i,o._onEnd=n,o._onEndCtx=i,o._results=t instanceof Array?[]:{},o._each(t,function(t,e){o._pool.push({index:e,value:t})}),o.size=o._pool.length,o._limit=e||o.size}var r=(__define,e),n=r.prototype;return n._each=function(t,e,r){if(t)if(t instanceof Array){for(var n=0,i=t.length;i>n;n++)if(e.call(r,t[n],n)===!1)return}else for(var o in t)if(e.call(r,t[o],o)===!1)return},n.onIterator=function(t,e){this._iterator=t,this._iteratorCtx=e},n.onEnd=function(t,e){this._onEnd=t,this._onEndCtx=e},n._handleItem=function(){var e=this;if(0!=e._pool.length&&!(e._workingSize>=e._limit)){var r=e._pool.shift(),n=r.value,i=r.index;e._workingSize++,e._iterator.call(e._iteratorCtx,n,i,function(r){if(!e._isErr){if(e.finishedSize++,e._workingSize--,r)return e._isErr=!0,void(e._onEnd&&e._onEnd.call(e._onEndCtx,r));var n=Array.prototype.slice.call(arguments);return n.splice(0,1),e._results[this.index]=n[0],e.finishedSize==e.size?void(e._onEnd&&e._onEnd.call(e._onEndCtx,null,e._results)):void("undefined"!=typeof t&&null!=t.setTimeout?t.setTimeout(function(){e._handleItem()},this,1):_thisGlobal.setTimeout(function(){e._handleItem()},1))}}.bind(r),e)}},n.flow=function(){var e=this,r=function(){if(0==e._pool.length)e._onEnd&&e._onEnd.call(e._onEndCtx,null,[]);else for(var t=0;t<e._limit;t++)e._handleItem()};"undefined"!=typeof t&&null!=t.setTimeout?t.setTimeout(function(){r()},this,1):_thisGlobal.setTimeout(function(){r()},1)},e}();t.AsyncPool=r,t.registerClass(r,"egret.AsyncPool");var n=function(){function t(){this.pool={},this.tempPool={},this.pool4Single={},this.tempArgsMap={},this.valuePool={}}var e=(__define,t),r=e.prototype;return r.register=function(t,e,r,n,i){var o=this.pool,s=o[t];s||(o[t]=s={});var a=s[e];a||(a=s[e]=[]);for(var u=0,l=a.length;l>u;u++){var c=a[u];if(c&&c.listener==r&&c.ctx==n)return}var g={listener:r,ctx:n,priority:i};if(null==i)a.push(g);else{for(var f=0,u=0,l=a.length;l>u;u++){var c=a[u];if(null==c.priority||c.priority<=i)f=u+1;else if(c.priority>i){f=u;break}}a.splice(f,0,g)}},r.unRegister=function(t,e,r,n){var i=this.pool,o=i[t];if(o){var s=o[e];if(s)for(var a=0,u=s.length;u>a;a++){var l=s[a];if(l.listener==r&&l.ctx==n)return void s.splice(a,1)}}},r.clear=function(t,e){var r=this.pool,n=r[t];if(n){var i=n[e];i&&(i.length=0)}},r.registerSingle=function(t,e,r,n){var i=this,o=i.pool4Single,s=o[t];s||(s=o[t]={}),s[e]={listener:r,ctx:n}},r.unRegisterSingle=function(t,e){var r=this,n=r.pool4Single,i=n[t];i&&delete i[e]},r.unRegisterAll=function(t,e){var r=this.pool,n=this.pool4Single,i=r[t],o=n[t];if(1==arguments.length){if(i)for(var s in i)delete i[s];if(o)for(var s in o)delete o[s]}else{if(i){var a=i[e];a&&(a.length=0)}o&&delete o[e]}},r.getTempArr=function(t,e){var r=this.pool,n=this.tempPool,i=r[t];if(!i)return null;var o=i[e];if(!o)return null;var s=n[t];s||(s=n[t]={});var a=s[e];a||(a=s[e]=[]),a.length=0;for(var u=0,l=o.length;l>u;u++)a.push(o[u]);return a},r.getSingle=function(t,e){var r=this,n=r.pool4Single,i=n[t];return i?i[e]:null},r.getTempArgs=function(t,e,r){var n=this.tempArgsMap,i=n[t];i||(i=n[t]={});var o=i[e];o||(o=i[e]=[]),o.length>0&&(o=[]);for(var s=0,a=r.length;a>s;s++)o.push(r[s]);return o},r.setValue=function(t,e,r){var n=this.valuePool,i=n[t];i||(i=n[t]={}),i[e]=r},r.removeValue=function(t,e){var r=this.valuePool,n=r[t];return n?n[e]:null},r.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},r.dtor=function(){var t=this;delete t.pool,delete t.tempPool,delete t.pool4Single,delete t.tempArgsMap,delete t.valuePool},t}();t.Store=n,t.registerClass(n,"egret.Store");var i="on",o="onNextTick",s="once",a="onceNextTick",u="onAsync",l="onceAsync",c=function(){function e(){var t=this;t._initProp(),t._init()}var r=(__define,e),c=r.prototype;return c._initProp=function(){var t=this;t._store=new n},c._init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},c.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},c.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},c.dtor=function(){this._store.doDtor()},c.on=function(t,e,r){var n=this;return n._store.register(i,t,e,r,null),n},c.onPriority=function(t,e,r,n){var o=this;return o._store.register(i,t,r,n,e),o},c.onAsync=function(t,e,r){var n=this;return n._store.register(u,t,e,r,null),n},c.onAsyncPriority=function(t,e,r,n){var i=this;return i._store.register(u,t,r,n,e),i},c.onNextTick=function(t,e,r){var n=this;return n._store.register(o,t,e,r,null),n},c.onPriorityNextTick=function(t,e,r,n){var i=this;return i._store.register(o,t,r,n,e),i},c.once=function(t,e,r){var n=this;return n._store.register(s,t,e,r,null),n},c.oncePriority=function(t,e,r,n){var i=this;return i._store.register(s,t,r,n,e),i},c.onceAsync=function(t,e,r){var n=this;return n._store.register(l,t,e,r,null),n},c.onceAsyncPriority=function(t,e,r,n){var i=this;return i._store.register(l,t,r,n,e),i},c.onceNextTick=function(t,e,r){var n=this;return n._store.register(a,t,e,r,null),n},c.oncePriorityNextTick=function(t,e,r,n){var i=this;return i._store.register(s,t,r,n,e),i},c.single=function(t,e,r){var n=this;return n._store.registerSingle(i,t,e,r),n},c.singleAsync=function(t,e,r){var n=this;return n._store.registerSingle(u,t,e,r),n},c.singleNextTick=function(t,e,r){var n=this;return n._store.registerSingle(o,t,e,r),n},c.un=function(t,e,r){var n=this;return n._store.unRegister(i,t,e,r),n},c.unNextTick=function(t,e,r){var n=this;return n._store.unRegister(o,t,e,r),n},c.unOnce=function(t,e,r){var n=this;return n._store.unRegister(s,t,e,r),n},c.unOnceNextTick=function(t,e,r){var n=this;return n._store.unRegister(a,t,e,r),n},c.unSingle=function(t){var e=this;return e._store.unRegisterSingle(i,t),e},c.unSingleNextTick=function(t){var e=this;return e._store.unRegisterSingle(o,t),e},c.unAll=function(t){for(var e=this,r=arguments.length,n=[i,s],o=0,a=n.length;a>o;o++){var u=n[o];0==r?e._store.unRegisterAll(u):e._store.unRegisterAll(u,t)}return e},c.unAllNextTick=function(t){for(var e=this,r=[o,a],n=arguments.length,i=0,s=r.length;s>i;i++){var u=r[i];0==n?e._store.unRegisterAll(u):e._store.unRegisterAll(u,t)}return e},c._emitByListenerInfoArr=function(t,e,r,n){if(r){var i=this;if(r=r instanceof Array?r:[r],0==r.length)return;var n=i._store.getTempArgs(t,e,n);n.push(e),n.push(i);for(var o=0,s=r.length;s>o;o++){var a=r[o];if(a){var u=a.listener;u&&u.apply(a.ctx,n)}}r.length=0,n.length=0}},c.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n,o,a=this,u=a._store;return n=u.getSingle(i,t),a._emitByListenerInfoArr(i,t,n,e),o=u.getTempArr(s,t),u.clear(s,t),a._emitByListenerInfoArr(s,t,o,e),o=u.getTempArr(i,t),a._emitByListenerInfoArr(i,t,o,e),u=a.__class._store,n=u.getSingle(i,t),a._emitByListenerInfoArr(i,t,n,e),o=u.getTempArr(s,t),u.clear(s,t),a._emitByListenerInfoArr(s,t,o,e),o=u.getTempArr(i,t),a._emitByListenerInfoArr(i,t,o,e),a},c.emitAsync=function(e,r,n){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s,a,c=this,g=c._store,f=[];if(s=g.getSingle(u,e),s&&f.push(f),a=g.getTempArr(l,e))for(var p=0,h=a.length;h>p;p++)f.push(a[p]);if(g.clear(l,e),a=g.getTempArr(u,e))for(var p=0,h=a.length;h>p;p++)f.push(a[p]);if(g=c.__class._store,s=g.getSingle(u,e),s&&f.push(f),a=g.getTempArr(l,e))for(var p=0,h=a.length;h>p;p++)f.push(a[p]);if(g.clear(l,e),a=g.getTempArr(u,e))for(var p=0,h=a.length;h>p;p++)f.push(a[p]);var v=[null].concat(i);v.push(e),v.push(c);var m=new t.AsyncPool(f,0,function(t,e,r){v[0]=r,t.listener.apply(t.ctx,v)},r,n);return m.flow(),c},c.emitNextTick=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this;return n._store.setValue(o,t,e),g.indexOf(n)<0&&g.push(n),n},c.emitBoth=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this;return n.emit.apply(n,arguments),n.emitNextTick.apply(n,arguments),n},c.emitPhase=function(t,e,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];var o=this;return o},c.emitPhaseNextTick=function(t,e,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];var o=this;return o},e.on=function(t,e,r){return this.prototype.on.apply(this,arguments)},e.onPriority=function(t,e,r,n){return this.prototype.onPriority.apply(this,arguments)},e.onAsync=function(t,e,r){return this.prototype.onAsync.apply(this,arguments)},e.onAsyncPriority=function(t,e,r,n){return this.prototype.onAsyncPriority.apply(this,arguments)},e.onNextTick=function(t,e,r){return this.prototype.onNextTick.apply(this,arguments)},e.onPriorityNextTick=function(t,e,r,n){return this.prototype.onPriorityNextTick.apply(this,arguments)},e.once=function(t,e,r){return this.prototype.once.apply(this,arguments)},e.oncePriority=function(t,e,r,n){return this.prototype.oncePriority.apply(this,arguments)},e.onceAsync=function(t,e,r){return this.prototype.onceAsync.apply(this,arguments)},e.onceAsyncPriority=function(t,e,r,n){return this.prototype.onceAsyncPriority.apply(this,arguments)},e.onceNextTick=function(t,e,r){return this.prototype.onceNextTick.apply(this,arguments)},e.oncePriorityNextTick=function(t,e,r,n){return this.prototype.oncePriorityNextTick.apply(this,arguments)},e.single=function(t,e,r){return this.prototype.single.apply(this,arguments)},e.singleAsync=function(t,e,r){return this.prototype.singleAsync.apply(this,arguments)},e.singleNextTick=function(t,e,r){return this.prototype.singleNextTick.apply(this,arguments)},e.un=function(t,e,r){return this.prototype.un.apply(this,arguments)},e.unNextTick=function(t,e,r){return this.prototype.unNextTick.apply(this,arguments)},e.unOnce=function(t,e,r){return this.prototype.unOnce.apply(this,arguments)},e.unOnceNextTick=function(t,e,r){return this.prototype.unOnceNextTick.apply(this,arguments)},e.unSingle=function(t){return this.prototype.unSingle.apply(this,arguments)},e.unSingleNextTick=function(t){return this.prototype.unSingleNextTick.apply(this,arguments)},e.unAll=function(t){return this.prototype.unAll.apply(this,arguments)},e.unAllNextTick=function(t){return this.prototype.unAllNextTick.apply(this,arguments)},e.formatBeforeEvent=function(t){return t+".before"},e.formatAfterEvent=function(t){return t+".after"},e.create=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this,n=new r;return n.init&&n.init.apply(n,arguments),n},e.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this;if(!r._instance){var n=r._instance=r.create.apply(r,arguments);n._isInstance=!0}return r._instance},e.purgeInstance=function(){var t=this,e=t._instance;e&&(e.doDtor&&e.doDtor(),t._instance=null)},e._store=new n,e}();t.Emitter=c,t.registerClass(c,"egret.Emitter");var g=[],f=[],p=[],h=[],v=[];t._loop4Emitter=e}(egret||(egret={}));var egret;!function(t){function e(t){o(t)}var r=function(){var e={},r=window.location.href,n=r.indexOf("?");if(n>0)for(var i=r.substring(n+1),o=i.split("&"),s=0,a=o.length;a>s;s++){var u=o[s],l=u.split("="),c=l[0],g=l[1];g.match(/(^\d+$)/)?g=parseInt(g):g.match(/(^\d+.\d+$)/)&&(g=parseFloat(g)),e[c]=g}t.project._parse(e)},n=function(e){var n="resource/project.json";t.isNative&&(n+="?v="+Date.now()),t.project.load(n,function(n,i){return n?console.error("缺失project.json文件，请检查！"):t.project._parse(i),!t.devMode||t.isNative?e():void t.project.load("resource/myProject.json",function(n,i){n||null==i?(r(),e()):(t.project._parse(i),r(),e())})})},i=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e);r.prototype;return e.AFTER_EGRET="afterEgret",e.AFTER_CONFIG="afterConfig",e.AFTER_MAIN="afterMain",e}(t.Emitter);t.Boot=i,t.registerClass(i,"egret.Boot");var o=function(e){var r=i.getInstance();t._loop4Emitter(),r.emit(i.AFTER_EGRET),r.emitAsync(i.AFTER_EGRET,function(){n(function(){var n=t.project.logLvl;if("number"==typeof n)logger.setLvl("default",n);else{var o=n["default"];null!=o&&logger.setLvl("default",o);for(var s in n)"all"!=s&&logger.setLvl(s,n[s])}if(!t.isNative){var a=document.getElementsByTagName("title")[0];a?a.innerHTML=t.project.appName:(a=document.createElement("title"),a.innerHTML=t.project.appName,document.getElementsByTagName("head")[0].appendChild(a))}r.emit(i.AFTER_CONFIG),r.emitAsync(i.AFTER_CONFIG,function(){console.log("项目启动完毕！"),r.emit(i.AFTER_MAIN),e&&e()})})},null)};t.boot=e}(egret||(egret={}));