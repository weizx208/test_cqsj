var g_shop;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var s=(__define,o),r=s.prototype;return r._childrenCreated=function(){e.prototype._childrenCreated.call(this)},r.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;t.name="shop_cell_"+t.itemIndex;var o=t.data,s=(o[1],o[0]),r=o[2],i=o[3],a=o[4],n=(o[5],o[7]);t.img_currency.source=uiHelper.resIco[utils.getCurrencyTypeItemId(r)],t.ico_item.setData({itemId:s,count:0}),t.label_yb.text=i,t.grp_discount.visible=!1,t.ico_new.visible=n>0,n>0&&(t.ico_new.source=mo.STR.format("ui_%s_discount",n)),t.label_vipCanBuy.visible=!1,t.btn_buy.visible=a>0||-1==a,t.ico_sellout.visible=!t.btn_buy.visible;var p=o[6];t.label_part.visible=!1,p&&p==gc.c_prop.shopTypeKey.equip&&(t.label_part.visible=!0,t.label_part.text=gd.equipCtrl.getEquipTypeName(s));var _=gd.shopCtrl.isShopEquipReddot();t.img_red.visible=p==gc.c_prop.shopTypeKey.equip&&-1!=_.indexOf(t.itemIndex)},r._tap_btn_buy=function(){var e=this,o=e.data,s=o[6];s&&s==gc.c_prop.shopTypeKey.equip?gd.shopCtrl.buy(s,e.itemIndex,1,function(){},e):t.ShopBuy.create().setData({type:s,shopItem:e.data,index:e.itemIndex}).show()},o.ON_BTN_BUY="on_btn_buy",o}(mo.gui.ItemRenderer);t.ShopItem=e,egret.registerClass(e,"g_shop.ShopItem")}(g_shop||(g_shop={}));var g_shop;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var s=(__define,o),r=s.prototype;return r._initProp=function(){var o=this;e.prototype._initProp.call(this),o._Item_list_items=t.ShopItem,o.registerClassByKey(gd.ShopCtrl,gd.ShopCtrl.ON_BUY_SUCC,o.reset)},r.reset=function(t){var e=this;e.data.shopItemType==t&&gd.shopCtrl.getList(t,function(t){e.setData({itemList:t}),e.refreshList("list_items")},e)},r.dataChanged=function(){var t=this;e.prototype.dataChanged.call(this),t.refreshList("list_items")},r._data_list_items=function(){var t=this;return t.data.itemList},r._initItem_list_items=function(t){var e=this,o=t.ico_item;o.onClick(function(){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.data[0],1)}).show()},e)},o}(mo.gui.Layer);t.Shop=e,egret.registerClass(e,"g_shop.Shop")}(g_shop||(g_shop={}));var g_shop;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),s=o.prototype;return s.onEnter=function(){t.prototype.onEnter.call(this);var e=this,o=e.data.shopItem,s=(e.data.type,o[0]),r=(o[1],o[2]),i=o[3],a=o[4],n=mo.getJSONWithFileNameAndID(gc.cfg_t_item,s);e.buyNum=1,e.label_name.text=n[gc.t_item_name],e.ico_item.setData({itemId:s,count:0}),e.label_desc.text=n[gc.t_item_note],e.label_num.text=e.buyNum,e.label_canBuyNum.visible=!1,a>0?(e.label_canBuyNum.text=mo.STR.format("今日可购买%s个(每日05:00更新)",a),e.label_canBuyNum.visible=!0):e.label_canBuyNum.visible=!1;var s=utils.getCurrencyTypeItemId(r);uiHelper.setResGrp(e.grp_res,s,i)},s._getMaxBuyNum=function(){var t=this,e=t.data.shopItem,o=e[2],s=utils.getCurrencyTypeItemId(o),r=e[4],i=e[3];return 0>r?Math.max(1,Math.floor(gd.userCtrl.getItemNum(s)/i)):r},s._tap_btn_sub=function(){var t=this;t.buyNum>1&&(t.buyNum--,t.showNum())},s._tap_btn_add=function(){var t=this;t.buyNum<t._getMaxBuyNum()&&(t.buyNum++,t.showNum())},s._tap_btn_min=function(){var t=this;t.buyNum-=10,t.buyNum<1&&(t.buyNum=1),t.showNum()},s._tap_btn_max=function(){var t=this;t.buyNum+=10,t.buyNum>t._getMaxBuyNum()&&(t.buyNum=t._getMaxBuyNum()),t.showNum()},s.showNum=function(){var t=this;t.label_num.text=t.buyNum,t.grp_res.getChildByName("num").text=t.buyNum*t.data.shopItem[3]},s._tap_btn_ok=function(){var t=this;t.data.type==gc.c_prop.shopTypeKey.rebirth?gd.reBirthCtrl.buyRebirth(t.data.index,t.buyNum,t.close,t):gd.shopCtrl.buy(t.data.type,t.data.index,t.buyNum,function(){t.close()},t)},e}(mo.gui.Dlg);t.ShopBuy=e,egret.registerClass(e,"g_shop.ShopBuy")}(g_shop||(g_shop={}));var g_shop;!function(t){t.SUBMID_ITEM=1,t.SUBMID_MOJIN=2;var e=function(e){function o(){e.apply(this,arguments),this._comps=[]}__extends(o,e);var s=(__define,o),r=s.prototype;return r._childrenCreated=function(){e.prototype._childrenCreated.call(this);var o=this;this.tab_str.dataProvider=o.viewStack,this.tab_str.selectedIndex=0,o.tabLastSelectIndex=0,o._comps.push(t.ShopBuyEquip.create().setData({tray:o.container}).show()),o._comps.push(t.Shop.create().setData({tray:o.container}).show()),o._comps.push(t.Shop.create().setData({tray:o.container}).show()),process.nextTick(function(){o.tab_str.selectedIndex=0,o._tap_tab_str()})},r._hideAllComp=function(){for(var t=this,e=0,o=t._comps.length;o>e;e++)t._comps[e].visible=!1},r.dtor=function(){var t=this;e.prototype.dtor.call(this);for(var o=0,s=t._comps.length;s>o;o++)mo.gui.helper.rm(t._comps[o]);t._comps=null},r._tap_tab_str=function(){var t,e=this,o=e.tab_str.selectedIndex,s=mo.getJSONWithFileName(gc.cfg_c_open);if(1==o&&(t=s[gc.id_c_open.stoneShop][gc.c_open_lvlRequired]),gd.userCtrl.getLvl()<t)return process.nextTick(function(){e.tab_str.selectedIndex=e.tabLastSelectIndex,e.viewStack.selectedIndex=e.tabLastSelectIndex}),mo.showMsg(gc.id_c_msgCode.noRoleLvl,t);e.tabLastSelectIndex=o,e._hideAllComp();var r=e._comps[o];r.visible=!0,1==o?(gd.shopCtrl.getList(gc.c_prop.shopTypeKey.gem,function(t){r.setData({shopItemType:gc.c_prop.shopTypeKey.gem,itemList:t})},e),e.resBar.showRes(!0,!0)):2==o?(gd.shopCtrl.getList(gc.c_prop.shopTypeKey.normal,function(t){r.setData({shopItemType:gc.c_prop.shopTypeKey.normal,itemList:t})},e),e.resBar.showRes(!0,!0)):0==o&&(gd.shopCtrl.getList(gc.c_prop.shopTypeKey.equip,function(t){r.setData({itemList:t})},e),e.resBar.showRes(!0,!0))},r._tap_btn_recharge=function(){mo.moduleMgr.runModule(g_consts.moduleId.recharge)},r._tap_btn_back=function(){mo.moduleMgr.runModule(g_consts.moduleId.fight)},o}(mo.gui.Layer);t.ShopLayer2=e,egret.registerClass(e,"g_shop.ShopLayer2")}(g_shop||(g_shop={}));var g_shop;!function(t){logger.initLogger(t,"g-shop"),logger.setLvl("g-shop",4);var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var s=(__define,o),r=s.prototype;return r.show=function(){var o=this;e.prototype.show.call(this),g_base.modIdx=5,gd.shopCtrl.getList(gc.c_prop.shopTypeKey.equip,function(e){var s=t.ShopLayer2.create();s.moduleParam=o.moduleParam,s.setData({itemList:e,type:gc.c_prop.shopTypeKey.equip}).show()},o),g_base.BaseBottomBar.create().show()},o}(mo.gui.UIScene);t.ShopScene=e,egret.registerClass(e,"g_shop.ShopScene"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){e()})})}(g_shop||(g_shop={}));var g_shop;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var s=(__define,o),r=s.prototype;return r._initProp=function(){var o=this;e.prototype._initProp.call(this),o._Item_list_items=t.ShopItem,o.registerClassByKey(gd.ShopCtrl,gd.ShopCtrl.ON_BUY_SUCC,o.reset),o.registerClassByKey(gd.UserCtrl,gd.UserCtrl.ON_TEN_LVL,o.reset)},r._childrenCreated=function(){var t=this;e.prototype._childrenCreated.call(this),t._setRefreshCost()},r._setRefreshCost=function(){var t=this,e=t.grp_refresh_cost,o=e.getChildByName("num"),s=e.getChildByName("icon"),r=gd.shopCtrl.getRefreshCount(gc.c_prop.shopTypeKey.equip);o.text=r>0?r:"免费",s.width=s.height=r>0?0/0:0},r.dataChanged=function(){var t=this;e.prototype.dataChanged.call(this),t.refreshList("list_items")},r.reset=function(t){var e=this;t==gc.c_prop.shopTypeKey.equip&&gd.shopCtrl.getList(gc.c_prop.shopTypeKey.equip,function(t){e.setData({itemList:t}),e.refreshList("list_items"),e._setRefreshCost()},e)},r._data_list_items=function(){var t=this;return process.nextTick(function(){mo.emitter.emit("shopList")}),t.data.itemList},r._tap_btn_refresh=function(){var t=this;gd.shopCtrl.refresh(gc.c_prop.shopTypeKey.equip,!1,function(e){t.reset(gc.c_prop.shopTypeKey.equip)},t)},r._tap_btn_buyAll=function(){var t=this;gd.shopCtrl.buyAll(gc.c_prop.shopTypeKey.equip,function(){t.reset(gc.c_prop.shopTypeKey.equip)},t)},r._initItem_list_items=function(t){var e=this,o=t.ico_item;o.showEquipName=!0,o.onClick(function(){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.data[0],null),extra:[t.data[9],t.data[8]]}).show()},e)},o}(mo.gui.Layer);t.ShopBuyEquip=e,egret.registerClass(e,"g_shop.ShopBuyEquip")}(g_shop||(g_shop={}));var g_shop;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var s=(__define,o),r=s.prototype;return r._initProp=function(){var o=this;e.prototype._initProp.call(this),o._Item_list_items=t.ArenaShopItem,o.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.prestige.toString(),o.updataJf)},r._childrenCreated=function(){var t=this;e.prototype._childrenCreated.call(this),t.moduleParam&&t.setData(t.moduleParam)},r.onEnter=function(){e.prototype.onEnter.call(this);var t=this;t.label_sw.text=gd.userCtrl.getPrestige().toString()},r.updataJf=function(){var t=this;t.label_sw.text=gd.userCtrl.getPrestige().toString()},r._data_list_items=function(){var t=this;return t.data.itemList},o}(mo.gui.Dlg);t.ArenaShop=e,egret.registerClass(e,"g_shop.ArenaShop"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){gd.shopCtrl.getList(gc.c_prop.shopTypeKey.arena,function(o){t.itemList=o,e()},this)})})}(g_shop||(g_shop={}));var g_shop;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var s=(__define,o),r=s.prototype;return r._childrenCreated=function(){e.prototype._childrenCreated.call(this)},r.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,o=t.data,s=(o[1],o[0]),r=(o[2],o[3]);o[4];t.ico_item.setData({itemId:s,count:0}),t.label_sw.text=r},r._tap_btn_buy=function(){var e=this;t.ShopBuy.create().setData({type:gc.c_prop.shopTypeKey.arena,shopItem:e.data,index:e.itemIndex}).show()},o}(mo.gui.ItemRenderer);t.ArenaShopItem=e,egret.registerClass(e,"g_shop.ArenaShopItem")}(g_shop||(g_shop={}));