var egret;!function(n){var t;!function(n){n.payCheckFrq=[2,2,2,2,2,4,4,4,4,4,5,10,20,30,60,600,1800,3600],n.registerValueHandler(function(t){n.setValue(t,"payCheckFrq")})}(t=n.project||(n.project={}))}(egret||(egret={}));var g_channel;!function(n){function t(n,t){mo_channel.channelKeyMap[n]=t}logger.initLogger(n,"g-channel"),logger.setLvl("g-channel",4),n.registerPayInfo=t;var e=function(n){function t(){n.apply(this,arguments),this._isAutoPopLogin=!0,this.isAutoLogin=!1,this.isValidShare=!1,this.isValidAttention=!1,this.isValidSendToDesktop=!1,this.isLogout=!1,this.isMultiAccount=!1}__extends(t,n);var e=(__define,t),o=e.prototype;return o.enterGame=function(n,t){var e=this;gd.AccountCtrl.loginBySdk(egret.project.channelId,e._sdkData,n,t)},o.afterLogin=function(n){mo.warn("afterLogin接口未实现")},o.afterLogout=function(n,t){n&&n.call(t)},o.checkLogin=function(n,t,e){mo.warn("checkLogin接口未实现"),n&&n.call(t)},o.login=function(n,t,e){mo.warn("login接口未实现")},o.openBBS=function(){mo.warn("openBBS接口未实现")},o.validateToken=function(n){return mo.warn("validLoginData接口未实现"),!1},o.restorePayment=function(){},o.stopRestorePayment=function(){},o.bindMobile=function(n,t){n.call(t,!0)},o.isBindMobile=function(n,t){n.call(t,!1,!1)},o.isShowShare=function(n,t){n.call(t,!1)},o.isSendToDesktopSucc=function(n,t){n.call(t,!1)},o.addLog=function(n,t){},o.getDesktopInfo=function(n,t,e){t&&t.call(e,!1,{})},o.setDesktopInfo=function(n,t,e){t&&t.call(e,!1)},o.acquireDesktopReward=function(n,t,e){t&&t.call(e,!1)},o.desktopShare=function(n,t,e){t&&t.call(e,!1)},o.footmark=function(n,t){},o.loadingProgress=function(n){},o.channel=function(){return""},o.homeUrl=function(){return""},o.onChannelReay=function(n,t){n.call(t)},o.getHdpuProperty=function(n){return""},o.getGameSetting=function(n){n({})},t}(mo_channel.BaseChannel);n.BaseSDKChannel=e,egret.registerClass(e,"g_channel.BaseSDKChannel")}(g_channel||(g_channel={}));var g_channel;!function(n){n.key={local:99999,egretCommon:10001,qqBrowser:10002,liebao:10003,qqWan8Aos:10004,xiaohuoban:10005},n.registerPayInfo(n.key.local,gc.c_payInfo_99999),n.registerPayInfo(n.key.egretCommon,gc.c_payInfo_10001),n.registerPayInfo(n.key.qqBrowser,gc.c_payInfo_10001),n.registerPayInfo(n.key.liebao,gc.c_payInfo_10001),n.registerPayInfo(n.key.qqWan8Aos,gc.c_payInfo_10004),n.registerPayInfo(n.key.xiaohuoban,gc.c_payInfo_10001)}(g_channel||(g_channel={}));var g_channel;!function(n){var t=function(n){function t(){n.apply(this,arguments),this.defaultUI=!1,this.appId=249,this._pollingIndex=0,this.isValidPay=!0,this._isRestoredPayment=!1}__extends(t,n);var e=(__define,t),o=e.prototype;return o.supportCheck=function(){var n=this;async.series([function(t){nest.share.isSupport(function(e){n.isValidShare=1==e.share,t()})},function(t){nest.app.isSupport(function(e){mo.log("---->nest.app.isSupport: "+JSON.stringify(e)),n.isValidAttention=1==e.attention,n.isValidSendToDesktop=1==e.sendToDesktop,t()})},function(t){nest.app.isSupport(function(e){mo.log("---->nest.app.isSupport: "+JSON.stringify(e)),n.isValidAttention=1==e.attention,n.isValidSendToDesktop=1==e.sendToDesktop,t()})},function(n){n()}],function(n){mo.log("---->nest.app.isSupport check completly")})},o.afterLogin=function(n){var t=this;t.isLogout=!1,t._sdkData=[n.token],t.name=n.name,t.supportCheck()},o.validateToken=function(n){return-1!=n.status},o.checkLogin=function(n,t,e){var o=this,i={};o.loginOpt=e||i,o.isLogout?(n.call(t,!1),o._isAutoPopLogin&&o.login(n,t,e)):nest.user.checkLogin(o.loginOpt,function(i){o.validateToken(i)?(o.afterLogin(i),n.call(t,!0)):(n.call(t,!1),o._isAutoPopLogin&&o.login(n,t,e))})},o.login=function(n,t,e){var o=this,i={};o.loginOpt=e||i,nest.user.login(o.loginOpt,function(e){o.validateToken(e)?(o.afterLogin(e),n.call(t,!0)):n.call(t,!1)})},o.logout=function(n,t){var e=this;e.stopPolling(),e._isRestoredPayment=!1},o.attention=function(){var n={};nest.app.attention(n,function(){})},o.stopPolling=function(){var n=this;n._pollingInvId&&(tm.clearInterval(n._pollingInvId),n._pollingInvId=null)},o.startPolling=function(){var n=this;n._pollingIndex=0;var t=egret.project.payCheckFrq;n._pollingInvId&&tm.clearInterval(n._pollingInvId);var e=function(){return n._pollingInvId&&tm.clearInterval(n._pollingInvId),t[n._pollingIndex]?(n._pollingInvId=tm.setInterval(function(){mo.log("----->request"),gd.rechargeCtrl.handleRequest(function(t){mo.log("---->rstArr: ",JSON.stringify(t));var e=t[0];e&&(mo.log("---->stop polling"),n.stopPolling()),n._isRestoredPayment=e},n),n._pollingIndex++,e()},1e3*t[n._pollingIndex]),void mo.log("start interval arr[%s] = %s",n._pollingIndex,t[n._pollingIndex])):(n._pollingIndex=0,void mo.log("stop interval"))};e()},o.pay=function(n,t,e,o){var i=this;mo.playWaiting(),tm.setTimeout4Tick(function(){mo.stopWaiting()},2e3),gd.rechargeCtrl.getRequest(n,t,function(n){var e=n[0],o=n[1],a={goodsId:t,goodsNumber:"1",serverId:o,ext:e};mo.log("--->pInfo: "+JSON.stringify(a)),nest.iap.pay(a,function(){mo.stopWaiting()}),i.startPolling()},i)},o.restorePayment=function(){var n=this;n._isRestoredPayment||n.startPolling()},o.stopRestorePayment=function(){var n=this;n.stopPolling()},o.share=function(n,t,e){var o={title:n.title,description:n.description,img_title:n.img_title,img_url:n.img_url,url:n.url};mo.log("---->shareInfo = "+JSON.stringify(o)),nest.share.share(o,function(n){mo.log("---->shareBack data = "+JSON.stringify(n)),t&&t.call(e,0==n.result)})},o.sendToDesktop=function(n,t,e){nest.app.sendToDesktop(n,function(n){t&&t.call(e,0==n.result)})},t.CHANNEL_ID=10001,t}(n.BaseSDKChannel);n.Channel10001=t,egret.registerClass(t,"g_channel.Channel10001")}(g_channel||(g_channel={}));var g_channel;!function(n){var t=function(n){function t(){n.apply(this,arguments),this.isMultiAccount=!0,this._isAutoPopLogin=!1}__extends(t,n);var e=(__define,t),o=e.prototype;return o.validateToken=function(n){return null!=n.token},o.getLoginOpt=function(){return{loginType:mo.getLocalStorageItem("loginType",!0)}},o.openBBS=function(){nest.social.openBBS({},function(){})},t}(n.Channel10001);n.Channel10002=t,egret.registerClass(t,"g_channel.Channel10002")}(g_channel||(g_channel={}));var g_channel;!function(n){var t=function(n){function t(){n.apply(this,arguments),this.isValidSendToDesktop=!0}__extends(t,n);var e=(__define,t);e.prototype;return t}(n.Channel10001);n.Channel10003=t,egret.registerClass(t,"g_channel.Channel10003")}(g_channel||(g_channel={}));var g_channel;!function(n){var t=function(n){function t(){n.apply(this,arguments)}__extends(t,n);var e=(__define,t),o=e.prototype;return o.login=function(t,e,o){var i={loginType:"qq"};n.prototype.login.call(this,t,e,i)},t}(n.Channel10001);n.Channel10004=t,egret.registerClass(t,"g_channel.Channel10004")}(g_channel||(g_channel={}));var g_channel;!function(n){function t(n){function t(n,t,e){o[decodeURIComponent(t)]=decodeURIComponent(e)}n||(n=location.href);var e=/(?:[?&]+)([^&]+)=([^&]+)/g,o={};return n.replace(e,t),o}function e(n){return void 0===n&&(n=location.href),"50f9bc36643e738e"}!function(n){n[n.WeiDuan=0]="WeiDuan",n[n.FenXiang=1]="FenXiang",n[n.GuangZhu=2]="GuangZhu",n[n.XiongDi=3]="XiongDi"}(n.WooolSdkDesktopShowType||(n.WooolSdkDesktopShowType={}));n.WooolSdkDesktopShowType;!function(n){n[n.Fight=0]="Fight",n[n.Home=1]="Home"}(n.WooolSdkDesktopPosition||(n.WooolSdkDesktopPosition={}));n.WooolSdkDesktopPosition;n.formatUrl=t,n.getGameKey=e;var o=function(o){function i(){o.apply(this,arguments),this.isAutoLogin=!0,this._pollingIndex=0,this._isRestoredPayment=!1,this._channelReady=!1}__extends(i,o);var a=__define,l=i,r=l.prototype;return r._initProp=function(){var e=this;e.__class;o.prototype._initProp.call(this),e.urlData=t(),e.hGame=new hGame(e.urlData),e.hGame.ready(function(){n.debug("--->hGame onReady!"),e._channelReady=!0,e._onChannelReadyCb.call(e._onChannelReadyCbtx)}),e._logActions=[]},r.afterLogin=function(n){var t=this;t.isLogout=!1,t._sdkData=[n.token],t.name=n.name},r.validateToken=function(n){return!0},r.checkLogin=function(n,t,e){n.call(t,!1)},r.login=function(n,t,e){var o=this,i={};o.loginOpt=e||i;var a=o.urlData.ticket,l=o.urlData.login_type;gd.AccountCtrl.loginBySdk(o.__class.CHANNEL_ID,[a,l],function(e){n.call(t,!0)},o)},r.logout=function(n,t){this.hGame.logout()},r.stopPolling=function(){var n=this;n._pollingInvId&&(tm.clearInterval(n._pollingInvId),n._pollingInvId=null)},a(r,"isMultiAccount",function(){var n=this.channel();return"qqbrowser"==n||"x4399"==n?!0:!1}),r.startPolling=function(){var n=this;n._pollingIndex=0;var t=egret.project.payCheckFrq;n._pollingInvId&&tm.clearInterval(n._pollingInvId);var e=function(){return n._pollingInvId&&tm.clearInterval(n._pollingInvId),t[n._pollingIndex]?(n._pollingInvId=tm.setInterval(function(){mo.log("----->request"),gd.rechargeCtrl.handleRequest(function(t){mo.log("---->rstArr: ",JSON.stringify(t));var e=t[0];e&&(mo.log("---->stop polling"),n.stopPolling()),n._isRestoredPayment=e},n),n._pollingIndex++,e()},1e3*t[n._pollingIndex]),void mo.log("start interval arr[%s] = %s",n._pollingIndex,t[n._pollingIndex])):(n._pollingIndex=0,void mo.log("stop interval"))};e()},r.pay=function(t,e,o,i){var a=this;mo.playWaiting(),tm.setTimeout4Tick(function(){mo.stopWaiting()},2e3),gd.rechargeCtrl.getRequest(t,e,function(t){var e=(t[0],t[1],t[2]),o="alipay_wap";n.debug(e,o),a.hGame.pay(e,o,function(n){0==n.code&&mo.stopWaiting(),g_base.BaseShowMsg.create().setData({msg:n.showMessage}).show()}),a.startPolling()},a)},r.restorePayment=function(){var n=this;n._isRestoredPayment||n.startPolling()},r.stopRestorePayment=function(){var n=this;n.stopPolling()},r.isBindMobile=function(n,t){var e=mo_channel.getCurChannel().channel();return"wanba"==e?n.call(t,!1,!1):void wooolsdk.queryBindState(function(e){e||n.call(t,!1,!1),console.log("ret",JSON.stringify(e)),0==e.code?n.call(t,!0,1==e.data.bindflag):n.call(t,!1,!1)})},r.bindMobile=function(n,t){gd.userCtrl.getBindPhoneUrl(function(e){wooolsdk.bindMobile(function(e){console.log("bind_back:",JSON.stringify(e)),e||n.call(t,!1),n.call(t,1==e.data.bindflag)},e)},this)},r.getDesktopInfo=function(n,t,e){wooolsdk.queryDesktopState(function(n){return null==n||0!=n.code?void(t&&t.call(e,!1,{})):void(t&&t.call(e,!0,n.data?n.data:{}))},n)},r.setDesktopInfo=function(n,t,e){wooolsdk.addDesktop(function(n){return null==n||0!=n.code?void(t&&t.call(e,!1)):void(t&&t.call(e,!0))},n)},r.acquireDesktopReward=function(n,t,e){wooolsdk.addDesktopReward(function(n){return null==n||0!=n.code?void(t&&t.call(e,!1)):void(t&&t.call(e,!0))},n)},r.desktopShare=function(n,t,e){wooolsdk.friendShare(n,function(n){return null==n||0!=n.code?void(t&&t.call(e,!1)):void(t&&t.call(e,!0))})},r.footmark=function(n,t){var o=gd.userCtrl.get(gc.dsConsts.UserEntity.serverIndexId),i=(gd.serverInfoCtrl.getServerInfoById(o),{game_key:e(),open_id:gd.accountCtrl.get(gc.dsConsts.AccountEntity.sdkData).open_id,role:gd.userCtrl.getId(),nickname:gd.userCtrl.getName(),area:o,group:o});this.hGame.gameReport(n,i,t,null)},r.channel=function(){var n=this.hGame.getPlatform();return 0==n.code?n.data.platform:""},r.homeUrl=function(){var n=this.hGame.getWebUrl();return 0==n.code?n.data.url:""},r.loadingProgress=function(n){this.hGame.loadingProgress(n)},r.onChannelReay=function(n,t){var e=this;e._channelReady?n.call(t):(e._onChannelReadyCb=n,e._onChannelReadyCbtx=t)},r.getHdpuProperty=function(n){var t=window,e=t.hdParameters;if(e&&e.hdpu)for(var o=e.hdpu.split("|"),i=0;i<o.length;i++){var a=o[i],l=a.split(":");if(l&&!(l.length<2)&&l[0]==n)return l[1]}return""},r.getGameSetting=function(n){wooolsdk.queryGameSetting(n)},i.CHANNEL_ID=10005,i}(n.BaseSDKChannel);n.Channel10005=o,egret.registerClass(o,"g_channel.Channel10005"),mo_channel.registerChannel(o)}(g_channel||(g_channel={}));