var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._tap_btn_ok=function(){this.close()},e}(mo.gui.Dlg);t.BindPhoneSucc=e,egret.registerClass(e,"g_mid.BindPhoneSucc")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this)},o._tap_btn_goBind=function(){var t=this,e=mo_channel.getCurChannel();e.bindMobile(function(e){e&&(gd.userCtrl.getBindPhoneReward(function(){mo.showMsg(gc.id_c_msgCode.rewardMail)},t),t.close())},t)},o._childrenCreated=function(){t.prototype._childrenCreated.call(this);for(var e=this,n=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.otherReward),o=n[1],a=o.split(","),i=[],r=0;r<a.length;++r){var s=a[r].split(":");i.push({itemId:s[0],count:s[1]})}uiHelper.setItemsGrp(e.grp_items,i)},e}(mo.gui.Dlg);t.BindPhone=e,egret.registerClass(e,"g_mid.BindPhone"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,t.fullScr=!0,t.notOwnRes=!0,t.onValid(function(){var t=mo_channel.getCurChannel();return 10005==t.__class.CHANNEL_ID&&!gd.userCtrl.isGetBindPhoneReward()}),mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){var n=mo_channel.getCurChannel();n.isBindMobile(function(t,n){return t?(n&&!gd.userCtrl.isGetBindPhoneReward()&&gd.userCtrl.getBindPhoneReward(function(){},this),void e(n?"noNeedOpen":null)):e("noNeedOpen")},this)})})}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this);var e=this;e._Item_list_items=g_base.BaseItemCell},o.showAndType=function(e,n){var o=this;return o.showType=e,o.position=n,t.prototype.show.call(this),o},o._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;1==e.showType?(e.img_bg.source="und_share",e.btn_save.icon="btn_txt_g_sharegame"):2==e.showType&&(e.img_bg.source="und_follow",e.btn_save.icon="btn_txt_g_followgame")},o.onEnter=function(){t.prototype.onEnter.call(this);var e=this,n=mo_channel.getCurChannel();n.getDesktopInfo(e.position,function(t,n){e.btn_save.visible=0==n.isfav,e.btn_get.visible=0!=n.isfav},e)},o._tap_btn_save=function(){var t=this,e=mo_channel.getCurChannel();e.setDesktopInfo(t.position,function(e){e&&t.close()},t)},o._tap_btn_get=function(){var t=this,e=mo_channel.getCurChannel();e.acquireDesktopReward(t.position,function(e){e&&t.close()},t)},o._data_list_items=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.otherReward),n=e[0];1==t.showType&&(n=e[2]);for(var o=n.split(","),a=[],i=0;i<o.length;++i){var r=o[i].split(":");a.push({itemId:r[0],count:r[1]})}return a},o._initItem_list_items=function(t){t.tapShowDetail=!0},e}(mo.gui.Dlg);t.SaveGame=e,egret.registerClass(e,"g_mid.SaveGame")}(g_mid||(g_mid={}));var g_mid;!function(t){logger.initLogger(t,"g-mid"),logger.setLvl("g-mid",4),t.showChatTime=-6e4,t.lastChatStr="",t.lastChatId=-1,t.showLabaTime=-6e4,t.lastLabaId=-1,t.lastLabaStr="";var e=function(e){function n(){e.apply(this,arguments),this.chatDelayId=-1,this.labaDelayId=-2,this.normalChatShowTime=3e4}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t.registerClassByKey(gd.HoodinnCtlr,gd.HoodinnCtlr.ON_ANNOUNCE_UPDATE,t.onAnnounceUpdate),t.registerClassByKey(gd.HoodinnCtlr,gd.HoodinnCtlr.ON_SYSNOTICE_UPDATE,t.onSysNoticeUpdate),t.registerClassByKey(gd.ChatCtrl,gd.ChatCtrl.ON_CHAT_UPDATE,t.onChatUpdate)},a._hide=function(t){var e=this;0==t?e.grp_chat&&(e.grp_chat.visible=!1):1==t&&e.grp_laba&&(e.grp_laba.visible=!1)},a._show=function(t){var e=this;0==t?e.grp_chat&&(e.grp_chat.visible=!0):1==t&&e.grp_laba&&(e.grp_laba.visible=!0)},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var n=this;n.canShowChat&&(t.lastChatStr&&egret.getTimer()-t.showChatTime<n.normalChatShowTime?n._showMsgAndDismiss(0,t.lastChatStr,n.normalChatShowTime-(egret.getTimer()-t.showChatTime)):t.lastLabaStr&&egret.getTimer()-t.showLabaTime<n.normalChatShowTime&&n._showMsgAndDismiss(1,t.lastLabaStr,n.normalChatShowTime-(egret.getTimer()-t.showLabaTime)))},a._tap_ico_chat=function(){t.Chat.create().show()},a._tap_ico_laba=function(){t.Chat.create().show()},a.onChatUpdate=function(t){var e=this;if(0!=t.length){var n=t[t.length-1],o=n[gc.dsConsts.ChatData.type];o!=gc.c_prop.chatTypeKey.user?e._showNormalMsg(n):0==n[gc.dsConsts.ChatData.userArgs][6]?e._showNormalMsg(n):e._showLabaMsg(n)}},a._showNormalMsg=function(e){var n=this,o=e[gc.dsConsts.ChatData.uniqueId];t.lastChatId!=o&&(t.lastChatId=o,t.lastChatStr=gd.chatCtrl.getChatDataStr(e),t.lastChatStr=t.lastChatStr.replace("[/br]",""),n._showMsgAndDismiss(0,t.lastChatStr,n.normalChatShowTime))},a._showLabaMsg=function(e){var n=this,o=e[gc.dsConsts.ChatData.uniqueId];t.lastLabaId!=o&&(t.lastLabaId=o,t.lastLabaStr=gd.chatCtrl.getChatDataStr(e),t.lastLabaStr=t.lastLabaStr.replace("[/br]",""),n._showMsgAndDismiss(1,t.lastLabaStr,n.normalChatShowTime))},a._showMsgAndDismiss=function(e,n,o){var a=this;0==e?(a.grp_all.visible=a.canShowChat&&!0,a._show(0),a.label_chatContent.text=n,t.showChatTime=egret.getTimer(),egret.clearTimeout(a.chatDelayId),a.chatDelayId=egret.setTimeout(function(){a._hide(0),t.showChatTime=0},a,o)):(a.grp_all.visible=a.canShowChat&&!0,a._show(1),a.label_chatContent_laba.text=n,t.showLabaTime=egret.getTimer(),egret.clearTimeout(a.labaDelayId),a.labaDelayId=egret.setTimeout(function(){a._hide(1),t.showLabaTime=0},a,o))},a.onAnnounceUpdate=function(t){null==g_base.baseShowAnnounce&&(g_base.baseShowAnnounce=g_base.BaseShowAnnounce.create().setData(t).show())},a.setChatVisible=function(t){var e=this;e.canShowChat=t,e.canShowChat||(e.grp_all.visible=!1)},a.onSysNoticeUpdate=function(t){null==g_base.BaseSysNotice.instance?g_base.BaseSysNotice.instance=g_base.BaseSysNotice.create().setData(t).show():g_base.BaseSysNotice.instance.setData(t)},n}(mo.gui.MenuLayer);t.BaseMidBar=e,egret.registerClass(e,"g_mid.BaseMidBar")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o.getPrice=function(){var t=this;return t.cost.toString()},o.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;e.rechargeId=e.data[gc.c_recharge_id],e.payId=e.data[gc.c_recharge_payId];var n=(e.data[gc.c_recharge_eventIcon],mo.getJSONWithFileNameAndID(gc.cfg_c_payInfo,e.payId));e.goodsId=n[mo_channel.channelKeyMap[egret.project.channelId]][0],e.cost=n[mo_channel.channelKeyMap[egret.project.channelId]][1];e.data[gc.c_recharge_cost];e.label_cost.text=e.getPrice();var o,a,i=e.data[gc.c_recharge_diamond],r=e.data[gc.c_recharge_first],s=e.data[gc.c_recharge_extra],c=e.data[gc.c_recharge_isTreble],l=!gd.rechargeCtrl.hasBuy(e.rechargeId),_=gd.rechargeCtrl.getAllCostRMB()<=0;_&&c?(r&&l?(o=mo.STR.format("%s×%s元宝 首充送%s元宝",i,3,r),a=mo.STR.format("%s",3*i+r)):(o=s>0?mo.STR.format("%s×%s元宝 另送%s元宝",i,3,s):mo.STR.format("%s×%s元宝",i,3),a=mo.STR.format("%s",3*i+s)),e.ico_3bei.visible=!0,e.ico_tuijian.visible=e.ico_remai.visible=!1):(e.ico_3bei.visible=!1,r&&l?(o=mo.STR.format("%s元宝 首充送%s元宝",i,r),a=mo.STR.format("%s",i+r)):(o=s>0?mo.STR.format("%s元宝 另送%s元宝",i,s):mo.STR.format("%s元宝",i),a=mo.STR.format("%s",i+s)),e.ico_tuijian.visible=1==e.data[gc.c_recharge_eventIcon],e.ico_remai.visible=2==e.data[gc.c_recharge_eventIcon]),e.label_yb2.text=o,e.label_yb.text=a;e.data[gc.c_recharge_id];e.ico_recharge.source=resHelper.getRechargeIconPath(e.data[gc.c_recharge_displayId])},e}(mo.gui.ItemRenderer);t.RechargeItem=e,egret.registerClass(e,"g_mid.RechargeItem")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setSkinName(this,e.__className)},o.getPrice=function(){var t=this;return(10*t.cost).toString()},e}(t.RechargeItem);t.RechargeItemWanba=e,egret.registerClass(e,"g_mid.RechargeItemWanba")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){var n=this;e.prototype._initProp.call(this);var o=mo_channel.getCurChannel().channel();"wanba"==o?n._Item_list_items=t.RechargeItemWanba:n._Item_list_items=t.RechargeItem},a._childrenCreated=function(){e.prototype._childrenCreated.call(this)},a.onEnter=function(){e.prototype.onEnter.call(this);var t=this,n=gd.userCtrl.getVip(),o=n+1;o>gd.rechargeCtrl.getMaxVip()&&(o=gd.rechargeCtrl.getMaxVip()),t.label_vip.text=n.toString(),t.label_nextVip.text=o.toString();var a=gd.userCtrl.getNextVipScore()-gd.userCtrl.getVipScore();0>a&&(a=0),t.label_nextRecharge.text=a.toString(),t.bar_recharge.maximum=gd.userCtrl.getNextVipScore(),t.bar_recharge.setValue(gd.userCtrl.getVipScore())},a._click_list_items=function(t){var e=this,n=t.item,o=n[gc.c_recharge_id],a=n[gc.c_recharge_payId],i=mo.getJSONWithFileNameAndID(gc.cfg_c_payInfo,a),r=i[mo_channel.channelKeyMap[egret.project.channelId]][0];mo_channel.getCurChannel().pay(o,r,function(t){mo.log("充值成功")},e)},a._data_list_items=function(){return gd.rechargeCtrl.getList()},a._tap_btn_lookVip=function(){var t=this;t.close(),process.nextTick(function(){mo.moduleMgr.runModule(g_consts.moduleId.vip)})},n}(mo.gui.Dlg);t.Recharge=e,egret.registerClass(e,"g_mid.Recharge"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){e()})})}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments),this.vipItems=[]}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this);var e=this;e._Item_list_items=g_base.BaseItemCell,e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.vip.toString(),e.reset)},o.onEnter=function(){t.prototype.onEnter.call(this);var e=this;e.reset()},o.reset=function(){var t=this,e=gd.userCtrl.getVip(),n=e+1;n>gd.rechargeCtrl.getMaxVip()?(n=gd.rechargeCtrl.getMaxVip(),t.grp_next.visible=!1):t.grp_next.visible=!0,t.label_vip.text=e.toString(),t.label_nextVip.text=n.toString();var o=gd.userCtrl.getNextVipScore()-gd.userCtrl.getVipScore();0>o&&(o=0),t.label_nextRecharge.text=o.toString(),t.bar_recharge.maximum=gd.userCtrl.getNextVipScore(),t.bar_recharge.setValue(gd.userCtrl.getVipScore()),t.curVip=gd.userCtrl.getVip(),t.moduleParam.showVipLv&&(t.curVip=parseInt(t.moduleParam.showVipLv)),t.curVip<=0&&(t.curVip=1),t.showVipInfo()},o.showVipInfo=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_vip,t.curVip),n=e[gc.c_vip_addEquipBag],o=e[gc.c_vip_equipCount],a=e[gc.c_vip_bossCount],i=e[gc.c_vip_realmCount],r=e[gc.c_vip_buyBossCount],s=e[gc.c_vip_openRole2],c=e[gc.c_vip_openRole3],l=e[gc.c_vip_openRole4],_=e[gc.c_vip_bossAutoFight],g=e[gc.c_vip_worldCount],d=e[gc.c_vip_guildCount],u=e[gc.c_vip_openingCount],h=e[gc.c_vip_coffersBuild],p=e[gc.c_vip_coffersBuff],m=e[gc.c_vip_copyBossAutoFight],f=e[gc.c_vip_isLock],b="",C=mo.getJSONWithFileNameAndID(gc.cfg_c_vip,t.curVip-1);t.label_vipCost.text=mo.STR.format("充值%s元宝可成为VIP%s",C[gc.c_vip_score],t.curVip),0!=n&&(b+=mo.STR.format("装备背包格子上限增加[ubb color=red]%s[/ubb]格",n),b+="\n"),0!=o&&(b+=mo.STR.format("每天可进入装备副本[ubb color=red]%s[/ubb]次",o),b+="\n"),0!=a&&(b+=mo.STR.format("每天可进入炼狱副本[ubb color=red]%s[/ubb]次",a),b+="\n"),0!=i&&(b+=mo.STR.format("每天可进入元神副本[ubb color=red]%s[/ubb]次",i),b+="\n"),0!=r&&(b+=mo.STR.format("每天可购买炼狱副本次数[ubb color=red]%s[/ubb]次",r),b+="\n"),0!=u&&(b+=mo.STR.format("每日妖莲开光[ubb color=red]%s[/ubb]次",u),b+="\n"),0!=s&&(b+=mo.STR.format("可提前解锁第二个角色"),b+="\n"),0!=c&&(b+=mo.STR.format("可提前解锁第三个角色"),b+="\n"),0!=l&&(b+=mo.STR.format("在飞升一重后即可进行第四角色解锁"),b+="\n"),_&&(b+=mo.STR.format("可在世界BOSS挑战中自动参战"),b+="\n"),f&&(b+=mo.STR.format("可以锁定召唤行会BOSS"),b+="\n"),0!=g&&(b+=mo.STR.format("每日可发送%s次全服红包",g),b+="\n"),0!=d&&(b+=mo.STR.format("每日可发送%s次行会红包",d),b+="\n"),0!=h&&(b+=mo.STR.format("每天可在国库添砖%s次",h),b+="\n"),0!=p&&(b+=-1!=p?mo.STR.format("每日可激励国库守卫%s次",p):mo.STR.format("可激励国库守卫无限次"),b+="\n"),0!=m&&(b+="直接开启自动挑战主线BOSS功能",b+="\n"),0!=e[gc.c_vip_copyCountV7]&&(b+=mo.STR.format("可进入副本凌云山麓%s次",e[gc.c_vip_copyCountV7]),b+="\n"),0!=e[gc.c_vip_copyCountV10]&&(b+=mo.STR.format("可进入副本媚心洞府%s次",e[gc.c_vip_copyCountV10]),b+="\n"),0!=e[gc.c_vip_copyCountV14]&&(b+=mo.STR.format("可进入副本封魔神殿%s次",e[gc.c_vip_copyCountV14]),b+="\n"),0!=e[gc.c_vip_copyCountV17]&&(b+=mo.STR.format("可进入副本黄泉鬼窟%s次",e[gc.c_vip_copyCountV17]),b+="\n"),0!=e[gc.c_vip_copyCountV19]&&(b+=mo.STR.format("可进入副本海底迷阵%s次",e[gc.c_vip_copyCountV19]),b+="\n"),0!=e[gc.c_vip_isPickAct]&&(b+=mo.STR.format("开启行会元宝上香功能"),b+="\n"),0!=e[gc.c_vip_buzhen]&&(b+=mo.STR.format("提前开启布阵功能"),b+="\n"),b=b.substr(0,b.length-1),t.label_vipInfo.text=b,t.label_showVip.text=t.curVip.toString(),t.label_showVip_liBao.text=t.curVip.toString();var v=e[gc.c_vip_itemId];if(t.vipItems=[],0!=v)for(var y=mo.getJSONWithFileNameAndID(gc.cfg_t_itemLogic,v),S=y[gc.t_itemLogic_create],I=0;I<S.length;++I){var T={itemId:S[I][0],count:S[I][1]};t.vipItems.push(T)}t.refreshList("list_items")},o._data_list_items=function(){var t=this;return t.vipItems},o._initItem_list_items=function(t){t.tapShowDetail=!0},o._tap_btn_lookRecharge=function(){var t=this;t.close(),process.nextTick(function(){mo.moduleMgr.runModule(g_consts.moduleId.recharge)})},o._tap_btn_next=function(){var t=this;t.curVip<gd.rechargeCtrl.getMaxVip()&&(t.curVip++,t.showVipInfo())},o._tap_btn_prev=function(){var t=this;t.curVip>1&&(t.curVip--,t.showVipInfo())},e}(mo.gui.Dlg);t.Vip=e,egret.registerClass(e,"g_mid.Vip"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){e()})})}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){var n=this;e.prototype._initProp.call(this);var o=mo_channel.getCurChannel().channel();"wanba"==o&&mo.gui.helper.setSkinName(n,t.FirstRechargeWanba.__className),n._Item_list_items=g_base.BaseItemCell},a._data_list_items=function(){var t=gd.activityCtrl.getFirstRechargeItems();return utils.itemObj2ObjArr(t)},a._childrenCreated=function(){var t=this;if(e.prototype._childrenCreated.call(this),t.btn_get.visible=gd.activityCtrl.hasRecharged(),t.grp_btns.visible=!t.btn_get.visible,t.grp_btns.visible)for(var n=mo.getJSONWithFileName(gc.cfg_c_recharge),o=[n[1],n[2],n[3],n[4]],a=0,i=4;i>a;a++)t._setItemInfo(t["grp_item"+a],o[a])},a._setItemInfo=function(t,e){var n=e[gc.c_recharge_isTreble]>0?3:1,o=(t.getChildByName("btn"),mo.gui.helper.getChild(t,"label_cost")),a=t.getChildByName("label_get"),i=e[gc.c_recharge_cost],r=mo_channel.getCurChannel().channel();"wanba"==r&&(i*=10),o.text=i+"",a.text=e[gc.c_recharge_diamond]*n+e[gc.c_recharge_first]},a._tap_btn_get=function(){var t=this;gd.activityCtrl.hasRecharged()?gd.activityCtrl.receiveFirstRecharge(function(){t.close()}):mo.moduleMgr.pushModule(g_consts.moduleId.recharge)},a._initItem_list_items=function(t){var e=t.ico_item;e.showEquipName=!0,t.tapShowDetail=!0},a._tap_btn_item0=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_recharge);t._doRecharge(e[1])},a._tap_btn_item1=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_recharge);t._doRecharge(e[2])},a._tap_btn_item2=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_recharge);t._doRecharge(e[3])},a._tap_btn_item3=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_recharge);t._doRecharge(e[4])},a._doRecharge=function(t){var e=this,n=t[gc.c_recharge_id],o=t[gc.c_recharge_payId],a=mo.getJSONWithFileNameAndID(gc.cfg_c_payInfo,o),i=a[mo_channel.channelKeyMap[egret.project.channelId]][0];mo_channel.getCurChannel().pay(n,i,function(t){mo.log("充值成功")},e)},n}(mo.gui.Dlg);t.FirstRecharge=e,egret.registerClass(e,"g_mid.FirstRecharge"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){e()})})}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e);n.prototype;return e}(mo.gui.Dlg);t.FirstRechargeWanba=e,egret.registerClass(e,"g_mid.FirstRechargeWanba")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this)},o._childrenCreated=function(){t.prototype._childrenCreated.call(this)},o._switchChatItemStyle=function(t){var e=this;t==gc.c_prop.chatTypeKey.user||t==gc.c_prop.chatTypeKey.guild?(e.label_content.visible=!1,e.label_content.includeInLayout=!1,e.grp_user.visible=!0,e.grp_user.includeInLayout=!0):(e.label_content.visible=!0,e.label_content.includeInLayout=!0,e.grp_user.visible=!1,e.grp_user.includeInLayout=!1)},o._setMedalTitle=function(t){var e=this,n=0!=t;e.grp_user_title.visible=n,e.grp_user_title.includeInLayout=n,n&&(e.img_user_title.source=resHelper.getChatTitle(t))},o.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,n=e.data,o=n[gc.dsConsts.ChatData.type],a="",i="",r="";if(e._switchChatItemStyle(o),e.ico_laba.source="ico_blank_point",o==gc.c_prop.chatTypeKey.user){var s=n[gc.dsConsts.ChatData.userArgs],c=s[3],l=s[4],_=s[5]||0,g=s[2],d=s[6]||0;1==d&&(e.ico_laba.source="ico_chat_laba"),c?(i=mo.STR.format("[ubb color=#ff0000]【GM %s】[/ubb]",s[0]),r=mo.STR.format("[ubb color=#ff0000]%s[/ubb]",g)):(i=s[1]>0?mo.STR.format("[ubb color=#ffad00]VIP%s [/ubb][ubb color=#00cdff]%s[/ubb]",s[1],s[0]):mo.STR.format("[ubb color=#00cdff]%s[/ubb]",s[0]),""!=l&&(i=mo.STR.format("[ubb color=#e76df5]%s[/ubb]",mo.trans4UBB(mo.STR.format("[%s]",l)))+i),r=mo.STR.format("[ubb color=#ffffff]%s[/ubb]",g)),e.label_user_name.text=i,e.label_user_msg.text=r,e._setMedalTitle(_)}else if(o==gc.c_prop.chatTypeKey.guild){var u=n[gc.dsConsts.ChatData.guildArgs];i=mo.STR.format("%s%s[ubb color=#00cdff]%s[/ubb]",u[2]==gc.c_prop.guildPostKey.rankFile?"":mo.STR.format("[ubb color=#F6EC6B][%s][/ubb]",gc.c_prop.guildPost[u[2]]),u[1]>0?mo.STR.format("[ubb color=#ffad00]VIP%s [/ubb]",u[1]):"",u[0]),r=mo.STR.format("[ubb color=#ffffff]%s[/ubb]",u[3]),_=u[4]||0,e.label_user_name.text=i,e.label_user_msg.text=r,e._setMedalTitle(_)}else{var h=n[gc.dsConsts.ChatData.sysArgs],p=mo.getJSONWithFileNameAndID(gc.cfg_c_chatSys,h[0]);a="【系统】",2==h.length?a+=mo.STR.format(p[gc.c_chatSys_text],h[1]):3==h.length?a+=mo.STR.format(p[gc.c_chatSys_text],h[1],h[2]):4==h.length?a+=mo.STR.format(p[gc.c_chatSys_text],h[1],h[2],h[3]):5==h.length?a+=mo.STR.format(p[gc.c_chatSys_text],h[1],h[2],h[3],h[4]):6==h.length?a+=mo.STR.format(p[gc.c_chatSys_text],h[1],h[2],h[3],h[4],h[5]):7==h.length?a+=mo.STR.format(p[gc.c_chatSys_text],h[1],h[2],h[3],h[4],h[5],h[6]):8==h.length&&(a+=mo.STR.format(p[gc.c_chatSys_text],h[1],h[2],h[3],h[4],h[5],h[6],h[7])),e.label_content.text=a}},e}(mo.gui.ItemRenderer);t.ChatItem=e,egret.registerClass(e,"g_mid.ChatItem")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments),this.isBottom=!0}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var n=this;n._Item_list_chat=t.ChatItem,n.tabLastSelectIndex=0,n.chatType=gc.c_prop.chatTypeKey.user,n.registerClassByKey(gd.ChatCtrl,gd.ChatCtrl.ON_IMPOTANT_UPDATE,function(t){n.onChatImpUpdate(t)}),n.registerClassByKey(gd.ChatCtrl,gd.ChatCtrl.ON_CHAT_UPDATE,function(t){n.onChatUpdate(gc.c_prop.chatTypeKey.user,t)}),n.registerClassByKey(gd.ChatCtrl,gd.ChatCtrl.ON_GUILD_CHAT_UPDATE,function(t){n.onChatUpdate(gc.c_prop.chatTypeKey.guild,t)}),n.registerClassByKey(gd.ChatCtrl,gd.ChatCtrl.ON_GUILD_CHANGED,n.guildChanged),n.registerClassByKey(gd.ChatCtrl,gd.ChatCtrl.ON_MODE_UPDATE,n.modeChanged)},a._data_list_chat=function(){var t=this;return t.chatType==gc.c_prop.chatTypeKey.user?gd.chatCtrl.getAllList():gd.chatCtrl.getGuildAllList()},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=gd.userCtrl.get(gc.dsConsts.UserEntity.exData),n=t[gc.c_prop.userExDataKey.catNoVipChat];void 0==n&&(n=1),gd.chatCtrl.isFollowNormalUser=n,gd.chatCtrl.isAutoBuyLaba=t[gc.c_prop.userExDataKey.autoBuyLittleHorn];var o=this;o.list_chat.dataGroup.layout.gap=5,process.nextTick(function(){o.tab_channel.selectedIndex=0,o._tap_tab_channel()});var a=o.list_chat.scroller;a.addEventListener(egret.Event.CHANGE,o.onScrollChanged,o)},a._tap_tab_channel=function(){var t=this,e=t.tab_channel.selectedIndex;if(0==e&&t._switchChannel(gc.c_prop.chatTypeKey.user),1==e){if(!gd.guildPersonalCtrl.getGuildId())return process.nextTick(function(){t.tab_channel.selectedIndex=t.tabLastSelectIndex}),mo.showMsg(gc.id_c_msgCode.noGuild);t._switchChannel(gc.c_prop.chatTypeKey.guild)}t.tabLastSelectIndex=e},a._switchChannel=function(t){var e=this;e.chatType=t,e.grp_chat.visible=e.chatType==gc.c_prop.chatTypeKey.user?!0:!1,e.onChatUpdate(t,e.chatType==gc.c_prop.chatTypeKey.user?gd.chatCtrl.getAllList():gd.chatCtrl.getGuildAllList()),e.onChatImpUpdate(gd.chatCtrl.getImportantList());var n=e.list_chat.scroller;process.nextTick(function(){process.nextTick(function(){e.list_chat&&n.throwVertically(n.getMaxScrollTop(),1)})})},a.guildChanged=function(){var t=this;0==t.tab_channel.selectedIndex||gd.guildPersonalCtrl.getGuildId()||mo.showMsg(gc.id_c_msgCode.outofGuild,function(){t.tab_channel.selectedIndex=0,t._tap_tab_channel()})},a.modeChanged=function(){var t=this;t.refreshList("list_chat");var e=t.list_chat.scroller;process.nextTick(function(){t.list_chat&&e.throwVertically(e.getMaxScrollTop(),1)})},a.onEnter=function(){e.prototype.onEnter.call(this),this._refreshLabaCount(),gd.chatCtrl.openWindow()},a.onExit=function(){e.prototype.onExit.call(this),gd.chatCtrl.closeWindow()},a.onChatImpUpdate=function(t){var e=this;e.clearChatImp();for(var n="",o=0;o<t.length;++o){var a=gd.chatCtrl.getChatDataStr(t[o]);n+=a+"\n"}e.label_contentSys.text=n,process.nextTick(function(){e.scrollerSys&&e.scrollerSys.throwVertically(e.scrollerSys.getMaxScrollTop(),1)})},a.onChatUpdate=function(t,e){var n=this;if(n.chatType==t){var o=n.list_chat.scroller,a=o.viewport.verticalScrollPosition;n.refreshList("list_chat"),n.isScrollChanged&&(n.isBottom=o.viewport.verticalScrollPosition==o.viewport.contentHeight-o.viewport.height,n.isScrollChanged=!1),process.nextTick(function(){n.list_chat&&(n.isBottom?o.throwVertically(o.getMaxScrollTop(),1):o.throwVertically(a,1))})}},a.onScrollChanged=function(){var t=this;t.list_chat.scroller;t.isScrollChanged=!0},a.clearChatImp=function(){var t=this;t.label_contentSys.text=""},a._tap_btn_send=function(){var t=this;gd.chatCtrl.sendData(mo.trans4UBB(t.label_input.text),t.chatType,!1,function(){t.label_input.text="",t._refreshLabaCount()},t)},a._tap_btn_laba=function(){var t=this;if(t.chatType!=gc.c_prop.chatTypeKey.user)return mo.showMsg("行会频道不可以使用喇叭");var e=gd.userCtrl.getItemNum(gc.c_prop.spItemIdKey.littleHorn);if(1>e){if(1!=gd.chatCtrl.isAutoBuyLaba)return mo.showMsg(gc.id_c_msgCode.noticeAutoBuyLittleHorn,function(){return gd.userCtrl.getVip()<2?mo.showMsg(gc.id_c_msgCode.noticeAutoBuyLittleHornVipNeed):(gd.chatCtrl.isAutoBuyLaba=1,void gd.userCtrl.updateSetting(gd.chatCtrl.isFollowNormalUser,gd.chatCtrl.isAutoBuyLaba,function(){t._sendLabaMsg(mo.trans4UBB(t.label_input.text))},t))});t._sendLabaMsg(mo.trans4UBB(t.label_input.text))}else t._sendLabaMsg(mo.trans4UBB(t.label_input.text))},a._sendLabaMsg=function(t){var e=this;gd.chatCtrl.sendData(mo.trans4UBB(e.label_input.text),e.chatType,!0,function(){e.label_input.text="",e._refreshLabaCount()},e)},a._refreshLabaCount=function(){var t=this;t.label_laba_left.text="喇叭剩余:"+gd.userCtrl.getItemNum(gc.c_prop.spItemIdKey.littleHorn)},a._tap_btn_setting=function(){t.ChatSetting.create().show()},n}(mo.gui.Dlg);t.Chat=e,egret.registerClass(e,"g_mid.Chat")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this)},o._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.ckb_vip.selected=gd.chatCtrl.isFollowNormalUser,e.ckb_laba.selected=gd.chatCtrl.isAutoBuyLaba},o.onEnter=function(){t.prototype.onEnter.call(this)},o.onExit=function(){t.prototype.onExit.call(this);var e=this;gd.userCtrl.updateSetting(gd.chatCtrl.isFollowNormalUser,gd.chatCtrl.isAutoBuyLaba,function(){},e)},o._chg_ckb_vip=function(){gd.chatCtrl.isFollowNormalUser=0==gd.chatCtrl.isFollowNormalUser?1:0,gd.chatCtrl.followModeChange()},o._chg_ckb_laba=function(){var t=this;return gd.userCtrl.getVip()<2?(t.ckb_laba.selected=!1,mo.showMsg("VIP2及以上才可开启此功能")):void(gd.chatCtrl.isAutoBuyLaba=0==gd.chatCtrl.isAutoBuyLaba?1:0)},e}(mo.gui.Dlg);t.ChatSetting=e,egret.registerClass(e,"g_mid.ChatSetting")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.label_qq.text=mo.STR.format("QQ群：%s",mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.contactUs)[0])},o.onEnter=function(){t.prototype.onEnter.call(this)},o._tap_btn_add=function(){window.open("http://jq.qq.com/?_wv=1027&k=Zt4mRQ")},e}(mo.gui.Dlg);t.BugFeedBack=e,egret.registerClass(e,"g_mid.BugFeedBack")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this);var e=this;e.registerClassByKey(gd.HoodinnCtlr,gd.HoodinnCtlr.ON_BUGCHAT_UPDATE,e.onChatUpdate)},o.onEnter=function(){t.prototype.onEnter.call(this),gd.hoodinnCtlr.openBugChatWindow(),this.label_openid.text="您的OPENID:"+gd.accountCtrl.get(gc.dsConsts.AccountEntity.sdkData).open_id,this.label_weburl.text=mo_channel.getCurChannel().homeUrl(),this.img_pctips.visible=""!=this.label_weburl.text,this.btn_bbs.visible="qqbrowser"==mo_channel.getCurChannel().channel()},o.onExit=function(){t.prototype.onExit.call(this),gd.hoodinnCtlr.closeBugChatWindow()},o.onChatUpdate=function(t){var e=this;e.clearChat();for(var n="",o=0;o<t.length;++o){var a=gd.hoodinnCtlr.getBugChatStr(t[o]);n+=a+"\n"}e.label_content.text=n,process.nextTick(function(){e.scroller&&e.scroller.throwVertically(e.scroller.getMaxScrollTop(),1)})},o.clearChat=function(){var t=this;t.label_content.text=""},o._tap_btn_send=function(){var t=this;gd.hoodinnCtlr.sendBugChat(mo.trans4UBB(t.label_input.text),function(){t.label_input.text=""},t)},o._tap_btn_bbs=function(){location.href="http://circle.html5.qq.com/?from=011&ch=20&gameId=8392920187#circle/q_11833288344_1449127137920445"},e}(mo.gui.Dlg);t.BugChat=e,egret.registerClass(e,"g_mid.BugChat")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.redPointData.toString(),t._checkRed),t.registerClassByKey(gd.UserCtrl,gd.UserCtrl.ON_GET_BINDPHONE_REWARD,t._update_bindPhone),t.registerClassByKey(gd.HoodinnCtlr,gd.HoodinnCtlr.ON_NEWBUGCHAT_RECEIVED,t._bugChatRed)},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t._checkRed(),t.btn_bindPhone.visible=!1,t.btn_bindPhone.includeInLayout=!1,t._update_bindPhone(),t._update_desktop()},a._checkRed=function(){var t=this;t.btn_mail.playEffect(gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.mail)),t.btn_chuanchen.playEffect(gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.chuanChen))},a._bugChatRed=function(){var t=this;null==this.bugChat&&(t.redpoint_bugchat.visible=!0)},a._tap_btn_bug=function(){var e=this;e.bugChat=t.BugChat.create().show(),e.bugChat.onClose(function(){e.bugChat=null}),e.redpoint_bugchat.visible=!1},a._tap_btn_mail=function(){mo.moduleMgr.runModule(g_consts.moduleId.mail)},a._tap_btn_chuanchen=function(){mo.moduleMgr.runModule(g_consts.moduleId.chuanchen)},a._tap_btn_notice=function(){var t=this;gd.NoticeCtrl.getList(function(t){g_base.NoticeDlg.create().setData({notices:t}).show()},t)},a._tap_btn_bindPhone=function(){mo.moduleMgr.runModule(g_consts.moduleId.bindPhone)},a._tap_btn_desktop=function(){var e=this;mo_channel.getCurChannel();if(e.btn_desktop_showType==g_channel.WooolSdkDesktopShowType.XiongDi)t.FriendDialog.Open();else{var n=0;e.btn_desktop_showType==g_channel.WooolSdkDesktopShowType.FenXiang?n=1:e.btn_desktop_showType==g_channel.WooolSdkDesktopShowType.GuangZhu&&(n=2);var o=t.SaveGame.create();o.showAndType(n,g_channel.WooolSdkDesktopPosition.Home).onClose(function(){e._update_desktop()})}},a._update_bindPhone=function(){var t=this,e=mo_channel.getCurChannel();e.isBindMobile(function(e,n){e&&!n?(t.btn_bindPhone.visible=!0,t.btn_bindPhone.includeInLayout=!0):t.btn_bindPhone&&(t.btn_bindPhone.visible=!1,t.grp_bottom.removeElement(t.btn_bindPhone),t.btn_bindPhone=null)},t)},a._update_desktop=function(){var t=this,e=mo_channel.getCurChannel();e.getDesktopInfo(g_channel.WooolSdkDesktopPosition.Home,function(e,n){if(e){switch(n.showType){case g_channel.WooolSdkDesktopShowType.FenXiang:t.btn_desktop.source="ico_desktop_share";break;case g_channel.WooolSdkDesktopShowType.GuangZhu:t.btn_desktop.source="ico_desktop_follow";break;case g_channel.WooolSdkDesktopShowType.XiongDi:t.btn_desktop.source="ico_xiongdi";break;default:t.btn_desktop.source="ico_desktop"}t.btn_desktop_showType=n.showType,n.flash&&t.btn_desktop.playEffect(!0)}else t.btn_desktop.visible=!1,t.btn_desktop.includeInLayout=!1},t)},n}(mo.gui.MenuLayer);t.HomeBottomBar=e,egret.registerClass(e,"g_mid.HomeBottomBar")}(g_mid||(g_mid={}));var g_mid;!function(t){logger.initLogger(t,"g-mid"),logger.setLvl("g-mid",4);var e=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.redPointData.toString(),t._checkRed),t.registerClassByKey(gd.HeroCtrl,gd.HeroCtrl.ON_CALL_HERO,t.onCallHero),t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.vip.toString(),t._upTuLongBtn),t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.lvl.toString(),t._upRebirthBtn)},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this,n=t.moduleParam.subModuleId;switch(n){case g_consts.FS_SUBMID_SMELT:t._tap_btn_resolve();break;case g_consts.FS_SUBMID_PVP_OUT:break;case g_consts.FS_SUBMID_CHAT:t._tap_btn_chat()}mo_channel.getCurChannel();t._checkRed(),t.onCallHero(),t._upTuLongBtn(),t._upRebirthBtn(),t._update_desktop()},a.onCallHero=function(){var t=this,e=gd.heroCtrl.getNextIdxToBeOpen(),n=e>0&&(3>e||3==e&&gd.userCtrl.get(gc.dsConsts.UserEntity.lvl)>=145);n?t.grp_bottom.addElementAt(t.btn_unlockRole,t.grp_bottom.numElements-2):t.btn_unlockRole.owner&&t.btn_unlockRole.owner.removeElement(t.btn_unlockRole)},a._checkRed=function(){var t=this;t.btn_resolve.playEffect(gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.bag));var e=gd.heroCtrl.getNextIdxToBeOpen(),n=e>0&&gd.heroCtrl.isOpenCfgOk(e);t.btn_unlockRole.playEffect(n),t.btn_wing.playEffect(gd.pointCtrl.isShow(gc.c_prop.pointRedKey.role1_wing)||gd.pointCtrl.isShow(gc.c_prop.pointRedKey.role2_wing)||gd.pointCtrl.isShow(gc.c_prop.pointRedKey.role3_wing)),t.btn_practice.playEffect(gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.medal))},a._tap_btn_unlockRole=function(){var t=this,e=gd.heroCtrl.getNextIdxToBeOpen();3>e?g_base.CreateRole.create().setData({action:1}).show().onClose(t._checkRed,t):g_base.Create4thRole.create().show().onClose(t._checkRed,t)
},a._tap_btn_wing=function(){var t;t={subModuleId:3},mo.moduleMgr.runModule(g_consts.moduleId.role,t)},a._tap_btn_resolve=function(){mo.moduleMgr.runModule(g_consts.moduleId.smelting)},a._tap_btn_practice=function(){mo.moduleMgr.runModule(g_consts.moduleId.practice)},a._tap_btn_chat=function(){t.Chat.create().show()},a._tap_btn_tulong=function(){mo.moduleMgr.runModule(g_consts.moduleId.tuLong)},a._upTuLongBtn=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_game),n=e[gc.id_c_game.tuLong][4],o=gd.userCtrl.getVip()<3,a=gd.userCtrl.getLvl()<n,i=o&&a;t.btn_tulong.visible=i,uiHelper.playUIEffect(t.efx_tulong,i)},a._tap_btn_rebirth=function(){mo.moduleMgr.runModule(g_consts.moduleId.rebirth)},a._upRebirthBtn=function(){var t=this,e=gd.reBirthCtrl.getRebirthCfg(1);t.btn_rebirth.visible=gd.userCtrl.getLvl()>=e.lvl-5,t.onCallHero()},a._tap_btn_desktop=function(){var e=this;mo_channel.getCurChannel();if(e.btn_desktop_showType==g_channel.WooolSdkDesktopShowType.XiongDi)t.FriendDialog.Open();else{var n=0;e.btn_desktop_showType==g_channel.WooolSdkDesktopShowType.FenXiang?n=1:e.btn_desktop_showType==g_channel.WooolSdkDesktopShowType.GuangZhu&&(n=2);var o=t.SaveGame.create();o.showAndType(n,g_channel.WooolSdkDesktopPosition.Fight).onClose(function(){e._update_desktop()})}},a._update_desktop=function(){var t=this,e=mo_channel.getCurChannel();e.getDesktopInfo(g_channel.WooolSdkDesktopPosition.Fight,function(e,n){if(e){switch(n.showType){case g_channel.WooolSdkDesktopShowType.FenXiang:t.btn_desktop.source="ico_desktop_share";break;case g_channel.WooolSdkDesktopShowType.GuangZhu:t.btn_desktop.source="ico_desktop_follow";break;case g_channel.WooolSdkDesktopShowType.XiongDi:t.btn_desktop.source="ico_xiongdi";break;default:t.btn_desktop.source="ico_desktop"}t.btn_desktop_showType=n.showType,n.flash&&t.btn_desktop.playEffect(!0)}else t.btn_desktop.visible=!1,t.btn_desktop.includeInLayout=!1},t)},n}(mo.gui.MenuLayer);t.FightBottomBar=e,egret.registerClass(e,"g_mid.FightBottomBar")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this);var e=this;e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.redPointData.toString(),e._checkRed),e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.redPointData.toString(),e._checkRed),e.registerClassByKey(gd.ChallengeCupCtrl,gd.ChallengeCupCtrl.ON_ACT_END,function(t){var n=t[gc.dsConsts.ChallengeCupData.isOpen];e.btn_kings_fight.playEffect(n),n||mo.moduleMgr.runModule(g_consts.moduleId.defarenaWinner)})},o._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this,n=e.moduleParam.subModuleId;e.moduleParam.param;switch(n){case g_consts.HS_SUBMID_DAILY:e._tap_btn_task();break;case g_consts.HS_SUBMID_SIGN:e._tap_btn_fuli();break;case g_consts.HS_SUBMID_CUSTOM_LIST:e._tap_btn_custom();break;case g_consts.HS_SUBMID_HEART:e._tap_btn_heart()}e._updateKingsFight(),e._checkRed()},o._checkRed=function(){var t=this;t.btn_print.playEffect(gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.medal)),t.btn_heart.playEffect(!1),t.task_red.visible=gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.task),t.fuli_red.visible=gd.pointCtrl.isShow(gc.c_prop.pointRedKey.fuli),t.btn_custom.playEffect(gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.custom)),t.exp_red.visible=gd.pointCtrl.isShow(gc.c_prop.pointRedKey.demonLotus_main)},o._updateKingsFight=function(){var t=this;gd.challengeCupCtrl.getIsOpen(function(e){t.btn_kings_fight.playEffect(gd.challengeCupCtrl.isOpen)},t)},o._tap_btn_kings_fight=function(){var t=this;gd.challengeCupCtrl.isOpen;gd.challengeCupCtrl.getIsOpen(function(e){gd.challengeCupCtrl.isOpen?mo.moduleMgr.runModule(g_consts.moduleId.defArena):mo.moduleMgr.runModule(g_consts.moduleId.defarenaWinner),t.btn_kings_fight.playEffect(gd.challengeCupCtrl.isOpen)},t)},o._tap_btn_task=function(){mo.moduleMgr.runModule(g_consts.moduleId.taskDlg)},o._tap_btn_print=function(){mo.moduleMgr.runModule(g_consts.moduleId.medal)},o._tap_btn_heart=function(){mo.moduleMgr.runModule(g_consts.moduleId.heart)},o._tap_btn_recharge=function(){mo.moduleMgr.runModule(g_consts.moduleId.recharge)},o._tap_btn_fuli=function(){mo.moduleMgr.runModule(g_consts.moduleId.fuliDlg)},o._tap_btn_expBox=function(){mo.moduleMgr.runModule(g_consts.moduleId.lotus)},o._tap_btn_custom=function(){mo.moduleMgr.runModule(g_consts.moduleId.customList)},e}(mo.gui.MenuLayer);t.HomeMidBar=e,egret.registerClass(e,"g_mid.HomeMidBar")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.redPointData.toString(),t._checkRed),t.registerClassByKey(gd.ActivityCtrl,gd.ActivityCtrl.ON_FIRST_REWARD_RECEIVED,t._upFirstBtn)},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this,n=t.moduleParam.subModuleId,o=t.moduleParam.param;switch(n){case g_consts.FS_SUBMID_ACTIVITY:t._tap_btn_activity();break;case g_consts.FS_SUBMID_RECHARGE:t._tap_btn_recharge();break;case g_consts.FS_SUBMID_VIP:mo.moduleMgr.pushModule(g_consts.moduleId.vip,{showVipLv:o})}t._checkRed(),t._upFirstBtn(),t._upTreasureBtn(),t._upFiveDayBtn(),t._upActivityEntry()},a.onEnter=function(){e.prototype.onEnter.call(this)},a._upTreasureBtn=function(){var t=this,e=null!=gd.activityCtrl.getLotteryActivity();!e&&t.btn_treasure&&(t.btn_treasure.playEffect(!1),mo.gui.helper.rm(t.grp_treasure),t.btn_treasure=null)},a._upFirstBtn=function(){var t=this,e=gd.activityCtrl.hasReceiveFirstRecharge();t.btn_recharge.visible=!1,e&&(t.btn_first.playEffect(!1),t.btn_first.visible=!1,t.btn_recharge.visible=!0)},a._upFiveDayBtn=function(){var t=this,e=null!=gd.activityCtrl.getNewFourActivity();if(e)t.btn_five.visible||(t.btn_five.playEffect(!0),t.grp_fiveDay.width=74,t.grp_fiveDay.visible=!0),4==gd.newFourDaysCtrl.getCurActDay()&&t.btn_five.playEffect(!1);else{var n=null!=gd.activityCtrl.getFiveTargetActivity();n||(t.btn_five.playEffect(!1),t.grp_fiveDay.width=13,t.grp_fiveDay.visible=!1),n&&!t.btn_five.visible&&(t.btn_five.playEffect(!0),t.grp_fiveDay.width=74,t.grp_fiveDay.visible=!0),n&&4==gd.fiveDaysTargetCtrl.getCurActDay()&&t.btn_five.playEffect(!1)}},a._upActivityEntry=function(){var t=this,e=!0,n=mo_channel.getCurChannel();n.getGameSetting(function(n){n&&-1==n.activity&&(e=!1),t.grp_activity.visible=e,t.grp_activity.includeInLayout=e})},a._checkRed=function(){var t=this;t.btn_activity.playEffect(gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.activity)||gd.pointCtrl.isShow(gc.c_prop.pointEffectKey.sign)),t.rank_red.visible=gd.pointCtrl.isShow(gc.c_prop.pointRedKey.rankPk)},a._tap_btn_activity=function(){mo.moduleMgr.runModule(g_consts.moduleId.activityDlg)},a._tap_btn_recharge=function(){mo.moduleMgr.runModule(g_consts.moduleId.recharge)},a._tap_btn_first=function(){mo.moduleMgr.runModule(g_consts.moduleId.firstRecharge)},a._tap_btn_treasure=function(){mo.moduleMgr.runModule(g_consts.moduleId.treasure)},a._tap_ico_chat=function(){t.Chat.create().show()},a._tap_btn_rank=function(){mo.moduleMgr.runModule(g_consts.moduleId.rank)},a._tap_btn_redPacket=function(){mo.moduleMgr.runModule(g_consts.moduleId.redPacket)},a._tap_btn_five=function(){null!=gd.activityCtrl.getNewFourActivity()?mo.moduleMgr.runModule(g_consts.moduleId.newFourDay):null!=gd.activityCtrl.getFiveTargetActivity()&&mo.moduleMgr.runModule(g_consts.moduleId.fiveDay)},n}(mo.gui.MenuLayer);t.FightMidBar=e,egret.registerClass(e,"g_mid.FightMidBar")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){var n=this;e.prototype._initProp.call(this),n.outsideClosable=!0,n._layerOpt.shownWithAction=!1,n._Item_list_items=g_base.BaseItemCell;var o=mo_channel.getCurChannel().channel();"wanba"==o&&mo.gui.helper.setSkinName(n,t.TuLongWanba.__className)},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t.label_vip.text="3";var n=t.getNextVipScore(2);t.bar_recharge.maximum=n;var o=gd.userCtrl.getVipScore();t.bar_recharge.setValue(o),t._setEquipInfo(0),t._setEquipInfo(1),t._setEquipInfo(2);for(var a=mo.getJSONWithFileName(gc.cfg_c_recharge),i=1,r=a[i];null!=r;){var s=r[gc.c_recharge_diamond];if(o+s>=n){i=r[gc.c_recharge_id];break}i++,r=a[i]}t._rechargeId=i,t._setItemInfo(t.grp_recharge,a[i])},a._setItemInfo=function(t,e){var n=(e[gc.c_recharge_isTreble]>0?3:1,t.getChildByName("btn"),mo.gui.helper.getChild(t,"label_cost")),o=t.getChildByName("label_get"),a=e[gc.c_recharge_cost],i=mo_channel.getCurChannel().channel();"wanba"==i&&(a*=10),n.text=a+"",o.text=e[gc.c_recharge_diamond]},a._data_list_items=function(){var t=mo.getJSONWithFileName(gc.cfg_c_game),e=t[gc.id_c_game.tuLong][3].split(",");return e},a._initItem_list_items=function(t){t.tapShowDetail=!0;var e=t.ico_item;e.showEquipName=!0},a._setEquipInfo=function(t){var e=this,n=e["grp_equip"+t],o=mo.getJSONWithFileName(gc.cfg_c_game),a=o[gc.id_c_game.tuLong][t].split(","),i=a[0],r=a[1],s=n.getChildByName("label_name"),c=n.getChildByName("label_desc"),l=n.getChildByName("label_str_lvl");s.text=gd.equipCtrl.getEquipName(i);for(var _,g=mo.STR.format("[ubb]评分:%s[/ubb]",gd.equipCtrl.getBaseEvaluate(i)),d=gd.equipCtrl.getBasePropArr(i),u="[ubb]%s: %s[/ubb]",h="[/br][ubb color=0x2EAAF7]%s: %s[/ubb]",g="",p=0,m=d.length;m>p;p++){_=d[p];var f=_[0],b=_[1];g+=mo.STR.format(0==p?u:h,gc.c_prop.equipProp[f],b)}c.text=g;var C=gd.equipCtrl.getStrLvlInfo(i,r),v=C[1],y=C[2],g=mo.STR.format("[/br][ubb]%s+%s[/ubb]",gc.c_prop.heroProp[v],y);l.text=[r,g]},a.getNextVipScore=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_vip,t);return e[gc.c_vip_score]},a._tap_grp_recharge=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_recharge);t._doRecharge(e[t._rechargeId])},a._doRecharge=function(t){var e=this,n=t[gc.c_recharge_id],o=t[gc.c_recharge_payId],a=mo.getJSONWithFileNameAndID(gc.cfg_c_payInfo,o),i=a[mo_channel.channelKeyMap[egret.project.channelId]][0];mo_channel.getCurChannel().pay(n,i,function(t){mo.log("充值成功")},e)},n}(mo.gui.Dlg);t.TuLong=e,egret.registerClass(e,"g_mid.TuLong"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){e()})})}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e);n.prototype;return e}(mo.gui.Dlg);t.TuLongWanba=e,egret.registerClass(e,"g_mid.TuLongWanba")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments),this._loadingNextPage=!1}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var n=this;n._Item_list_items=t.FriendListItem},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t.list_items.scroller.addEventListener(egret.Event.COMPLETE,t._cbScrolled,t)},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;t.reloadData()},a.reloadData=function(){var t=this,e=t.data.items;return null==e||0==e.length?(t.sk_null.visible=!0,!0):(t.sk_null.visible=!1,void t.refreshList("list_items"))},a._data_list_items=function(){var t=this;return t.data.items},a._cbScrolled=function(e){var n=this;if(!n._loadingNextPage){var o=e.currentTarget,a=o.scrollTop,i=o.getMaxScrollTop();if(a>=i){n._loadingNextPage=!0;var r=gc.iface.a_bonus_getInfo_args,s={};s[r.lastId]=n.data.lastId,mo.requestWaiting4Server(gc.iface.a_bonus_getInfo,s,function(e){var i=e[gc.dsConsts.BonusInfo.relations];if(null==i&&(i=[]),i.length){var r=t.FriendDialog.getLastId(i);r>n.data.lastId&&(n.data.lastId=r),n.data.items=n.data.items.concat(i),n.refreshList("list_items"),process.nextTick(function(){o.setScrollTop(a)}),n._loadingNextPage=!1}})}}},a._click_list_items=function(e){var n=this,o=e.item,a=o[gc.dsConsts.BonusRelationData.nickName],i="是否解除和[ubb color=#9b570b]"+a+"[/ubb]的兄弟关系?[/br]一旦解除关系，将不再享受兄弟之间的任何福利";t.FriendMsgAlert.create().setData({callback:function(){for(var t=o[gc.dsConsts.BonusRelationData.userId],e=0;e<n.data.items.length;++e){var a=n.data.items[e],i=a[gc.dsConsts.BonusRelationData.userId];if(i==t){var r=gc.iface.a_bonus_breakRelation_args,s={};s[r.inviteeUserId]=i,mo.requestWaiting4Server(gc.iface.a_bonus_breakRelation,s,function(t){n.data.items.splice(e,1),n.refreshList("list_items")});break}}},msg:i,icon:"tit_txt_xiongdi_break"}).show()},n}(mo.gui.Dlg);t.FriendBreakDialog=e,egret.registerClass(e,"g_mid.FriendBreakDialog")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments),this._loadingNextPage=!1}__extends(n,e);var o=(__define,n),a=o.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var n=this;n._Item_list_items=t.FriendListItem},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t.list_items.scroller.addEventListener(egret.Event.COMPLETE,t._cbScrolled,t)},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,n=t.data.info;t.data.items;t.label_stat.text="兄弟人数:"+n[gc.dsConsts.BonusShareData.relationCount]+"\n累计元宝:"+n[gc.dsConsts.BonusShareData.amountDraw],t.label_value.text="目前可领取:"+n[gc.dsConsts.BonusShareData.balance]+"元宝",t.reloadData()},a.reloadData=function(){var t=this,e=t.data.items;return 0==e.length?(t.sk_null.visible=!0,!0):(t.sk_null.visible=!1,void t.refreshList("list_items"))},a._data_list_items=function(){var t=this;return t.data.items},a._cbScrolled=function(t){var e=this;if(!e._loadingNextPage){var o=t.currentTarget,a=o.scrollTop,i=o.getMaxScrollTop();if(a>=i){e._loadingNextPage=!0;var r=gc.iface.a_bonus_getInfo_args,s={};s[r.lastId]=e.data.lastId,mo.requestWaiting4Server(gc.iface.a_bonus_getInfo,s,function(t){var i=t[gc.dsConsts.BonusInfo.relations];if(null==i&&(i=[]),i.length){var r=n.getLastId(i);r>e.data.lastId&&(e.data.lastId=r),e.data.items=e.data.items.concat(i),e.refreshList("list_items"),process.nextTick(function(){o.setScrollTop(a)}),e._loadingNextPage=!1}})}}},a._tap_btn_reinvite=function(){n.Invite()},a._tap_btn_get=function(){var t=this,e=t.data.info,n=e[gc.dsConsts.BonusShareData.balance];0>=n||mo.requestWaiting4Server(gc.iface.a_bonus_draw,{},function(n){var o=n[gc.dsConsts.BonusDrawResult.added],a=n[gc.dsConsts.BonusDrawResult.total];t.label_value.text="目前可领取:0元宝",e[gc.dsConsts.BonusShareData.amountDraw]+=o,t.label_stat.text="兄弟人数:"+e[gc.dsConsts.BonusShareData.relationCount]+"\n累计元宝:"+e[gc.dsConsts.BonusShareData.amountDraw],g_base.BaseShowMsg.create().setData({msg:"领取成功",interval:2}).show(),gd.userCtrl.set(gc.dsConsts.UserEntity.diamond.toString(),a)})},a._tap_btn_help=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_help,101);g_base.BaseShowMsg.create().setData({msg:t[gc.c_help_helpText]}).show()},a._tap_btn_break=function(){var e=this;e.close(),t.FriendBreakDialog.create().setData(e.data).show()},n.getLastId=function(t){var e=0;return null==t?e:(t.forEach(function(t){var n=t[gc.dsConsts.BonusRelationData.id];e=Math.max(n,e)},this),e)},n.Open=function(){var e=gc.iface.a_bonus_getInfo_args,o={};o[e.lastId]=0,mo.requestWaiting4Server(gc.iface.a_bonus_getInfo,o,function(e){var o=e[gc.dsConsts.BonusInfo.shareInfo],a=e[gc.dsConsts.BonusInfo.relations];null==a&&(a=[]),o[gc.dsConsts.BonusShareData.isFirst]?t.FriendFirstInvite.create().show():n.create().setData({info:o,items:a,lastId:n.getLastId(a)}).show()})},n.Invite=function(){var t=gc.iface.a_bonus_share_args,e={};e[t.serverIndexId]=gd.userCtrl.get(gc.dsConsts.UserEntity.serverIndexId),mo.requestWaiting4Server(gc.iface.a_bonus_share,e,function(t){var e=t[gc.dsConsts.BonusShareUrl.url],n=t[gc.dsConsts.BonusShareUrl.gifted];console.info("邀请好友的链接: "+e),mo_channel.getCurChannel().desktopShare(e,function(t){t&&!n&&mo.requestWaiting4Server(gc.iface.a_bonus_sendShareGift,{},function(t){})})})},n}(mo.gui.Dlg);t.FriendDialog=e,egret.registerClass(e,"g_mid.FriendDialog")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(e){function n(){e.apply(this,arguments)}__extends(n,e);var o=(__define,n),a=o.prototype;return a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=mo.getJSONWithFileNameAndID(gc.cfg_c_help,100);this.label_content.text=t[gc.c_help_helpText]},a._tap_btn_invite=function(){t.FriendDialog.Invite()},n}(mo.gui.Dlg);t.FriendFirstInvite=e,egret.registerClass(e,"g_mid.FriendFirstInvite")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._initProp=function(){t.prototype._initProp.call(this)},o.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,n=e.data[gc.dsConsts.BonusRelationData.nickName],o=e.data[gc.dsConsts.BonusRelationData.vip],a=e.data[gc.dsConsts.BonusRelationData.level],i=e.data[gc.dsConsts.BonusRelationData.amount];null==n&&(n=""),null==o&&(o=0),null==a&&(a=0),null==i&&(i=0),this.label_vip.text=o+"",this.label_who.text=n+" [ubb color=#ca5d05]Lv."+a+"[/ubb]",this.label_value.text="已累计获得福利:[ubb color=#cea007]"+i+"元宝[/ubb]"},e}(mo.gui.ItemRenderer);t.FriendListItem=e,egret.registerClass(e,"g_mid.FriendListItem")}(g_mid||(g_mid={}));var g_mid;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var n=(__define,e),o=n.prototype;return o._tap_btn_cancel=function(){var t=this;t.close()},o.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,n=e.data.msg,o=e.data.icon;e.label_message.text=n,e.container.title=o},o._tap_btn_confirm=function(){var t=this,e=t.data.callback;e&&e(),t.close()},e}(mo.gui.Dlg);t.FriendMsgAlert=e,egret.registerClass(e,"g_mid.FriendMsgAlert")}(g_mid||(g_mid={}));