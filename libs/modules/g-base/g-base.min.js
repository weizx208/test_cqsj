var gc;!function(t){function e(t,e){return se(ae(.006*(e-t),.005),.5)}function r(t){return 10+10*le(t/1.5)}function i(t,e,r){return r+e*t}function a(t){return 12<<t-1}function s(t){return 12<<t-1}function n(t){return 110*t-70}function o(t,e){return le(t*ne(e,.25))}function c(t,e,r,i){return(100+ge(e,e))*(r+i)*25}function g(t,e,r,i,a){return(50*r+ge(e,e))*(i+a)}function l(t,e){return le(t*((e+ge(1,20))/100))}function _(t,e,r){return t+e*r}function u(t,e){return t*le(1+e/20)}function d(t,e){return le(25*ne(ce(ae(t-e,2)),.1))}function p(t){return t+1e5+1e4*ge(1,3)}function m(t){return t+1e4*ge(1,3)}function f(t){return 120*le(t/6+1)}function h(t){return le(t/300)}function y(t,e,r,i,a,s,n,o,c,g,l,_,u,d,p,m,f,h){return le((t*e+r*i+a*s+n*o+c*g+l*_+u*d+p*m)*(f/h))}function C(t,e,r,i){return le(t+e+r+i)}function v(t,e,r,i,a,s,n,o,c,g){return le(t*e+r*i+a*s+n*o+c*g)}function I(t,e,r){return t+e+r}function E(t){return le(t/2)+3}function D(t){return le(4*oe(.45*(t/40)))}function b(t){return ge(le(t/180),le(t/120))}function S(t,e,r){return t*(r/10)*_e(e+1)/3*(-10*_e(r)/2.5+100)/100}function N(t,e){return t*e*(-10*_e(e)/2.5+80)/100}function T(t){return 10*le(t/40+1)}function k(t){return le(t/10)+1+1e5+1e4*ge(1,3)+1e3*ge(1,6)}function x(t){return 1e3*se(le(t/4),1)}function R(t){return le(15)}function w(t,e){return ae(t+e,0)}function A(t,e,r){return ae(15*t/100*r+e,0)}function L(t){return le(t/2)}function P(t,e){return le(t*e)}function B(t){return se(10*t,3500)}function O(t){return ae(60,1200*le(t/2))}function q(t,e){return ae(1,le(t/e*ge(50,125)/100))}function M(t,e,r,i){return le(t*t*e/r*oe(i))}function W(t,e,r){return le(t*e*r/100)}function F(t,e){return t*e/100}function U(t){return le(ge(.75*t/40,.85*t/40))}function G(t){return le(ge(.75*t/120,.85*t/120))}function K(t){return le(ge(.75*t/360,.85*t/360))}function H(t,e,r){return(t+.018*e)*r*.25}function J(t){return le(.5*le(t/6))}function V(t){return 20+30*(t-1)}function j(t){return 100+100*(t-1)}function z(t){return le(100*ne(1.1,t-1))}function Q(t){return le(100+30*t)}function Y(t,e){return le(15e4*oe(.2*t)/1e4)+5*e}function X(t){return le(t/10)+1}function Z(t,e){return 1.31-t/e}function $(t,e){return le(ae((e-t)/ge(50,100),1))+ge(3,7)}function te(t,e){return le(ae((e-t)/ge(30,100),1))}function ee(t,e,r){return le(3*t+.005*e+500*(r+1)+ne(4.5,r))}function re(t){return 2*t+5}function ie(t,e){return t>=e?1:0}var ae=function(t,e){return Math.max.apply(Math,arguments)},se=function(t,e){return Math.min.apply(Math,arguments)},ne=function(t,e){return Math.pow.apply(Math,arguments)},oe=function(t){return Math.exp.apply(Math,arguments)},ce=function(t){return Math.abs.apply(Math,arguments)},ge=function(t,e){return 0|Math.random()*(e-t+1)+t},le=function(t){return parseInt(t)},_e=function(t){return Math.log.apply(Math,arguments)};t.calBlock=e,t.calBuyGoldDiamond=r,t.calBuyGold=i,t.calBuyRealm=a,t.calBuyEquip=s,t.calBuyBoss=n,t.calPkOutHonor=o,t.calPkOutGold=c,t.calPkOutExpc=g,t.calEquipSubjoin=l,t.calEquipGrade=_,t.calSmeltIntensify=u,t.calKillValue=d,t.calSmeltUpId=p,t.calSmeltId=m,t.calSkillCd=f,t.calSkillDiamond=h,t.calBaseCombat=y,t.calBreakCombat=C,t.calSkillCombat=v,t.callCountCombat=I,t.callBuyEquipBag=E,t.callEquipTraGold=D,t.callOfflineEquipCount=b,t.callOfflineGold=S,t.callOfflineExp=N,t.callEquipLvl=T,t.callOfflineEquipId=k,t.callRefreshShop=x,t.calRefreshPKCost=R,t.calPkKillCfg=w,t.calPkCombatCfg=A,t.calClearPkCost=L,t.calSmeltGetCurrency=P,t.calBossRate=B,t.calQuitGuildCfg=O,t.calRedEnvelopeShareCfg=q,t.calCoffersPersonRecource=M,t.calCoffersPersonHp=W,t.calCoffersAllHp=F,t.calCuChests=U,t.calAgChests=G,t.calAuChests=K,t.calCoffersLoot=H,t.calGuildCopyCd=J,t.calClearGuildWarCd=V,t.calInspireGuildWar=j,t.calIncognito=z,t.calSpies=Q,t.calPaTaAward=Y,t.calEquipLvlCfg=X,t.calTrumpPro=Z,t.calTrumpAdd=$,t.calTrumpSub=te,t.calGuildBossRepeat=ee,t.calBuyLingyun=re,t.calFundVipCount=ie}(gc||(gc={}));var gc;!function(t){var e;!function(t){t.userRefreshCountKey={buyGold:0,rePK:1,buyPK:2,bossTesseraReplace:3,worShip:4,getKingWelfare:5,buyPrimaryRebirth:6,buyMidRebirth:7,buyAdvancedRebirth:8,coffersBuild:9,opening:10,coffersAction:11,coffersWin:12,coffersBuffNum:13,spies:14,incognito:15,clearGuildWarCount:16,inspireGuildWar:17,enterBoss:18,repeatBoss:19,buyLingyun:20},t.userRefreshCount={0:"购买金币次数",1:"剩余挑战次数",2:"购买挑战次数",3:"BOSS替代令使用次数",4:"膜拜次数",5:"领取霸主福利次数",6:"购买初级飞升丹次数",7:"购买中级飞升丹次数",8:"购买高级飞升丹次数",9:"国库建设次数",10:"开光次数",11:"国库行动次数",12:"国库连胜",13:"国库激励次数",14:"密探次数",15:"隐姓埋名次数",16:"清除行会战cd",17:"行会战个人鼓舞",18:"参与boss",19:"复活boss",20:"购买凌云石"},t.userExDataKey={guide:1,wipeItemNum:2,wipeReTime:3,sign:4,skipFightNum:5,replaySkipFightTime:6,buyGoldNum:7,autoFight:8,timeError:9,missEquip:10,todayRankWin:11,arenaCount:12,genuineQi:13,catNoVipChat:14,autoBuyLittleHorn:15,talismanSkill:16,isChangeLvl:17,oldLvl:18,oldExpc:19},t.userExData={1:"引导数据",2:"扫荡券数量",3:"扫荡券上一次恢复时间",4:"签名",5:"剩余跳过次数",6:"上一次恢复跳过次数时间",7:"金币购买总次数",8:"自动战斗",9:"时间异常次数",10:"装备丢失",11:"PK榜挑战次数",12:"竞技场挑战次数",13:"真气数据",14:"关注非VIP",15:"自动购买",16:"法宝技能",17:"是否转换等级",18:"原等级",19:"原经验"},t.itemTypeKey={logic:0,equip:1,rebirth:2,gold:3,diamond:4,exp:5,chest:6,"break":7,prestige:8,gem:9,expBall:10,rebirthExp:11,custom:12,medal:13,genuineQi:14,gift:15},t.itemType={0:"0,道具",1:"1,装备",2:"2,元神道具",3:"3,金币",4:"4,元宝",5:"5,经验",6:"6,宝箱",7:"7,特殊戒指",8:"8,声望",9:"9,宝石",10:"10,经验丹",11:"11,飞升经验",12:"12,定制道具",13:"13,勋章",14:"14，真气",15:"15，法宝"},t.spItemIdKey={gold:99,diamond:200,timeError:71003,wipeItem:25501,equipTessera:7,realmTessera:2,honor:1140,intensify:18,bossTessera:8,bossTesseraReplace:78,starStone:19,plumage:30,goldenKey:1551,vitality:89,prestige:88,paralysis:3,revive:4,protect:5,harm:6,ctWeapon:700026,ctClothes:700027,ctHelmet:700028,ctRing:700029,ctBracelet:700030,ctNecklace:700031,lotus:45,genuineQi:85,littleHorn:1564,silverKey:1550,copperKey:1545},t.spItemId={2:"元神入场劵",3:"麻痹碎片",4:"复活碎片",5:"护身碎片",6:"伤害碎片",7:"装备入场劵",8:"boss令牌",18:"强化石",19:"升星石",30:"羽毛",45:"妖莲之心",78:"boss令牌替代令",85:"真气",88:"声望",89:"活跃值",99:"金币",200:"钻石",301:"摸金符",1140:"荣誉",1545:"铜钥匙",1550:"银钥匙",1551:"金钥匙",1564:"小喇叭",25501:"扫荡券",71003:"体力",700026:"定制武器",700027:"定制黄金甲",700028:"定制头盔",700029:"定制戒指",700030:"定制手环",700031:"定制项链"},t.activityTypeKey={firstRecharge:1,sevenLogin:2,limitBuy:3,dayChargeCount:4,allChargeCount:5,dayCostCount:6,allCostCount:7,upLvl:8,redeemCode:9,text:10,upVip:11,limitBuyRange:12,sign:13,lottery:14,fiveDaysTarget:15,singleCharge:16,mysterShop:17,challengeCup:18,blueNewbie:19,blueGrowth:20,blueEveryday:21,luckyTalos:22,everydayCharge:23,limitPanicBuying:24,yellowNewbie:25,yellowGrowth:26,yellowEveryday:27,rebate:28,dayRecharge:29,setTheWord:30,vPlan:31,sysRedredEnvelope:32,luckyMajong:33,appMysterShop:34,userSurvey:35,activityNotice:36,newLuckyMajong:37,newFourDays:38,newLimitPanicBuying:39},t.activityType={1:"首冲",2:"7天登陆",3:"每日抢购",4:"每日累充福利",5:"全部累充福利",6:"每日消费有礼",7:"全部消费有礼",8:"升级有奖",9:"兑换码",10:"文字说明",11:"VIP升级奖励",12:"时间段限购",13:"签到",14:"探宝",15:"五日目标",16:"单笔充值",17:"神秘商店",18:"王城擂台",19:"蓝钻新手礼包",20:"蓝钻成长礼包",21:"蓝钻每日礼包",22:"幸运塔罗牌",23:"天天充值",24:"限时抢购",25:"黄钻新手礼包",26:"黄钻成长礼包",27:"黄钻每日礼包",28:"消费返利",29:"每日累冲",30:"集字",31:"v计划",32:"系统红包",33:"幸运麻将",34:"指定物品神秘商店",35:"用户调研",36:"空活动模板",37:"新麻将牌",38:"新四日目标",39:"新限时抢购"},t.userRecordTypeKey={diamondTodayCost:1,saveDesk:2,linkShare:3,bindPhone:4,downloadQQGame:5,follow:6,wanbaGift:7,coupon:8,demonLotusOpenNum:9,demonLotusOpenDate:10},t.userRecordType={1:"钻石每天消耗",2:"保存桌面成功次数",3:"分享成功奖励次数",4:"绑定手机",5:"下载qq游戏大厅",6:"关注公众微信号",7:"玩吧礼包",8:"兑换码领取时间",9:"妖莲连续开光次数",10:"妖莲最近开光时间"},t.mailTypeKey={admin:0,arenaRank:1,saveDesk:2,vip:3,equipChest:4,coupon:5,rechargeCom:6,pkKill:7,temp1:8,champions:9,championsRank:10,chaampionsJoin:11,bonusFirstShare:12,bonusGift:13,temp5:14,linkShare:15,mysterShop:16,summonAward:17,guildAward:18,hurtAward:19,rankAward:20,killAward:22,continueChampions:23,redEnvelopeExpire:24,serverPk:25,blueDiamondRecharge:26,coffers:27,limitPanicBuyingAward:28,everydayChargeAward:29,kingMedal:30,suraMedal:31,bindPhone:32,worldBossWin:33,worldBossLose:34,worldBossLastKill:35,yellowDiamondRecharge:36,follow:37,downloadQQGame:38,coffersKill:39,guildBoss:40,guildChapter:41,rebate:42,treasureMove:43,treasureOpen:44,guildWarRank1:45,guildWarRank2:46,guildWarRank3:47,dayRecharge:48,setTheWord:49,vPlan:50,userSurvey:51,summonAwardLimit:52,guildAwardLimit:53,hurtAwardLimit:54,rankAwardLimit:55,killAwardLimit:56,impeachAll:57,impeachUp:58,impeachFall:59},t.mailType={0:"后台人工",1:"竞技场排行奖励",2:"收藏奖励",3:"VIP大礼包",4:"装备宝箱装备",5:"兑换码奖励",6:"封测充值返利",7:"PK奖励",8:"五日目标奖励",9:"王城霸主",10:"守擂排名奖励",11:"擂台赛参与奖",12:"兄弟首次分享",13:"兄弟屠龙刀",14:"单笔充值奖励",15:"分享奖励",16:"神秘商店",17:"BOSS召唤奖",18:"BOSS行会奖",19:"BOSS伤害奖",20:"BOSS排名奖",22:"BOSS最后一击",23:"霸主连任",24:"红包到期",25:"仗剑天涯奖励",26:"蓝钻续费奖励",27:"国库红利",28:"显示抢购奖励",29:"天天充值奖励",30:"王城霸主勋章",31:"修罗追命勋章",32:"绑定手机奖励",33:"世界BOSS胜利奖",34:"世界BOSS失败奖",35:"世界BOSS最后一击",36:"黄钻续费奖励",37:"关注公众微信号",38:"下载qq游戏大厅",39:"破军虎将勋章",40:"行会副本boss击杀奖",41:"行会副本通关奖",42:"消费返利",43:"秘宝被抢",44:"秘宝被开奖",45:"行会战行会排名奖",46:"行会战会长排名奖",47:"行会战个人点数排名奖",48:"每日累充福利",49:"集字",50:"V计划",51:"用户调研",52:"限时BOSS召唤奖",53:"限时BOSS行会奖",54:"限时BOSS伤害奖",55:"限时BOSS排名奖",56:"限时BOSS最后一击",57:"会长降职全体通知",58:"升职会长通知",59:"会长降职通知"},t.goldCostTypeKey={upSkill:1,strength:2,upStar:3,wingFos:4,fieldPk:5,buy:6,refreshShop:7,guildAct:8,stuMenCulMethods:9},t.goldCostType={1:"技能升级",2:"强化",3:"升星",4:"翅膀培养",5:"野外pk",6:"商店购买",7:"刷新商店",8:"行会上香",9:"心法加点"},t.diamondCostTypeKey={buyEquipTessera:1,buyRealmTessera:2,equipCopyCount:3,bossCopyCount:4,realmCopyCount:5,clearSkillCd:6,callHero:7,shop:8,activity:9,refreshCD:10,arenaNum:11,wingFos:12,lottery:13,refreshEnemy:14,patchSign:15,buyBagGrid:16,buyGold:17,buyBossTessera:18,clearPkValue:19,establishGuild:20,guildAct:21,inspire:22,chuanChen:23,openBoss:24,redEnvelope:25,clearChallengeCupCd:26,challengeCup:27,clearBossCd:28,wingStrength:29,clearGuildCopy:30,clearGuildWarCd:31,spies:32,incognito:33,inspireGuildWar:34,fourRole:35,paTaAward:36,littleHorn:37,sellEquipItem:38,chaMenCulMethods:39,baptizeTrump:40,buyLingyun:41},t.diamondCostType={1:"购买装备入场卷",2:"购买元神入场卷",3:"装备副本挑战次数购买",4:"炼狱副本挑战次数购买",5:"元神副本挑战次数购买",6:"清除技能CD",7:"角色开启",8:"商店购买",9:"领取活动",10:"竞技场刷新cd",11:"竞技场挑战次数购买",12:"翅膀培养",13:"抽奖",14:"野外pk刷新对手",15:"补签",16:"购买背包格子",17:"购买金币",18:"购买BOSS入场卷",19:"清除pk值",20:"创建行会",21:"行会上香",22:"鼓舞",23:"传承",24:"开启boss",25:"红包",26:"清除擂台赛挑战cd",27:"挑战擂主",28:"boss清除cd",29:"翅膀强化",30:"行会副本清cd",31:"清除行会战cd",32:"江湖探秘",33:"隐姓埋名",34:"行会战个人鼓舞",35:"第四角色注入经验",36:"镇妖塔宝库购买次数",37:"喇叭",38:"出售装备",39:"心法更换",40:"法宝洗练",41:"购买凌云石"},t.diamondGetTypeKey={activity:1,coupon:2,rechargeCom:3,mail:4,recharge:5,task:6,monster:7,smelt:8,redEnvelope:9,openChest:10,kingWelfare:11,sellEquipItem:12,sellItem:13},t.diamondGetType={1:"领取活动",2:"兑换码",3:"测试服充值双倍返还",4:"邮件",5:"充值",6:"任务",7:"打怪",8:"熔炼",9:"红包",10:"开宝箱",11:"霸主福利",12:"出售装备",13:"出售物品"},t.honorGetTypeKey={heroNum:1,produceNum:2,goldNum:3,userLvl:4,heroType:5,userRank:6,pkWinCount:7,pkLoseCount:8,attack:9,defence:10,hp:11,crit:12,crystalId:13,arenaWinCount:14,arenaMaxConWinCount:15},t.honorGetType={1:"小弟总数量",2:"金币生产速度达到",3:"获得的金币总量",4:"召唤师等级",5:"小弟类型数量",6:"段位达到等级",7:"排位赛胜利场次",8:"排位赛失败场次",9:"攻击",10:"防御",11:"血量",12:"暴击",13:"水晶塔层数",14:"巅峰赛累胜场次",15:"巅峰赛最大连胜场次"},t.itemGetTypeKey={shop:1,battle:2,tower:3,event:4,copy:5},t.itemGetType={1:"商店",2:"战场",3:"推水晶",4:"活动",5:"关卡"},t.rankTypeKey={lvlRank:1,combatRank:2,goldRank:3,wingRank:4,killRank:5,arenaRank:6,zsRank:7,fsRank:8,dsRank:9,guildRank:10,guildCombatRank:11,chairmanCombatRank:12,paTaRank:13},t.rankType={1:"等级榜",2:"总战榜",3:"财富榜",4:"神翼榜",5:"PK榜",6:"竞技榜",7:"战神榜",8:"法神榜",9:"道尊榜",10:"行会等级榜",11:"行会战力榜",12:"会长战力榜",13:"魔塔榜"},t.fightTypeKey={pk:1,arena:2,copy:3,rankPk:4,challengeCupPk:5,coffers:6,worldBoss:7,coffersBoss:8,guildCopy:9,guildWar:10},t.fightType={1:"野外pk",2:"巅峰赛",3:"副本",4:"排行榜pk",5:"擂台pk",6:"国库",7:"世界boss",8:"国库Boss",9:"行会副本",10:"行会跨服战"},t.shopTypeKey={normal:0,arena:1,equip:2,gem:3,rebirth:4},t.shopType={0:"普通商店",1:"荣誉商店",2:"装备商店",3:"宝石商店",4:"飞升商店"},t.currencyTypeKey={gold:1,diamond:2,honor:3,prestige:4},t.currencyType={1:"金币",2:"钻石",3:"荣誉值",4:"声望"},t.copyTypeKey={normal:0,hell:1,equip:2,state:3,arena:4,pk:5,vip:6,coffer:7,paTa:8,guild:9,undefined:11},t.copyType={0:"普通副本",1:"炼狱boss",2:"装备副本",3:"元神副本",4:"竞技场",5:"遭遇战",6:"VIP副本",7:"国库BOSS战",8:"爬塔",9:"公会副本",10:"世界BOSS",11:"行会BOSS"},t.equipPropKey={maxHpTemp:33,attackTemp:34,defenceTemp:35,magicDefenceTemp:36,hitTemp:37,dodgeTemp:38,criticalTemp:39,disCriticalTemp:40},t.equipProp={33:"生命",34:"攻击",35:"物防",36:"法防",37:"命中",38:"闪避",39:"暴击",40:"抗暴"},t.heroEquipIndexKey={weapon:0,clothes:1,bracelet1:2,ring1:3,paralysisRing:4,reviveRing:5,protectRing:6,harmRing:7,ring2:8,bracelet2:9,helmet:10,necklace:11},t.heroEquipIndex={0:"武器",1:"衣服",2:"手环",3:"戒指",4:"麻痹戒指",5:"复活戒指",6:"护身戒指",7:"伤害戒指",8:"戒指2",9:"手环2",10:"头盔",11:"项链"},t.pkNameColorKey={white:1,yellow:2,red:3},t.pkNameColor={1:"白名",2:"黄名",3:"红名"},t.equipColorKey={white:1,green:2,blue:3,purple:4,orange:5,red:6},t.equipColor={1:"白色",2:"绿色",3:"蓝色",4:"紫色",5:"橙色",6:"红色"},t.fightDataKey={winStatus:0,reHp:1,maxHp:2},t.fightData={0:"是否胜利",1:"剩余血量",2:"总血量"},t.winStatusKey={win:1,lose:2,bigWin:3},t.winStatus={1:"胜利",2:"失败",3:"大胜"},t.heroPropKey={maxHp:1,maxHpScale:2,attack:3,attackScale:4,defence:5,defenceScale:6,magicDefence:7,magicDefenceScale:8,hit:9,hitScale:10,dodge:11,dodgeScale:12,critical:13,criticalScale:14,disCritical:15,disCriticalScale:16,luckyValue:17,luckyValueScale:18,moveSpeed:19,moveSpeedScale:20,attackInterval:21,attackIntervalScale:22,damageIncrease:23,damageDecrease:24,benumbPro:25,disBenumbPro:26,poisoningRecoveryProb:27,benumbProSpan:28,reviveCount:29,reviveHPScale:30,maxHp2:31,disMaxHp2:32,maxHpTemp:33,attackTemp:34,defenceTemp:35,magicDefenceTemp:36,hitTemp:37,dodgeTemp:38,criticalTemp:39,disCriticalTemp:40,luckyValueTemp:41,moveSpeedTemp:42,attackIntervalTemp:43,damageIncreaseTemp:44,damageDecreaseTemp:46},t.heroProp={1:"生命",2:"生命加成",3:"攻击",4:"攻击加成",5:"物防",6:"物防加成",7:"法防",8:"法防加成",9:"命中",10:"命中加成",11:"闪避",12:"闪避加成",13:"暴击",14:"暴击加成",15:"抗暴",16:"抗暴加成",17:"幸运",18:"幸运",19:"移动速度",20:"移动速度加成",21:"攻击频率",22:"攻击频率加成",23:"伤害加深",24:"伤害减免",25:"麻痹",26:"抗麻痹",27:"未知",28:"麻痹时长",29:"复活次数",30:"复活HP%",31:"护盾",32:"复活无敌时间",33:"生命",34:"攻击",35:"物防",36:"法防",37:"命中",38:"闪避",39:"暴击",40:"抗暴",41:"幸运值",42:"移动速度",43:"攻击频率",44:"伤害加成",45:"伤害减免",46:"护盾穿透"},t.heroJobKey={zs:1,fs:2,ds:3,ys:4},t.heroJob={1:"战士",2:"法师",3:"道士",4:"幻术师"},t.bagTypeKey={equip:1,item:2,rebirth:3,chest:4,medal:5},t.bagType={1:"装备",2:"物品",3:"元神",4:"宝箱",5:"勋章"},t.wingFosTypeKey={comFoster:1,advFoster:2},t.wingFosType={1:"普通培养",2:"高级培养"},t.arenaDataKey={reNum:0,lastReNumTime:1,nextFightTime:2,lastResetTime:3},t.arenaData={0:"剩余挑战次数",1:"上一次恢复次数时间",2:"下一次可以挑战的时间(cd)",3:"最后重置时间"},t.lotteryTypeKey={common:1,advanced:2,supremacy:3},t.lotteryType={1:"普通",2:"高级",3:"至尊"},t.equipTypeKey={weapon:0,clothes:1,helmet:2,necklace:3,ring:4,bracelet:5},t.equipType={0:"武器",1:"衣服",2:"头盔",3:"项链",4:"戒指",5:"手镯"},t.pointEffectKey={activity:1,task:2,sign:3,bag:4,mail:5,recharge:6,fiveDaysTarget:7,chuanChen:8,custom:9,medal:10},t.pointEffect={1:"活动-有可领取的活动奖励时",2:"任务-有可领取的奖励时",3:"签到-可以签到时",4:"熔炼-背包已满",5:"邮件-有可领取附件的邮件时,有未读邮件时",6:"首充",7:" 五日目标-前四日必转",8:"传承",9:"订制",10:"战印"},t.pointRedKey={home_main:100,role_main:101,make_main:102,pkout1:103,arena1:104,role1_wing:105,role1_equip:106,role1_skill:108,role1_realm:109,role1_intensify:110,role1_star:111,role1_gem:112,role2_wing:113,role2_equip:114,role2_skill:116,role2_realm:117,role2_intensify:118,role2_star:119,role2_gem:120,role3_wing:121,role3_equip:122,role3_skill:124,role3_realm:125,role3_intensify:126,role3_star:127,role3_gem:128,role1_main:129,role2_main:130,role3_main:131,role1_dazao:132,role2_dazao:133,role3_dazao:134,copy_boss:135,rankPk:136,bePkKill:137,shopMain:138,fuli:139,lanzuan:140,role4_main:141,role4_equip:142,role4_skill:143,role1_tring:144,role2_tring:145,role3_tring:146,demonLotus_main:147,demonLotus_1:148,demonLotus_2:149,talisman_main:150,talisman_role1:151,talisman_role2:152,talisman_role3:153},t.pointRed={100:"主城-红点",101:"角色-红点",102:"打造-红点",103:"野外PK-有新的防守记录时",104:"主城-竞技场-红点",105:"角色1-翅膀-红点",106:"角色1-装备-红点",108:"角色1-技能-红点",109:"角色1-元神-红点",110:"角色1-强化-红点",111:"角色1-升星-红点",112:"角色1-宝石-红点",113:"角色2-翅膀-红点",114:"角色2-装备-红点",116:"角色2-技能-红点",117:"角色2-元神-红点",118:"角色2-强化-红点",119:"角色2-升星-红点",120:"角色2-宝石-红点",121:"角色3-翅膀-红点",122:"角色3-装备-红点",124:"角色3-技能-红点",125:"角色3-元神-红点",126:"角色3-强化-红点",127:"角色3-升星-红点",128:"角色3-宝石-红点",129:"角色1-主",130:"角色2-主",131:"角色3-主",132:"角色1-打造",133:"角色2-打造",134:"角色3-打造",135:"炼狱boss",136:"排行榜战斗记录",137:"新仇人",138:"商城按钮",139:"福利",140:"蓝钻",141:"角色4-主",142:"角色4-装备-红点",143:"角色4-技能-红点",144:"角色1特戒",145:"角色2特戒",146:"角色3特戒",147:"妖莲主",148:"妖莲经验",149:"妖莲培养",150:"法宝主",151:"法宝角色1",152:"法宝角色2",153:"法宝角色3"},t.pointGreenKey={home_main:200,copy_equip:201,copy_realm:202,copy_boss:203,area:204,role1_skill:205,role1_realm:206,role2_skill:207,role2_realm:208,role3_skill:209,role3_realm:210},t.pointGreen={200:"主城-绿点",201:"主城-装备副本-绿点",202:"主城-元神副本-绿点",203:"主城-boss副本-绿点",204:"主城-竞技场-绿点",205:"角色1-技能-绿点",206:"角色1-元神-绿点",207:"角色2-技能-绿点",208:"角色2-元神-绿点",209:"角色3-技能-绿点",210:"角色3-元神-绿点"},t.pointDataKey={copy_equip:300,copy_realm:301,copy_boss:302},t.pointData={300:"装备副本-开启组",301:"元神副本-开启组",302:"boss副本-开启组"},t.cTaskTypeKey={personLvl:0,skillLvl:1,equipStrength:2,equipUpStar:3,closeTollGate:4,gemUp:5,equipSmelt:6,clearHero:7,heroGem:8,equipCopy:9,combat:10,encounter:11,hell:12,state:13,shopBuy:14,wingTrain:15,rankFighting:16,chat:20,treasure:17,wing:18,guild:19,guildCopy:21,paTaLottery:22,heartStunt:23},t.cTaskType={0:"人物等级",1:"技能等级",2:"装备强化",3:"装备升星",4:"通关关卡",5:"宝石升级",6:"熔炼装备",7:"解锁职业",8:"角色宝石",9:"装备副本",10:"战力",11:"遭遇战",12:"炼狱副本",13:"元神副本",14:"商店购买",15:"翅膀培养",16:"竞技场战斗",17:"探宝",18:"翅膀总阶数达到5阶",19:"加入公会或者拥有公会",20:"发送聊天消息",21:"行会副本挑战",22:"爬塔寻宝",23:"心法升级"},t.chatTypeKey={sys:1,user:2,lottery:3,guildLottery:4,guild:5},t.chatType={1:"系统",2:"用户聊天",3:"探宝",4:"公会探宝",5:"公会"},t.sexKey={male:1,female:0},t.sex={0:"女",1:"男"},t.receiverKey={chat:"r1",task:"r2",point:"r3",pkDeal:"r4"},t.receiver={r1:"聊天",r2:"任务",r3:"红点",r4:"pk被抢"},t.roleIconKey={zs_nan:1,zs_nv:2,fs_nan:3,fs_nv:4,ds_nan:5,ds_nv:6},t.roleIcon={1:"男战士",2:"女战士",3:"男法师",4:"女法师",5:"男道士",6:"女道士"},t.guildPostKey={chairman:1,viceChairman:2,rankFile:3},t.guildPost={1:"会长",2:"副会长",3:"会员"},t.guildJoinConKey={can:1,verify:2,cannot:3},t.guildJoinCon={1:"不需要验证",2:"需要验证",3:"不能加入"},t.guildMemberOpKey={trans:1,kick:2,release:3,increase:4,quitGuild:5,dissolveGuild:6},t.guildMemberOp={1:"转让会长",2:"踢出行会",3:"解除职务",4:"提升职务",5:"退出公会",6:"解散公会"},t.ennobleTypeKey={civilian:1,ennoble1:2,ennoble2:3,ennoble3:4,ennoble4:5,ennoble5:6,ennoble6:7,ennoble7:8,ennoble8:9,ennoble9:10,ennoble10:11,ennoble11:12,ennoble12:13},t.ennobleType={1:"平民",2:"亭长",3:"庶长",4:"轻骑",5:"游骑",6:"校尉",7:"都尉",8:"男爵",9:"子爵",10:"伯爵",11:"侯爵",12:"公爵",13:"王爵"},t.bossAwardTypeKey={summonAward:1,guildAward:2,hurtAward:3,rankAward1:4,rankAward2:5,rankAward3:6,lastShotAward:7},t.bossAwardType={1:"召唤奖",2:"行会奖",3:"伤害奖励",4:"排名奖1",5:"排名奖2",6:"排名奖3",7:"最后一击奖励"},t.biLogTypeKey={boss:1,realm:2,upStarStone:3,wing:4,mysterShop:5,lottery:6,callBoss:7},t.biLogType={1:"炼狱BOSS挑战记录",2:"元神升级记录",3:"升星石获得记录",4:"翅膀升级记录",5:"神秘商店购买",6:"探宝",7:"召唤boss"},t.upStarWayKey={pkAward:1,mail:2,activity:3},t.upStarWay={1:"PK奖励",2:"邮件",3:"活动"},t.redEnvelopeTypeKey={comRed:1,guildRed:2,sysComRed:3,sysGuildRed:4},t.redEnvelopeType={1:"普通红包",2:"行会福利",3:"[官方]传世尊享红包",4:"[官方]行会至尊红包"},t.wbossRewardDesKey={diamond:1,equip:2,treasure:3,gas:4,goods:5,talisman:6,undefined:12},t.wbossRewardDes={1:"大量元宝奖励",2:"%s级超、精品橙装",3:"大量宝物奖励",4:"大量真气奖励",5:"大量凌云石勋章碎片奖励",6:"珍稀法宝奖励",7:"大量强化石",8:"大量经验丹",9:"大量钥匙",10:"大量宝石",11:"大量特戒碎片",12:"大量勋章碎片"},t.otherBuffIdKey={boss:1,king:2,week:3,month:4,inspireGuildWar:5},t.otherBuffId={1:"世界BOSS鼓舞",2:"王城霸主经验加成",3:"周卡加成",4:"月卡加成",5:"行会战个人鼓舞"},t.offersDoorKey={qinglong:0,baihu:1,xuanwu:2,zhuque:3},t.offersDoor={0:"青龙",1:"白虎",2:"玄武",3:"朱雀"},t.coffersRankTypeKey={king:1,pk:2,arena:3,combat:4},t.coffersRankType={1:"王城霸主",2:"杀戮狂魔",3:"竞技大师",4:"战力精英"},t.activityBgTypeKey={newYear:1},t.activityBgType={1:"春节活动"},t.noticeIconTypeKey={notice:1,activity:2,logon:3,crossClo:4},t.noticeIconType={1:"公告",2:"活动",3:"登录公告",4:"跨服"},t.wingStrengthKey={left:1,right:2},t.wingStrength={1:"左边",2:"右边"},t.activityExDataTypeKey={titleIcon:1,desIcon:2,spItemId:3,bgIcon:4,subType:5,freeDay:6,totalDay:7,minLvl:8,maxLvl:9,vipLimitLvl:10,funcName:11},t.activityExDataType={1:"活动标题icon",2:"活动描述icon",3:"活动货币类型",4:"活动背景icon",5:"活动子类型",6:"每日免费参与次数",7:"每日参与总次数",8:"活动最小参与等级",9:"活动最大参与等级",10:"vip限制等级",11:"活动函数名"},t.worldBossTypeKey={guild:0,world:1},t.worldBossType={},t.propertyDataKey={dlTreasure:1,heartStunt:2},t.propertyData={1:"妖莲宝物",2:"心法"},t.guildCopyKey={boss:1,chapter:2},t.guildCopy={1:"boss奖",2:"章节奖"},t.guildGroupKey={diamond:1,wGold:2,hGold:3,silver:4,copper:5},t.guildGroup={1:"钻石",2:"白金",3:"黄金",4:"白银",5:"黄铜"},t.guildWarDoorKey={dong:0,nan:1,xi:2,bei:3},t.guildWarDoor={0:"东",1:"南",2:"西",3:"北"},t.serverArrTypeKey={littleHorn:1},t.serverArrType={1:"跨服聊天分组"},t.accountExDataKey={lastLoginServer:1},t.accountExData={1:"上次登录的服务器"},t.treasureRecordTypeKey={getTreasure:1,pkTreasure:2,openTreasure:3,compose:4},t.treasureRecordType={1:"获得秘宝",2:"pk获得秘宝",3:"成功开启",4:"合成成功"},t.extraInfuseTypeKey={genuineQi:1,diamond:2},t.extraInfuseType={1:"真气注入",2:"元宝注入"},t.chestTypeKey={equipLvl:5},t.chestType={5:"按等级开对应装备"},t.practiceTypeKey={medal:0,heart:1,gift:2},t.practiceType={0:"战印",1:"心法",2:"法宝"},t.talismanSkillTypeKey={property:1,cure:2,exp:3,genuineQi:4,callBoss:5,replaceSkill:6},t.talismanSkillType={1:"属性",2:"治疗效果被加成",3:"经验获得加成",4:"真气回复加快",5:"召唤宝宝",6:"替换技能"},t.outActivityTypeKey={outType1:1,outType2:2,outType3:3},t.outActivityType={1:"跨服行会个人排名",2:"行会BOSS",3:"活动"},t.userSurveyTypeKey={radio:1,checkbox:2},t.userSurveyType={1:"单选",2:"多选"},t.newFourDaysTypeKey={wingRank:1,gemRank:2,realmRank:3,combatRank:4},t.newFourDaysType={1:"角色翅膀",2:"角色宝石",3:"角色元神",4:"角色总战力"}}(e=t.c_prop||(t.c_prop={}))}(gc||(gc={}));var gc;!function(t){t.cfg_c_game="shared/c_game.json",t.c_game_id="A",t.c_game_key="B",t.c_game_func="C",t.c_game_memo="D",t.c_game_param0="E",t.c_game_param1="F",t.c_game_param2="G",t.c_game_param3="H",t.c_game_param4="I",t.c_game_param5="J",t.c_game_param6="K",t.c_game_param7="L",t.c_game_param8="M",t.c_game_param9="N",t.c_game_param10="O",t.c_game_param11="P",t.c_game_param12="Q",t.c_game_param13="R",t.c_game_param14="S",t.c_game_param15="T",t.c_game_param16="U",t.c_game_param17="V",t.c_game_param18="W",t.c_game_param19="X",t.c_game_param20="Y",t.c_game_param21="Z",t.c_game_param22="AA",t.c_game_param23="AB",t.c_game_param24="AC",t.c_game_param25="AD",t.c_game_param26="AE",t.cfg_c_lvl="shared/c_lvl.json",t.c_lvl_lvl="A",t.c_lvl_name="B",t.c_lvl_minExp="C",t.c_lvl_reqExp="D",t.c_lvl_slotStrength="E",t.c_lvl_slotLevelup="F",t.c_lvl_upSkillLevel="G",t.c_lvl_maxHp="H",t.c_lvl_attack="I",t.c_lvl_defence="J",t.c_lvl_magicDefence="K",t.c_lvl_hit="L",t.c_lvl_dodge="M",t.c_lvl_critical="N",t.c_lvl_disCritical="O",t.c_lvl_maxHp2="P",t.c_lvl_attack2="Q",t.c_lvl_defence2="R",t.c_lvl_magicDefence2="S",t.c_lvl_hit2="T",t.c_lvl_dodge2="U",t.c_lvl_critical2="V",t.c_lvl_disCritical2="W",t.c_lvl_minPKLvl="X",t.c_lvl_maxPKLvl="Y",t.c_lvl_minRobotLvl="Z",t.c_lvl_maxRobotLvl="AA",t.c_lvl_robotRate="AB",t.c_lvl_pkExpcMult="AC",t.c_lvl_robotRange="AD",t.c_lvl_equipStrengthNum="AE",t.c_lvl_equipStrengthGold="AF",t.c_lvl_equipStrengthGoldAdd="AG",t.c_lvl_buyGoldMult="AH",t.c_lvl_buyGoldRate="AI",t.c_lvl_skillNeedGold="AJ",t.c_lvl_guildExp="AK",t.c_lvl_guildMan="AL",t.c_lvl_postCount="AM",t.c_lvl_rankFileNeedAct="AN",t.c_lvl_ennobleCon="AO",t.c_lvl_upStarNum="AR",t.c_lvl_upStarGold="AS",t.c_lvl_upStarPropAdd="AT",t.c_lvl_upStarTop="AU",t.c_lvl_maxUpStarLvl="AV",t.c_lvl_topCosNum="AW",t.c_lvl_topCosGold="AX",t.c_lvl_succeedPro="AY",t.c_lvl_propertys="AZ",t.c_lvl_ringSlotLevelupReqItemCount="BA",t.c_lvl_lotusLvl="BB",t.c_lvl_upLotusNum="BC",t.c_lvl_expOutput="BD",t.c_lvl_storeLimit="BE",t.c_lvl_needLvl="BF",t.c_lvl_openingExp="BG",t.c_lvl_coffersBase="BI",t.c_lvl_cofferPower="BJ",t.c_lvl_cofferExpc="BK",t.c_lvl_cofferBoss="BL",t.cfg_c_msgCode="shared/c_msgCode.json",t.c_msgCode_id="A",t.c_msgCode_code="B",t.c_msgCode_text="C",t.c_msgCode_region0="D",t.c_msgCode_time="E",t.c_msgCode_onTop="F",t.c_msgCode_remark="G",t.c_msgCode_range="H",t.cfg_c_open="shared/c_open.json",t.c_open_id="A",t.c_open_key="B",t.c_open_sys="C",t.c_open_lvlRequired="D",t.cfg_c_guide="shared/c_guide.json",t.c_guide_id="A",t.c_guide_revert="D",t.c_guide_next="E",t.c_guide_condition="F",t.c_guide_judge="G",t.c_guide_type="H",t.c_guide_talk="I",t.c_guide_npcIndex="J",t.c_guide_penetrable="K",t.c_guide_countdown="L",t.c_guide_lvl="M",t.c_guide_copyId="N",t.c_guide_taskId="O",t.c_guide_layer="P",t.c_guide_node="Q",t.c_guide_rectNode="R",t.c_guide_delayTimeToShow="S",t.c_guide_beforeShow="T",t.c_guide_afterShow="U",t.c_guide_beforeNext="V",t.c_guide_afterNext="W",t.c_guide_endType="X",t.c_guide_toSave="Y",t.c_guide_waiting="Z",t.c_guide_actions="AA",t.c_guide_refreshEvent="AB",t.c_guide_isHook="AC",t.c_guide_route="AD",t.c_guide_option="AE",t.cfg_c_guildLvl="shared/c_guildLvl.json",t.c_guildLvl_1="V",t.c_guildLvl_2="W",t.c_guildLvl_3="X",t.c_guildLvl_4="Y",t.c_guildLvl_5="Z",t.c_guildLvl_6="AA",t.c_guildLvl_7="AB",t.c_guildLvl_8="AC",t.c_guildLvl_9="AD",t.c_guildLvl_10="AE",t.c_guildLvl_11="AF",t.c_guildLvl_12="AG",t.c_guildLvl_13="AH",t.c_guildLvl_id="A",t.c_guildLvl_name="B",t.c_guildLvl_props="C",t.c_guildLvl_ennobleCount="D",t.cfg_c_payInfo="shared/c_payInfo.json",t.c_payInfo_10001="C",t.c_payInfo_10004="D",t.c_payInfo_99999="B",t.c_payInfo_id="A",t.cfg_c_arenaRankReward="shared/c_arenaRankReward.json",t.c_arenaRankReward_id="A",t.c_arenaRankReward_name="B",t.c_arenaRankReward_rangeStart="C",t.c_arenaRankReward_rangeEnd="D",t.c_arenaRankReward_rewardId="E",t.c_arenaRankReward_gold="F",t.c_arenaRankReward_winPrestige="G",t.c_arenaRankReward_losePrestige="H",t.cfg_t_itemBreak="shared/t_itemBreak.json",t.t_itemBreak_id="A",t.t_itemBreak_name="B",t.t_itemBreak_level="C",t.t_itemBreak_position="D",t.t_itemBreak_props="E",t.t_itemBreak_combat="F",t.t_itemBreak_desc="G",t.cfg_c_gem="shared/c_gem.json",t.c_gem_id="A",t.c_gem_itemID="B",t.c_gem_index="C",t.c_gem_count="D",t.c_gem_gemLvl="E",t.c_gem_items1="F",t.c_gem_gemId0="G",t.c_gem_effectType1="H",t.c_gem_effectPro1="I",t.c_gem_items2="J",t.c_gem_gemId1="K",t.c_gem_effectType2="L",t.c_gem_effectPro2="M",t.c_gem_items3="N",t.c_gem_gemId2="O",t.c_gem_effectType3="P",t.c_gem_effectPro3="Q",t.c_gem_items4="R",t.c_gem_gemId3="S",t.c_gem_effectType4="T",t.c_gem_effectPro4="U",t.cfg_c_compound="shared/c_compound.json",t.c_compound_id="A",t.c_compound_name="B",t.c_compound_reqJinbi="C",t.c_compound_reqExploit="D",t.c_compound_needLvl="E",t.c_compound_reqItems1="F",t.c_compound_reqCount1="G",t.c_compound_reqItems2="H",t.c_compound_reqCount2="I",t.c_compound_reqItems3="J",t.c_compound_reqCount3="K",t.c_compound_reqItems4="L",t.c_compound_reqCount4="M",t.cfg_c_exchange="shared/c_exchange.json",t.c_exchange_id="A",t.c_exchange_item="B",t.c_exchange_stuffs="C",t.c_exchange_lvlRequired="D",t.c_exchange_type="E",t.c_exchange_count="F",t.c_exchange_rate="G",t.cfg_c_mail="shared/c_mail.json",t.c_mail_id="A",t.c_mail_type="B",t.c_mail_fromName="C",t.c_mail_title="D",t.c_mail_content="E",t.c_mail_expireDays="F",t.c_mail_delHours="G",t.c_mail_explain="H",t.cfg_c_task="shared/c_task.json",t.c_task_id="A",t.c_task_name="B",t.c_task_note="C",t.c_task_taskType="D",t.c_task_cTaskType="E",t.c_task_targetValue="F",t.c_task_rewardId="G",t.c_task_uiLink="H",t.c_task_icon="I",t.cfg_c_nameData="shared/c_nameData.json",t.c_nameData_id="A",t.c_nameData_firstName="B",t.c_nameData_maleName="C",t.c_nameData_femaleName="D",t.cfg_c_pvpRankReward="shared/c_pvpRankReward.json",t.c_pvpRankReward_id="A",t.c_pvpRankReward_name="B",t.c_pvpRankReward_range="C",t.c_pvpRankReward_gold="D",t.c_pvpRankReward_diamond="E",t.c_pvpRankReward_starStone="F",t.c_pvpRankReward_items="G",t.cfg_c_realm="shared/c_realm.json",t.c_realm_id="A",t.c_realm_name="B",t.c_realm_reqItems="C",t.c_realm_propertys="D",t.cfg_c_recharge="shared/c_recharge.json",t.c_recharge_id="A",t.c_recharge_name="B",t.c_recharge_type="C",t.c_recharge_diamond="D",t.c_recharge_payId="E",t.c_recharge_cost="F",t.c_recharge_first="G",t.c_recharge_extra="H",t.c_recharge_daily="I",t.c_recharge_desc="J",t.c_recharge_visible="K",t.c_recharge_index="L",t.c_recharge_eventIcon="M",t.c_recharge_displayId="N",t.c_recharge_isTreble="O",t.cfg_c_reward="shared/c_reward.json",t.c_reward_id="A",t.c_reward_name="B",t.c_reward_exp="C",t.c_reward_gold="D",t.c_reward_diamond="E",t.c_reward_prestige="F",t.c_reward_activity="G",t.c_reward_rewardItems="H",t.cfg_c_vip="shared/c_vip.json",t.c_vip_id="A",t.c_vip_score="B",t.c_vip_itemId="C",t.c_vip_equipCount="D",t.c_vip_bossCount="E",t.c_vip_realmCount="F",t.c_vip_buyBossCount="G",t.c_vip_guildFbCount="H",t.c_vip_buyLingyunCount="I",t.c_vip_skipFight="J",t.c_vip_autoSmelt="K",t.c_vip_autoPkOut="L",t.c_vip_guildBoss="M",t.c_vip_copyCountV10="N",t.c_vip_copyCountV14="O",t.c_vip_copyCountV17="P",t.c_vip_copyCountV19="Q",t.c_vip_copyCountV7="R",t.c_vip_addEquipBag="S",t.c_vip_redEnvelopeCount="T",t.c_vip_openingCount="U",t.c_vip_coffersBuild="V",t.c_vip_coffersBuff="W",t.c_vip_kingOp="X",t.c_vip_bossBackRes="Y",t.c_vip_isLock="Z",t.c_vip_worldCount="AA",t.c_vip_guildCount="AB",t.c_vip_bossAutoFight="AC",t.c_vip_copyBossAutoFight="AD",t.c_vip_isPickAct="AE",t.c_vip_isWipeMore="AL",t.c_vip_wipeCount="AM",t.c_vip_openRole2="AN",t.c_vip_openRole3="AO",t.c_vip_openRole4="AP",t.c_vip_buzhen="AQ",t.cfg_t_buff="shared/t_buff.json",t.t_buff_id="A",t.t_buff_name="B",t.t_buff_note="C",t.t_buff_state="D",t.t_buff_liftTime="E",t.t_buff_lifeTimeAdd="F",t.t_buff_effectValue="G",t.t_buff_effectValeAdd="H",t.t_buff_propertyID="I",t.t_buff_baseValue1="J",t.t_buff_linerScale="K",t.t_buff_quadraticScale="L",t.t_buff_channel="M",t.t_buff_overlap="N",t.t_buff_disBuffChannel="O",t.t_buff_cleanChannel="P",t.t_buff_specialEffect="Q",t.t_buff_targetColor="R",t.t_buff_effectRes="S",t.t_buff_effectPos="T",t.cfg_t_copy="shared/t_copy.json",t.t_copy_id="A",t.t_copy_name="B",t.t_copy_displayID="C",t.t_copy_type="D",t.t_copy_monsterCount="E",t.t_copy_monsterTotal="F",t.t_copy_bossSpace="G",t.t_copy_bossID="H",t.t_copy_loot="I",t.t_copy_bossLoot="J",t.t_copy_lootDisplay="K",t.t_copy_cond="L",t.t_copy_icon="M",t.t_copy_randMonsters="N",t.cfg_t_copyLoot="shared/t_copyLoot.json",t.t_copyLoot_id="A",t.t_copyLoot_name="B",t.t_copyLoot_exItems="C",t.t_copyLoot_moneyMin="D",t.t_copyLoot_moneyMax="E",t.t_copyLoot_diamond="F",t.t_copyLoot_moneyProbability="G",t.t_copyLoot_lootChildIds="H",t.t_copyLoot_randCounts="I",t.t_copyLoot_showItems="J",t.cfg_t_copyLootChild="shared/t_copyLootChild.json",t.t_copyLootChild_id="A",t.t_copyLootChild_name="B",t.t_copyLootChild_num="C",t.t_copyLootChild_num2="D",t.t_copyLootChild_items="E",t.t_copyLootChild_items2="F",t.cfg_t_item="shared/t_item.json",t.t_item_id="A",t.t_item_name="B",t.t_item_note="C",t.t_item_iconId="D",t.t_item_itemLvl="E",t.t_item_level="F",t.t_item_vip="G",t.t_item_color="H",t.t_item_type="I",t.t_item_bagTag="J",t.t_item_count="K",t.t_item_price="L",t.t_item_dropId="M",t.t_item_isLoot="N",t.t_item_lootType="O",t.cfg_t_itemLogic="shared/t_itemLogic.json",t.t_itemLogic_id="A",t.t_itemLogic_type="B",t.t_itemLogic_chestType="C",t.t_itemLogic_create="D",t.t_itemLogic_num="E",t.t_itemLogic_needItems="F",t.t_itemLogic_create2="G",t.cfg_t_itemEquip="shared/t_itemEquip.json",t.t_itemEquip_id="A",t.t_itemEquip_name="B",t.t_itemEquip_job="C",t.t_itemEquip_type="D",t.t_itemEquip_displayID="E",t.t_itemEquip_slotStrengthProperty="F",t.t_itemEquip_propValue="G",t.t_itemEquip_propertys="H",t.t_itemEquip_randomRate="I",t.t_itemEquip_randomPro="J",t.t_itemEquip_fixProp="K",t.t_itemEquip_isUp="L",t.t_itemEquip_isRare="M",t.t_itemEquip_isSuper="N",t.t_itemEquip_gradeBase="O",t.t_itemEquip_isLocked="P",t.cfg_t_itemRealm="shared/t_itemRealm.json",t.t_itemRealm_id="A",t.t_itemRealm_name="B",t.t_itemRealm_propertys="C",t.t_itemRealm_compoundId="D",t.cfg_t_monster="shared/t_monster.json",t.t_monster_id="A",t.t_monster_name="B",t.t_monster_note="C",t.t_monster_displayID="D",t.t_monster_bossLevel="E",t.t_monster_attackType="F",t.t_monster_maxHp="G",t.t_monster_attack="H",t.t_monster_defense="I",t.t_monster_magicDefence="J",t.t_monster_hit="K",t.t_monster_dodge="L",t.t_monster_critical="M",t.t_monster_disCritical="N",t.t_monster_damageIncrease="O",t.t_monster_damageDecrease="P",t.t_monster_benumbPro="Q",t.t_monster_disBenyumbPro="R",t.t_monster_immunity="S",t.t_monster_moveSpeed="T",t.t_monster_attackTime="U",t.t_monster_skillIds="V",t.t_monster_effectsId="W",t.t_monster_seeDistance="X",t.t_monster_idleSound="Y",t.t_monster_attackSound="Z",t.t_monster_deadSound="AA",t.t_monster_dropId="AB",t.t_monster_userExp="AC",t.t_monster_level="AD",t.t_monster_scale="AE",t.t_monster_combat="AF",t.cfg_t_wing="shared/t_wing.json",t.t_wing_id="A",t.t_wing_name="B",t.t_wing_level="C",t.t_wing_star="D",t.t_wing_iconId="E",t.t_wing_displayID="F",t.t_wing_needExp="G",t.t_wing_attack="H",t.t_wing_maxHp="I",t.t_wing_defence="J",t.t_wing_magicDefence="K",t.cfg_t_wingStrength="shared/t_wingStrength.json",t.t_wingStrength_id="A",t.t_wingStrength_lvl="B",t.t_wingStrength_needWingLvl="C",t.t_wingStrength_attack="D",t.t_wingStrength_defence="E",t.t_wingStrength_maxHp="F",t.t_wingStrength_magicDefence="G",t.t_wingStrength_consume="H",t.t_wingStrength_successPro="I",t.t_wingStrength_demotePro="J",t.t_wingStrength_critPro="K",t.cfg_t_skill="shared/t_skill.json",t.t_skill_id="A",t.t_skill_name="B",t.t_skill_desc="C",t.t_skill_canExtends="D",t.t_skill_effect="E",t.t_skill_cd="F",t.t_skill_firstCD="G",t.t_skill_special="H",t.t_skill_attackDistance="I",t.t_skill_priority="J",t.t_skill_targetType="K",t.t_skill_effectRadius="L",t.t_skill_damage="M",t.t_skill_pushType="N",t.t_skill_pushDistance="O",t.t_skill_casterPositionType="P",t.t_skill_buffID="Q",t.t_skill_callMonsterID="R",t.t_skill_callMonsterNum="S",t.t_skill_damageScaleA="T",t.t_skill_damageScaleB="U",t.t_skill_damageScaleC="V",t.t_skill_pushDistanceScaleA="W",t.t_skill_pushDistanceScaleB="X",t.t_skill_pushDistanceScaleC="Y",t.t_skill_castAction="Z",t.t_skill_combat="AA",t.t_skill_actionTime="AB",t.t_skill_casterEffect="AC",t.t_skill_targetEffect="AD",t.t_skill_flyEffect="AE",t.t_skill_beHittedEffect="AF",t.cfg_t_hero="shared/t_hero.json",t.t_hero_id="A",t.t_hero_name="B",t.t_hero_note="C",t.t_hero_job="D",t.t_hero_displayID="E",t.t_hero_describe="F",t.t_hero_attackType="G",t.t_hero_moveSpeed="H",t.t_hero_attackInterval="I",t.t_hero_skillIds="J",t.cfg_c_shop="shared/c_shop.json",t.c_shop_id="A",t.c_shop_type="B",t.c_shop_itemId="C",t.c_shop_needLvl="D",t.c_shop_endLvl="E",t.c_shop_limit="F",t.c_shop_currencyType="G",t.c_shop_price="H",t.c_shop_discount="K",t.c_shop_rate="L",t.c_shop_order="M",t.cfg_c_help="shared/c_help.json",t.c_help_id="A",t.c_help_system="B",t.c_help_helpText="C",t.cfg_c_chatSys="shared/c_chatSys.json",t.c_chatSys_id="A",t.c_chatSys_type="B",t.c_chatSys_subType="C",t.c_chatSys_arg="D",t.c_chatSys_text="E",t.c_chatSys_ifNotice="F",t.c_chatSys_ifImport="G",t.cfg_c_guildFuncCfg="shared/c_guildFuncCfg.json",t.c_guildFuncCfg_id="A",t.c_guildFuncCfg_setEnnoble="B",t.c_guildFuncCfg_maxMember="D",t.c_guildFuncCfg_disGuild="E",t.c_guildFuncCfg_quitGuild="F",t.c_guildFuncCfg_invite="G",t.c_guildFuncCfg_agreeApp="H",t.c_guildFuncCfg_setGuild="I",t.c_guildFuncCfg_moveMember="J",t.c_guildFuncCfg_upToChairman="K",t.c_guildFuncCfg_upToVice="L",t.c_guildFuncCfg_movePosition="M",t.c_guildFuncCfg_changeNotice="N",t.c_guildFuncCfg_resetCopy="O",t.c_guildFuncCfg_distribution="P",t.c_guildFuncCfg_signWar="Q",t.c_guildFuncCfg_sendEmail="R",t.cfg_c_guildAct="shared/c_guildAct.json",t.c_guildAct_id="A",t.c_guildAct_name="B",t.c_guildAct_type="C",t.c_guildAct_act="D",t.c_guildAct_num="E",t.c_guildAct_gold="F",t.c_guildAct_actCount="G",t.c_guildAct_icon="H",t.c_guildAct_uiLink="I",t.c_guildAct_seniority="J",t.cfg_c_guildEnnoble="shared/c_guildEnnoble.json",t.c_guildEnnoble_id="A",t.c_guildEnnoble_ennobleGuildLvlCfg="B",t.c_guildEnnoble_ennobleLvlCfg="C",t.c_guildEnnoble_props="D",t.cfg_c_mysterShop="shared/c_mysterShop.json",t.c_mysterShop_id="A",t.c_mysterShop_type="B",t.c_mysterShop_integralItem1="C",t.c_mysterShop_integralItem2="D",t.c_mysterShop_integralItem3="E",t.c_mysterShop_giftBag1="F",t.c_mysterShop_giftBag2="G",t.c_mysterShop_picture="H",t.cfg_t_inheritedEquip="shared/t_inheritedEquip.json",t.t_inheritedEquip_id="A",t.t_inheritedEquip_nextId="B",t.t_inheritedEquip_num="C",t.cfg_c_bossParameter="shared/c_bossParameter.json",t.c_bossParameter_id="B",t.c_bossParameter_isOpen="C",t.c_bossParameter_week="D",t.c_bossParameter_displayId="E",t.c_bossParameter_copyId="F",t.c_bossParameter_repeat="G",t.c_bossParameter_openLvl="H",t.c_bossParameter_fightLvl="I",t.c_bossParameter_maxLvl="J",t.c_bossParameter_summonCd="K",t.c_bossParameter_summonCost="L",t.c_bossParameter_rankAward1="M",t.c_bossParameter_rankAward2="N",t.c_bossParameter_rankAward3="O",t.c_bossParameter_rankAward4="P",t.c_bossParameter_summonAward="Q",t.c_bossParameter_guildAward="R",t.c_bossParameter_lastShotAward="S",t.c_bossParameter_awardDesc="T",t.c_bossParameter_goldRate="U",t.c_bossParameter_timeLimit="V",t.c_bossParameter_isLimit="W",t.c_bossParameter_startTime="X",t.c_bossParameter_endTime="Y",t.c_bossParameter_showOnHoliday="Z",t.c_bossParameter_sort="AA",t.cfg_t_otherBuff="shared/t_otherBuff.json",t.t_otherBuff_id="A",t.t_otherBuff_name="B",t.t_otherBuff_type="C",t.t_otherBuff_addHurt="D",t.t_otherBuff_conTime="E",t.t_otherBuff_icon="F",t.t_otherBuff_des="G",t.cfg_c_bossHurtRate="shared/c_bossHurtRate.json",t.c_bossHurtRate_id="A",t.c_bossHurtRate_startHurt1="B",t.c_bossHurtRate_endHurt1="C",t.c_bossHurtRate_gold1="D",t.c_bossHurtRate_startHurt2="E",t.c_bossHurtRate_endHurt2="F",t.c_bossHurtRate_gold2="G",t.c_bossHurtRate_startHurt3="H",t.c_bossHurtRate_endHurt3="I",t.c_bossHurtRate_gold3="J",t.c_bossHurtRate_guildStartHurt1="K",t.c_bossHurtRate_guildEndHurt1="L",t.c_bossHurtRate_guildProgress1="M",t.c_bossHurtRate_guildStartHurt2="N",t.c_bossHurtRate_guildEndHurt2="O",t.c_bossHurtRate_guildProgress2="P",t.c_bossHurtRate_guildStartHurt3="Q",t.c_bossHurtRate_guildEndHurt3="R",t.c_bossHurtRate_guildProgress3="S",t.c_bossHurtRate_guildStartHurt4="T",t.c_bossHurtRate_guildEndHurt4="U",t.c_bossHurtRate_guildProgress4="V",t.c_bossHurtRate_guildStartHurt5="W",t.c_bossHurtRate_guildEndHurt5="X",t.c_bossHurtRate_guildProgress5="Y",t.c_bossHurtRate_guildStartHurt6="Z",t.c_bossHurtRate_guildEndHurt6="AA",t.c_bossHurtRate_guildProgress6="AB",t.c_bossHurtRate_guildStartHurt7="AC",t.c_bossHurtRate_guildEndHurt7="AD",t.c_bossHurtRate_guildProgress7="AE",t.c_bossHurtRate_guildStartHurt8="AF",t.c_bossHurtRate_guildEndHurt8="AG",t.c_bossHurtRate_guildProgress8="AH",t.cfg_c_challengeCupRankReward="shared/c_challengeCupRankReward.json",t.c_challengeCupRankReward_id="A",t.c_challengeCupRankReward_name="B",t.c_challengeCupRankReward_rangeStart="C",t.c_challengeCupRankReward_rangeEnd="D",t.c_challengeCupRankReward_gold="E",t.c_challengeCupRankReward_reward="F",t.cfg_t_rebirth="shared/t_rebirth.json",t.t_rebirth_id="A",t.t_rebirth_rebirthLvl="B",t.t_rebirth_lvl="C",t.t_rebirth_limitLvl="D",t.t_rebirth_exp="E",t.t_rebirth_maxHpTemp="F",t.t_rebirth_attackTemp="G",t.t_rebirth_defenceTemp="H",t.t_rebirth_magicDefenceTemp="I",t.t_rebirth_hitTemp="J",t.t_rebirth_dodgeTemp="K",t.t_rebirth_criticalTemp="L",t.t_rebirth_disCriticalTemp="M",t.cfg_c_customParameter="shared/c_customParameter.json",t.c_customParameter_id="A",t.c_customParameter_gainType="B",t.c_customParameter_part="C",t.c_customParameter_job1_itemId0="D",t.c_customParameter_job1_itemId1="E",t.c_customParameter_job2_itemId0="F",t.c_customParameter_job2_itemId1="G",t.c_customParameter_job3_itemId0="H",t.c_customParameter_job3_itemId1="I",t.c_customParameter_equip_lvl_range="J",t.c_customParameter_vip="K",t.c_customParameter_color="L",t.cfg_c_luckyTalos="shared/c_luckyTalos.json",t.c_luckyTalos_id="A",t.c_luckyTalos_itemID="B",t.c_luckyTalos_amount="C",t.c_luckyTalos_class="D",t.c_luckyTalos_color="E",t.c_luckyTalos_weight="F",t.c_luckyTalos_spItemId="G",t.c_luckyTalos_itemLimit="H",t.c_luckyTalos_subType="I",t.c_luckyTalos_subTypeDivide="J",t.cfg_c_everydayCharge="shared/c_everydayCharge.json",t.c_everydayCharge_id="A",t.c_everydayCharge_awardId="B",t.c_everydayCharge_chargeAmount="C",t.cfg_t_medal="shared/t_medal.json",t.t_medal_id="A",t.t_medal_name="B",t.t_medal_propertys="C",t.t_medal_iconId="D",t.t_medal_staIconId="E",t.t_medal_text="F",t.t_medal_grade="G",t.t_medal_chatIconId="H",t.t_medal_outputWay="I",t.t_medal_isAchivement="J",t.t_medal_lootArg="K",t.t_medal_metalType="L",t.cfg_t_medalLvl="shared/t_medalLvl.json",t.t_medalLvl_id="A",t.t_medalLvl_lvl="B",t.t_medalLvl_reqItems="C",t.t_medalLvl_strengthPro="D",t.t_medalLvl_grade="E",t.t_medalLvl_needLvl="F",t.cfg_t_strengthRefine="shared/t_strengthRefine.json",t.t_strengthRefine_lvl="A",t.t_strengthRefine_needStrLvl="B",t.t_strengthRefine_consumeStr="C",t.t_strengthRefine_consumeGold="D",t.t_strengthRefine_strAddition="E",t.t_strengthRefine_succeedPro="F",t.t_strengthRefine_demotePro="G",t.t_strengthRefine_critPro="H",t.cfg_c_demonLotus="shared/c_demonLotus.json",t.c_demonLotus_lvl="A",t.c_demonLotus_advNeedLvl="B",t.c_demonLotus_expcAccLimit="C",t.c_demonLotus_genqiAccLimit="D",t.c_demonLotus_expOutput="E",t.c_demonLotus_advSucceedPro="F",t.c_demonLotus_advCosLotus="G",t.c_demonLotus_treaNeedUserLvl="I",t.c_demonLotus_treaSucceedPro="J",t.c_demonLotus_treaCosGenqi="K",t.c_demonLotus_treaCosLotus="L",t.c_demonLotus_treaPropertys="M",t.cfg_c_genuineQi="shared/c_genuineQi.json",t.c_genuineQi_lvl="A",t.c_genuineQi_recovery="B",t.c_genuineQi_genuLimit="C",t.cfg_c_heartStunt="shared/c_heartStunt.json",t.c_heartStunt_id="A",t.c_heartStunt_name="B",t.c_heartStunt_skillId="C",t.c_heartStunt_skillId2="D",t.c_heartStunt_series="E",t.c_heartStunt_layer="F",t.c_heartStunt_desc="G",t.c_heartStunt_skillDesc="H",t.cfg_c_heartStuntLvl="shared/c_heartStuntLvl.json",t.c_heartStuntLvl_lvl="A",t.c_heartStuntLvl_succeedPro="D",t.c_heartStuntLvl_cosGenqi="E",t.c_heartStuntLvl_cosGold="F",t.c_heartStuntLvl_addProperty="G",t.cfg_c_bossWorld="shared/c_bossWorld.json",t.c_bossWorld_id="A",t.c_bossWorld_displayId="B",t.c_bossWorld_copyId="C",t.c_bossWorld_fightLvl="D",t.c_bossWorld_rankAward1="E",t.c_bossWorld_rankAward2="F",t.c_bossWorld_rankAward3="G",t.c_bossWorld_rankAward4="H",t.c_bossWorld_rankAward5="I",t.c_bossWorld_rankAward6="J",t.c_bossWorld_rankAward7="K",t.c_bossWorld_lastShotAward="L",t.c_bossWorld_treasureItemRate="M",t.c_bossWorld_treasurePercentAward="N",t.c_bossWorld_treasureAward="O",t.c_bossWorld_failAward1="P",t.c_bossWorld_failAward2="Q",t.c_bossWorld_failAward3="R",t.c_bossWorld_failAward4="S",t.c_bossWorld_failAward5="T",t.c_bossWorld_failAward6="U",t.c_bossWorld_failAward7="V",t.c_bossWorld_isLimit="W",t.c_bossWorld_startTime="X",t.c_bossWorld_endTime="Y",t.c_bossWorld_sort="Z",t.cfg_c_bossRes="shared/c_bossRes.json",t.c_bossRes_id="A",t.c_bossRes_winRes1="B",t.c_bossRes_winCond1="C",t.c_bossRes_winRes2="D",t.c_bossRes_winCond2="E",t.c_bossRes_winRes3="F",t.c_bossRes_winCond3="G",t.c_bossRes_winRes4="H",t.c_bossRes_winCond4="I",t.c_bossRes_winRes5="J",t.c_bossRes_winCond5="K",t.c_bossRes_winRes6="L",t.c_bossRes_winCond6="M",t.c_bossRes_winRes7="N",t.c_bossRes_winCond7="O",t.c_bossRes_winRes8="P",t.c_bossRes_winCond8="Q",t.c_bossRes_winRes9="R",t.c_bossRes_winCond9="S",t.c_bossRes_winRes10="T",t.c_bossRes_winCond10="U",t.c_bossRes_failRes1="V",t.c_bossRes_failCond1="W",t.c_bossRes_failRes2="X",t.c_bossRes_failCond2="Y",t.c_bossRes_failRes3="Z",t.c_bossRes_failCond3="AA",t.c_bossRes_failRes4="AB",t.c_bossRes_failCond4="AC",t.c_bossRes_failRes5="AD",t.c_bossRes_failCond5="AE",t.c_bossRes_failRes6="AF",t.c_bossRes_failCond6="AG",t.c_bossRes_failRes7="AH",t.c_bossRes_failCond7="AI",t.c_bossRes_failRes8="AJ",t.c_bossRes_failCond8="AK",t.c_bossRes_failRes9="AL",t.c_bossRes_failCond9="AM",t.c_bossRes_failRes10="AN",t.c_bossRes_failCond10="AO",t.cfg_c_vipCopy="shared/c_vipCopy.json",t.c_vipCopy_vipLvl="A",t.c_vipCopy_copyIds="B",t.c_vipCopy_name="C",t.c_vipCopy_lootDesc="D",t.cfg_c_giftPack="shared/c_giftPack.json",t.c_giftPack_id="A",t.c_giftPack_content="B",t.cfg_t_guildCopy="shared/t_guildCopy.json",t.t_guildCopy_id="A",t.t_guildCopy_name="B",t.t_guildCopy_openLvl="C",t.t_guildCopy_award="D",t.t_guildCopy_section="E",t.t_guildCopy_title_icon="F",t.t_guildCopy_bg="G",t.t_guildCopy_sub_title_icon="H",t.cfg_t_guildCopyBoss="shared/t_guildCopyBoss.json",t.t_guildCopyBoss_bossId="A",t.t_guildCopyBoss_copyId="B",t.t_guildCopyBoss_award="C",t.t_guildCopyBoss_lastShotAward="D",t.cfg_t_sellItem="shared/t_sellItem.json",t.t_sellItem_id="A",t.t_sellItem_name="B",t.t_sellItem_note="C",t.t_sellItem_items="D",t.t_sellItem_sells="E",t.cfg_t_treasure="shared/t_treasure.json",t.t_treasure_id="A",t.t_treasure_name="B",t.t_treasure_items="C",t.t_treasure_guardTime="D",t.cfg_c_guildWarReward="shared/c_guildWarReward.json",t.c_guildWarReward_id="A",t.c_guildWarReward_name="B",t.c_guildWarReward_rangeBeg="C",t.c_guildWarReward_rangeEnd="D",t.c_guildWarReward_diamond="E",t.c_guildWarReward_diamondSp="F",t.c_guildWarReward_diamondUser="G",t.c_guildWarReward_wgold="H",t.c_guildWarReward_wgoldSp="I",t.c_guildWarReward_wgoldUser="J",t.c_guildWarReward_hgold="K",t.c_guildWarReward_hgoldSp="L",t.c_guildWarReward_hgoldUser="M",t.c_guildWarReward_silver="N",t.c_guildWarReward_silverSp="O",t.c_guildWarReward_silverUser="P",t.c_guildWarReward_copper="Q",t.c_guildWarReward_copperSp="R",t.c_guildWarReward_copperUser="S",t.cfg_t_paTaTreasury="shared/t_paTaTreasury.json",t.t_paTaTreasury_copyId="A",t.t_paTaTreasury_displayId="B",t.t_paTaTreasury_award="C",t.t_paTaTreasury_preview="D",t.t_paTaTreasury_treasury="E",t.t_paTaTreasury_troHorLamp="F",t.t_paTaTreasury_exData="G",t.cfg_t_talisman="shared/t_talisman.json",t.t_talisman_id="A",t.t_talisman_name="B",t.t_talisman_job="C",t.t_talisman_iconId="D",t.t_talisman_effectId="E",t.t_talisman_imgId="F",t.t_talisman_sEffect="G",t.t_talisman_atStart="H",t.t_talisman_atEnd="I",t.t_talisman_resonance="J",t.t_talisman_compound="K",t.t_talisman_desc="L",t.t_talisman_skillStar="M",t.t_talisman_isOpen="N",t.cfg_t_talismanCom="shared/t_talismanCom.json",t.t_talismanCom_id="A",t.t_talismanCom_reqItems1="B",t.t_talismanCom_reqCount1="C",t.t_talismanCom_needLvl1="D",t.t_talismanCom_needStar1="E",t.t_talismanCom_reqItems2="F",t.t_talismanCom_reqCount2="G",t.t_talismanCom_needLvl2="H",t.t_talismanCom_needStar2="I",t.t_talismanCom_reqItems3="J",t.t_talismanCom_reqCount3="K",t.t_talismanCom_needLvl3="L",t.t_talismanCom_needStar3="M",t.cfg_t_talismanLvl="shared/t_talismanLvl.json",t.t_talismanLvl_id="A",t.t_talismanLvl_lvl="B",t.t_talismanLvl_userLv="C",t.t_talismanLvl_propertys="D",t.t_talismanLvl_needItems="E",t.t_talismanLvl_starLimit="F",t.cfg_t_talismanRes="shared/t_talismanRes.json",t.t_talismanRes_id="A",t.t_talismanRes_name="B",t.t_talismanRes_desc="C",t.t_talismanRes_resonance="D",t.t_talismanRes_type="E",t.t_talismanRes_extraPro="F",t.cfg_t_talismanSkill="shared/t_talismanSkill.json",t.t_talismanSkill_id="A",t.t_talismanSkill_name="B",t.t_talismanSkill_desc="C",t.t_talismanSkill_icon="D",t.t_talismanSkill_type="E",t.t_talismanSkill_effect="F",t.cfg_t_talismanStar="shared/t_talismanStar.json",t.t_talismanStar_id="A",t.t_talismanStar_aptitude="C",t.t_talismanStar_needItems="D",t.t_talismanStar_skillId="E",t.t_talismanStar_getPro="F",t.cfg_c_luckyMajong="shared/c_luckyMajong.json",t.c_luckyMajong_id="A",t.c_luckyMajong_itemID="B",t.c_luckyMajong_amount="C",t.c_luckyMajong_class="D",t.c_luckyMajong_color="E",t.c_luckyMajong_weight="F",t.c_luckyMajong_spItemId="G",t.c_luckyMajong_itemLimit="H",t.c_luckyMajong_subType="I",t.c_luckyMajong_subTypeDivide="J",t.c_luckyMajong_ifRare="K",t.c_luckyMajong_cardCount="L",t.cfg_c_userSurvey="shared/c_userSurvey.json",t.c_userSurvey_id="A",t.c_userSurvey_question="B",t.c_userSurvey_optionContent="C",t.c_userSurvey_type="D"
}(gc||(gc={}));var gc;!function(t){t.dsConsts={AccountEntity:{id:1,name:2,email:3,pwd:4,deviceId:5,status:6,channelId:7,sdkData:8,exData:9,createTime:10,createIP:11,lastUpdateTime:12,loginCount:13,loginKey:14,userServers:15,rechargeCom:16,sdkChannelId:17,bendExpireAt:18,bendType:19},ActivityEntity:{id:1,title:2,type:3,iconType:4,tiIconType:5,startTime:6,endTime:7,items:8,randomHeroes:9,exValues:10,exValues2:11,exValues3:12,content:13,isOpen:14,sort:15,exData:16,templateId:17},ActivityRecordEntity:{id:1,userId:2,activityId:3,activityType:4,userLvl:5,userVip:6,costDiamond:7,getDiamond:8,joinCount:9,addTime:10,updateTime:11},AllRunwatEntity:{id:1,dateTime:2,newUser:3,active:4,nextDayLeft:5,weekLeft:6,runwat:7,payCount:8,newPay:9,ARPU:10,payRate:11,ARPPU:12,runwatNum:13,userNum:14},ArenaBakEntity:{id:1,userId:2,rank:3,highRank:4,fightRanks:5,reNumData:6,awardData:7,winCount:8,conWinCount:9,maxConWinCount:10},ArenaEntity:{id:1,userId:2,rank:3,highRank:4,fightRanks:5,reNumData:6,awardData:7,winCount:8,conWinCount:9,maxConWinCount:10},ArenaRecordEntity:{id:1,userId:2,userLvl:3,userIconId:4,userName:5,userWinCount:6,enemyId:7,enemyLvl:8,enemyIconId:9,enemyName:10,enemyWinCount:11,isWin:12,fightTime:13,fightData:14,fightType:15,isDeal:16,isRead:17,isRevenge:18},BossBakEntity:{id:1,bossId:2,startTime:3,endTime:4,killUserId:5,deathTime:6,status:7,lastIsWin:8,resultData:9,isPrize:10,limitStartTime:11,limitEndTime:12,isLimit:13,type:14,originBossId:15,deathBossId:16,repeatCount:17,repeatTime:18,callArr:19,week:20,errData:21},BossEntity:{id:1,bossId:2,startTime:3,endTime:4,killUserId:5,deathTime:6,status:7,lastIsWin:8,resultData:9,isPrize:10,limitStartTime:11,limitEndTime:12,isLimit:13,type:14,originBossId:15,deathBossId:16,repeatCount:17,repeatTime:18,callArr:19,week:20,errData:21},ChallengeCupEntity:{id:1,userId:2,leftTime:3,championUserId:4,startTime:5,exData:6,isOpen:7,worship:8,worshipCount:9,buffOpenNum:10,buffOpenTime:11,buffEndTime:12,recordArr:13},ChallengeCupRankEntity:{id:1,userId:2,startTime:3,endTime:4,maxTime:5,iconId:6,nickName:7,lvl:8,vip:9},CoffersBakEntity:{id:1,lvl:2,buildValue:3,resource:4,lootResource:5,beLootResource:6,defeseData:7,defeseRecordArr:8,lootRecordArr:9,points:10,todayPoints:11,buffLvl:12,buffExpc:13,buffBase:14,bakDate:15,lootUserData:16,breakTimeData:17},CoffersEntity:{id:1,lvl:2,buildValue:3,resource:4,lootResource:5,beLootResource:6,defeseData:7,defeseRecordArr:8,lootRecordArr:9,points:10,todayPoints:11,buffLvl:12,buffExpc:13,buffBase:14,lootUserData:15,breakTimeData:16},CoffersGroupEntity:{id:1,name:2,serverArr:3},ConsumeEntity:{id:1,recordTime:2,userId:3,item_id:4,amount:5,shopRecord:6,channelId:7},CopyProgressEntity:{id:1,userId:2,copyType:3,pCopyId:4,winningStreak:5,pTime:6,copyObj:7,refreshTime:8,timeArr:9,copyStar:10,finished:11,isPickAward:12,isPickChests:13,timesPerDay:14,resetCounts:15,resetTime:16,readObj:17},CouponEntity:{id:1,userId:2,name:3,content:4,code:5,type:6,startTime:7,endTime:8,items:9,channelIds:10,channelId:11,isUsed:12,serverId:13,period:14,isNew:15},DemonLotusEntity:{id:1,userId:2,lvl:3,addUpExpc:4,lastOpeTime:5,advanceLvl:6,treasureLvl:7},ExpeditionEntity:{id:1,userId:2,stageId:3,fightCount:4,soulCount:5},ExpHeroEntity:{id:1,userId:2,tempId:3,quality:4,intensifyArr:5,starArr:6,gemArr:7,wingArr:8,expc:9,lvl:10,equipData:11,skillLvlArr:12,propArr:13,realmLvl:14,realmArr:15,sex:16,combat:17,refineArr:18,starTopArr:19,talismanAdorn:20,talismanData:21,talismanFg:22,wingSumLvl:23,gemSumLvl:24,realmSumLvl:25,fightSort:26,soulArr:27,wearSoulId:28,recordTime:29},FiveDaysTargetEntity:{id:1,userId:2,userName:3,iconId:4,userLvl:5,pkWinCount:6,combat:7,rankType:8,rankValue:9},GameCommonEntity:{id:1,highCopyId:2,isOpenBoss:3},GameConfigEntity:{id:1,guildWarSign:2,guildWarOpen:3,guildWarHost:4,guildWarPort:5,redisHostArr:6,noSignServerArr:7},GameRecordEntity:{id:1,userId:2,recordTime:3,loginCount:4,copyCount:5,wipeCount:6,pkCount:7,jjcPkCount:8,rechargeCount:9,rechargeSum:10,rechargeRecord:11,shopRecord:12,costGoldRecord:13,costDiamondRecord:14,costDiamondRecord1:15,costDiamondRecord2:16,getDiamondRecord:17,getDiamondRecord1:18,getDiamondRecord2:19,channelId:20,serverId:21},GemGainEntity:{id:1,recordTime:2,userId:3,item_id:4,amount:5,shopRecord:6,channelId:7},GuildEntity:{id:1,name:2,iconId:3,chairmanId:4,viceChairmanId:5,guildPopulation:6,addUpAct:7,joinCon:8,joinLvl:9,lvl:10,notice:11,note:12,appliedMembers:13,numbersArr:14,lastExpelTime:15,ennobleData:16,guildCopyData:17,resetCount:18,resetTime:19,lastLgTime:20},GuildGroupEntity:{id:1,name:2,serverArr:3,lastRankData:4,lastRankTime:5,redisId:6},GuildPersonalEntity:{id:1,userId:2,guildId:3,position:4,viceTime:5,todayAct:6,noticeCount:7,exitGuildCount:8,lotteryCount:9,actLastTime:10,addUpAct:11,outMsg:12,appliedMsg:13,actData:14,guildAct:15,lastQuipGuildTime:16,ennoble:17},GuildWarRecordEntity:{id:1,recordData:2,recordTime:3,lastRankData:4},GuildWarSignEntity:{id:1,serverId:2,guildId:3,signTime:4,groupId:5,signUserId:6},HeartStuntEntity:{id:1,userId:2,stateArr:3,heartLvlArr:4},HeroEntity:{id:1,userId:2,tempId:3,quality:4,intensifyArr:5,starArr:6,gemArr:7,wingArr:8,expc:9,lvl:10,equipData:11,skillLvlArr:12,propArr:13,realmLvl:14,realmArr:15,sex:16,combat:17,refineArr:18,starTopArr:19,talismanAdorn:20,talismanData:21,talismanFg:22,wingSumLvl:23,gemSumLvl:24,realmSumLvl:25,fightSort:26,soulArr:27,wearSoulId:28},IncognitoEntity:{id:1,userId:2,openTime:3},LootConfigEntity:{id:1,startTime:2,endTime:3,lootTypeArr:4},LotteryEntity:{id:1,userId:2,treasureValue:3,treasureChestCount:4},MailEntity:{id:1,userId:2,type:3,fromName:4,title:5,content:6,replaceArgs:7,items:8,isPicked:9,isRead:10,delHours:11,delTime:12,expireTime:13,addTime:14,isDelete:15,taskId:16},ManagerEntity:{id:1,name:2,pwd:3,groupId:4},ManagerGroup:{id:1,name:2,rights:3},ManagerLog:{id:1,managerId:2,managerName:3,module:4,serverId:5,type:6,operation:7,ip:8,time:9,tid:10},MirrorRankViewEntity:{combatEff:1,isLocked:2,totalGain:3},NewFourDaysEntity:{id:1,userId:2,userName:3,iconId:4,userLvl:5,pkWinCount:6,combat:7,rankType:8,rankValue:9},NoticeEntity:{id:1,title:2,content:3,serverIdArr:4,isOpen:5,updateTime:6,iconType:7,noticeTime:8,startTime:9,endTime:10,sort:11,exData:12},PkOutBakEntity:{id:1,userId:2,enemyIds:3,exEnemyId:4,freshTime:5,pkValue:6,highPkValue:7,killValue:8,pkValueTime:9,enemyTypes:10,todayRefreshNum:11,todayRefreshTime:12,winCount:13,highWinCount:14,accWinCount:15},PkOutEntity:{id:1,userId:2,enemyIds:3,exEnemyId:4,freshTime:5,pkValue:6,highPkValue:7,killValue:8,pkValueTime:9,enemyTypes:10,todayRefreshNum:11,todayRefreshTime:12,winCount:13,highWinCount:14,accWinCount:15},ProtocolContentEntity:{id:1,content:2,isOpen:3},RechargeEntity:{id:1,userId:2,rechargeId:3,diamond:4,rechargeTime:5,effTime:6,channelId:7,transId:8,currency:9,ip:10,payMoney:11,userLvl:12},RechargeRankEntity:{id:1,userId:2,nickName:3,serverId:4,payNum:5,payCount:6,payRecord:7,buyGoldNum:8,shopRecord:9},RechargeRequestEntity:{id:1,accountId:2,userId:3,serverId:4,rechargeId:5,status:6,addTime:7,transId:8,goodsId:9,orderNo:10},RedEnvelopeEntity:{id:1,redType:2,userId:3,guildId:4,spItemId:5,diamond:6,personNum:7,wish:8,getData:9,addTime:10,expireTime:11,isDelete:12},RedEnvelopePersonalEntity:{id:1,userId:2,addUpServer:3,addUpGuild:4,addUpGet:5,sendCount:6,lastSendTime:7,getData:8,exData:9,exAddUpGet:10},RunwatEntity:{id:1,dateTime:2,newUser:3,active:4,nextDayLeft:5,weekLeft:6,runwat:7,payCount:8,newPay:9,ARPU:10,payRate:11,ARPPU:12,runwatNum:13,userNum:14},ServerInfoEntity:{id:1,name:2,mergerName:3,area:4,host:5,port:6,isNew:7,status:8,dbLink:9,sort:10,appId:11,serverId:12,indexId:13,isClose:14,closeExplain:15,serverDate:16,outLink:17},ServersGroupEntity:{id:1,type:2,name:3,serverArr:4,isDelete:5,"case":6},ShopEntity:{id:1,userId:2,type:3,items:4,lastTime:5,refreshCount:6,refreshCountResetTime:7},ShopRecordEntity:{id:1,userId:2,userLvl:3,userVip:4,costGold:5,shopType:6,costDiamond:7,buyItemId:8,buyAmount:9,buyTime:10},SysRedEnvelopeEntity:{id:1,userId:2,sendName:3,redType:4,guildId:5,spItemId:6,amount:7,viewAmount:8,personNum:9,wish:10,limitZone:11,addTime:12,isDeal:13},SystemMessageEntity:{id:1,serverId:2,message:3,type:4,color:5,size:6,status:7,times:8,interval:9,sendTime:10,createTime:11,lastUpdateTime:12},TaskEntity:{id:1,userId:2,dailyTasks:3,vitality:4,vitalityChests:5,refreshTime:6,tasks:7,tasksValue:8,doneTasks:9},TreasureEntity:{id:1,userId:2,treasureId:3,openTime:4,isOpen:5,items:6,isDelete:7},TreasureRecordEntity:{id:1,recordType:2,userId:3,guildName:4,userVip:5,userName:6,medalTitle:7,treasureId:8,items:9,recordDate:10},UserCouponEntity:{id:1,codeName:2,userId:3},UserEntity:{accountId:1,iconId:2,nickName:3,gold:4,diamond:5,id:6,giveDiamond:7,buyDiamond:8,lvl:9,expc:10,combat:11,vip:12,vipScore:13,strength:14,strengthReTime:15,signName:16,honor:17,bag:18,equipBag:19,equipBagBuyCount:20,honorData:21,blueDiamond:22,sign:23,activity:24,record:25,exData:26,counts:27,countsRefreshTime:28,lastUpdateTime:29,serverId:30,lastSkillTime:31,skillCd:32,isOpenPk:33,prestige:34,redPointData:35,robotId:36,createTime:37,sdkChannelId:38,serverIndexId:39,onlineLootData:40,isKing:41,rebirthLvl:42,rebirthExp:43,coffersPoints:44,todayCoffersPoints:45,medalTitle:46,medalData:47,genuineQi:48,propertyData:49,coffersKillNum:50,isOpenIn:51,infuseExpc:52,highPaTa:53},UserMirrorCombatViewEntity:{combatEff:1},UserRankEntity:{id:1,userId:2,userName:3,iconId:4,userLvl:5,blueDiamond:6,pkWinCount:7,combat:8,rankType:9,rankValue:10},UserSurveyEntity:{id:1,serverId:2,userId:3,userLvl:4,userVip:5,activityId:6,questionId:7,selectIndex:8},ExHeartStuntData:{heartStuntData:1,userData:2,isSucceed:3,genuineQiArr:4},ExDemonLotusData:{demonLotusData:1,userData:2,expSum:3,isSucceed:4,isWeek:5,isMonth:6,delBagItems:7,genuineQiArr:8},FightData:{isWin:1,star:2,vData:3,residueHp:4},BossData:{originHp:1,curHp:2,bossId:3,startTime:4,endTime:5,inspireHurt:6,inspireEndTime:7,inspireNum:8,myHurt:9,myRank:10,myGuildName:11,myKey:12,callUserName:13,callUserGuildName:14,lastExitTime:15,isOver:16,isFirstEnter:17,type:18,isRepeat:19,callUserId:20,callUserGuildId:21},ExBossData:{bossData:1,userData:2,bossEntity:3,delBagItems:4},ExTreasureBossData:{bossData:1,bagItem:2},ExBossEntity:{bossList:1,otherData:2,nowDate:3},BossHurtRank:{userId:1,rank:2,icon:3,userName:4,guildName:5,hurt:6,vip:7},BossResult:{isWin:1,totalHurt:2,myHurtRank:3,hurtGold:4,killTotalTime:5,firstHurtName:6,killUserName:7,bossId:8,items:9},BossSaveResult:{rank10:1,callUserId:2,guildUserIds:3,callGuildName:4,hurtDic:5,isWin:6,killTotalTime:7,firstHurtName:8,killUserName:9},BossResultData:{rank5:1,callUserName:2,callGuildName:3,firstHurtName:4,killUserName:5,myHurt:6,isWin:7},FightResult:{winStatus:1,gold:2,items:3,honor:4,expc:5,killValue:6,pkValue:7,prestige:8,curRank:9,changeRank:10,hasChangeRank:11,attackMember:12,beAttackMember:13,mPkColor:14,ePkColor:15,isRevenge:16,coffersPerson:17,coffersCommon:18,coffersStatus:19,coffersPoints:20,coffersHurt:21,guildWarPoints:22,guildWarStatus:23,updateUser:24,updatePkOut:25,updateArena:26,bagItems:27,equipBagItems:28,guildData:29,guildPersonalData:30,updateCoffers:31},ExCopyProgress:{copyProgress:1,userData:2,copyLoot:3,items:4,delBagItems:5,bagItems:6,equipBagItems:7,guildData:8,guildPersonalData:9,isWin:10,progress:11,damage:12,msg:13,wipeCount:14},ServerInfo:{id:1,area:2,name:3,host:4,port:5,isNew:6,status:7},LoginData:{sdkData:1,account:2,user:3,rechargeData:4,rank:5,offLineData:6,arenaData:7,copyProgressList:8,heroList:9,pkOut:10,lottery:11,task:12,lootTypeArr:13},SDKData:{id:1,name:2,pic:3,sex:4,age:5},ExAccount:{account:1,loginKey:2},ExGuildData:{userData:1,guildData:2,guildPersonalData:3,chairmanName:4,rank:5,isGuild:6,isJoin:7,isAtherGuild:8,isMembersMax:9,dissolveId:10,items:11,bagItems:12,equipBagItems:13,isOpenBoss:14,isOpenGuildWar:15,cfgData:16},ExRedEnvelopeData:{userData:1,guildPersonalData:2,redEnvelopeData:3,redEnvelopePersonalData:4,isGet:5,nameObj:6},ExUserData:{userData:1,heroData:2,lotteryData:3,taskData:4,gold:5,expc:6,eventData:7,items:8,arenaData:9,shopData:10,isFriend:11,cheerCombat:12,friendCount:13,residueCount:14,pickAllItemsArr:15,pickAllItemsList:16,buyGoldResultArr:17,copyProgressData:18,gainArr:19,treasureValue:20,cosTreValue:21,vitality:22,offlineArr:23,isMail:24,isFull:25,bagItems:26,delBagItems:27,equipBagItems:28,delEquipBagArr:29,wingExp:30,isWingCrit:31,shopIdObj:32,showMsgArr:33,rebirthExp:34,strengthArr:35,genuineQi:36,wingCritNum:37,isGetSkill:38,baptizeValue:39},ExCrystalData:{crystalData:1,beyondPer:2},ExWarPrintedData:{medalData:1,medalTitle:2,isUpdata:3,delBagItems:4},ExUserRankData:{userRankList:1,userRankData:2,userRank:3,guildName:4,value:5},HeroChangeRecord:{type:1,fightType:2,enemyName:3,heroData:4,time:5,gold:6,isWin:7},RechargeData:{countMap:1,cardTimeMap:2},ExActivity:{activity:1,activityItems:2,todayRecharge:3,allRecharge:4,todayCost:5,allCost:6,isNeedOp:7,days:8,bgType:9,leftTime:10,maxPaymoney:11,luckValue:12},ActivityItem:{items:1,diamond:2,rmb:3,userLvl:4,limitNum:5,discount:6,vipLvl:7,randomHero:8,wordSet:9,vPlan:10},ExActivityData:{userData:1,bagItems:2,equipBagItems:3,lotteryItemsArr:4,mysterShopArr:5,luckyTalosItemArr:6,exItem:7,getGold:8},SdkVipData:{isVip:1,vipLevel:2,score:3},Rank:{rank:1,name:2,iconId:3,lvl:4,combat:5,killValue:6,vip:7,userId:8,pkValue:9,guildName:10},PkOutUserData:{userId:1,name:2,iconId:3,killValue:4,gold:5,expc:6,lvl:7,pkValue:8,vip:9,combat:10,guildName:11,isTreasure:12},ExPkOut:{pkOutData:1,heroList:2,enemyList:3,otherDataList:4,userData:5,hasNewDeal:6,fightData:7,guildData:8,guildPersonalData:9},ExArena:{arenaData:1,heroList:2,otherDataList:3,fightData:4,userData:5},PKUserData:{userId:1,name:2,iconId:3,combat:4,lvl:5,rank:6,vip:7,guildName:8},ChatData:{uniqueId:1,type:2,sysArgs:3,userArgs:4,guildArgs:5,subType:6},AllChatData:{worldChat:1,guildChat:2,isOri:3,guildId:4,userData:5,delBagItems:6},AsyncData:{chat:1,redEnvelope:2,task:3,pkDeal:4,rankPkDeal:5,kefu:6,sysMsg:7,bePkKill:8,inspire:9,isBossOpen:10,buffArr:11,guildChat:12,isGuildChange:13,guildWarIsOpen:14},AsyncData2:{lastUpdateTime:1,lootTypeArr:2},ExTask:{taskData:1,updateId:2},HandleRecharge:{userData:1,addDiamond:2,isFinish:3,rechargeId:4},GuildMember:{lvl:1,nickName:2,combat:3,guildAct:4,position:5,ennoble:6,lastUpdateTime:7,iconId:8,vip:9,userId:10,offlineHour:11},BonusInfo:{shareInfo:1,relations:2},BonusShareData:{isFirst:1,relationCount:2,amountDraw:3,balance:4},BonusRelationData:{id:1,userId:2,nickName:3,level:4,vip:5,amount:6},BonusShareUrl:{url:1,gifted:2},BonusDrawResult:{added:1,total:2},FiveDaysTaret:{day:1,items:2},ExFiveDaysTargetData:{value:1,rank:2},ShowHeroData:{heroList:1,otherDataList:2,fightData:3},ChallengeCupData:{isOpen:1,userId:2,nickName:3,iconId:4,lvl:5,vip:6,combat:7,guildName:8,guildLevel:9,challengerUserId:10,leftTime:11,nextChallengeTime:12,activityLeftTime:13,HeroDisplay:14,upCount:15,downCount:16,myOpNum:17},ChampionDurationTimeRank:{rank:1,name:2,iconId:3,lvl:4,durationTime:5,userId:6,vip:7},ExChallengeCupFight:{errCode:1,heroList:2,otherDataList:3,fightData:4,userData:5},King:{myGuildId:1,myGuildName:2,kingGuildId:3,kingGuildName:4,kingGuildLvl:5,kingId:6,kingName:7,kingVip:8,kingLvl:9,kingHeroDisplay:10,beWorshipNum:11,beWorshipCount:12,buffOpenNum:13,buffOpenTime:14,buffEndTime:15},ExKing:{king:1,userData:2,bagItems:3},Rebirth:{userData:1,heroList:2},Opening:{userData:1,diffExp:2},ExCoffers:{coffers:1,userData:2,heroList:3,otherDataList:4,fightData:5,addBuildValue:6,addGold:7,addBuffExpc:8,delBagItems:9,coffersLvl:10,status:11},CoffersRecord:{isWin:1,time:2,attackName:3,serverName:4,door:5,defeseName:6,recource:7,points:8},CofferUser:{userId:1,serverId:2,door:3,rankType:4,icon:5,lvl:6,vip:7,name:8,combat:9,isLoot:10,isBreak:11,medalTitle:12,breakReplaySeconds:13},ExDefenceData:{cofferUserArr:1,hpAdd:2,attackAdd:3,personResource:4,coffersResource:5,lootRate:6,breakNum:7,isCanLoot:8,todayLootNum:9,coffersLvl:10,curResource:11,serverName:12,serverId:13},CoffersServer:{serverName:1,serverId:2,resource:3,isLootArr:4,isBreakArr:5},WanbaGift:{code:1,message:2,userData:3,getGold:4,getDiamond:5,bagItems:6,equipBagItems:7},MyGuildWarData:{groupId:1,guildReNum:2,guildRank:3,doorLives:4,points:5,nextFightTime:6,inspireEndTime:7,warEndTime:8,guildTotal:9,isDefence:10,myGuildRefreshId:11,serverId:12},ExMyGuildWarData:{userData:1,myGuildWarData:2},GuildWarSyncData:{myGuildWarData:1,fightRecordArr:2,guildList:3,attackData:4,defenceData:5},GuildWarFightRecord:{id:1,type:2,attackData:3,beAttackData:4,time:5},GuildServer:{serverName:1,serverId:2,guildId:3,guildName:4,guildLvl:5,doorLives:6,points:7,progress:8,maxPoints:9,lastLootTime:10},GuildWarData:{doorList:1,guildId:2,guildName:3,cd:4,serverId:5},GuildFightData:{heroList:1,otherDataList:2,fightData:3,directWin:4,myGuildWarData:5,isBreak:6,getPoints:7},GuildWarDoor:{door:1,hp:2,userId:3,userName:4,userIcon:5,lastUserId:6,lastUserName:7,lastUserIcon:8,isBreak:9,lastDownTime:10},GuildWarAllRank:{guildArr:1,chairArr:2,userArr:3},GuildWarRank:{rank:1,guildId:2,guildName:3,points:4,serverId:5},GuildWarUserRank:{rank:1,userId:2,userName:3,vip:4,iconId:5,guildName:6,points:7,serverId:8},GuildWarDefenceRecord:{isWin:1,time:2,door:3,attackServerId:4,attackServerName:5,attackUserName:6,attackGuildName:7,defenceUserName:8,hp:9,isDirect:10},GuildWarAttackRecord:{aServerId:1,aServerName:2,aUserName:3,aGuildName:4,dServerId:5,dServerName:6,dUserName:7,dGuildName:8,isBreak:9,door:10,time:11},Incognito:{userData:1,openTime:2},TreasureInfo:{id:1,itemId:2,openTime:3,status:4,items:5},AccountServer:{myServerArr:1,lastServer:2,serverArr:3},ServerNameInfo:{serverId:1,serverName:2},ExPkOutInfo:{openTime:1,treasureInfo:2},GuildWarServerSyncData:{guildWarObj:1,syncId:2},ComposeInfo:{delBagItem:1,treasureInfo:2},SyncGuildWarData:{serverName:1,serverId:2,serverHost:3,serverPort:4,guildId:5,guildName:6,guildLvl:7,doorLives:8,points:9,progress:10,groupId:11,doorData:12,rank:13,chairmanData:14,lastLootTime:15,fightRecordArr:16,refreshId:17,maxPoints:18},SyncGuildWarUser:{userId:1,userName:2,guildId:3,guildName:4,points:5,vip:6,iconId:7,lastLootTime:8,rank:9,groupId:10,nextFightTime:11,inspireEndTime:12,guildPosition:13,nextUpTime:14,serverId:15},SignData:{signGroupId:1,lastGroupId:2,lastGuildRank:3,lastUserRank:4,isPrize:5},ExpeditionData:{expData:1,expHeroData:2,upUserData:3,finishData:4,heroList:5,otherDataList:6,fightData:7,finishLvl:8}}}(gc||(gc={}));var gc;!function(t){t.id_c_game={initCfg:1,monsterUpMult:2,skillRate:3,copyVipChest:4,fuckWord:5,strengthCfg:6,friends:7,goldBuySet:10,pkOutCfg:11,pkOutYellowLoot:13,pkOutRedLoot:14,pkOutHonor:15,pkOutLootGold:16,wingCrit:17,equipGrade:18,pkOutLootLimit:19,smeltEquip:20,smeltIntensify:21,gemInitial:22,gemLimit:27,patchSignCon:23,killValueMax:24,refreshTime:25,copyNeedItem:26,combatMult:28,copyIdSection:29,lotteryCfg:30,lotteryCostCfg:31,treasureChestCfg:32,arenaCfg:33,arenaRankCfg:34,shopCfg:35,lotteryShowCfg:37,chatCfg:38,equipBagCfg:39,vitalityCfg:41,honorStartCfg1:42,honorStartCfg2:43,dailyTasksCfg:44,offlineCfg:45,parRingCfg:46,guide:47,contactUs:48,openCfg:49,otherReward:50,tuLong:51,pkValueRange:52,pkCombatRange:53,pkCfg1:56,killChallengeCfg:57,guideCfg:58,battleSet:59,bossLootRate:60,revengeGolds:61,smeltGoldCfg:62,smeltDiamondCfg:63,smeltGoldLvlCfg:64,guildSet:65,gemLvlLimit:66,bossTesseraReplace:67,targetRank:69,guildAct:70,lootLimit:71,rebirth:72,challengeCupCfg:73,lowOraEquipCfg:74,mysterShopCfg:75,worldBossCfg:76,equipMinRandomCfg:77,inheritedEquip:79,redEnvelopeCfg:80,king:81,weekMonthCard:82,blueDiamond:83,demonLotusCfg:84,serverPk:85,coffers:86,customizationCfg:87,coffers2:88,equipRefineCfg:89,newBossCfg:90,heartStuntCfg:92,yellowDiamond:93,fightProtect:94,copyVip:95,coffers3:96,wxlinkCfg:97,guildCopyCfg:98,fourRole:99,towerCopy:100,guildWar:101,littlHorn:102,treasure:103,trumpCfg:104,vPlanCfg:105,skipFightCfg:106,newFourRank:107,newFourNeedValue:108,buyLingyunCfg:109,pkLoot:110,lotteryWillFall:111,talosWillFall:113},t.id_c_msgCode={inputRoleName:1,sensitiveInRoleName:2,roleNameUsed:3,loginNoUser:4,loginNotNull:5,accountLengthNotCorrect:6,pwdLengthNotCorrect:7,loginFalse:8,regHasUser:9,pwdNotSame:10,regFalse:11,cRoleFalse:12,getRoleDataFalse:13,noLogin:14,regSucc:15,roleNameOutLenght:16,loginWordWrong:17,tooFrequently:18,buyLimitNow:19,accountLockout:20,deviceLockout:21,loggedInOtherDevice:22,outGame:23,connectFail:24,noOpenNow:25,cantGetNoCharge:26,cantGetNoDays:27,ifBuyLimitedItem:28,totalChargeNotEnough:29,totalChargeNotEnough1:30,totalCostNotEnough:31,engCostNotEnough:32,coinCostNotEnough:33,noCdKey:34,cdKeyRedeemed:35,alreadyGetcdKey:36,redeemRewardMail:37,cdKeyNull:38,activitiesEnd:39,getTomorrow:40,noHeroReward:41,noEventNow:42,checkYourNet:43,collectSuccess:44,collectRewardMail:45,collectWrong:46,noHonor:47,refreshShop:48,NoLvlOpen:49,cantSpeedUp:50,cantSkip:51,heroLvMax:52,noGoldsToUp:53,ifBuy:54,vipNotEnough:55,lvNotEnough:56,ifHeroUp:57,noMaterial:58,noGolds:59,buyGolds:60,noDiamond:61,onGetItems:62,copyNoPass:63,vipLess:64,cantUseMax:65,noCopyTimes:66,buyCopyTimes:67,noCopyItem:68,buyCopyItem:69,buyTimesMax:70,ifPatch:71,ifResetTime:72,cantRebirth:73,copyFightNow:74,findRival:75,findRival100:76,noReputation:77,noArenaTimes:78,buyArenaTimes:79,cleanArenaTime:80,userFighting:81,rankChanged:82,noWord:83,wordTooLong:84,wordIllegal:85,wordTooFast:86,ifBuyBag:87,ifBuyRole:88,noEquipNow:89,noCopyTimes1:90,buyCopyTimes1:91,bagMaxMail:92,bagMax:93,noRoleLvl:94,bagMaxCantGet:95,rewardMail:96,ifBuyAll:97,rewardInMail:98,nameToRedIfGo:99,ifClearPKPoint:100,noPKPoint:101,pkNoOpen:102,noLvlAuto:103,autoOpen:104,autoClose:105,goalNotGet:106,ifQuitGuild:107,enterGuildCd:108,enterOriginalGuildCd:109,enterGuildTimesMax:110,cantGdisband:111,ifGdisband:112,guildNameIsNull:113,guildNameTooLong:114,guildNameIllegal:115,ifCreateGuild:116,guildIdIsNull:117,guildIdIsExist:118,guildMembersMax:119,noPermission:120,worshippedTimesMax:121,worshipTimesMax:122,ifRetiringGuildMaster:123,noReceivedReward:124,fireMembersMax:125,ifFireMember:126,positionsMax:127,quitedTheGuild:128,ifPromote:129,ifRelieve:130,relieveCd:131,MembersMax:132,otherGuildEntered:133,noticeTooLong:134,noticeMax:135,noMailTitle:136,noMailBody:137,MailTitleIllegal:138,MailBodyIllegal:139,MailTitleTooLong:140,MailBodyTooLong:141,applicationMax:142,guildNameSame:143,permissionRelieved:144,enterGuildNow:145,waitForApprove:146,ifResrtCopy:147,noGuildActivePoint:148,rechargeSucceed:149,noGuildLevel:150,outGuild:151,noGuildLv:152,noTreasure:153,noGuildList:154,noPlayerGuildList:155,ifGquit:156,cantEnterGuildCd:157,someoneHoldArena:158,eventEnded:159,userBeInFignting:160,userChangeIfGoOn:161,noLvlgetKing:162,userBeInKing:163,ifSmeltHeirloom:164,eventNoStart:165,novLvAutoFight:166,inspireAdd:167,challengeBossCd:168,rewardTime:169,noLvlchallengeBoss:170,guildBossEscape:171,guildBossDead:172,touristForbidGuild:173,touristForbidTalk:174,noLvlToTalk:175,timeOutCantCall:176,noExperience:177,noBuyPrimaryRebirthTimes:178,noBuyMidRebirthTimes:179,noBuyAdvancedRebirthTimes:180,reincarnationOpen:181,noPosition:182,noMemberLv:183,notChooseLv:184,noFrequency:185,noIntegral:186,ifOpenBuff:187,noBuffTimes:188,packetMin20:189,packetMaxToday:190,packetSuccess:191,kingCome:192,noKingNow:193,noGuild:194,notOpen:195,actOver:196,battleActive:197,alreadyOver:198,banish:199,gatesBroken:200,noBattlePoint:201,gatesRobed:202,ifRobeGates:203,gatesBrokenByOthers:204,peaceTimeCantRobe:205,noLvlUse:206,outofGuild:207,mainProperty:208,fullProperty:209,choseCareer:210,noItemName:211,fuckword:212,nameToolong:213,choseProperty:214,makeItem:215,yourServerNoOpen:216,makeLvlBigger:217,ifSmeltCustom:218,notEnoughFeather:219,wingLevelRequire:220,noMedal:221,noMedalActivated:222,bossNegative:223,reinforceRequire:224,noMoreBoss:225,formulaNoOpen:226,ifLearnFormula:227,noGas:228,onlyoneAutoFight:229,worldBossEscape:230,noRightarena:231,gasNoOpen:232,vipRequire:233,vipNotimes:234,noGuardDown:235,disAgree:236,noMoreRob:237,outGuildBoss:238,guardExist:239,noCard:240,noBoom:241,buyTime:242,noReset:243,atkReset:244,noticeAutoBuyLittleHorn:245,noticeAutoBuyLittleHornVipNeed:246,noGuard:247,beGuard:248,careerNotOpen:249,guildLevelRequire:250,notReportTime:251,notGuildLeader:252,fightNotRight:253,memberFight:254,haveGuard:255,beAttacked:256,buyInspire:257,buyManyCD:258,guardDown:259,buyPerfusion:260,openNotice:261,noSnatch:262,noGuildOut:263,noGuildDisband:264,noGuildTransfer:265,noGuildExpel:266,noInspire:267,noLevelDown:268,towerNotOpen:269,resetCopy:270,defendCD:271,nowAttack:272,notPerfect:273,noticket:274,reGetMatch:275,vipLock:276,openMagicLV:277,haveNoGuard:278,noMagic:279,noSll:280,noYgy:281,reRecast:282,noSynthesis:283,haveTalismen:284,lowLevelTalismen:285,lowStarTailsmen:286,noCareer:287,talismanNotOpen:288,noPrivilege:289,giveUpRecover:290,openRole4LvNotEnough:291,noBossTime:292,reSummonBoss:293,reSummonLock:294,noLvlSummonBoss:295,noLvlActivity:296,changeheartStunt:297,cantBusMax:298,noRole:299,vipItemRequire:300,functionOpen:301,vipCall:302,sysNotice:900,offlineGain:901,firstEnterGame:902,wxFollow:903,ifSellItem:904,ifSellItem2:905,ifSellItem3:906,wordBeBend:1e3,errIfaceCode:11e3,vPlan:907,vPlan2:909,majongLuckyPoint:910,majongLuckyPointMax:911,majongLuckyBonusTips:912},t.id_c_open={openRole2:1,openRole3:2,strength:3,pkOut:4,wing:5,star:6,stone:7,equipCopy:8,arena:9,bossCopy:10,reamCopy:11,stoneShop:12,ream:13,shop:14,autoFight:15,rebirth:16,challengeCup:17,guild:18,redEnvelope:19,worldboss:20,expBox:21,serverPk:22,coffers:23,heartStunt1:27,heartStunt2:28,heartStunt3:29,vipheartStunt2:30,vipheartStunt3:31,paTa:32,openRole4:33,openTrump:34,fightList:36,buzhen:37}}(gc||(gc={}));var gc;!function(t){t.iface={a_activity_buyMysterShop:"a.ac.a",a_activity_buyMysterShop_args:{activityId:"_0",index:"_1"},a_activity_getList:"a.ac.e",a_activity_receive:"a.ac.f",a_activity_receive_args:{activityId:"_0",index:"_1"},a_activity_getIsNeedOperate:"a.ac.h",a_activity_patchSign:"a.ac.i",a_activity_patchSign_args:{activityId:"_0"},a_activity_report:"a.ac.j",a_activity_report_args:{activityId:"_0",report:"_1"},a_arena_getInfo:"a.ar.a",a_arena_resetFightRanks:"a.ar.d",a_arena_fightStart:"a.ar.h1",a_arena_fightStart_args:{rank:"_0"},a_arena_fightEnd:"a.ar.h2",a_arena_fightEnd_args:{rank:"_0",isWin:"_1",fightData:"_2"},a_arena_getFightUserList:"a.ar.l",a_arena_buyPKNum:"a.ar.m",a_arena_getRecordList:"a.ar.n",a_arena_getRecordList_args:{index:"_0",count:"_1"},a_arena_setRead:"a.ar.o",a_arena_pickRankAward:"a.ar.p",a_arena_refreshCD:"a.ar.q",a_arena_getRankList:"a.ar.r",a_arena_getRefreshRemainTime:"a.ar.rt",a_bonus_getInfo:"a.bs.a",a_bonus_getInfo_args:{lastId:"_0"},a_bonus_breakRelation:"a.bs.b",a_bonus_breakRelation_args:{inviteeUserId:"_0"},a_bonus_share:"a.bs.c",a_bonus_share_args:{serverIndexId:"_0"},a_bonus_draw:"a.bs.d",a_bonus_sendShareGift:"a.bs.e",a_boss_getGuildBossList:"a.bo.a",a_boss_getWorldBossList:"a.bo.a1",a_boss_openBoss:"a.bo.b1",a_boss_openBoss_args:{bossId:"_0",isLock:"_1"},a_boss_enter:"a.bo.b",a_boss_enter_args:{bossId:"_0"},a_boss_startFight:"a.bo.c",a_boss_startFight_args:{bossId:"_0"},a_boss_hurt:"a.bo.d",a_boss_hurt_args:{bossId:"_0",hurtDic:"_1",isEnd:"_2",mData:"_3",hurtArr:"_4"},a_boss_exitFight:"a.bo.e",a_boss_exitFight_args:{bossId:"_0"},a_boss_clearFightCd:"a.bo.e1",a_boss_inspire:"a.bo.f",a_boss_inspire_args:{bossId:"_0"},a_boss_getInspireRecordArr:"a.bo.g",a_boss_getInspireRecordArr_args:{bossId:"_0"},a_boss_syncInspire:"a.bo.h",a_boss_syncInspire_args:{bossId:"_0"},a_boss_getHurtRankList:"a.bo.i",a_boss_getHurtRankList_args:{bossId:"_0"},a_boss_getFirstHurtRank:"a.bo.i1",a_boss_getFirstHurtRank_args:{bossId:"_0"},a_boss_getBossResult:"a.bo.j",a_boss_getBossResult_args:{bossId:"_0",originBossId:"_1"},a_boss_getResultData:"a.bo.j1",a_boss_getResultData_args:{originBossId:"_0"},a_demonLotus_getInfo:"a.de.a",a_demonLotus_upLotus:"a.de.b",a_demonLotus_getRevenue:"a.de.c",a_demonLotus_opening:"a.de.d",a_demonLotus_lotusAdvance:"a.de.e",a_demonLotus_treasureTrain:"a.de.f",a_mail_getList:"a.em.a",a_mail_pickItems:"a.em.b",a_mail_pickItems_args:{mailId:"_0"},a_mail_pickAllItems:"a.em.d",a_mail_setRead:"a.em.c",a_mail_setRead_args:{mailId:"_0"},a_mail_getIsNeedOperate:"a.em.e",a_mail_getIsNeedOperate_args:{mailId:"_0"},a_event_eventBuy:"a.ev.a",a_event_eventBuy_args:{eventId:"_0"},a_equip_changeEquip:"a.eq.a",a_equip_changeEquip_args:{tempId:"_0",index:"_1",equipId:"_2"},a_equip_inheritedEquip:"a.eq.b",a_equip_inheritedEquip_args:{equipId:"_0",tempId:"_1"},a_equip_customization:"a.eq.c",a_equip_customization_args:{certificate:"_0",job:"_1",name:"_2",lvl:"_3",abilityIndex:"_4",equipType:"_5"},a_equip_upCustomization:"a.eq.d",a_equip_upCustomization_args:{equipId:"_0"},a_equip_updateEquipItemLockStatus:"a.eq.e",a_equip_updateEquipItemLockStatus_args:{equipId:"_0",isLocked:"_1"},a_equip_sellEquipItems:"a.eq.f",a_equip_sellEquipItems_args:{equipIdArr:"_0"},a_user_getInfo:"a.u.a",a_user_changeName:"a.u.b",a_user_changeName_args:{name:"_0",heroTempId:"_1"},a_user_upLvl:"a.u.c",a_user_syncData:"a.u.f",a_user_syncData_args:{sendData:"_0"},a_user_syncData2:"a.u.f1",a_user_getBagChest:"a.u.g",a_user_getBagChest_args:{chestId:"_0",count:"_1"},a_user_buyGold:"a.u.d",a_user_buyLingyun:"a.u.d1",a_user_getRedPoint:"a.u.h",a_user_updateGuide:"a.u.i",a_user_updateGuide_args:{guideId:"_0"},a_user_getWinRecord:"a.u.j",a_user_getLoseRecord:"a.u.k",a_user_buyToUpLvl:"a.u.m",a_user_saveDeskSuccess:"a.u.o",a_user_saveDeskSuccess_args:{type:"_0"},a_user_setHeroEmbattle:"a.u.p",a_user_setHeroEmbattle_args:{heroEmbattle:"_0"},a_user_buyBagGrid:"a.u.q",a_user_updateCombat:"a.u.q1",a_user_setAutoFight:"a.u.q2",a_user_setAutoFight_args:{isAuto:"_0"},a_user_setTimeError:"a.u.q3",a_user_setTimeError_args:{errorNum:"_0"},a_user_setTodayRankWin:"a.u.q4",a_user_setTodayRankWin_args:{eid:"_0"},a_user_getWarPrintedList:"a.u.q5",a_user_warPrintedStrength:"a.u.q6",a_user_warPrintedStrength_args:{warPrintedId:"_0"},a_user_setMedalTitle:"a.u.q7",a_user_setMedalTitle_args:{warPrintedId:"_0"},a_user_getGenuineQi:"a.u.q8",a_user_activeMedal:"a.u.q9",a_user_activeMedal_args:{warPrintedId:"_0"},a_user_getBindPhoneUrl:"a.u.r",a_user_getWanbagift:"a.u.s",a_user_getWanbagift_args:{os:"_0",giftId:"_1"},a_user_updateSetting:"a.u.t",a_user_updateSetting_args:{catNoVipChat:"_0",autoBuyLittleHorn:"_1"},a_user_updateItems4Bag:"a.u.u",a_user_updateItems4Bag_args:{itemId:"_0"},a_friend_getInfo:"a.f.a",a_friend_requestFriend:"a.f.b",a_friend_requestFriend_args:{requestedId:"_0"},a_friend_disposeFriendRequest:"a.f.c",a_friend_disposeFriendRequest_args:{requestId:"_0",isTake:"_1"},a_friend_eventCheer:"a.f.d",a_friend_getRequestInfo:"a.f.e",a_fight_pickLoot:"a.fi.a",a_fight_pickLoot_args:{copyId:"_0",uidArr:"_1",fightData:"_2"},a_fight_revive:"a.fi.b",a_fight_getAndInitNextLoot:"a.fi.c",a_fight_getAndInitNextLoot_args:{copyId:"_0",isBoss:"_1",lvl:"_2"},a_fiveDaysTarget_getInfo:"a.ft.e",a_fiveDaysTarget_getInfo1:"a.ft.a",a_guild_getInfo:"a.g.a",a_guild_establishGuild:"a.g.b",a_guild_establishGuild_args:{name:"_0"},a_guild_seekGuild:"a.g.c",a_guild_seekGuild_args:{guildId:"_0"},a_guild_joinGuild:"a.g.d",a_guild_joinGuild_args:{guildId:"_0"},a_guild_getAppliedMembers:"a.g.e",a_guild_appliedMembersSet:"a.g.f",a_guild_appliedMembersSet_args:{tUserId:"_0",isConsent:"_1"},a_guild_guildSetting:"a.g.g",a_guild_guildSetting_args:{joinCon:"_0",joinLvl:"_1"},a_guild_exitGuild:"a.g.h",a_guild_setNotice:"a.g.i",a_guild_setNotice_args:{notice:"_0"},a_guild_lottery:"a.g.j",a_guild_lottery_args:{count:"_0"},a_guild_setEnnoble:"a.g.k",a_guild_setEnnoble_args:{targetUserId:"_0",ennobleType:"_1"},a_guildPerson_pickAct:"a.gp.a",a_guildPerson_pickAct_args:{actId:"_0"},a_guildPerson_getMemberList:"a.gp.b",a_guildPerson_opMember:"a.gp.c",a_guildPerson_opMember_args:{targetUserId:"_0",op:"_1"},a_guildWar_getInfo:"a.gw.a",a_guildWar_getGuildList:"a.gw.a1",a_guildWar_getGuildList_args:{guildId:"_0"},a_guildWar_getWarAttackData:"a.gw.b",a_guildWar_getWarAttackData_args:{serverId:"_0",guildId:"_1"},a_guildWar_getWarDefenceData:"a.gw.c",a_guildWar_getWarDefenceData_args:{guildId:"_0"},a_guildWar_getDefenceRecordList:"a.gw.d",a_guildWar_getAttackRecordList:"a.gw.e",a_guildWar_getGuildWarAllRank:"a.gw.f",a_guildWar_getLastRankList:"a.gw.f1",a_guildWar_getLastRankList_args:{groupId:"_0"},a_guildWar_getSignUpData:"a.gw.g",a_guildWar_getSignUpData_args:{guildId:"_0"},a_guildWar_signUp:"a.gw.g1",a_guildWar_signUp_args:{groupId:"_0"},a_guildWar_fightStartDoor:"a.gw.h",a_guildWar_fightStartDoor_args:{serverId:"_0",guildId:"_1",door:"_2"},a_guildWar_fightEndDoor:"a.gw.h1",a_guildWar_fightEndDoor_args:{serverId:"_0",guildId:"_1",door:"_2",isWin:"_3"},a_guildWar_upDoor:"a.gw.i",a_guildWar_upDoor_args:{door:"_0"},a_guildWar_downDoor:"a.gw.i1",a_guildWar_downDoor_args:{door:"_0"},a_guildWar_enter:"a.gw.j",a_guildWar_clearCd:"a.gw.j1",a_guildWar_inspire:"a.gw.j2",a_guildWar_syncData:"a.gw.k",a_guildWar_syncData_args:{sceneType:"_0",attackData:"_1"},a_honor_getInfo:"a.h.a",a_honor_getAward:"a.h.b",a_honor_getAward_args:{honorId:"_0"},a_honor_bugAlter:"a.h.c",a_heartStunt_getInfo:"a.hs.a",a_heartStunt_choMenCulMethods:"a.hs.b",a_heartStunt_choMenCulMethods_args:{index:"_0",heartStuntId:"_1"},a_heartStunt_stuMenCulMethods:"a.hs.c",a_heartStunt_stuMenCulMethods_args:{index:"_0"},a_heartStunt_chaMenCulMethods:"a.hs.d",a_heartStunt_chaMenCulMethods_args:{index:"_0",heartStuntId:"_1"},a_hero_callHero:"a.he.a",a_hero_callHero_args:{tempId:"_0",sex:"_1"},a_hero_upSkill:"a.he.b",a_hero_upSkill_args:{tempId:"_0",index:"_1"},a_hero_clearSkillCd:"a.he.c",a_hero_wearRune:"a.he.d",a_hero_wearRune_args:{tempId:"_0",index:"_1"},a_hero_upRealm:"a.he.e",a_hero_upRealm_args:{tempId:"_0"},a_hero_strength:"a.he.f",a_hero_strength_args:{tempId:"_0",index:"_1"},a_hero_equipRefine:"a.he.f1",a_hero_equipRefine_args:{tempId:"_0",index:"_1"},a_hero_upStar:"a.he.g",a_hero_upStar_args:{tempId:"_0",index:"_1"},a_hero_starTop:"a.he.g1",a_hero_starTop_args:{tempId:"_0",index:"_1"},a_hero_upGem:"a.he.h",a_hero_upGem_args:{tempId:"_0",index:"_1"},a_hero_wingFos:"a.he.z",a_hero_wingFos_args:{tempId:"_0",fosType:"_1"},a_hero_wingStrength:"a.he.z1",a_hero_wingStrength_args:{tempId:"_0",part:"_1",isReplace:"_2"},a_hero_wingFos2Top:"a.he.z2",a_hero_wingFos2Top_args:{tempId:"_0",fosType:"_1",isUseDiamond:"_2"},a_hero_upWing:"a.he.k",a_hero_upWing_args:{tempId:"_0"},a_hero_wingActivate:"a.he.l",a_hero_wingActivate_args:{tempId:"_0"},a_hero_calPropAndCombat:"a.he.m",a_hero_getMainHeroDisplay:"a.he.n",a_hero_getMainHeroDisplay_args:{userId:"_0"},a_hero_getHeroDisplayByTempId:"a.he.o",a_hero_getHeroDisplayByTempId_args:{userId:"_0",tempId:"_1"},a_hero_getShowHeroData:"a.he.o1",a_hero_getShowHeroData_args:{userId:"_0"},a_hero_wearAllRune:"a.he.p",a_hero_wearAllRune_args:{tempId:"_0"},a_hero_autoInfuseSwitch:"a.he.q",a_hero_autoInfuseSwitch_args:{isOpenIn:"_0"},a_hero_extraInfuse:"a.he.q1",a_hero_extraInfuse_args:{type:"_0"},a_hero_saveFightList:"a.he.q2",a_hero_saveFightList_args:{fightArr:"_0"},a_lottery_lottery:"a.l.a",a_lottery_lottery_args:{type:"_0",count:"_1"},a_lottery_getTreasureChest:"a.l.b",a_lottery_getInfo:"a.l.c",a_task_getInfo:"a.t.a",a_task_taskAward:"a.t.b",a_task_taskAward_args:{taskId:"_0"},a_task_getVitalityChest:"a.t.c",a_task_getVitalityChest_args:{index:"_0"},a_pk_buyPKNum:"a.p.a",a_pk_getPKUserList:"a.p.b",a_pk_getPKUserData:"a.p.c",a_pk_getPKUserData_args:{userId:"_0"},a_pk_fight:"a.p.d",a_pk_fight_args:{enemyId:"_0",isNPC:"_1",fightType:"_2"},a_pk_getEnemyList:"a.p.e",a_pk_getUserRanks:"a.p.f",a_pk_getRank:"a.p.g",a_pk_changeSign:"a.p.h",a_pk_changeSign_args:{sign:"_0"},a_pk_setRead:"a.p.i",a_pk_skip:"a.p.j",a_pk_pickRankAward:"a.p.k",a_pk_getEnemyRecord:"a.p.l",a_pk_getEnemyRecord_args:{enemyId:"_0"},a_pk_getList:"a.p.m",a_pkOut_open:"a.po.a",a_pkOut_getEnemyList:"a.po.b",a_pkOut_getRevengeEnemyList:"a.po.b1",a_pkOut_refreshEnemy:"a.po.c",a_pkOut_start:"a.po.d",a_pkOut_start_args:{enemyId:"_0",fightType:"_1",isRevenge:"_2"},a_pkOut_end:"a.po.e",a_pkOut_end_args:{isWin:"_0",enemyId:"_1",fightData:"_2",fightType:"_3",isRevenge:"_4"},a_pkOut_getRankList:"a.po.f",a_pkOut_getMyRank:"a.po.g",a_pkOut_getPkRecordList:"a.po.h",a_pkOut_getRankPkRecordList:"a.po.h1",a_pkOut_setPkRecordRead:"a.po.i",a_pkOut_dealRecord:"a.po.j",a_pkOut_dealRecord_args:{fightType:"_0"},a_pkOut_clearPkValue:"a.po.k",a_pkOut_resetBePkKill:"a.po.l",a_pkOut_incognito:"a.po.m",a_pkOut_getTreasurePkRecordList:"a.po.n",a_shop_getInfo:"a.s.a",a_shop_getInfo_args:{type:"_0"},a_shop_refreshExShop:"a.s.b",a_shop_refreshExShop_args:{type:"_0",lvlRefresh:"_1"},a_shop_buy:"a.s.c",a_shop_buy_args:{index:"_0",type:"_1",num:"_2"},a_shop_buyAll:"a.s.d",a_shop_buyAll_args:{type:"_0"},a_copy_getInfo:"a.c.a",a_copy_getInfo_args:{type:"_0"},a_copy_buyCopyCount:"a.c.b",a_copy_buyCopyCount_args:{type:"_0",copyId:"_1"},a_copy_buyEquipTessera:"a.c.c",a_copy_buyRealmTessera:"a.c.d",a_copy_copyWipe:"a.c.e",a_copy_copyWipe_args:{copyId:"_0"},a_copy_start:"a.c.f",a_copy_start_args:{copyId:"_0",biCost:"_1"},a_copy_end:"a.c.g",a_copy_end_args:{copyId:"_0",fightData:"_1",isWin:"_2"},a_copy_updateWinningStreak:"a.c.h",a_copy_updateWinningStreak_args:{copyId:"_0"},a_copy_setRead:"a.c.i",a_copy_setRead_args:{copyId:"_0"},a_copy_guildStart:"a.c.j",a_copy_guildStart_args:{copyId:"_0",bossId:"_1"},a_copy_guildEnd:"a.c.k",a_copy_guildEnd_args:{copyId:"_0",bossId:"_1",isWin:"_2"},a_copy_guildCopyAward:"a.c.l",a_copy_guildCopyAward_args:{type:"_0",typeId:"_1"},a_copy_guildCopyReset:"a.c.m",a_copy_clearGuildCopy:"a.c.n",a_copy_clearGuildCopy_args:{bossId:"_0"},a_copy_paTaAward:"a.c.o",a_copy_paTaAward_args:{copyId:"_0"},a_copy_paTaTreasury:"a.c.o1",a_challengeCup_getInfo:"a.cc.a",a_challengeCup_startFight:"a.cc.b",a_challengeCup_startFight_args:{championUserId:"_0"},a_challengeCup_endFight:"a.cc.c",a_challengeCup_endFight_args:{isWin:"_0"},a_challengeCup_clearCd:"a.cc.d",a_challengeCup_toBeChampion:"a.cc.e",a_challengeCup_getDurationTimeRankList:"a.cc.f",a_challengeCup_getIsOpen:"a.cc.g",a_challengeCup_op:"a.cc.h",a_challengeCup_op_args:{op:"_0"},a_crystal_getInfo:"a.cr.a",a_crystal_saveProgress:"a.cr.b",a_crystal_saveProgress_args:{hp:"_0",hpNum:"_1",nextReplayTime:"_2"},a_crystal_finish:"a.cr.c",a_crystal_finish_args:{crystalId:"_0"},a_crystal_pickAward:"a.cr.d",a_crystal_pickAward_args:{crystalId:"_0"},a_crystal_useSkill:"a.cr.e",a_crystal_useSkill_args:{index:"_0"},a_crystal_refreshSkillCd:"a.cr.f",a_crystal_refreshSkillCd_args:{index:"_0"},a_rank_getRankList:"a.r.a",a_rank_getRankList_args:{rankType:"_0"},a_rank_getUserRank:"a.r.b",a_rank_getUserRank_args:{rankType:"_0"},a_rank_allRankArr:"a.r.c",a_rank_allRankArr_args:{rankType:"_0"},a_rank_getGuildRank:"a.r.d",a_rank_getGuildRank_args:{rankType:"_0"},a_rebirth_rebirth:"a.rb.a",a_rebirth_buyRebirth:"a.rb.b",a_rebirth_buyRebirth_args:{index:"_0",num:"_1"},a_recharge_getInfo:"a.rc.a",a_recharge_recharge:"a.rc.b",a_recharge_recharge_args:{rechargeId:"_0",channelId:"_1",receiptData:"_2"},a_recharge_getTodayCount:"a.rc.c",a_recharge_getAllCount:"a.rc.d",a_recharge_getRequest:"a.rc.e",a_recharge_getRequest_args:{rechargeId:"_0",goodsId:"_1"},a_recharge_handleRequest:"a.rc.g",a_redEnvelope_getList:"a.re.a",a_redEnvelope_sendRedEnvelope:"a.re.b",a_redEnvelope_sendRedEnvelope_args:{type:"_0",spItemId:"_1",amount:"_2",personNum:"_3",wish:"_4"},a_redEnvelope_syncRedEnvelope:"a.re.c",a_redEnvelope_getNewList:"a.re.d",a_redEnvelope_getNewList_args:{lastId:"_0"},a_redEnvelope_receiveBonus:"a.re.e",a_redEnvelope_receiveBonus_args:{redEnvelopeId:"_0"},a_redEnvelopePersonal_getInfo:"a.rp.a",a_chat_getNewList:"a.ch.a",a_chat_getNewList_args:{lastId:"_0",guildId:"_1",guildLastId:"_2"},a_chat_getNewSysMsgList:"a.ch.hda",a_chat_getNewSysMsgList_args:{lastId:"_0"},a_chat_sendData:"a.ch.b",a_chat_sendData_args:{content:"_0",lastId:"_1",type:"_2",guildId:"_3",guildLastId:"_4",isLittleHorn:"_5"},a_coupon_use:"a.co.a",a_coupon_use_args:{code:"_0"},a_coffers_getInfo:"a.cof.a",a_coffers_build:"a.cof.b",a_coffers_addBuff:"a.cof.b1",a_coffers_getLootRecordArr:"a.cof.c",a_coffers_getDefeseRecord:"a.cof.c1",a_coffers_getDefeseData:"a.cof.d",a_coffers_getEnemyDefeseData:"a.cof.d1",a_coffers_getEnemyDefeseData_args:{serverId:"_0"},a_coffers_getServerArr:"a.cof.e",a_coffers_fightStart:"a.cof.f",a_coffers_fightStart_args:{serverId:"_0",door:"_1"},a_coffers_fightEnd:"a.cof.f2",a_coffers_fightEnd_args:{serverId:"_0",door:"_1",isWin:"_2",fightData:"_3"},a_coffers_fightCoffersStart:"a.cof.g",a_coffers_fightCoffersStart_args:{serverId:"_0"},a_coffers_fightCoffersEnd:"a.cof.g1",a_coffers_fightCoffersEnd_args:{hurt:"_0",serverId:"_1",fightData:"_2"},a_sdk_getVip:"a.sd.a",a_smelt_smelt:"a.sm.a",a_smelt_smelt_args:{equipArr:"_0",choColor:"_1"},a_smelt_compound:"a.sm.b",a_smelt_compound_args:{compoundId:"_0"},a_smelt_wearParRing:"a.sm.c",a_smelt_wearParRing_args:{tempId:"_0",breakId:"_1"},a_smelt_ringBreak:"a.sm.d",a_smelt_ringBreak_args:{tempId:"_0",breakId:"_1"},a_king_getInfo:"a.k.a",a_king_worship:"a.k.b",a_king_receiveWelfare:"a.k.c",a_king_openBuff:"a.k.d",a_item_sellItems:"a.it.a",a_item_sellItems_args:{itemId:"_0",itemNum:"_1"},a_treasure_spies:"a.tr.a",a_treasure_getExPkOutInfo:"a.tr.b",a_treasure_open:"a.tr.c",a_treasure_open_args:{id:"_0"},a_treasure_compose:"a.tr.d",a_treasure_compose_args:{itemId:"_0"},a_talisman_useTrumpItem:"a.tm.a",a_talisman_useTrumpItem_args:{itemId:"_0"},a_talisman_wearTrump:"a.tm.b",a_talisman_wearTrump_args:{tempId:"_0",trumpId:"_1"},a_talisman_upTrumpLvl:"a.tm.c",a_talisman_upTrumpLvl_args:{tempId:"_0",trumpId:"_1"},a_talisman_upTrumpStar:"a.tm.d",a_talisman_upTrumpStar_args:{tempId:"_0",trumpId:"_1"},a_talisman_recastTrump:"a.tm.e",a_talisman_recastTrump_args:{tempId:"_0",trumpId:"_1"},a_talisman_compoundTrump:"a.tm.f",a_talisman_compoundTrump_args:{tempId:"_0",trumpId:"_1"},a_talisman_baptizeTrump:"a.tm.g",a_talisman_baptizeTrump_args:{tempId:"_0",trumpId:"_1",isCheck:"_2"},a_talisman_confirmBaptizeTrump:"a.tm.h",a_talisman_confirmBaptizeTrump_args:{tempId:"_0",trumpId:"_1"},a_talisman_cancelBaptizeTrump:"a.tm.i",a_talisman_cancelBaptizeTrump_args:{tempId:"_0",trumpId:"_1"},a_expedition_getInfo:"a.ex.a",a_expedition_wearSoul:"a.ex.b",a_expedition_wearSoul_args:{tempId:"_0",soulId:"_1"},a_expedition_startBattle:"a.ex.c",a_expedition_startBattle_args:{stageId:"_0"},a_expedition_endBattle:"a.ex.d",a_expedition_endBattle_args:{isWin:"_0",herosHp:"_1"},a_expedition_buyBlackItem:"a.ex.e",a_expedition_buyBlackItem_args:{itemId:"_0"},c_account_enterGame:"c.a.a",c_account_enterGame_args:{accountId:"_0",loginKey:"_1",serverIndexId:"_2"},c_account_createUser:"c.a.b",c_account_createUser_args:{name:"_0",heroTempId:"_1",sex:"_2",serverIndexId:"_3",shareKey:"_4"},c_account_getThirdUserInfo:"c.a.hda",c_net_connect:"c.n.a",c_net_disconnect:"c.n.b",c_net_disconnect_args:{sessionId:"_0"},c_net_getServerDate:"c.n.c",h_account_login:"h.a.a",h_account_login_args:{name:"_0",pwd:"_1",channelId:"_2"},h_account_loginBySdk:"h.a.a1",h_account_loginBySdk_args:{channelId:"_0",sdkData:"_1",deviceId:"_2"},h_account_register:"h.a.c",h_account_register_args:{name:"_0",pwd:"_1",channelId:"_2",deviceId:"_3"},h_notice_getNewOne:"h.nc.a",h_notice_getList:"h.nc.b",h_protocolContent_getInfo:"h.pc.a",h_serverInfo_getServerList:"h.s.a",h_serverInfo_getServerList_args:{isTest:"_0"},h_serverInfo_getServerInfo:"h.s.c",h_serverInfo_getServerInfo_args:{id:"_0"},h_serverInfo_getServerDate:"h.s.e",h_serverInfo_getUserServers:"h.s.f",h_serverInfo_getUserServers_args:{accountId:"_0"},h_serverInfo_getaccountServers:"h.s.g",h_serverInfo_getaccountServers_args:{openId:"_0",appId:"_1",isTest:"_2"},h_kefu_getList:"h.cs.hda",h_kefu_getList_args:{lastId:"_0",openId:"_1"},h_kefu_sendData:"h.cs.hdb",h_kefu_sendData_args:{lastId:"_0",content:"_1",openId:"_2",nickname:"_3",vipLevel:"_4"},admin_coffers_lootDefense:"admin.coffers.a",admin_coffers_lootDefense_args:{attackData:"_0",door:"_1"},admin_coffers_lootCoffersDefense:"admin.coffers.a1",admin_coffers_lootCoffersDefense_args:{hurt:"_0",breakNum:"_1"},admin_coffers_getCache:"admin.coffers.b",admin_coffers_resetPoints:"admin.coffers.c",admin_coffers_updateCache:"admin.coffers.d",admin_coffers_updateCache_args:{data:"_0"},admin_guild_getCache:"admin.guild.a",admin_guild_getGuildById:"admin.guild.b",admin_guild_getGuildById_args:{id:"_0"},admin_guild_updateCache:"admin.guild.c",admin_guild_updateCache_args:{id:"_0",data:"_1"},admin_guild_getZombieGuild:"admin.guild.d",admin_guild_clearZombieGuild:"admin.guild.e",admin_guild_clearZombieGuild_args:{id:"_0",data:"_1"},admin_guild_chairmanImpeach:"admin.guild.f",admin_boss_getBossData:"admin.boss.a",admin_boss_getBossData_args:{bossId:"_0"},admin_boss_getUserCache:"admin.boss.a1",admin_boss_getUserCache_args:{bossId:"_0"},admin_boss_getGuildById:"admin.boss.a2",admin_boss_getGuildById_args:{id:"_0"},admin_boss_updateBossCache:"admin.boss.b",admin_boss_updateBossCache_args:{data:"_0"},admin_boss_updateUserCache:"admin.boss.c",admin_boss_updateUserCache_args:{id:"_0",data:"_1"},admin_chat_serversChat:"admin.chat.a",admin_chat_serversChat_args:{nickName:"_0",vip:"_1",content:"_2",isGM:"_3",guildName:"_4",medalTitle:"_5",isLittleHorn:"_6"},admin_guildWar_lootDefense:"admin.guildWar.a",admin_guildWar_lootDefense_args:{attackData:"_0",isWin:"_1",defenceData:"_2"},admin_guildWar_pushBeFightRecord:"admin.guildWar.b",admin_guildWar_pushBeFightRecord_args:{guildId:"_0",data:"_1"},admin_guildWar_getCurServerGuildWarObj:"admin.guildWar.c",admin_guildWar_enter100User:"admin.guildWar.d",admin_guildWarSync_getSyncServer:"admin.guildWarSync.a",admin_guildWarSync_getSyncServer_args:{curServerData:"_0"},admin_treasure_getTreasureCash:"admin.treasure.a",admin_treasure_getTreasureByUserId:"admin.treasure.b",admin_treasure_setTreasureByUserId:"admin.treasure.c",admin_treasure_setTreasureByUserId_args:{userId:"_0"}}
}(gc||(gc={}));var g_consts;!function(t){t.moduleId={index:"IndexScene",home:"HomeScene",forge:"ForgeScene",role:"RoleScene",fight:"FightScene",guild:"GuildScene",guildwar:"GuildWarScene",bag:"BagScene",shop:"ShopScene",gift:"GiftScene",mail:"Mail",copyEntry:"CopyEntry",equipCopy:"Copy",stateCopy:"StateCopy",bossCopy:"BossCopy",vipCopy:"VipCopy",rank:"Rank",taskDlg:"TaskDlg",smelting:"Smelting",practice:"Practice",firstRecharge:"FirstRecharge",vip:"Vip",activityDlg:"ActivityNewCenter",tuLong:"TuLong",treasure:"Treasure",recharge:"Recharge",arena:"Arena",arenaShop:"ArenaShop",fiveDay:"FiveDay",newFourDay:"NewFiveDay",guildListLayer:"GuildListLayer",guildMineLayer:"GuildMineLayer",fuliDlg:"FuliDlg",chuanchen:"Chuanchen",worldBoss:"WorldBoss",guildBossInspire:"GuildBossInspire",worldBossHurtList:"WorldBossHurtList",guildBossReward:"GuildBossReward",roleEnemyInfo:"RoleEnemyInfo",redPacket:"RedPacket",redPacketList:"RedPacketList",redPacketGet:"RedPacketGet",defArena:"DefArena",defarenaWinner:"DefarenaWinner",king:"King",lotus:"LotusScene",rebirth:"Rebirth",rebirthExp:"RebirthExp",coffers:"CoffersScene",coffersServer:"CoffersServerDlg",customList:"CustomList",custom:"Custom",medal:"Medal",bossWar:"BossWar",guildBossLevelList:"GuildBossLevelList",wBossList:"WBossList",wBossReward:"WBossReward",guildBossCall:"GuildBossCall",wBossCall:"WBossCall",bindPhone:"BindPhone",userAgreement:"UserAgreement",guildCopy:"GuildCopy",guildCopyBoss:"GuildCopyBoss",tower:"Tower",heart:"HeartLayer",towerTreasury:"TowerTreasury",villian:"VillianLayer"},t.FS_SUBMID_SMELT=0,t.FS_SUBMID_ACTIVITY=2,t.FS_SUBMID_PVP_OUT=3,t.FS_SUBMID_CHAT=4,t.FS_SUBMID_RECHARGE=6,t.FS_SUBMID_VIP=7,t.HS_SUBMID_EQUIP_COPY=0,t.HS_SUBMID_BOSS_COPY=1,t.HS_SUBMID_STATE_COPY=2,t.HS_SUBMID_ARENA_SHOP=3,t.HS_SUBMID_ARENA=4,t.HS_SUBMID_GUILD=5,t.HS_SUBMID_KING=6,t.HS_SUBMID_DAILY=7,t.HS_SUBMID_CUSTOM_LIST=8,t.HS_SUBMID_SIGN=9,t.HS_SUBMID_VIP_COPY=10,t.HS_SUBMID_COFFERS_SERVER=11,t.HS_SUBMID_GUILD_COPY_BOSS=12,t.HS_SUBMID_TOWER=13,t.HS_SUBMID_HEART=14,t.subModuleMap={},t.subModuleMap[t.moduleId.home]=[t.HS_SUBMID_EQUIP_COPY,t.HS_SUBMID_BOSS_COPY,t.HS_SUBMID_STATE_COPY,t.HS_SUBMID_ARENA,t.HS_SUBMID_GUILD,t.HS_SUBMID_KING,t.HS_SUBMID_DAILY,t.HS_SUBMID_CUSTOM_LIST,t.HS_SUBMID_SIGN,t.HS_SUBMID_VIP_COPY,t.HS_SUBMID_COFFERS_SERVER,t.HS_SUBMID_GUILD_COPY_BOSS,t.HS_SUBMID_TOWER,t.HS_SUBMID_HEART],t.subModuleMap[t.moduleId.fight]=[t.FS_SUBMID_SMELT,t.FS_SUBMID_ACTIVITY,t.FS_SUBMID_PVP_OUT,t.FS_SUBMID_CHAT,t.FS_SUBMID_RECHARGE,t.FS_SUBMID_VIP]}(g_consts||(g_consts={}));var g_consts;!function(t){var e;!function(t){var e={};t.test=1,t.white_000=1e3,t.white_001=1001,t.white_101=1101,t.white_102=1102,t.white_103=1103,e[t.white_000]={textColor:16777215},e[t.white_001]={textColor:8750469},e[t.white_101]={textColor:16777215,stroke:2,strokeColor:1651794},e[t.white_102]={textColor:15461355,stroke:2,strokeColor:3618615},e[t.white_103]={textColor:16774902,stroke:2,strokeColor:9903104},t.green_000=2e3,t.green_001=2001,t.green_002=2002,e[t.green_000]={textColor:65280},e[t.green_001]={textColor:49678},e[t.green_002]={textColor:8309262},t.blue_000=3e3,t.blue_001=3001,t.blue_002=3002,t.blue_003=3003,t.blue_004=3004,t.blue_101=3101,t.blue_102=3102,e[t.blue_000]={textColor:255},e[t.blue_001]={textColor:1651794},e[t.blue_002]={textColor:9688040},e[t.blue_003]={textColor:1541884},e[t.blue_004]={textColor:7505614},e[t.blue_101]={textColor:9688040,stroke:2,strokeColor:12385},e[t.blue_102]={textColor:4259327,stroke:2,strokeColor:22639},t.purple_000=4e3,e[t.purple_000]={textColor:15166965,stroke:1,strokeColor:15166965},t.orange_000=5e3,t.orange_001=5001,t.orange_002=5002,t.orange_101=5101,t.orange_102=5102,t.orange_103=5103,e[t.orange_000]={textColor:16749568},e[t.orange_001]={textColor:15052900},e[t.orange_002]={textColor:16180930},e[t.orange_101]={textColor:16773580,stroke:2,strokeColor:4331271},e[t.orange_102]={textColor:16755495,stroke:2,strokeColor:8257792},e[t.orange_103]={textColor:16749568,stroke:2},t.red_000=6e3,t.red_001=6001,t.red_101=6101,e[t.red_000]={textColor:16711680},e[t.red_001]={textColor:15990784},e[t.red_101]={textColor:12081717,stroke:2,strokeColor:16775406},t.black_000=1e4,t.black_001=10001,t.black_002=10002,e[t.black_000]={textColor:0},e[t.black_001]={textColor:2827041},e[t.black_002]={textColor:4005377},t.yellow_000=11e3,t.yellow_001=11001,t.yellow_101=11101,t.yellow_102=11102,t.yellow_103=11103,e[t.yellow_000]={textColor:16776960},e[t.yellow_001]={textColor:15837696},e[t.yellow_101]={textColor:16775843,stroke:2,strokeColor:9790493},e[t.yellow_102]={textColor:15986881,stroke:2,strokeColor:7095306},e[t.yellow_103]={textColor:16775843,stroke:2,strokeColor:3087617},t.brown_001=12001,e[t.brown_001]={textColor:6428160},t.btn_101=60101,t.btn_102=60102,t.btn_103=60103,t.btn_111=60111,t.btn_112=60112,t.btn_113=60113,t.btn_120=60120,e[t.btn_101]={textColor:15335347,stroke:2,strokeColor:483333},e[t.btn_102]={textColor:16775621,stroke:2,strokeColor:6498304},e[t.btn_103]={textColor:14153471,stroke:2,strokeColor:803167},e[t.btn_111]={textColor:10924928,stroke:2,strokeColor:16128},e[t.btn_112]={textColor:11776917,stroke:2,strokeColor:4529413},e[t.btn_113]={textColor:10334899,stroke:2,strokeColor:10051},e[t.btn_120]={textColor:9803157,stroke:2,strokeColor:3552822},mo.registerFontStyle(e)}(e=t.style||(t.style={}))}(g_consts||(g_consts={}));var g_consts;!function(t){t.GUIDE_LCK={eqpChged:"eqpChged",hasSmelting:"hasSmelting",buyEquip:"buyEquip",everEquiped:"everEquiped",popBindPhoneAfterPay:"popBindAfterPay"}}(g_consts||(g_consts={}));var g_cache;!function(t){function e(t,e,r){return n[t]!=e?(n[t]=e,mo.setLocalStorageItem(t,e,r)):void 0}function r(t,e){return n.hasOwnProperty(t)?n[t]:mo.getLocalStorageItem(t,e)}function i(){for(var t in g_consts.GUIDE_LCK)delete n[t],mo.removeLocalStorageItem(t,!1)}function a(){for(var t in g_consts.GUIDE_LCK)n[t]=r(t)}function s(t){var i=r(t);i||e(t,!0)}var n={};t.setLocalStorageItem=e,t.getLocalStorageItem=r,t.clearGuideKeyCache=i,t.initGuideKeyCache=a,t.recordGuideDone=s}(g_cache||(g_cache={}));var ws;!function(t){function e(){var t=document.referrer;if(t){var e=/http:\/\/([^\/]+)\//i,r=t.match(e)[1];return r}return"未知"}function r(t){if(!egret.isNative){var r={appId:"A6971D498D982AFCE9BF0CE5C453E52C",appVer:t,channel:e(),errorReport:!0,virus:!0};DCAgent.init(r)}}function i(t,e){if(!egret.isNative){var r={amount:0,currencyType:"",payType:"",iapid:"",orderId:"",payTime:0};r.amount=t,r.currencyType="CNY",r.payTime=~~(Date.newDate().getTime()/1e3),e&&(r.iapid=e),DCAgent.onPayment(r)}}function a(t,e){if(!egret.isNative){var t=t,r=1,i={value:e};DCAgent.onEvent(t,r,i)}}t.initRecharge=r,t.recordRecharge=i,t.recordEvent=a}(ws||(ws={}));var gc;!function(t){function e(e){if(!o){o=[];var r=t.c_prop.spItemIdKey;for(var i in r)o.push(r[i])}return o.indexOf(parseInt(e))>=0}function r(t,e,r){for(var i=[],a=e,s=r?r:t.length;s>a;a++)i.push(t[a]);return i}function i(){var e=["ico_loading","panel_top_notice","s9g_failinfo","btn_0_0_0","btn_close_0"],i=["ico_first_recharge","ico_treasure","ico_five_day","ico_dinzhisfg","ico_zanyingrukou"],a=["ico_heirloom","ico_mail","ico_phone","ico_desktop_share","ico_desktop_follow","ico_xiongdi","ico_desktop"];e=e.concat(i),e=e.concat(a),mo.R.setGlobal.apply(mo.R,e),t.net.reset(),mo.setWaitingView(g_base.BaseJuHua.getInstance()),mo.registerDcParser("@mc",function(t,e){for(var i=t[1][1],a=0,s=[],n={},o=0,c=i.length;c>o;o++,a++){var g=i[o],l=r(g,0,4),_=r(g,4);s.push({res:a.toString(),x:_[0],y:_[1],duration:_[2]}),n[a.toString()]={x:l[0],y:l[1],w:l[2],h:l[3]}}var u={},d=u.mc={},p=d[e]={};return p.frameRate=t[1][0],p.frames=s,u.res=n,u})}function a(e,r){mo.playWaiting(),mo.request4Http(t.iface.c_net_getServerDate,function(t){mo.debug("serverDate--->",t),Date.setStandard(t),mo.stopWaiting(),e&&e.call(r)})}function s(e,r,i){return t.handleTodayRefresh(e,r,i)}function n(e,r,i){var a=mo.getJSONWithFileName(t.cfg_c_game);i=null==i?a[t.id_c_game.refreshTime][0]:i;var s=Date.newDate();e?"string"==typeof e&&(e=Date.newDate(e)):e=s.clone();var n=!e.isAfter(s);if(n){var o=Date.today();o.addHours(i),o.isAfter(s)||o.addDays(1)}return r(n,o)}logger.initLogger(t,"gc");var o;t.isSpecialItem=e,t.subArr=r,t.init=i,t.initData=a,t.getTodayCount=s,t.handleTodayRefresh=n;var c=function(){function e(){}var r=(__define,e),i=r.prototype;return i.init=function(){mo._dc.mc={29:["@mc",[24,[[330,492,327,240,-165,-152],[1,494,327,239,-165,-154],[1,251,327,241,-165,-157],[688,1,325,243,-164,-160],[342,247,343,243,-179,-158],[342,1,344,244,-179,-158],[1,1,339,248,-176,-160],[687,247,328,243,-165,-155]]]]}},i.load=function(e){var r=this;if(!r.loading&&!r.loaded){var i=e,a=new egret.URLLoader,s=new egret.URLRequest;s.url=i,a.dataFormat=egret.URLLoaderDataFormat.BINARY,a.load(s),r.loading=!0,a.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){mo.showMsg("E:"+egret.IOErrorEvent.IO_ERROR),r.loading=!1,r.onResult(!1)},r),a.addEventListener(egret.Event.COMPLETE,function(){r.loading=!1,r.loaded=!0;for(var e=new JSZip(a.data),i=e.file(/^[tc].*/),s=0,n=i.length;n>s;s++){var o=i[s],c=mo.STR.format("shared/%s",o.name);res._jsData[c]=JSON.parse(o.asText())}var g=res._jsData[t.cfg_c_msgCode];mo.setMsgData(g);var l=["dc_mc"],_=".json";mo._dc.mc=JSON.parse(e.file(l[0]+_).asText()),r.onResult(!0)},r)}},i.onResult=function(t){var e=this;e.playWaiting&&(mo.stopWaiting(),e.playWaiting=!1),e.cb&&e.cb.call(e.ctx,t)},i.waitingResult=function(t,e){var r=this;return r.loaded?void t.call(e,!0):void(r.loading&&(mo.playWaiting(),r.playWaiting=!0,r.cb=t,r.ctx=e))},e}();t.Lzcl=c,egret.registerClass(c,"gc.Lzcl")}(gc||(gc={}));var utils;!function(t){function e(t){var e=Object.keys(t)[0],r=t[e];return[e,r]}function r(t){var e=[];for(var r in t)e.push({itemId:r,count:t[r]});return e}function i(t){for(var e=[],r=0,i=t.length;i>r;r++){var a=Object.keys(t[r])[0],s=t[r][a];e.push({itemId:a,count:s})}return e}function a(t){for(var e,r={},i=0,a=t.length;a>i;i++){e=t[i];var s=e[0],n=e[1];r[s]=n}return r}function s(t){for(var e=[],r=0,i=t.length;i>r;r++){var a=t[r];e.push({itemId:a[0],count:a[1]})}return e}function n(t){var e=mo.getJSONWithFileName(gc.cfg_c_nameData),r=Object.keys(e).length,i=0|Math.random()*r||1,a=e[i][gc.c_nameData_firstName],s="",n=0|Math.random()*r||1;return s=t==gc.c_prop.sexKey.male?e[n][gc.c_nameData_maleName]:e[n][gc.c_nameData_femaleName],a+s||"张德帅"}function o(e,r){if(!e)return t.getRandomName(r);e+="";for(var i=["1758","68wan","猎豹"],a=!1,s=0;s<i.length;s++){var n=i[s];-1!=e.indexOf(n)&&(a=!0)}return isNaN(e)&&!a?e:t.getRandomName(r)}function c(t,e){void 0===e&&(e=1);for(var r=["万","亿","兆","万兆","亿兆"],i=[4,8,12,16,20],a=i.length-1;a>=0;a--){var s=Math.pow(10,i[a]);if(t>=s)return(t/s).toFixed(e)+r[a]}return 0==e?t.toFixed(e):t.toString()}function g(t){var e=t,r=e/Math.pow(10,8)>>0;e-=Math.pow(10,8)*r;var i=e/Math.pow(10,4)>>0;e-=Math.pow(10,4)*i;var a="";return r>0?(a+=r+"亿",i>0&&(a+=i+"万")):i>0?(a+=i+"万",e>0&&(a+=e)):a+=e,a}function l(t){var e=Math.floor(t/24),r=t%24;return(e>0?e+"天":"")+(r>1/60?r.toFixed(2)+"小时":"1分钟内")}function _(t){var e;switch(t){case gc.c_prop.currencyTypeKey.gold:e=gc.c_prop.spItemIdKey.gold;break;case gc.c_prop.currencyTypeKey.diamond:e=gc.c_prop.spItemIdKey.diamond;break;case gc.c_prop.currencyTypeKey.honor:e=gc.c_prop.spItemIdKey.honor;break;case gc.c_prop.currencyTypeKey.prestige:e=gc.c_prop.spItemIdKey.honor}return e}t.obj2KVArr=e,t.itemObj2ObjArr=r,t.itemObjArr2ObjArr=i,t.kvArr2KvObj=a,t.kvArrItems2ObjArr=s,t.getRandomName=n,t.filterName=o,t.formatByWan=c,t.formatByWan2=g,t.formatHour=l,t.getCurrencyTypeItemId=_}(utils||(utils={}));var resHelper;!function(t){function e(t,e,r){return t+"_"+mo.STR.fill(e,"00000")+(r?"_"+r:"")}function r(e,r,i,a){return i=i?"."==i.substring(0,1)?i.substring(1):i:"png",mo.STR.format(t.dynamicTemp,e,mo.STR.fill(r,H)+(a?"_"+a:""),i)}function i(t,e,r,i){return r=r?"."==r.substring(0,1)?r.substring(1):r:"png",mo.STR.format(K,t,mo.STR.fill(e,H)+(i?"_"+i:""),r)}function a(t,e){var r=t+"/"+t+"_"+mo.STR.fill(e,"00000");return{png:mo.STR.format(G,r+"_texture","png"),plist:mo.STR.format(G,r+"_texture","json"),exportJson:mo.STR.format(G,r+"_ske","json")}}function s(t){var e=t.split("_");return a(e[0],e[1])}function n(e){return t.getResName(t.dynamic.buff,e)}function o(e){return t.getCcaRes(t.dynamic.buff,e)}function c(e){return t.getResName(t.dynamic.effect,e)}function g(e){return t.getCcaRes(t.dynamic.effect,e)}function l(e,r){return t.getResourceDynamicResPath(t.dynamic.effect,e,r)}function _(e){return t.getDynamicResPath(t.dynamic.recharge,e,"png")}function u(e){return mo.STR.format(t.dynamicTemp,t.dynamic.clothes,mo.STR.fill(e,"00000"),"png")}function d(e){return mo.STR.format(t.dynamicTemp,t.dynamic.weapon,mo.STR.fill(e,"00000"),"png")}function p(e){return mo.STR.format(t.dynamicTemp,t.dynamic.ui_wing,mo.STR.fill(e,"00000"),"png")}function m(e){var r,i=mo.getJSONWithFileNameAndID(gc.cfg_t_otherBuff,e);return i&&(r=i[gc.t_otherBuff_icon]),r||(r=e),mo.STR.format(t.dynamicTemp,t.dynamic.buff,mo.STR.fill(r,"00000"),"png")}function f(t){return mo.STR.format(G,"role/role_"+mo.STR.fill(t,"00000")+"_ico","png")}function h(t){return mo.STR.format(G,"role/role_"+mo.STR.fill(t,"00000")+"_body","png")}function y(t){return"ico_item_"+mo.STR.fill(t,"00000")}function C(t){return"ico_item_"+mo.STR.fill(t,"00000")}function v(e){return e+="","-"==e.substring(0,1)&&(e=e.substring(1)),t.getDynamicResPath(t.dynamic.fight,e,"jpg")}function I(e){return t.getDynamicResPath(t.dynamic.map,e,"json")}function E(e){return t.getDynamicResPath(t.dynamic.skill,e,"png")}function D(e){return t.getDynamicResPath(t.dynamic.vip,e,"png")}function b(e){return path.join("audio/"+t.getResName(t.dynamic.ui,e)+".mp3")}function S(e){return t.getDynamicResPath(t.dynamic.event,e,"png")}function N(t,e){return mo.STR.format(G,t+"/"+t+"_"+mo.STR.fill(e,"00000"),"arm")}function T(t,e){return e=e||1,(1==t?"border_":"border_2_")+e}function k(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_item,e),i=r[gc.t_item_iconId]||e;return isNaN(parseInt(i))?mo.STR.format(t.dynamicTemp,t.dynamic.item,i,"png"):mo.STR.format(t.dynamicTemp,t.dynamic.item,mo.STR.fill(i,"000000"),"png")}function x(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_talisman,e),i=r[gc.t_talisman_imgId]||e;return isNaN(parseInt(i))?mo.STR.format(t.dynamicTemp,t.dynamic.gift_img,i,"png"):mo.STR.format(t.dynamicTemp,t.dynamic.gift_img,mo.STR.fill(i,"000000"),"png")}function R(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_talisman,e),i=r[gc.t_talisman_iconId]||e;return isNaN(parseInt(i))?mo.STR.format(t.dynamicTemp,t.dynamic.gift,i,"png"):mo.STR.format(t.dynamicTemp,t.dynamic.gift,mo.STR.fill(i,"000000"),"png")}function w(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_talismanSkill,e),i=r[gc.t_talismanSkill_icon]||e;return mo.STR.format(t.dynamicTemp,t.dynamic.gift_skill,i,"png")}function A(e){var i=mo.getJSONWithFileNameAndID(gc.cfg_t_monster,e),a=i[gc.t_monster_displayID];return r(t.dynamic.head,a,"png")}function L(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_wing,e);return t.getDynamicResPath(t.dynamic.wing,r[gc.t_wing_iconId],"png")}function P(e){return t.getDynamicResPath(t.dynamic.task,e,"png")}function B(e){return t.getDynamicResPath(t.dynamic.ui_gboss,e,"png")}function O(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_medal,e)[gc.t_medal_staIconId];return t.getDynamicResPath(t.dynamic.medal,r,"png")}function q(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_medal,e)[gc.t_medal_chatIconId];return t.getDynamicResPath(t.dynamic.title,r,"png")}function M(e){return t.getDynamicResPath(t.dynamic.ui_heart,"b_"+e,"png")}function W(e){return t.getDynamicResPath(t.dynamic.ui_heart,"t_"+e,"png")}function F(e){return t.getDynamicResPath(t.dynamic.ui_heart,"c_"+e,"png")}function U(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_item,e),i=r[gc.t_item_iconId]||e,a=t.getResName("small",i),s=mo.STR.format(J,a);return s}var G="arm_%s.%s";t.dynamicTemp="dynamic2/%s_%s.%s";var K="resource/dynamic2/%s_%s.%s",H="00000",J="resource/ui2/ui_activity/%s.png";t.dynamic={role:"role",hero:"role",monster:"role",effect:"effect",ui:"ui",fight:"fight",map:"map",skill:"skill",task:"task",item:"item",gift:"gift",gift_skill:"gift_skill",gift_img:"gift_img",vip:"vip",death:"death",buff:"buff",icon:"icon",event:"event",head:"head",wing:"wing",clothes:"ui_clothes",weapon:"ui_weapon",ui_wing:"ui_wing",recharge:"recharge",ui_gboss:"ui_gboss",ui_heart:"ui_heart",medal:"medal",title:"title"},t.getResName=e,t.getDynamicResPath=r,t.getResourceDynamicResPath=i,t.getCcaRes=a,t.getCcaResByName=s,t.getBuffCcaName=n,t.getBuffCcaRes=o,t.getSkillEffectCcaName=c,t.getSkillEffectCcaRes=g,t.getEffectPath=l,t.getRechargeIconPath=_,t.getHeroClothesIconPath=u,t.getHeroWeaponIconPath=d,t.getHeroWingIconPath=p,t.getBuffIconPath=m,t.getRoleIconPath=f,t.getRoleBodyPath=h,t.getSpecialIconPath=y,t.getUIIconPath=C,t.getFightBgPath=v,t.getMapJsonPath=I,t.getSkillIconPath=E,t.getVipIconPath=D,t.getUIAudioPath=b,t.getEventIconPath=S,t.getArmPath=N,t.getBorderByQuality=T,t.getItemIconPath=k,t.getGiftIcon=x,t.getGiftIconWordPath=R,t.getGiftSkillIconPath=w,t.getMonsterHeadIconPath=A,t.getWingIconPath=L,t.getTaskIconPath=P,t.getWorldBossIconPath=B,t.getWarPrintIconPath=O,t.getChatTitle=q,t.getHeartIconPath=M,t.getHeartTitlePath=W,t.getHeartNamePath=F,t.getSmallItemPath=U}(resHelper||(resHelper={}));var uiHelper;!function(t){function e(e,r,i){var a=e.getChildByName("icon"),s=e.getChildByName("num"),n=t.resIco[r],o=n?1:.5;n=n?n:resHelper.getItemIconPath(r),a.source=n,o!=a.scaleX&&(a.scaleX=o,a.scaleY=o),s.text=i+""}function r(t,e,r,i){if(null!=i){var a=t.getChildByName("grp_vip"),s=parseInt(i)>0;if(a&&s){a.includeInLayout=s,a.visible=s;var n=a.getChildByName("label_vipLvl");n.text=i+""}}var o=t.getChildByName("label_name");o.text=e;var c=t.getChildByName("label_level");c.text=r+""}function i(e,r){t.resetItemsGrp(e,"ico_item");for(var i,a,s=0,n=r.length;n>s;s++)i=r[s],a=e.getChildByName("ico_item"+s),a&&(a.visible=!0,a.includeInLayout=!0,a.setData(i))}function a(t,e){var r,i=0;for(r=t.getChildByName(e+i);r;)r.visible=!1,r.includeInLayout=!1,++i,r=t.getChildByName(e+i)}function s(e,r){t.resetItemsGrp(e,"img_star");for(var i,a=0,s=r;s>a;a++)i=e.getChildByName("img_star"+a),i&&(i.visible=!0,i.includeInLayout=!0)}function n(e){return t.qualityColorMap[e]||16777215}function o(t){var e=mo.getJSONWithFileName(gc.cfg_c_game)[gc.id_c_game.pkOutCfg],r=16777215;return t>=e[5]&&(r=16773120),t>=e[6]&&(r=16711680),r}function c(e){return t.partRes[parseInt(e)]}function g(t,e){return void 0===e&&(e=1),mo.STR.format("avatar_%s_%s_%s",Math.floor((t-1)/2)+1,t%2,e)}function l(t,e){t&&(e?(t.visible=!0,t.play(-1)):(t.visible=!1,t.gotoAndStop(1)))}function _(t,e){t.textColor=e?65280:16711680}function u(t,e,r){t.text=mo.STR.format("%s--%s",e.toFormat("MM月DD日HH24:MI"),r.toFormat("MM月DD日HH24:MI"))}t.resIco={},t.resIco[gc.c_prop.spItemIdKey.gold]="ico_gold",t.resIco[gc.c_prop.spItemIdKey.honor]="ico_hornor",t.resIco[gc.c_prop.spItemIdKey.diamond]="ico_yuanbao",t.resIco[gc.c_prop.spItemIdKey.vitality]="ico_active",t.setResGrp=e,t.setVipGrp=r,t.setItemsGrp=i,t.resetItemsGrp=a,t.setStarGrp=s,t.qualityColorMap={1:16777215,2:46676,3:1994751,4:6815946,5:13979648,6:13762575},t.getColorByQuality=n,t.getUserNameColor=o,t.partRes=[["ntc_ico_weapon","txt_part_weapon","txt_part_weapon"],["ntc_ico_clothes","txt_part_body","txt_part_weapon"],["ntc_ico_bracelet","txt_part_bracelet","txt_part_weapon"],["ntc_ico_ring","txt_part_ring","txt_part_weapon"],["ntc_ico_ring_mb","txt_part_ring_mb","txt_part_weapon"],["ntc_ico_ring_recover","txt_part_ring_recover","txt_part_weapon"],["ntc_ico_ring_body","txt_part_ring_protect","txt_part_weapon"],["ntc_ico_ring_hurt","txt_part_ring_hurt","txt_part_weapon"],["ntc_ico_ring","txt_part_ring","txt_part_weapon"],["ntc_ico_bracelet","txt_part_bracelet","txt_part_weapon"],["ntc_ico_helmet","txt_part_head","txt_part_weapon"],["ntc_ico_necklace","txt_part_necklace","txt_part_weapon"]],t.getPartRes=c,t.getHeroIcon=g,t.playUIEffect=l,t.setLabelGreenOrRed=_,t.setEventTime=u;var d=function(){function t(t){this._sc=t.scroller,this._sc.addEventListener(egret.Event.CHANGE,this.chgFunc,this),this._sc.addEventListener(egret.gui.UIEvent.CHANGE_END,this.chgEnd,this)}var e=(__define,t),r=e.prototype;return r.chgFunc=function(t){var e=this;e._isPause&&(e._scrollTopOnPause&&(t.target.scrollTop=e._scrollTopOnPause),e._scrollLeftOnPause&&(t.target.scrollLeft=e._scrollLeftOnPause))},r.chgEnd=function(){this._isPause=!1,this._scrollLeftOnPause=null,this._scrollTopOnPause=null},r.pauseScrollV=function(){this._isPause=!0,this._scrollTopOnPause=this._sc.scrollTop},r.pauseScrollH=function(){this._isPause=!0,this._scrollLeftOnPause=this._sc.scrollLeft},r.resumeScroll=function(){this.chgEnd()},r.doDtor=function(){this._sc.removeEventListener(egret.Event.CHANGE,this.chgFunc,this),this._sc.removeEventListener(egret.gui.UIEvent.CHANGE_END,this.chgEnd,this),this._sc=null},t}();t.ScrollerHelper=d,egret.registerClass(d,"uiHelper.ScrollerHelper")}(uiHelper||(uiHelper={}));var gd;!function(t){var e=function(){function e(){}var r=(__define,e),i=r.prototype;return i.getCurLastRefreshTime=function(t){t=t||5;var e=Date.newDate().getHours(),r=null;return r=t>e?Date.newDate().addDays(-1).clearTime().addHours(t):Date.newDate().clearTime().addHours(t)},i.calRefreshData=function(e,r,i){var a=t.commonUtils.getCurLastRefreshTime();return r&&a.equalsDay(new Date(r))||(e=i,r=a),[e,r]},e}();t.CommonUtils=e,egret.registerClass(e,"gd.CommonUtils"),t.commonUtils=new e}(gd||(gd={}));var gd;!function(t){var e=function(){function t(){}var e=(__define,t),r=e.prototype;return r.addPropValue=function(t,e,r){switch(e){case gc.c_prop.heroPropKey.maxHp:t.maxHp+=r;break;case gc.c_prop.heroPropKey.maxHpScale:t.maxHpScale+=r;break;case gc.c_prop.heroPropKey.attack:t.attack+=r;break;case gc.c_prop.heroPropKey.attackScale:t.attackScale+=r;break;case gc.c_prop.heroPropKey.defence:t.defence+=r;break;case gc.c_prop.heroPropKey.defenceScale:t.defenceScale+=r;break;case gc.c_prop.heroPropKey.magicDefence:t.magicDefence+=r;break;case gc.c_prop.heroPropKey.magicDefenceScale:t.magicDefenceScale+=r;break;case gc.c_prop.heroPropKey.hit:t.hit+=r;break;case gc.c_prop.heroPropKey.hitScale:t.hitScale+=r;break;case gc.c_prop.heroPropKey.dodge:t.dodge+=r;break;case gc.c_prop.heroPropKey.dodgeScale:t.dodgeScale+=r;break;case gc.c_prop.heroPropKey.critical:t.critical+=r;break;case gc.c_prop.heroPropKey.criticalScale:t.criticalScale+=r;break;case gc.c_prop.heroPropKey.disCritical:t.disCritical+=r;break;case gc.c_prop.heroPropKey.disCriticalScale:t.disCriticalScale+=r;break;case gc.c_prop.heroPropKey.luckyValue:t.luckyValue+=r;break;case gc.c_prop.heroPropKey.luckyValueScale:t.luckyValueScale+=r;break;case gc.c_prop.heroPropKey.moveSpeed:t.moveSpeed+=r;break;case gc.c_prop.heroPropKey.moveSpeedScale:t.moveSpeedScale+=r;break;case gc.c_prop.heroPropKey.attackInterval:t.attackInterval+=r;break;case gc.c_prop.heroPropKey.attackIntervalScale:t.attackIntervalScale+=r;break;case gc.c_prop.heroPropKey.damageIncrease:t.damageIncrease+=r;break;case gc.c_prop.heroPropKey.damageDecrease:t.damageDecrease+=r;break;case gc.c_prop.heroPropKey.benumbPro:t.benumbPro+=r;break;case gc.c_prop.heroPropKey.disBenumbPro:t.disBenumbPro+=r;break;case gc.c_prop.heroPropKey.poisoningRecoveryProb:t.poisoningRecoveryProb+=r;break;case gc.c_prop.heroPropKey.benumbProSpan:t.benumbProSpan+=r;break;case gc.c_prop.heroPropKey.reviveCount:t.reviveCount+=r;break;case gc.c_prop.heroPropKey.reviveHPScale:t.reviveHPScale+=r;break;case gc.c_prop.heroPropKey.maxHp2:t.maxHp2+=r;break;case gc.c_prop.heroPropKey.disMaxHp2:t.disMaxHp2+=r;break;case gc.c_prop.heroPropKey.maxHpTemp:t.maxHpTemp+=r;break;case gc.c_prop.heroPropKey.attackTemp:t.attackTemp+=r;break;case gc.c_prop.heroPropKey.defenceTemp:t.defenceTemp+=r;break;case gc.c_prop.heroPropKey.magicDefenceTemp:t.magicDefenceTemp+=r;break;case gc.c_prop.heroPropKey.hitTemp:t.hitTemp+=r;break;case gc.c_prop.heroPropKey.dodgeTemp:t.dodgeTemp+=r;break;case gc.c_prop.heroPropKey.criticalTemp:t.criticalTemp+=r;break;case gc.c_prop.heroPropKey.disCriticalTemp:t.disCriticalTemp+=r;break;case gc.c_prop.heroPropKey.luckyValueTemp:t.luckyValueTemp+=r;break;case gc.c_prop.heroPropKey.moveSpeedTemp:t.moveSpeedTemp+=r;break;case gc.c_prop.heroPropKey.attackIntervalTemp:t.attackIntervalTemp+=r;break;case gc.c_prop.heroPropKey.damageIncreaseTemp:t.damageIncreaseTemp+=r;break;case gc.c_prop.heroPropKey.damageDecreaseTemp:t.damageDecreaseTemp+=r}},r.getPropValue=function(t,e,r){},t}();t.HeroUtils=e,egret.registerClass(e,"gd.HeroUtils"),t.heroUtils=new e}(gd||(gd={}));var gd;!function(t){var e=function(){function e(){}var r=(__define,e),i=r.prototype;return i.getNumOfItems=function(t,e){var r=0;if(!t)return r;var i=mo.getJSONWithFileName(gc.cfg_t_item);for(var a in t){var s=a,n=i[s];if(n){var o=parseInt(t[a]);n[gc.t_item_type]==e&&(r+=o)}}return r},i.getNewBag=function(e,r){var i=t.userCtrl.getBag(),a=JSON.parse(JSON.stringify(i));for(var s in e){var n=parseInt(a[s])||0;a[s]=n-parseInt(e[s]),a[s]<=0&&delete a[s]}for(var s in r){var n=parseInt(a[s])||0;a[s]=n+parseInt(r[s])}return a},i.getNewBag4update=function(e){var r=t.userCtrl.getBag(),i=JSON.parse(JSON.stringify(r));for(var a in e)i[a]=parseInt(e[a]),i[a]<=0&&delete i[a];return i},i.getNewEquipBag=function(e,r){for(var i=t.userCtrl.getEquipBag(),a=JSON.parse(JSON.stringify(i)),s=0;s<e.length;s++)delete a[e[s]],delete t.userCtrl._equipBk[e[s]];for(var n in r)a[n]=r[n];return a},i.getEquipGrade=function(t,e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_t_itemEquip),s=0;if(r){for(var n=[],o=a[t][gc.t_itemEquip_propertys],c=0;c<r.length;c++)n.push(o[r[c]]);s=i._calEquipGrade(n)}else s=a[t][gc.t_itemEquip_gradeBase];return s+=i._calEquipGrade(e)},i._calEquipGrade=function(t){for(var e=mo.getJSONWithFileName(gc.cfg_c_game),r=0,i=0,a=0;a<t.length;a++){var s=t[a][0],n=t[a][1];switch(s){case gc.c_prop.equipPropKey.maxHpTemp:i=e[gc.id_c_game.equipGrade][0];break;case gc.c_prop.equipPropKey.attackTemp:i=e[gc.id_c_game.equipGrade][1];break;case gc.c_prop.equipPropKey.defenceTemp:i=e[gc.id_c_game.equipGrade][2];break;case gc.c_prop.equipPropKey.magicDefenceTemp:i=e[gc.id_c_game.equipGrade][3];break;case gc.c_prop.equipPropKey.hitTemp:i=e[gc.id_c_game.equipGrade][4];break;case gc.c_prop.equipPropKey.dodgeTemp:i=e[gc.id_c_game.equipGrade][5];break;case gc.c_prop.equipPropKey.criticalTemp:i=e[gc.id_c_game.equipGrade][6];break;case gc.c_prop.equipPropKey.disCriticalTemp:i=e[gc.id_c_game.equipGrade][7]}r+=i*n}return r},i.isLoot=function(e){var r=mo.getJSONWithFileName(gc.cfg_t_item),i=r[e];if(!i)return!1;var a=i[gc.t_item_lootType]||0;if(0==a)return!0;var s=t.userCtrl.getLootTypeArr();return s&&s.indexOf(a)>-1?!0:!1},i.getLoots=function(t){if(t instanceof Array){for(var e=[],r=0;r<t.length;++r)t[r]instanceof Array?this.isLoot(t[r][0])&&e.push([t[r][0],t[r][1]]):t[r]instanceof Object?this.isLoot(t[r].itemId)&&e.push({itemId:t[r].itemId,count:t[r].count}):this.isLoot(t[r])&&e.push(t[r]);return e}if(t instanceof Object){var i={};for(var a in t)this.isLoot(a)&&(i[a]=t[a]);return i}},e}();t.UserUtils=e,egret.registerClass(e,"gd.UserUtils"),t.userUtils=new e}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.AccountEntity},a.getId=function(){return this._data?this._data[gc.dsConsts.AccountEntity.id]:0},a.getStatus=function(){return this._data?this._data[gc.dsConsts.AccountEntity.status]:0},a.getSdkData=function(){return this._data?this._data[gc.dsConsts.AccountEntity.sdkData]:{}},a.isGuest=function(){var t=this,e=t.getSdkData(),r=!1;return"1"==e.is_guest&&(r=!0),r},a.getLoginKey=function(){return this.loginKey},r.login=function(e,r,i,a,s){var n=gc.iface.h_account_login_args,o={};o[n.name]=e,o[n.pwd]=r,o[n.channelId]=i,mo.requestWaiting4Http(gc.iface.h_account_login,o,function(e){var r=e[gc.dsConsts.ExAccount.account];t.accountCtrl.loginKey=e[gc.dsConsts.ExAccount.loginKey],t.accountCtrl.init(r),a&&a.call(s,r)})},r.loginBySdk=function(e,r,i,a){var s={},n=gc.iface.h_account_loginBySdk_args;s[n.channelId]=e,s[n.sdkData]=r,s[n.deviceId]=mo.getDeviceId(),mo.requestWaiting4Http(gc.iface.h_account_loginBySdk,s,function(e){var r=e[gc.dsConsts.ExAccount.account];t.accountCtrl.loginKey=e[gc.dsConsts.ExAccount.loginKey],t.accountCtrl.init(r),i&&i.call(a,r)})},r.registerAccount=function(e,r,i,a,s){var n=gc.iface.h_account_register_args,o={};o[n.name]=e,o[n.pwd]=r,o[n.channelId]=i,o[n.deviceId]=mo.getDeviceId(),mo.requestWaiting4Http(gc.iface.h_account_register,o,function(e){var r=e[gc.dsConsts.ExAccount.account];t.accountCtrl.loginKey=e[gc.dsConsts.ExAccount.loginKey],t.accountCtrl.init(r),a&&a.call(s,r)})},r}(mo.DataController);t.AccountCtrl=e,egret.registerClass(e,"gd.AccountCtrl"),t.accountCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.AccountEntity,this._dataList=[]},a.hasReceiveFirstRecharge=function(){var t=this,e=t.getFirstRecharge();if(!e)return!0;var r=t.getActivityValue(e,gc.dsConsts.ActivityEntity.id),i=t.getReceiveData(r);return i[0]?!0:!1},a.hasRecharged=function(){return t.rechargeCtrl.getAllCostRMB()>0},a.getFirstRecharge=function(){var t=this,e=t._getExActivityByType(gc.c_prop.activityTypeKey.firstRecharge);return e},a.getFirstRechargeItems=function(){var t=this,e=t.getFirstRecharge();return e[gc.dsConsts.ExActivity.activityItems][0][gc.dsConsts.ActivityItem.items]},a.getAllChargeCountStatus=function(t,e){var r=this,i=r._getExActivityById(t),a=r.getReceiveData(t),s=i[gc.dsConsts.ExActivity.activityItems],n=i[gc.dsConsts.ExActivity.allRecharge],o=s[e],c=o[gc.dsConsts.ActivityItem.rmb]||0;if(c>n)return 2;var g=a[e]||0;return 0>=g?1:0},a.receiveFirstRecharge=function(t,e){var r=this;if(!r.hasRecharged())return mo.showMsg(gc.id_c_msgCode.cantGetNoCharge);if(r.hasReceiveFirstRecharge())return mo.showMsg("首充礼包已经领过，不能再领取！");var i=r.getFirstRecharge(),a=r.getActivityValue(i,gc.dsConsts.ActivityEntity.id);r.receive(a,0,function(){r.pushNotify(r.__class.ON_FIRST_REWARD_RECEIVED),t.call(e)},r)},a.getSevenLoginStatus=function(t){var e=this,r=e._getExActivityByType(gc.c_prop.activityTypeKey.sevenLogin),i=e.getActivityValue(r,gc.dsConsts.ActivityEntity.id),a=e.getReceiveData(i);if(a.length<=0)return 0==t?1:2;var s=a[a.length-1];return s=new Date(s),t>a.length?2:t<a.length?0:s.equalsDay(Date.newDate())?2:1},a.getSignActivity=function(){var t=this,e=t._getExActivityByType(gc.c_prop.activityTypeKey.sign);return e},a.getSignItems=function(){var t=this,e=t.getSignActivity();if(!e)return{};var r=e[gc.dsConsts.ExActivity.activity];if(!r)return{};var i=r[gc.dsConsts.ActivityEntity.exValues];return i},a.buyMysterShop=function(e,r,i,a){var s=this,n=gc.iface.a_activity_buyMysterShop_args,o={};o[n.activityId]=e,o[n.index]=r;var c=0,g=999999,l=mo.getJSONWithFileName(gc.cfg_c_mysterShop),_=s._getExActivityByType(gc.c_prop.activityTypeKey.mysterShop);if(!_)return mo.showMsg(gc.id_c_msgCode.activitiesEnd);var u=_[gc.dsConsts.ExActivity.activity];if(!u)return mo.showMsg(gc.id_c_msgCode.activitiesEnd);var d=u[gc.dsConsts.ActivityEntity.exValues];if(!d[0])return mo.showMsg("参数错误");var p=l[d[0]];if(!p)return mo.showMsg("参数错误");switch(r){case 0:var m=p[gc.c_mysterShop_giftBag1];c=m[2],g=m[3];break;case 1:var f=p[gc.c_mysterShop_giftBag2];c=f[2],g=f[3]}if(1==c){if(t.userCtrl.getGold()<g)return void t.userCtrl.noGolds(function(){s.buyMysterShop(e,r,i,a)},s)}else{if(2!=c)return mo.showMsg("参数错误");if(t.userCtrl.getDiamond()<g)return mo.showMsg(gc.id_c_msgCode.noDiamond)}mo.requestWaiting4Server(gc.iface.a_activity_buyMysterShop,o,function(e){var r=e[gc.dsConsts.ExActivityData.userData]||{},n=e[gc.dsConsts.ExActivityData.bagItems]||{},o=e[gc.dsConsts.ExActivityData.equipBagItems]||{},c=e[gc.dsConsts.ExActivityData.mysterShopArr]||[],g=t.userUtils.getNewBag({},n);
r[gc.dsConsts.UserEntity.bag]=g;var l=t.userUtils.getNewEquipBag({},o);r[gc.dsConsts.UserEntity.equipBag]=l,t.userCtrl.updateEntity(r),s.getInfo(function(){s.pushNotify(s.__class.ACTIVITY_OP,{})},s),i.call(a,c)})},a.buyAppMysterShop=function(e,r,i,a){var s=this,n=gc.iface.a_activity_buyMysterShop_args,o={};o[n.activityId]=e,o[n.index]=r;var c=0,g=999999,l=mo.getJSONWithFileName(gc.cfg_c_mysterShop),_=s._getExActivityByType(gc.c_prop.activityTypeKey.appMysterShop);if(!_)return mo.showMsg(gc.id_c_msgCode.activitiesEnd);var u=_[gc.dsConsts.ExActivity.activity];if(!u)return mo.showMsg(gc.id_c_msgCode.activitiesEnd);var d=u[gc.dsConsts.ActivityEntity.exValues];if(!d[0])return mo.showMsg("参数错误");var p=l[d[0]];if(!p)return mo.showMsg("参数错误");switch(r){case 0:var m=p[gc.c_mysterShop_giftBag1];c=m[2],g=m[3];break;case 1:var f=p[gc.c_mysterShop_giftBag2];c=f[2],g=f[3]}if(1==c){if(t.userCtrl.getGold()<g)return void t.userCtrl.noGolds(function(){s.buyMysterShop(e,r,i,a)},s)}else{if(2!=c)return mo.showMsg("参数错误");if(t.userCtrl.getDiamond()<g)return mo.showMsg(gc.id_c_msgCode.noDiamond)}mo.requestWaiting4Server(gc.iface.a_activity_buyMysterShop,o,function(e){var r=e[gc.dsConsts.ExActivityData.userData]||{},n=e[gc.dsConsts.ExActivityData.bagItems]||{},o=e[gc.dsConsts.ExActivityData.equipBagItems]||{},c=e[gc.dsConsts.ExActivityData.mysterShopArr]||[],g=t.userUtils.getNewBag({},n);r[gc.dsConsts.UserEntity.bag]=g;var l=t.userUtils.getNewEquipBag({},o);r[gc.dsConsts.UserEntity.equipBag]=l,t.userCtrl.updateEntity(r),s.getInfo(function(){s.pushNotify(s.__class.ACTIVITY_OP,{})},s),i.call(a,c)})},a.getMysterShopArr=function(e,r,i){var a=t.userCtrl.getActivity()[e],s=[];if(a){if(a[2]){var n=Date.newDate(a[2]);s=r&&(Date.newDate(r).isAfter(n)||Date.newDate(i).isBefore(n))?[0,[]]:[a[0],a[1]]}}else s=[0,[]];return s},a.exChangeMysterShop=function(t,e,r,i){var a=this;a.receive(t,e,function(){mo.showMsg(gc.id_c_msgCode.redeemRewardMail),r.call(i)},a)},a.getLotteryActivity=function(){var t=this,e=t._getExActivityByType(gc.c_prop.activityTypeKey.lottery);return e},a.lottery=function(e,r,i){var a=this,s=a.getLotteryActivity();if(!s)return r();var n=t.userCtrl.getDiamond(),o=a.getLotteryCost(e);if(1!=e&&10!=e)return mo.showMsg("参数错误！");if(o>n)return mo.showMsg(gc.id_c_msgCode.noDiamond);var c=a.getActivityValue(s,gc.dsConsts.ActivityEntity.id);a.receive(c,e,function(t){var e=t[gc.dsConsts.ExActivityData.lotteryItemsArr]||[];r.call(i,e)},a)},a.getLotteryCost=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_game),r=e[gc.id_c_game.lotteryCostCfg][8]||1,i=e[gc.id_c_game.lotteryCostCfg][0]*r,a=e[gc.id_c_game.lotteryCostCfg][1]*r;return 1==t?i:a},a.getFiveTargetActivity=function(){var t=this,e=t._getExActivityByType(gc.c_prop.activityTypeKey.fiveDaysTarget);return e},a.getNewFourActivity=function(){var t=this,e=t._getExActivityByType(gc.c_prop.activityTypeKey.newFourDays);return e},a.luckyTalos=function(e,r,i,a){var s=this,n=s.getLuckyTalosActivity(e);if(!n)return console.log("找不到该活动"),i();if(0>r||r>3)return i("参数错误");var o=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exData);if(!o)return i("参数错误");var c=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exValues),g=o[gc.c_prop.activityExDataTypeKey.spItemId];if(!g)return i("参数错误");var l=t.userCtrl.getItemNum(g),_=c[0];if(g==gc.c_prop.spItemIdKey.gold){if(_>l)return void t.userCtrl.noGolds(function(){},this)}else if(g==gc.c_prop.spItemIdKey.diamond){if(_>l)return mo.showMsg(gc.id_c_msgCode.noDiamond)}else if(_>l)return mo.showMsg("材料不足！");s.receive(e,r,function(t){var e=t[gc.dsConsts.ExActivityData.luckyTalosItemArr]||[];i.call(a,e)},s,g)},a.getLuckyTalosCost=function(t,e){var r=this,i=9999,a=r.getLuckyTalosActivity(e);if(a){var s=r.getActivityValue(a,gc.dsConsts.ActivityEntity.exValues);return s[0]||i}},a.getLuckyTalosActivity=function(t){var e=this,r=e._getExActivityById(t);return r},a.getActivity=function(t){var e=this,r=e._getExActivityById(t);return r},a.getUiInfoActivity=function(t){var e=this,r=e.getLuckyTalosActivity(t);if(r){var i=e.getActivityValue(r,gc.dsConsts.ActivityEntity.exData);return[i[gc.c_prop.activityExDataTypeKey.titleIcon],i[gc.c_prop.activityExDataTypeKey.desIcon]]}},a.limitPanicBuying=function(e,r,i,a){var s=this,n=s._getExActivityById(e);if(!n)return i(mo.showMsg("找不到该活动"));var o=s.getLimitPanicBuyCount(e),c=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exValues2),g=c[0]||0;if(o>=g)return mo.showMsg(gc.id_c_msgCode.activitiesEnd);var l=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exData);if(!l)return mo.showMsg("参数错误");var _=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exValues),u=l[gc.c_prop.activityExDataTypeKey.spItemId];if(!u)return mo.showMsg("参数错误");var d=l[gc.c_prop.activityExDataTypeKey.vipLimitLvl]||0,p=t.userCtrl.getVip();if(d>p)return mo.showMsg("vip"+d+"以上才可购买");var m=t.userCtrl.getItemNum(u),f=_[0];if(u==gc.c_prop.spItemIdKey.gold){if(f>m)return void t.userCtrl.noGolds(function(){},this)}else if(u==gc.c_prop.spItemIdKey.diamond){if(f>m)return mo.showMsg(gc.id_c_msgCode.noDiamond)}else if(f>m)return mo.showMsg("材料不足！");s.receive(e,r,function(t){mo.showMsg("购买成功,请到邮箱领取奖励！"),i.call(a,t)},s)},a.getLimitPanicBuyCount=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.activity),i=r[e]||0;return i},a.getLimitNum=function(t){var e=this,r=e._getExActivityById(t);if(!r)return 0;var i=e.getActivityValue(r,gc.dsConsts.ActivityEntity.exValues2);return i[0]||0},a.everydayCharge=function(e,r,i,a){var s=this,n=s._getExActivityById(e);if(!n)return i(mo.showMsg("找不到该活动"));var o=n[gc.dsConsts.ExActivity.days]||0;if(r+1>o)return mo.showMsg(gc.id_c_msgCode.goalNotGet);var c=t.userCtrl.get(gc.dsConsts.UserEntity.activity),g=c[e]||[],l=g[r]||0;return l?mo.showMsg("已领取请查看邮件!"):void s.receive(e,r,function(t){mo.showMsg("领取成功,请到邮箱领取奖励！"),i.call(a,t)},s)},a.getAllRebateStatus=function(t,e){var r=this,i=r._getExActivityById(t),a=r.getReceiveData(t),s=i[gc.dsConsts.ExActivity.activityItems],n=i[gc.dsConsts.ExActivity.allCost],o=s[e],c=o[gc.dsConsts.ActivityItem.diamond]||0;if(c>n)return 2;var g=a[1]||[],l=g[e]||0;return l},a.getDayRechargeStatus=function(t,e){var r=this,i=r._getExActivityById(t),a=r.getReceiveData(t),s=i[gc.dsConsts.ExActivity.activityItems],n=i[gc.dsConsts.ExActivity.todayRecharge],o=i[gc.dsConsts.ExActivity.days],c=s[e],g=c[gc.dsConsts.ActivityItem.rmb]||0;if(g>n)return 2;var l=a[o]||[],_=l[e]||0;return _},a.getSetTheWordCount=function(t,e){var r=this,i=r.getReceiveData(t);return i[e]||0},a.setTheWord=function(t,e,r,i){var a=this,s=a._getExActivityById(t);return s?void a.receive(t,e,function(t){mo.showMsg("兑换成功,请到邮箱领取奖励！"),r.call(i,t)},a):mo.showMsg("找不到该活动")},a.getVPlanStatus=function(t,e){var r=this,i=r.getReceiveData(t),a=i[e]||0;return a},a.vPlan=function(e,r,i,a){var s=this,n=mo.getJSONWithFileName(gc.cfg_c_game),o=s._getExActivityById(e);if(!o)return i(mo.showMsg("找不到该活动"));var c=(s.getReceiveData(e),o[gc.dsConsts.ExActivity.activityItems]),g=o[gc.dsConsts.ExActivity.maxPaymoney],l=c[r],_=l[gc.dsConsts.ActivityItem.vPlan],u=0,d=30;u=10500==_[0]?0:1;var p=n[gc.id_c_game.vPlanCfg][u]||7;if(d=n[gc.id_c_game.vPlanCfg][u+2]||30,t.userCtrl.getVip()<p||g<_[1])return mo.showMsg(gc.id_c_msgCode.vPlan,_[1]);var m=Date.newDate();return m.isBefore(new Date(t.userCtrl.get(gc.dsConsts.UserEntity.createTime)).clone().addDays(d))?mo.showMsg("需要至少创角"+d+"天才可领取"):void s.receive(e,r,function(t){mo.showMsg("兑换成功,请到邮箱领取奖励！"),i.call(a,t)},s)},a.luckyMajong=function(e,r,i,a){var s=this,n=s.getActivity(e);if(!n)return console.log("找不到该活动"),i();if(0>r||r>6)return i("参数错误");var o=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exData);if(!o)return i("参数错误");var c=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exValues),g=o[gc.c_prop.activityExDataTypeKey.spItemId];if(!g)return i("参数错误");var l=t.userCtrl.getItemNum(g),_=c[0];if(g==gc.c_prop.spItemIdKey.gold){if(_>l)return void t.userCtrl.noGolds(function(){},this)}else if(g==gc.c_prop.spItemIdKey.diamond){if(_>l)return mo.showMsg(gc.id_c_msgCode.noDiamond)}else if(_>l)return mo.showMsg("材料不足！");var u=s.getLuckValue(e);s.receive(e,r,function(t){var r=t[gc.dsConsts.ExActivityData.luckyTalosItemArr]||[],n=s.getLuckValue(e);if(n>u)mo.showMsg(gc.id_c_msgCode.majongLuckyPoint,s.getAddLuckValue(e));else{var o=t[gc.dsConsts.ExActivityData.exItem];for(var c in o){var g=mo.getJSONWithFileNameAndID(gc.cfg_t_item,c),l=g[gc.t_item_name]||"";mo.showMsg(gc.id_c_msgCode.majongLuckyBonusTips,l,o[c]);break}}i.call(a,r)},s,g)},a.getLuckValue=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.activity),i=r[e]||0;return i},a.getAddLuckValue=function(t){var e=this,r=e.getActivity(t),i=e.getActivityValue(r,gc.dsConsts.ActivityEntity.exValues3);return i[0]||5},a.userSurvey=function(t,e,r,i,a){var s=this,n=s.getActivity(t);if(!n)return mo.showMsg("找不到该活动");var o={},c=gc.iface.a_activity_report_args;o[c.activityId]=t,o[c.report]=r,mo.requestWaiting4Server(gc.iface.a_activity_report,o,function(r){s.receive(t,e,function(t){i&&i.call(a,t)})},s)},a.getUserSurveyStatus=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.activity),i=r[e]||0;return 1!=i?0:1},a.getNewLuckValue=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.activity),i=r[e]||[];return i[0]||0},a.newLuckyMajong=function(e,r,i,a){var s=this,n=s.getActivity(e);if(!n)return mo.showMsg("找不到该活动");var o=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exData);if(!o)return mo.showMsg("参数错误");var c=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exValues),g=o[gc.c_prop.activityExDataTypeKey.spItemId];if(!g)return mo.showMsg("参数错误");var l=t.userCtrl.getItemNum(g),_=c[0],u=s.getTodayActivityCount(e),d=s.getFreeDay(e),p=s.getTotalDay(e);if(u>=p)return mo.showMsg("已达最大次数");if(u>=d)if(g==gc.c_prop.spItemIdKey.gold){if(_>l)return void t.userCtrl.noGolds(function(){},this)}else if(g==gc.c_prop.spItemIdKey.diamond){if(_>l)return mo.showMsg(gc.id_c_msgCode.noDiamond)}else if(_>l)return mo.showMsg("材料不足！");var m=s.getLuckValue(e);s.receive(e,r,function(t){var r=t[gc.dsConsts.ExActivityData.luckyTalosItemArr]||[],n=s.getLuckValue(e);if(n>m)mo.showMsg(gc.id_c_msgCode.majongLuckyPoint,s.getAddLuckValue(e));else{var o=t[gc.dsConsts.ExActivityData.exItem];for(var c in o){var g=mo.getJSONWithFileNameAndID(gc.cfg_t_item,c),l=g[gc.t_item_name]||"";mo.showMsg(gc.id_c_msgCode.majongLuckyBonusTips,l,o[c]);break}}i.call(a,r)},s,g)},a.getTodayNewLimitPanicBuyCount=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.activity),i=r[e]||[0,Date.newDate()],a=i[0],s=Date.newDate(i[1]);return s&&(s=Date.newDate(s),s.equalsDay(Date.newDate())||(s=Date.newDate(),a=0)),i[0]=a,i[1]=s,r[e]=i,t.userCtrl.set(gc.dsConsts.UserEntity.activity,r),a},a.newLimitPanicBuy=function(e,r,i,a){var s=this,n=s.getActivity(e);if(!n)return mo.showMsg("找不到该活动");var o=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exData);if(!o)return mo.showMsg("参数错误");var c=o[gc.c_prop.activityExDataTypeKey.vipLimitLvl]||0,g=o[gc.c_prop.activityExDataTypeKey.funcName],l=t.userCtrl.getVip();if(g&&"function"==typeof gc[g]){var _=gc[g](l,c);if(!_)return mo.showMsg("vip"+c+"以上才可购买")}else if(c>l)return mo.showMsg("vip"+c+"以上才可购买");var u=s.getActivityValue(n,gc.dsConsts.ActivityEntity.exValues),d=o[gc.c_prop.activityExDataTypeKey.spItemId];if(!d)return mo.showMsg("参数错误");var p=t.userCtrl.getItemNum(d),m=u[0],f=s.getTodayNewLimitPanicBuyCount(e),h=s.getTotalDay(e);if(f>=h)return mo.showMsg("已达今日购买最大次数");if(d==gc.c_prop.spItemIdKey.gold){if(m>p)return void t.userCtrl.noGolds(function(){},this)}else if(d==gc.c_prop.spItemIdKey.diamond){if(m>p)return mo.showMsg(gc.id_c_msgCode.noDiamond)}else if(m>p)return mo.showMsg("材料不足！");s.getLuckValue(e);s.receive(e,r,function(t){mo.showMsg("领取成功,请到邮箱领取奖励！"),i.call(a,t)},s)},a.receive=function(e,r,i,a,s){void 0===s&&(s=0);var n=this,o={},c=gc.iface.a_activity_receive_args;o[c.activityId]=e,o[c.index]=r,mo.requestWaiting4Server(gc.iface.a_activity_receive,o,function(e){var r=e[gc.dsConsts.ExActivityData.userData]||{},o=e[gc.dsConsts.ExActivityData.bagItems]||{},c=e[gc.dsConsts.ExActivityData.equipBagItems]||{},g=t.userUtils.getNewBag({},o);r[gc.dsConsts.UserEntity.bag]=g;var l=t.userUtils.getNewEquipBag({},c);if(r[gc.dsConsts.UserEntity.equipBag]=l,t.userCtrl.updateEntity(r),egret.setTimeout(function(){n.getInfo(function(){n.pushNotify(n.__class.ACTIVITY_OP,{})},n)},n,500),i&&i.call(a,e),s>0&&s==gc.c_prop.spItemIdKey.gold){var _=e[gc.dsConsts.ExActivityData.getGold]||0;if(_>0)var u=egret.setTimeout(function(){mo.showMsg("获得金币: "+_),egret.clearTimeout(u)},n,400)}})},a.getReceiveData=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.activity),i=r[e]||[];return i},a.getActivityValue=function(t,e){var r=t[gc.dsConsts.ExActivity.activity];return r[e]},a.getMainList=function(){for(var t=this,e=[],r=0;r<t._dataList.length;r++){var i=t._dataList[r],a=t.getActivityValue(i,gc.dsConsts.ActivityEntity.type);a!=gc.c_prop.activityTypeKey.firstRecharge&&a!=gc.c_prop.activityTypeKey.lottery&&a!=gc.c_prop.activityTypeKey.fiveDaysTarget&&a!=gc.c_prop.activityTypeKey.sign&&a!=gc.c_prop.activityTypeKey.sevenLogin&&a!=gc.c_prop.activityTypeKey.redeemCode&&a!=gc.c_prop.activityTypeKey.challengeCup&&e.push(i)}return e.sort(function(t,e){return t[gc.dsConsts.ExActivity.activity][gc.dsConsts.ActivityEntity.sort]-e[gc.dsConsts.ExActivity.activity][gc.dsConsts.ActivityEntity.sort]}),e},a.getFuliList=function(){for(var t=this,e=[],r=0;r<t._dataList.length;r++){var i=t._dataList[r],a=t.getActivityValue(i,gc.dsConsts.ActivityEntity.type);(a==gc.c_prop.activityTypeKey.sign||a==gc.c_prop.activityTypeKey.sevenLogin||a==gc.c_prop.activityTypeKey.redeemCode)&&e.push(i)}return e.sort(function(t,e){return t[gc.dsConsts.ExActivity.activity][gc.dsConsts.ActivityEntity.sort]-e[gc.dsConsts.ExActivity.activity][gc.dsConsts.ActivityEntity.sort]}),e},a.getInfo=function(e,r){var i=this;mo.request4Server(gc.iface.a_activity_getList,{},function(a){i._dataList=a,t.pointCtrl.cal(gc.c_prop.pointEffectKey.activity),t.pointCtrl.cal(gc.c_prop.pointRedKey.fuli),e&&e.call(r,a)})},a.isPointEffect=function(){for(var t=this,e=t.getMainList(),r=0;r<e.length;r++){var i=e[r],a=i[gc.dsConsts.ExActivity.isNeedOp];if(a)return!0}return!1},a.isFuliPointEffect=function(){for(var t=this,e=t.getFuliList(),r=0;r<e.length;r++){var i=e[r],a=i[gc.dsConsts.ExActivity.isNeedOp];if(a)return!0}return!1},a.isPoint=function(t){for(var e=this,r=e.getMainList(),i=0;i<r.length;i++){var a=r[i],s=e.getActivityValue(a,gc.dsConsts.ActivityEntity.id);if(t==s){var n=a[gc.dsConsts.ExActivity.isNeedOp];if(n)return!0}}for(var o=e.getFuliList(),i=0;i<o.length;i++){var a=o[i],s=e.getActivityValue(a,gc.dsConsts.ActivityEntity.id);if(t==s){var n=a[gc.dsConsts.ExActivity.isNeedOp];if(n)return!0}}return!1},a._getExActivityByType=function(t){for(var e=this,r=0;r<e._dataList.length;r++){var i=e._dataList[r],a=e.getActivityValue(i,gc.dsConsts.ActivityEntity.type);if(a==t)return i}return null},a._getExActivityById=function(t){for(var e=this,r=0;r<e._dataList.length;r++){var i=e._dataList[r],a=e.getActivityValue(i,gc.dsConsts.ActivityEntity.id);if(a==t)return i}return null},a.getFreeDay=function(t){var e=this,r=e.getActivity(t),i=e.getActivityValue(r,gc.dsConsts.ActivityEntity.exData);return i[gc.c_prop.activityExDataTypeKey.freeDay]||0},a.getTotalDay=function(t){var e=this,r=e.getActivity(t),i=e.getActivityValue(r,gc.dsConsts.ActivityEntity.exData);return i[gc.c_prop.activityExDataTypeKey.totalDay]||0},a.getTodayActivityCount=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.activity),i=r[e]||[0,[0,Date.newDate()]],a=i[1][0],s=Date.newDate(i[1][1]);return s&&(s=Date.newDate(s),s.equalsDay(Date.newDate())||(s=Date.newDate(),a=0)),i[1][0]=a,i[1][1]=s,r[e]=i,t.userCtrl.set(gc.dsConsts.UserEntity.activity,r),a},r.ON_FIRST_REWARD_RECEIVED="on_first_",r.ACTIVITY_OP="ACTIVITY_OP",r}(mo.DataController);t.ActivityCtrl=e,egret.registerClass(e,"gd.ActivityCtrl"),t.activityCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._hasNotReadNewArenaRecord=0}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.ArenaEntity},a.initData=function(t){this._hasNotReadNewArenaRecord=t},a.updateEntity=function(r){e.prototype.updateEntity.call(this,r),t.pointCtrl.cal(gc.c_prop.pointRedKey.arena1)},a.getInfo=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_arena_getInfo,{},function(a){i.init(a),t.pointCtrl.cal(gc.c_prop.pointRedKey.arena1),e&&e.call(r,a)})},a.getRank=function(){var t=this;return t._data?t.get(gc.dsConsts.ArenaEntity.rank):0},a.getHighRank=function(){var t=this;return t._data?t.get(gc.dsConsts.ArenaEntity.highRank):0},a.resetArenaFightRanks=function(e,r){var i=this,a=t.userCtrl.getDiamond(),s=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.arenaCfg),n=i.get(gc.dsConsts.ArenaEntity.reNumData),o=n[gc.c_prop.arenaDataKey.lastResetTime];if(o){var c=s[6]||999999,g=Date.newDate(),l=(g.getTime()-Date.newDate(o).getTime())/1e3;if(c>l){var _=s[7]||999999;if(_>a)return mo.showMsg(gc.id_c_msgCode.noDiamond)}}mo.requestWaiting4Server(gc.iface.a_arena_resetFightRanks,{},function(t){i.updateEntity(t),e&&e.call(r,t)})},a.getFightUserList=function(t,e){mo.requestWaiting4Server(gc.iface.a_arena_getFightUserList,{},function(r){t&&t.call(e,r)})},a.getReNumNextSeconds=function(){var e=this,r=e.getRePKNum();if(r>=0)return null;var i=t.commonUtils.getCurLastRefreshTime(),a=Date.newDate().getSecondsBetween(i.addDays(1));return a},a.buyPKNum=function(e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.arenaCfg][4];mo.showMsg(gc.id_c_msgCode.noArenaTimes,s,function(){mo.requestWaiting4Server(gc.iface.a_arena_buyPKNum,{},function(a){t.userCtrl.updateEntity(a[gc.dsConsts.ExUserData.userData]),i.updateEntity(a[gc.dsConsts.ExUserData.arenaData]),e&&e.call(r,a)})})},a.getRePKNum=function(){var t=this;return t._data?(t._calReNumData(),t.get(gc.dsConsts.ArenaEntity.reNumData)[0]||0):0},a.getCDSeconds=function(){var t=this,e=t.get(gc.dsConsts.ArenaEntity.reNumData)[gc.c_prop.arenaDataKey.nextFightTime]||Date.newDate();e=new Date(e);var r=Date.newDate().getSecondsBetween(e);return 0>r&&(r=0),r},a.refreshCD=function(e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.arenaCfg][3];mo.showMsg(gc.id_c_msgCode.cleanArenaTime,s,function(){mo.requestWaiting4Server(gc.iface.a_arena_refreshCD,{},function(a){t.userCtrl.updateEntity(a[gc.dsConsts.ExUserData.userData]),i.updateEntity(a[gc.dsConsts.ExUserData.arenaData]),e&&e.call(r,a)})})},a.fightStart=function(e,r,i){var a=this;if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(t.fightCtrl.isDie)return mo.showMsg("复活中，请稍后");var s=gc.iface.a_arena_fightStart_args,n={};n[s.rank]=e;var o=a.getCDSeconds();if(o>0)return void a.refreshCD(function(){a.fightStart(e,r,i)},a);var c=a.getRePKNum();return 0>=c?void a.buyPKNum(function(){a.fightStart(e,r,i)},a):void mo.requestWaiting4Server(gc.iface.a_arena_fightStart,n,function(s){a._fightRank=e;var n=s[gc.dsConsts.ExArena.arenaData];n&&a.updateEntity(n);var o=s[gc.dsConsts.ExArena.userData];o&&t.userCtrl.updateEntity(o);for(var c=s[gc.dsConsts.ExArena.heroList],g=s[gc.dsConsts.ExArena.otherDataList],l=s[gc.dsConsts.ExArena.fightData],_=[],u=0;u<c.length;u++){var d=c[u],p=t.HeroEntityCtrl.createNewEnemy(d,l,g[u]);_.push(p)}_.sort(t.heroCtrl._sortHeroList),t.fightCtrl.isSpFighting=!0,r&&r.call(i,_)})},a.fightEnd=function(e,r,i,a){var s=this;if(s._fightRank){var n=gc.iface.a_arena_fightEnd_args,o={};o[n.rank]=s._fightRank,o[n.isWin]=e,o[n.fightData]=r,mo.requestWaiting4Server(gc.iface.a_arena_fightEnd,o,function(e){var r=e[gc.dsConsts.FightResult.updateArena];r&&s.updateEntity(r);var n=e[gc.dsConsts.FightResult.updateUser];n&&t.userCtrl.updateEntity(n);var o=e[gc.dsConsts.FightResult.guildData];o&&t.guildCtrl.updateData(o);var c=e[gc.dsConsts.FightResult.guildPersonalData];c&&t.guildPersonalCtrl.updateData(c);var g=e[gc.dsConsts.FightResult.hasChangeRank];g&&mo.showMsg(gc.id_c_msgCode.rankChanged),i&&i.call(a,e)})}},a.getRecordList=function(t,e){var r=gc.iface.a_arena_getRecordList_args,i={};i[r.index]=0,i[r.count]=20,mo.requestWaiting4Server(gc.iface.a_arena_getRecordList,i,function(r){t&&t.call(e,r)})},a.getRefreshRemainTime=function(t){mo.request4Server(gc.iface.a_arena_getRefreshRemainTime,{},function(e){return t(e)})},a.getRankList=function(t,e){mo.requestWaiting4Server(gc.iface.a_arena_getRankList,{},function(r){t&&t.call(e,r)})},a.getRankReward=function(t){for(var e=mo.getJSONWithFileName(gc.cfg_c_arenaRankReward),r=0,i=0,a=0,s=null,n=1;50>n;n++){var o=e[n];if(!o)break;if(t>=o[gc.c_arenaRankReward_rangeStart]&&t<=o[gc.c_arenaRankReward_rangeEnd]){s=o;break}}if(s){var c=s[gc.c_arenaRankReward_rewardId],g=mo.getJSONWithFileName(gc.cfg_c_reward),l=g[c];r=l[gc.c_reward_prestige],i=l[gc.c_reward_gold],a=l[gc.c_reward_diamond]}return[i,a,r]},a._calReNumData=function(){var e=this,r=mo.getJSONWithFileName(gc.cfg_c_game),i=e.get(gc.dsConsts.ArenaEntity.reNumData),a=i[0]||0,s=i[1],n=r[gc.id_c_game.arenaCfg][1],o=t.commonUtils.calRefreshData(a,s,n);i[0]=o[0],i[1]=o[1]},r}(mo.DataController);t.ArenaCtrl=e,egret.registerClass(e,"gd.ArenaCtrl"),t.arenaCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=gc.c_prop.bagTypeKey,r="bagTag",i={},a=mo.ARR.filterOption;i[0]=a,i[1]=a.bind({list:[[r,e.equip]]}),i[2]=a.bind({list:[[r,e.item]]}),i[3]=a.bind({list:[[r,e.rebirth]]}),i[4]=a.bind({list:[[r,e.chest]]}),i[5]=a.bind({list:[[r,e.medal]]});var s={},n="tempId",o="lvl",c="itemLvl",g="quality",l="count",_="isReachedUseLvl",u="isOpenNoCost",d="getItemTypeWeight",p=mo.ARR.sortOption;s[0]=p.bind({list:[n]}),s[1]=p.bind({list:[g,c,n]}),s[2]=p.bind({list:[_,d,g,c,{type:1,name:n}]}),s[3]=p.bind({list:[g,o,n]}),s[4]=p.bind({list:[_,u,g,{type:1,name:c},{type:1,name:n}]}),s[5]=p.bind({list:[l,n]});var m=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var a=(__define,r),n=a.prototype;return n._initProp=function(){var t=this;e.prototype._initProp.call(this),t._tempCfgName=gc.cfg_t_item,t.tempId=null,t._temp=null,t._isRequesting=!1,t.pileCount=0,t.islock=0},n.init=function(r,i,a){e.prototype.init.call(this,null);var s=this;s.tempId=parseInt(r);var n=s.temp=s._temp=mo.getJSONWithFileNameAndID(s._tempCfgName,r);if(s.name=n[gc.t_item_name],s.type=n[gc.t_item_type],s.type==gc.c_prop.itemTypeKey.equip){var o=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,r);if(s.equipId=i,s.job=o[gc.t_itemEquip_job],s.jobName=gc.c_prop.heroJob[s.job],s.proptys=o[gc.t_itemEquip_propertys],s.equipType=o[gc.t_itemEquip_type],s.equipTypeName=gc.c_prop.equipType[s.equipType],s.equipId){var c=t.equipCtrl.equipTrans(s.equipId);c.isCustomEquip&&(s.name=c.name,s.proptys=c.basePropArr),s.score=c.score}s.count=1,s.islock=a}else s.count=i||0;s.price=n[gc.t_item_price]||0,s.note=n[gc.t_item_note]||"",s.quality=n[gc.t_item_color],s.level=n[gc.t_item_level],s.itemLvl=n[gc.t_item_itemLvl],s.vip=n[gc.t_item_vip],s.bagTag=n[gc.t_item_bagTag]},n.isEquip=function(){return this.type==gc.c_prop.itemTypeKey.equip},n._changeCount=function(t){void 0===t&&(t=0);var e=this,r=e.count;r+=t,r=0>r?0:r,e.count=r,e.pushNotify(e.__class.ON_COUNT_CHANGED,r)},n.addCount=function(t){void 0===t&&(t=1);var e=this;e._changeCount(t)},n.setCount=function(t){this.count=t,this._changeCount()},n.getTempValue=function(t){return this._temp[t]},n.getLogicTempValue=function(t){},n.getExclusiveExp=function(){return this.exclusiveExp},n.isReachedUseLvl=function(){return t.userCtrl.getLvl()>=this.level?1:0},n.isOpenNoCost=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_t_itemLogic,this.tempId);return t&&null!=t[gc.t_itemLogic_needItems]?0:1},n.getItemTypeWeight=function(){var e=t.BagDataCtrl.ITEM_TYPE_SORT_CFG;if(!e){e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.initCfg)[7].split(",");for(var r=0,i=e.length;i>r;r++)e[r]=parseInt(e[r]);t.BagDataCtrl.ITEM_TYPE_SORT_CFG=e}var a=e.indexOf(this.type);return a>=0?e.length-a:a},r.getSortOpt=function(t){return s[t]},r.getFilterOpt=function(t){return i[t]},r.getList=function(e,r){var i=t.userCtrl.getBag(),a=this.pileItems(i);return e&&(a=a.filter(e)),r&&(a=a.sort(r)),a},r.getEquipList=function(e){for(var r,i,a=t.userCtrl.getEquipBag(),s=[],n=mo.getJSONWithFileName(gc.cfg_t_itemEquip),o=0,c=e.length;c>o;o++){var g=e[o],r=a[g],l=r[0],_=0;if(void 0==r[6]){var u=n[l];u&&u[gc.t_itemEquip_isLocked]&&(_=u[gc.t_itemEquip_isLocked])}else _=r[6];i=t.BagDataCtrl.create(l,g,_),s.push(i)}return s.sort(t.BagDataCtrl.getSortOpt(1)),s},r.getEquipListUnlocked=function(e){for(var r,i,a=t.userCtrl.getEquipBag(),s=[],n=mo.getJSONWithFileName(gc.cfg_t_itemEquip),o=0,c=e.length;c>o;o++){var g=e[o],r=a[g],l=r[0],_=0;if(void 0==r[6]){var u=n[l];u&&u[gc.t_itemEquip_isLocked]&&(_=u[gc.t_itemEquip_isLocked])}else _=r[6];_||(i=t.BagDataCtrl.create(l,g,_),s.push(i))}return s},r.getEquipSalesInfo=function(){var e={1:[],2:[],3:[],4:[],5:[],below:[]};e.below=[];for(var r=t.equipCtrl.getEquipList(),i=t.userCtrl.getEquipBag(),a=mo.getJSONWithFileName(gc.cfg_t_sellItem),s=mo.getJSONWithFileName(gc.cfg_t_itemEquip),n=0,o=r.length;o>n;n++){var c=r[n],g=i[c],l=g[0],_=0;if(void 0==g[6]){var u=s[l];u&&u[gc.t_itemEquip_isLocked]&&(_=u[gc.t_itemEquip_isLocked])}else _=g[6];if(!_){var d=t.BagDataCtrl.create(l,c,_),p=d.quality,m=e[p];m?m.push(d):(m=[d],e[p]=m),d.level<=t.userCtrl.getLvl()-30&&e.below.push(d),a[l]&&(d.rewards=a[l][gc.t_sellItem_items])}}return e},r.pileItems=function(e){var r=[],i=mo.getJSONWithFileName(gc.cfg_t_item);for(var a in e){var s,n,o=e[a],c=i[a],g=c[gc.t_item_count];if(g=null==g?1:g,0!=g){s=Math.floor(o/g);for(var l=0;s>l;l++)n=t.BagDataCtrl.create(a,g),r.push(n),o-=g}o>0&&(n=t.BagDataCtrl.create(a,o),r.push(n))}return r},r.ON_BATCH_USE_EXP_ITEM="onBatchUseExpItem",r.ON_SOLD="onSold",r.ON_COUNT_CHANGED="onCountChanged",r}(mo.DataController);t.BagDataCtrl=m,egret.registerClass(m,"gd.BagDataCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._bossListData=null}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.BossData,this._isOpen=0},a.isGuildBoss=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_bossParameter);return null!=e[t]},a.getBackResOpt=function(t,e,r){void 0===r&&(r=0);for(var i=mo.getJSONWithFileName(gc.cfg_c_bossRes),a=i[t],s=[],n=0,o=0,c=[gc.c_bossRes_winCond1,gc.c_bossRes_winCond2,gc.c_bossRes_winCond3,gc.c_bossRes_winCond4,gc.c_bossRes_winCond5,gc.c_bossRes_winCond6,gc.c_bossRes_winCond7,gc.c_bossRes_winCond8,gc.c_bossRes_winCond9,gc.c_bossRes_winCond10],g=[gc.c_bossRes_winRes1,gc.c_bossRes_winRes2,gc.c_bossRes_winRes3,gc.c_bossRes_winRes4,gc.c_bossRes_winRes5,gc.c_bossRes_winRes6,gc.c_bossRes_winRes7,gc.c_bossRes_winRes8,gc.c_bossRes_winRes9,gc.c_bossRes_winRes10],l=[gc.c_bossRes_failCond1,gc.c_bossRes_failCond2,gc.c_bossRes_failCond3,gc.c_bossRes_failCond4,gc.c_bossRes_failCond5,gc.c_bossRes_failCond6,gc.c_bossRes_failCond7,gc.c_bossRes_failCond8,gc.c_bossRes_failCond9,gc.c_bossRes_failCond10],_=[gc.c_bossRes_failRes1,gc.c_bossRes_failRes2,gc.c_bossRes_failRes3,gc.c_bossRes_failRes4,gc.c_bossRes_failRes5,gc.c_bossRes_failRes6,gc.c_bossRes_failRes7,gc.c_bossRes_failRes8,gc.c_bossRes_failRes9,gc.c_bossRes_failRes10],u=0==r?c:l,d=0==r?g:_,p=0,m=u.length;m>p;p++){var f=u[p],h=a[f];if(!h)break;if(o=h[0],n=h[1],e>=o){s=a[d[p]];break}}var y={items:s,combatNeed:o,costDimond:n};return y},a.getReFightNum=function(){var e=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.enterBoss),r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.worldBossCfg][9],a=i-e;return 0>=a&&(a=0),a},a.getReRepeatNum=function(){var e=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.repeatBoss),r=mo.getJSONWithFileName(gc.cfg_c_vip),i=r[t.userCtrl.getVip()][gc.c_vip_guildBoss],a=i-e;return 0>=a&&(a=0),a},r.ON_BOSS_CALL_UPDATE="ON_BOSS_CALL_UPDATE",r.ON_WORLD_BOSS_OPEN_CHANGE="ON_WORLD_BOSS_OPEN_CHANGE",r}(mo.DataController);t.BossCtrl=e,egret.registerClass(e,"gd.BossCtrl"),t.bossCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this._entityDic={},this._isAutoFight=!1,this._openBossIds=[]},a.getOpenIds=function(){return this._openBossIds},a.getOpenIdsByType=function(e,r){for(var i=this,a=[],s=[],n=[],o=[],c=0;c<i._openBossIds.length;c++){var g=i._openBossIds[c];t.bossCtrl.isGuildBoss(g)?t.bossGuildCtrl.isLimitTime(g)?o.push(g):s.push(g):n.push(g)}switch(e){case gc.c_prop.worldBossTypeKey.world:a=n;break;case gc.c_prop.worldBossTypeKey.guild:a=r?o:s}return a},a.setOpenIds=function(e){e=e||[];var r=this,i=r._openBossIds.concat();r._openBossIds=e;for(var a=0;a<i.length;a++){var s=i[a];-1==r._openBossIds.indexOf(s)&&t.bossFightCtrl.getEntity(s).setIsOpen(0)}for(var a=0;a<r._openBossIds.length;a++){var s=r._openBossIds[a];t.bossFightCtrl.getEntity(s).setIsOpen(1)}},a.isAutoFight=function(){return this._isAutoFight},a.startAutoFight=function(){var t=this;t._isAutoFight=!0,t.startUpdateInterval2()},a.endAutoFight=function(){var t=this;t._isAutoFight=!1,t.clearUpdateIntervalId2()},a.getEntity=function(e){var r=this,i=r._getEntity(e);if(t.bossCtrl.isGuildBoss(e)){var a=t.bossGuildCtrl.getBossData(e);if(a){var s=a[gc.dsConsts.BossEntity.startTime],n=i.getStartTime();n&&s&&(s=Date.newDate(s),n.equals(s)||(r.delEntity(e),i=r._getEntity(e))),i.setStartTime(s)}}return i},a._getEntity=function(e){var r=this,i=r._entityDic[e];return i?i:(i=new t.BossFightEntityCtrl,i.setBossId(e),r._entityDic[e]=i,i)},a.delEntity=function(t){var e=this,r=e._entityDic[t];r&&(r.clearUpdateIntervalId1(),delete e._entityDic[t])},a.syncInspire=function(){var t=this;for(var e in t._entityDic){var r=t._entityDic[e];r.syncInspire()}},a.startUpdateInterval2=function(){var t=this;t.clearUpdateIntervalId2(),t._syncIntervalId2=mo.setInterval(t._update2,t,2e3)},a.clearUpdateIntervalId2=function(){var t=this;t._syncIntervalId2&&(mo.clearInterval(t._syncIntervalId2),t._syncIntervalId2=null)},a._update2=function(){var e=this;if(e._isAutoFight&&e._autoBossId){var r=e.getEntity(e._autoBossId);r.getFightCd()>0||t.fightCtrl.isSpFighting||r.isOver()||(e.pushNotify(e.__class.ON_BOSS_AUTO_FIGHT),r.startFight(function(){},this),e.clearUpdateIntervalId2())}},a.setAutoBossId=function(t){this._autoBossId=t},a.getAutoBossId=function(){return this._autoBossId},a.setCurFightBossId=function(t){this._curFightBossId=t},a.getCurFightBossId=function(){return this._curFightBossId},a.getLastExitTime=function(){return this._lastExitTime},a.setLastExitTime=function(t){this._lastExitTime=t},a.hasAutoFightBoss=function(){return this._autoBossId&&this._isAutoFight},r.ON_BOSS_CALL_UPDATE="ON_BOSS_CALL_UPDATE",r.ON_BOSS_AUTO_FIGHT="ON_BOSS_AUTO_FIGHT",r.ON_WORLD_BOSS_OPEN_CHANGE="ON_WORLD_BOSS_OPEN_CHANGE",r.BOSS_STATUS={fighting:2,sleep:3,cd:4,canCall:5,prize:6},r}(mo.DataController);t.BossFightCtrl=e,egret.registerClass(e,"gd.BossFightCtrl"),t.bossFightCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.BossData,this._hurtArr=[],this._isOver=!0,this._isOpen=0,this._roundHurt=0},a.setStartTime=function(t){var e=this;t&&(t=Date.newDate(t)),e._startTime=t},a.getStartTime=function(){return this._startTime},a.isOpen=function(){return 0!=this._isOpen},a.setIsOpen=function(e){var r=this,i=r._isOpen;r._isOpen!=e&&(r._isOpen=e,t.bossCtrl.isGuildBoss(r._bossId)?t.bossGuildCtrl.freshData(function(){r.pushNotify(r.__class.ON_WORLD_BOSS_OPEN_CHANGE)},r):t.bossWorldCtrl.freshData(function(){r.pushNotify(r.__class.ON_WORLD_BOSS_OPEN_CHANGE)},r),1==i&&r.onOver())},a.initilized=function(){var t=this;return t._data?!0:!1},a.setBossId=function(t){this._bossId=t},a.mData=function(t,e){var r=this,i=JSON.stringify(t),a=r.getMyKey();
return mo.md5(a+i+e)},a.enter=function(e,r){var i=this,a={},s=gc.iface.a_boss_enter_args;a[s.bossId]=i._bossId,mo.requestWaiting4Server(gc.iface.a_boss_enter,a,function(a){i.init(a);var s=i.get(gc.dsConsts.BossData.lastExitTime);t.bossFightCtrl.setLastExitTime(s);var n=i.get(gc.dsConsts.BossData.isOver);i._isOver=n,e.call(r,a)})},a.isSelfRepeat=function(){var e=this,r=e.get(gc.dsConsts.BossData.isRepeat),i=e.get(gc.dsConsts.BossData.callUserId);return r&&i==t.userCtrl.getId()?!0:!1},a.isSelfCall=function(){var e=this,r=e.get(gc.dsConsts.BossData.callUserGuildId);return r==t.guildCtrl.getId()?!0:!1},a.getMyKey=function(){return this.get(gc.dsConsts.BossData.myKey)},a.getTotalHp=function(){return this.get(gc.dsConsts.BossData.originHp)},a.getCurHp=function(){return this.get(gc.dsConsts.BossData.curHp)},a.getReOverSeconds=function(){var e=this,r=e.getType();return r==gc.c_prop.worldBossTypeKey.guild?t.bossGuildCtrl.getReDisappearSeconds(e._bossId):t.bossWorldCtrl.getReDisappearSeconds(e._bossId)},a.getOpenCd=function(){var e=this,r=e.getType();return r==gc.c_prop.worldBossTypeKey.guild?t.bossGuildCtrl.getOpenCd(e._bossId):t.bossWorldCtrl.getOpenCd(e._bossId)},a.getFightCd=function(){var e=t.bossFightCtrl.getLastExitTime();if(!e)return 0;e=Date.newDate(e);var r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.worldBossCfg][1],a=Date.newDate().getSecondsBetween(e.clone().addSeconds(i));return a=a>0?a:0},a.clearFightCd=function(e,r){var i={};mo.requestWaiting4Server(gc.iface.a_boss_clearFightCd,i,function(i){t.userCtrl.updateEntity(i),t.bossFightCtrl.setLastExitTime(Date.newDate().addDays(-1)),e.call(r,i)})},a.getMyHurt=function(){return this.get(gc.dsConsts.BossData.myHurt)},a.getType=function(){var e=this,r=t.bossCtrl.isGuildBoss(e._bossId);return r?gc.c_prop.worldBossTypeKey.guild:gc.c_prop.worldBossTypeKey.world},a.getMyRank=function(){return this.get(gc.dsConsts.BossData.myRank)},a.hurt=function(t,e){var r=this,i=r.getCurHp();0>i||(r.isLimitHp()?r._hurtArr.push([t,e,0]):(r._roundHurt+=t,i-=t,r._hurtArr.push([t,e,1])),0>i&&(i=0,r._pushHurt(1)),r.set(gc.dsConsts.BossData.curHp,i))},a.isLimitHp=function(){var e=this;if(!t.bossCtrl.isGuildBoss(e._bossId))return!1;var r=this.getTotalHp(),i=this._roundHurt/r;return i>.1},a._pushHurt=function(e){var r=this;if(!(r._isOver||(e=e||0,r._hurtArr.length<=0))){for(var i={},a=0,s=0,n=0;n<r._hurtArr.length;n++){var o=r._hurtArr[n],c=o[0],g=o[1],l=o[2],_=i[g]||[0,0,0],u=_[0]||0,d=_[1]||0,p=_[2]||0;u+=c,d++,l&&(p+=c),a+=c,s++,i[g]=[u,d,p]}r._hurtArr.length=0;var m={},f=gc.iface.a_boss_hurt_args;m[f.hurtDic]=i,m[f.isEnd]=e,m[f.mData]=1,m[f.bossId]=r.getBossId(),m[f.hurtArr]=[a,s],mo.request4Server(gc.iface.a_boss_hurt,m,function(e){var i=e[gc.dsConsts.ExTreasureBossData.bossData],a=e[gc.dsConsts.ExTreasureBossData.bagItem];if(i){if(a){var s={},n=t.userUtils.getNewBag({},a);s[gc.dsConsts.UserEntity.bag]=n,t.userCtrl.updateEntity(s)}var o=i[gc.dsConsts.BossData.isOver];r.updateEntity(i),o&&r.onOver()}})}},a.getBossId=function(){return this._bossId},a.getInspireHurt=function(){var t=this;return t._data?t.getInspireReSeconds()<=0?0:t.get(gc.dsConsts.BossData.inspireHurt):0},a.getCallUserName=function(){return this.get(gc.dsConsts.BossData.callUserName)},a.getCallUserGuildName=function(){return this.get(gc.dsConsts.BossData.callUserGuildName)},a.inspire=function(e,r){var i=this,a={},s=gc.iface.a_boss_inspire_args;a[s.bossId]=i.getBossId(),mo.requestWaiting4Server(gc.iface.a_boss_inspire,a,function(a){var s=a[gc.dsConsts.ExBossData.userData];s&&t.userCtrl.updateEntity(s);var n=a[gc.dsConsts.ExBossData.bossData];n&&i.updateEntity(n),mo.showMsg(gc.id_c_msgCode.inspireAdd),e.call(r,a)})},a.getInspireReSeconds=function(){var t=this,e=t.get(gc.dsConsts.BossData.inspireEndTime);e=Date.newDate(e);var r=Date.newDate().getSecondsBetween(e);return r=r>0?r:0},a.getInspireNum=function(){var t=this;return t._data?t.get(gc.dsConsts.BossData.inspireNum):0},a.getInspireRecordArr=function(t,e){var r=this,i={},a=gc.iface.a_boss_getInspireRecordArr_args;i[a.bossId]=r.getBossId(),mo.requestWaiting4Server(gc.iface.a_boss_getInspireRecordArr,i,function(r){t.call(e,r)})},a.syncInspire=function(){var t=this;if(t._data){var e={},r=gc.iface.a_boss_syncInspire_args;e[r.bossId]=t.getBossId(),mo.requestWaiting4Server(gc.iface.a_boss_syncInspire,e,function(e){e&&t.updateEntity(e)})}},a.getFirstHurtRank=function(t,e){var r=this;return r._firstHurtLastTime||(r._firstHurtLastTime=Date.newDate()),r._firstHurtRankData&&r._firstHurtLastTime.getSecondsBetween(Date.newDate())<10?t.call(e,r._firstHurtRankData):(r._firstHurtLastTime=Date.newDate(),void r._getFirstHurtRank(t,e))},a._getFirstHurtRank=function(t,e){var r=this,i={},a=gc.iface.a_boss_getFirstHurtRank_args;i[a.bossId]=r.getBossId(),mo.request4Server(gc.iface.a_boss_getFirstHurtRank,i,function(i){r._firstHurtRankData=i,t.call(e,i)})},a.getHurtRankList=function(t,e){var r=this,i={},a=gc.iface.a_boss_getHurtRankList_args;i[a.bossId]=r.getBossId(),mo.request4Server(gc.iface.a_boss_getHurtRankList,i,function(r){t.call(e,r)})},a.getFightableLvl=function(){var t=this,e=t.getType(),r=t.getBossId(),i=0;if(e==gc.c_prop.worldBossTypeKey.guild){var a=mo.getJSONWithFileName(gc.cfg_c_bossParameter),s=a[r];i=s[gc.c_bossParameter_fightLvl]}return i},a.getFightMaxLvl=function(){var t=this,e=t.getType(),r=t.getBossId(),i=99999;if(e==gc.c_prop.worldBossTypeKey.guild){var a=mo.getJSONWithFileName(gc.cfg_c_bossParameter),s=a[r];i=s[gc.c_bossParameter_maxLvl]}return i},a.startFight=function(e,r){var i=this,a=i.getBossId();if(i.getFightCd()>0)return mo.showMsg(gc.id_c_msgCode.challengeBossCd);var s=i.getFightableLvl(),n=i.getFightMaxLvl();if(t.userCtrl.getLvl()<s||t.userCtrl.getLvl()>n)return mo.showMsg(gc.id_c_msgCode.noLvlchallengeBoss,s,n);if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");var o={},c=gc.iface.a_boss_startFight_args;o[c.bossId]=a,mo.requestWaiting4Server(gc.iface.a_boss_startFight,o,function(s){i._roundHurt=0;var n=s[gc.dsConsts.ExBossData.bossData],o=s[gc.dsConsts.ExBossData.userData];o&&t.userCtrl.updateEntity(o);var c=n[gc.dsConsts.BossData.isFirstEnter];c&&(i._hurtArr.length=0),i._isOver=!1,t.fightCtrl.isSpFighting=!0,t.bossFightCtrl.setCurFightBossId(a),i._startUpdateInterval1(),t.bossFightCtrl.clearUpdateIntervalId2(),t.curBFECtrl=i,mo.moduleMgr.curModule.name==g_consts.moduleId.home?mo.moduleMgr.runModule(g_consts.moduleId.fight):i.pushNotify(i.__class.START_FIGHT_BOSS_IN_FIGHT_SCENE),t.fightLayer.onEnterWorldBoss({bossId:i.getBossId()}),i.pushNotify(i.__class.ON_START_FIGHT_BOSS),e.call(r,n)})},a.exitFight=function(e,r){var i=this,a=i.getBossId(),s={},n=gc.iface.a_boss_exitFight_args;s[n.bossId]=a,i._pushHurt(1),mo.requestWaiting4Server(gc.iface.a_boss_exitFight,s,function(a){i.clearUpdateIntervalId1(),t.bossFightCtrl.startUpdateInterval2(),t.bossFightCtrl.setLastExitTime(Date.newDate()),t.bossFightCtrl.setCurFightBossId(null),e.call(r,a)})},a.getBossResult=function(t,e){var r=this,i=r.getBossId(),a={},s=gc.iface.a_boss_getBossResult_args;a[s.bossId]=i,a[s.originBossId]=r.getOriginBossId(),mo.requestWaiting4Server(gc.iface.a_boss_getBossResult,a,function(r){t.call(e,r)})},a.getOriginBossId=function(){var e=this,r=e.getType();return r==gc.c_prop.worldBossTypeKey.guild?t.bossGuildCtrl.getOriginBossId(e._bossId):t.bossWorldCtrl.getOriginBossId(e._bossId)},a.getResultData=function(t,e){var r=this,i={},a=gc.iface.a_boss_getResultData_args;i[a.originBossId]=r.getOriginBossId(),mo.requestWaiting4Server(gc.iface.a_boss_getResultData,i,function(r){t.call(e,r)})},a.isOver=function(){return this._isOver},a._startUpdateInterval1=function(){var t=this;t.clearUpdateIntervalId1(),t._syncIntervalId1=mo.setInterval(t._update1,t,3e3)},a._update1=function(){var t=this;t._pushHurt(0)},a.clearUpdateIntervalId1=function(){var t=this;t._syncIntervalId1&&(mo.clearInterval(t._syncIntervalId1),t._syncIntervalId1=null)},a.onChangeData=function(){},a.onOver=function(){var e=this;if(!e._isOver){e._isOver=!0,t.bossFightCtrl.endAutoFight(),e._hurtArr.length=0,e.setIsOpen(0),e._getFirstHurtRank(function(){},this),e.clearUpdateIntervalId1();var r=e.getMyHurt();r>0&&t.fightLayer.onWorldBossOver(e),e.exitFight(function(){},e)}},r.START_FIGHT_BOSS_IN_FIGHT_SCENE="START_FIGHT_BOSS_IN_FIGHT_SCENE",r.ON_START_FIGHT_BOSS="ON_START_FIGHT_BOSS",r.ON_WORLD_BOSS_OPEN_CHANGE="ON_WORLD_BOSS_OPEN_CHANGE",r}(mo.DataController);t.BossFightEntityCtrl=e,egret.registerClass(e,"gd.BossFightEntityCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.BossData,this._bossListData={}},a.getInfo=function(t,e){var r=this;r._initGuild(function(){mo.requestWaiting4Server(gc.iface.a_boss_getGuildBossList,{},function(i){var a=i[gc.dsConsts.ExBossEntity.otherData];r._otherData=a;var s=i[gc.dsConsts.ExBossEntity.bossList];r._bossListData={};for(var n=0;n<s.length;n++){var o=s[n],c=o[gc.dsConsts.BossEntity.bossId];r._bossListData[c]=o}t.call(e)})},r)},a.getBossData=function(t){var e=this;return e._bossListData[t]},a.freshData=function(t,e){var r=this;r._initGuild(function(){mo.request4Server(gc.iface.a_boss_getGuildBossList,{},function(i){var a=i[gc.dsConsts.ExBossEntity.otherData];r._otherData=a;var s=i[gc.dsConsts.ExBossEntity.bossList];r._bossListData={};for(var n=0;n<s.length;n++){var o=s[n],c=o[gc.dsConsts.BossEntity.bossId];r._bossListData[c]=o}t.call(e)})},r)},a._initGuild=function(e,r){t.guildCtrl.getData()?e.call(r):t.guildCtrl.getInfo(e,r)},a.hasFightingBoss=function(){var e=this;for(var r in e._bossListData){var i=r,a=e.getBossStatus(i);if(a==t.BossFightCtrl.BOSS_STATUS.fighting)return!0}return!1},a.hasGuildFightingBoss=function(){var e=this;for(var r in e._bossListData){var i=r,a=e.getBossStatus(i);if(a==t.BossFightCtrl.BOSS_STATUS.fighting){var s=e.getOtherData(i),n=s[0];if(n&&t.guildCtrl.getData()&&n==t.guildCtrl.get(gc.dsConsts.GuildEntity.id))return!0}}return!1},a.getOtherData=function(t){var e=this,r=e._otherData[t];return r},a.isLimitTime=function(t){var e=this,r=e._bossListData[t],i=r[gc.dsConsts.BossEntity.isLimit];return i},a.getLimitStartTime=function(t){var e=this,r=e._bossListData[t];return r[gc.dsConsts.BossEntity.limitStartTime]},a.getLimitEndTime=function(t){var e=this,r=e._bossListData[t];return r[gc.dsConsts.BossEntity.limitEndTime]},a.getOriginBossId=function(t){var e=this,r=e._bossListData[t];return r[gc.dsConsts.BossEntity.originBossId]},a.getBossStatus=function(e){var r=this,i=r._bossListData[e],a=i[gc.dsConsts.BossEntity.status];if(1==a)return t.BossFightCtrl.BOSS_STATUS.fighting;if(2==a)return t.BossFightCtrl.BOSS_STATUS.prize;var s=Date.newDate();if(s.isBefore(r.getOpenStartTime())||s.isAfter(r.getOpenEndTime()))return t.BossFightCtrl.BOSS_STATUS.sleep;var n=r.getOpenCd(e);return n>0?t.BossFightCtrl.BOSS_STATUS.cd:t.BossFightCtrl.BOSS_STATUS.canCall},a.getOpenStartTime=function(){var t=mo.getJSONWithFileName(gc.cfg_c_game),e=t[gc.id_c_game.worldBossCfg][5],r=parseInt(e.split(";")[0]),i=parseInt(e.split(";")[1]),a=Date.newDate().clearTime();return a.addHours(r).addMinutes(i),a},a.getOpenEndTime=function(){var t=mo.getJSONWithFileName(gc.cfg_c_game),e=t[gc.id_c_game.worldBossCfg][6],r=parseInt(e.split(";")[0]),i=parseInt(e.split(";")[1]),a=Date.newDate().clearTime();return a.addHours(r).addMinutes(i),a},a.getOpenCd=function(t){var e=this,r=e._bossListData[t],i=mo.getJSONWithFileName(gc.cfg_c_bossParameter),a=i[t],s=a[gc.c_bossParameter_summonCd],n=r[gc.dsConsts.BossEntity.deathTime]||Date.newDate().addDays(-10);n=new Date(n);var o=n.getSecondsBetween(Date.newDate()),c=s-o;return c=c>0?c:0},a.getReDisappearSeconds=function(t){var e=this,r=e._bossListData[t],i=r[gc.dsConsts.BossEntity.startTime];i=new Date(i);var a=mo.getJSONWithFileNameAndID(gc.cfg_c_bossParameter,t),s=a[gc.c_bossParameter_timeLimit],n=Date.newDate().getSecondsBetween(i.clone().addSeconds(s));return n=n>0?n:0},a.getRePrizeSeconds=function(t){var e=this,r=e._bossListData[t],i=r[gc.dsConsts.BossEntity.endTime];i=new Date(i);var a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.worldBossCfg][8],n=Date.newDate().getSecondsBetween(i.clone().addSeconds(s));return n=n>0?n:0},a.isInStartTime=function(t){var e=this,r=!0,i=(e._bossListData[t],e.isLimitTime(t));if(i){var a=Date.newDate(e.getLimitStartTime(t)),s=Date.newDate(e.getLimitEndTime(t)),n=Date.newDate();(n.isBefore(a)||n.isAfter(s))&&(r=!1)}return r},a.isInWeek=function(t){var e=this,r=e._bossListData[t],i=r[gc.dsConsts.BossEntity.week];if(0>=i)return!0;var a=Date.newDate(),s=a.getDay();return 7==i&&0==s?!0:i==s?!0:!1},a.getWeek=function(t){var e=this,r=e._bossListData[t],i=r[gc.dsConsts.BossEntity.week];return i},a.getWeekBossData=function(){var t=this,e={},r=mo.getJSONWithFileName(gc.cfg_c_bossParameter);for(var i in t._bossListData)if(t.isInStartTime(i)&&t.isLimitTime(i)){var a=r[i];if(a[gc.c_bossParameter_isOpen]){var s=t._bossListData[i][gc.dsConsts.BossEntity.week],n=e[s]||[];n.push(i),e[s]=n}}return e},a.getLimitBossList=function(e){var r=this,i=[],a=mo.getJSONWithFileName(gc.cfg_c_bossParameter);for(var s in r._bossListData)if(r.isInStartTime(s)&&r.isLimitTime(s)&&r.isInWeek(s)){var n=a[s];if(n[gc.c_bossParameter_isOpen]){var o=r.getBossStatus(s);if(e){if(o!=t.BossFightCtrl.BOSS_STATUS.fighting)continue}else if(o==t.BossFightCtrl.BOSS_STATUS.fighting)continue;i.push(n)}}return i.sort(function(t,e){return t[gc.c_bossParameter_sort]-e[gc.c_bossParameter_sort]}),i},a.getBossList=function(e,r){var i=this,a=[],s=mo.getJSONWithFileName(gc.cfg_c_bossParameter);for(var n in i._bossListData)if(i.isInStartTime(n)&&!i.isLimitTime(n)){var o=s[n];if(o[gc.c_bossParameter_isOpen]){var c=i.getBossStatus(n);if(e){if(c!=t.BossFightCtrl.BOSS_STATUS.fighting)continue}else{if(c==t.BossFightCtrl.BOSS_STATUS.fighting)continue;var g=mo.getJSONWithFileNameAndID(gc.cfg_t_monster,n);if(g[gc.t_monster_level]!=r)continue}a.push(o)}}return a.sort(function(t,e){return t[gc.c_bossParameter_sort]-e[gc.c_bossParameter_sort]}),a},a.getLockCost=function(){var t=mo.getJSONWithFileName(gc.cfg_c_game);return t[gc.id_c_game.newBossCfg][2]},a.getOpenChannelCost=function(){var t=mo.getJSONWithFileName(gc.cfg_c_game);return t[gc.id_c_game.newBossCfg][1]},a.getRepeatCount=function(t){var e=this,r=e._bossListData[t],i=r[gc.dsConsts.BossEntity.repeatTime];return i||(i=Date.newDate()),i=Date.newDate(i),r[gc.dsConsts.BossEntity.repeatTime]=i,Date.newDate().equalsDay(r[gc.dsConsts.BossEntity.repeatTime])||(r[gc.dsConsts.BossEntity.repeatCount]=0),r[gc.dsConsts.BossEntity.repeatCount]},a.getRepeatCost=function(e,r){var i=this,a=0,s=i.getRepeatCount(e),n=mo.getJSONWithFileNameAndID(gc.cfg_t_monster,e),o=t.bossFightCtrl.getEntity(e),c=o.getOpenCd(),g=gc.calGuildBossRepeat(n[gc.t_monster_level],c,s);if(g=parseInt(g.toString()),a+=g,r){var l=mo.getJSONWithFileName(gc.cfg_c_game),_=l[gc.id_c_game.newBossCfg][2];a+=_}return a},a.openBoss=function(e,r,i,a){var s=this;if(!t.guildCtrl.isOpenBoss())return mo.showMsg("此功能暂时关闭！");if(!s.isInStartTime(e))return mo.showMsg(gc.id_c_msgCode.timeOutCantCall);var n={},o=gc.iface.a_boss_openBoss_args;n[o.bossId]=e,n[o.isLock]=r,mo.requestWaiting4Server(gc.iface.a_boss_openBoss,n,function(r){t.bossFightCtrl.delEntity(e);var n=r[gc.dsConsts.ExBossData.bossEntity];s._bossListData[e]=n;var o=r[gc.dsConsts.ExBossData.userData],c=r[gc.dsConsts.ExBossData.delBagItems]||{},g=t.userUtils.getNewBag(c,{});o[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(o),s.pushNotify(s.__class.ON_BOSS_CALL_UPDATE),i.call(a,r)})},a.getNotKillNumByLvl=function(e){var r=this,i=0,a=mo.getJSONWithFileName(gc.cfg_c_bossParameter);for(var s in r._bossListData)if(r.isInStartTime(s)&&!r.isLimitTime(s)){var n=a[s];if(n[gc.c_bossParameter_isOpen]){var o=mo.getJSONWithFileNameAndID(gc.cfg_t_monster,s);if(o[gc.t_monster_level]==e){var c=r.getBossStatus(s);c!=t.BossFightCtrl.BOSS_STATUS.cd&&c!=t.BossFightCtrl.BOSS_STATUS.prize&&i++}}}return i},a.checkAndShowLvlEnough=function(e){var r=mo.getJSONWithFileName(gc.cfg_c_bossParameter),i=r[e];return t.userCtrl.getLvl()<i[gc.c_bossParameter_fightLvl]?(mo.showMsg(gc.id_c_msgCode.noLvlchallengeBoss,i[gc.c_bossParameter_fightLvl]),!1):!0},r.ON_BOSS_CALL_UPDATE="ON_BOSS_CALL_UPDATE",r.ON_WORLD_BOSS_OPEN_CHANGE="ON_WORLD_BOSS_OPEN_CHANGE",r}(mo.DataController);t.BossGuildCtrl=e,egret.registerClass(e,"gd.BossGuildCtrl"),t.bossGuildCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.BossData},a.getInfo=function(t,e){var r=this;r._initGuild(function(){mo.requestWaiting4Server(gc.iface.a_boss_getWorldBossList,{},function(i){var a=i[gc.dsConsts.ExBossEntity.otherData];r._otherData=a;var s=i[gc.dsConsts.ExBossEntity.nowDate];r._nowDate=Date.newDate(s);var n=i[gc.dsConsts.ExBossEntity.bossList];r._bossListData={};for(var o=0;o<n.length;o++){var c=n[o],g=c[gc.dsConsts.BossEntity.bossId];r._bossListData[g]=c}t.call(e)})},r)},a.freshData=function(t,e){var r=this;r._initGuild(function(){mo.request4Server(gc.iface.a_boss_getWorldBossList,{},function(i){var a=i[gc.dsConsts.ExBossEntity.otherData];r._otherData=a;var s=i[gc.dsConsts.ExBossEntity.bossList];r._bossListData={};for(var n=0;n<s.length;n++){var o=s[n],c=o[gc.dsConsts.BossEntity.bossId];r._bossListData[c]=o}t.call(e)})},r)},a._initGuild=function(e,r){t.guildCtrl.getData()?e.call(r):t.guildCtrl.getInfo(e,r)},a.getBossData=function(t){var e=this;for(var r in e._bossListData)return e._bossListData[r];return null},a.getOtherData=function(t){var e=this,r=e._otherData[t];return r},a.isLimitTime=function(t){var e=this,r=e.getBossData(t),i=r[gc.dsConsts.BossEntity.isLimit];return i},a.getLimitStartTime=function(t){var e=this,r=e.getBossData(t);return r[gc.dsConsts.BossEntity.limitStartTime]},a.getLimitEndTime=function(t){var e=this,r=e.getBossData(t);return r[gc.dsConsts.BossEntity.limitEndTime]},a.getOriginBossId=function(t){var e=this,r=e.getBossData(t);return r[gc.dsConsts.BossEntity.originBossId]},a.getBossStatus=function(e){var r=this,i=r.getBossData(e),a=i[gc.dsConsts.BossEntity.status];if(1==a)return t.BossFightCtrl.BOSS_STATUS.fighting;if(2==a)return t.BossFightCtrl.BOSS_STATUS.prize;var s=r.getOpenStartTime(e),n=r.getOpenEndTime(e);if(r._nowDate.isBefore(s)||r._nowDate.isAfter(n))return t.BossFightCtrl.BOSS_STATUS.sleep;var o=i[gc.dsConsts.BossEntity.deathTime];return o&&(o=Date.newDate(o),r._nowDate.isAfter(s)&&r._nowDate.isBefore(n))?t.BossFightCtrl.BOSS_STATUS.cd:t.BossFightCtrl.BOSS_STATUS.fighting},a.getDeathBossId=function(t){var e=this,r=e.getBossData(t);return r[gc.dsConsts.BossEntity.deathBossId]||t},a.getOpenStartTime=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_bossWorld,t),r=e[gc.c_bossWorld_startTime],i=parseInt(r[0]),a=parseInt(r[1]),s=this._nowDate.clone().clearTime();return s.addHours(i).addMinutes(a),s},a.getOpenEndTime=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_bossWorld,t),r=e[gc.c_bossWorld_endTime],i=parseInt(r[0]),a=parseInt(r[1]),s=this._nowDate.clone().clearTime();return s.addHours(i).addMinutes(a),s},a.getReDisappearSeconds=function(t){var e=this,r=e.getOpenEndTime(t),i=this._nowDate.clone().getSecondsBetween(r);return i=i>0?i:0},a.getRePrizeSeconds=function(t){var e=this,r=e.getBossData(t),i=r[gc.dsConsts.BossEntity.endTime];i=Date.newDate(i);var a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.worldBossCfg][8],n=e._nowDate.getSecondsBetween(i.clone().addSeconds(s));return n=n>0?n:0},a.isInStartTime=function(t){var e=this,r=!0,i=(e.getBossData(t),e.isLimitTime(t));if(i){var a=Date.newDate(e.getLimitStartTime(t)),s=Date.newDate(e.getLimitEndTime(t)),n=e._nowDate.clone();(n.isBefore(a)||n.isAfter(s))&&(r=!1)}return r},a.getBossList=function(){var t=this,e=[],r=mo.getJSONWithFileName(gc.cfg_c_bossWorld);for(var i in t._bossListData)if(t.isInStartTime(i)){var a=r[i];e.push(a)}return e.sort(function(t,e){return t[gc.c_bossParameter_sort]-e[gc.c_bossParameter_sort]}),e},a.getOpenCd=function(t){return 0},r.ON_BOSS_CALL_UPDATE="ON_BOSS_CALL_UPDATE",r.ON_WORLD_BOSS_OPEN_CHANGE="ON_WORLD_BOSS_OPEN_CHANGE",r.BOSS_STATUS={fighting:2,sleep:3,cd:4,canCall:5,prize:6},r}(mo.DataController);t.BossWorldCtrl=e,egret.registerClass(e,"gd.BossWorldCtrl"),t.bossWorldCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._channelMsg=[],this._syncSeconds=5,this.isFollowNormalUser=1,this.isAutoBuyLaba=0}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._lastId=0,t._lastTime=Date.newDate(),t._allList=[],t._vipList=[],t._importantList=[],t._lotteryList=[],t._guildLotteryList=[],t._guildLastId=0,t._guildList=[]},a.initData=function(t){var e=this;e.syncData()},a.getLastId=function(){return this._lastId},a.getGuildLastId=function(){return this._guildLastId},a.getNoticeList=function(){return null},a.delNotice=function(t){},a.getAllList=function(){var t=this;return t.isFollowNormalUser?t._allList:t._vipList},a.getImportantList=function(){return this._importantList},a.getGuildAllList=function(){return this._guildList},a.getLotteryList=function(){return this._lotteryList},a.getGuildLotteryList=function(){return this._guildLotteryList},a.getLastDiffSeconds=function(){return 0},a.followModeChange=function(){var t=this;t.pushNotify(t.__class.ON_MODE_UPDATE)},a.sendData=function(e,r,i,a,s){var n=this;if(r!=gc.c_prop.chatTypeKey.user&&r!=gc.c_prop.chatTypeKey.guild)return mo.showMsg("聊天类型错误");if(t.accountCtrl.isGuest())return mo.showMsg(gc.id_c_msgCode.touristForbidTalk);if(t.accountCtrl.getStatus()<4&&t.userCtrl.getLvl()<30)return mo.showMsg(gc.id_c_msgCode.noLvlToTalk);var o=mo.getJSONWithFileName(gc.cfg_c_game),c=o[gc.id_c_game.fuckWord][0].split(","),g=o[gc.id_c_game.chatCfg][1],l=o[gc.id_c_game.chatCfg][3];if(null==e||""==e)return mo.showMsg(gc.id_c_msgCode.noWord);if(mo.STR.getStringLength(e)>l)return mo.showMsg(gc.id_c_msgCode.wordTooLong);if(mo.STR.checkSensitiveWord(e,c))return mo.showMsg(gc.id_c_msgCode.wordIllegal);if(n._lastSendTime&&r==gc.c_prop.chatTypeKey.user&&n._lastSendTime.getSecondsBetween(Date.newDate())<g)return mo.showMsg(gc.id_c_msgCode.wordTooFast);n._lastSendTime=Date.newDate();var _=0;t.guildCtrl.getData()&&(_=t.guildPersonalCtrl.getGuildId());var u=gc.iface.a_chat_sendData_args,d={};d[u.content]=e,d[u.type]=r,d[u.lastId]=n._lastId,d[u.guildId]=_,d[u.guildLastId]=n._guildLastId,d[u.isLittleHorn]=i?1:0,mo.requestWaiting4Server(gc.iface.a_chat_sendData,d,function(e){var r=e[gc.dsConsts.AllChatData.worldChat],i=e[gc.dsConsts.AllChatData.guildChat],o=e[gc.dsConsts.AllChatData.isOri];if(!o){var c=e[gc.dsConsts.AllChatData.guildId];t.guildPersonalCtrl.set(gc.dsConsts.GuildPersonalEntity.guildId,c),n.pushNotify(n.__class.ON_GUILD_CHANGED)}n._updateData(r),n._updateGuildData(i,o);var g=e[gc.dsConsts.AllChatData.userData],l=e[gc.dsConsts.AllChatData.delBagItems];if(g){var _=t.userUtils.getNewBag(l,{});g[gc.dsConsts.UserEntity.bag]=_,t.userCtrl.updateEntity(g)}a.call(s)})},a.openWindow=function(){var t=this;t.syncData(),t.onNewAll()},a.closeWindow=function(){},a.updateNewMsg=function(t){var e=this;t>e._lastId&&e.syncData()},a.syncData=function(){var e=this,r=0;t.guildCtrl.getData()&&(r=t.guildPersonalCtrl.getGuildId());var i=gc.iface.a_chat_getNewList_args,a={};a[i.lastId]=e._lastId,a[i.guildId]=r,a[i.guildLastId]=e._guildLastId,mo.request4Server(gc.iface.a_chat_getNewList,a,function(r){var i=r[gc.dsConsts.AllChatData.worldChat],a=r[gc.dsConsts.AllChatData.guildChat],s=r[gc.dsConsts.AllChatData.isOri];if(!s){var n=r[gc.dsConsts.AllChatData.guildId];t.guildPersonalCtrl.set(gc.dsConsts.GuildPersonalEntity.guildId,n),e.pushNotify(e.__class.ON_GUILD_CHANGED)}e._updateData(i),e._updateGuildData(a,s)})},a.getChatDataStr=function(t){var e=t[gc.dsConsts.ChatData.type],r="";if(e==gc.c_prop.chatTypeKey.user){var i=t[gc.dsConsts.ChatData.userArgs],a=i[3],s=i[4],n=i[2];a?r=mo.STR.format("[ubb color=#ff0000]【GM %s】%s[/ubb]",i[0],n):(r=i[1]>0?mo.STR.format("[ubb color=#ffad00]VIP%s [/ubb][ubb color=#00cdff]%s: [/ubb][ubb color=#ffffff]%s[/ubb]",i[1],i[0],n):mo.STR.format("[ubb color=#00cdff]%s: [/ubb][ubb color=#ffffff]%s[/ubb]",i[0],n),""!=s&&(r=mo.STR.format("[ubb color=#e76df5]%s[/ubb]",mo.trans4UBB(mo.STR.format("[%s]",s)))+r))}else if(e==gc.c_prop.chatTypeKey.guild){var o=t[gc.dsConsts.ChatData.guildArgs];r=mo.STR.format("%s%s[ubb color=#00cdff]%s: [/ubb][ubb color=#ffffff]%s[/ubb]",o[2]==gc.c_prop.guildPostKey.rankFile?"":mo.STR.format("[ubb color=#F6EC6B][%s][/ubb]",gc.c_prop.guildPost[o[2]]),o[1]>0?mo.STR.format("[ubb color=#ffad00]VIP%s [/ubb]",o[1]):"",o[0],o[3])}else{var c=t[gc.dsConsts.ChatData.sysArgs],g=mo.getJSONWithFileNameAndID(gc.cfg_c_chatSys,c[0]);r="【系统】",2==c.length?r+=mo.STR.format(g[gc.c_chatSys_text],c[1]):3==c.length?r+=mo.STR.format(g[gc.c_chatSys_text],c[1],c[2]):4==c.length?r+=mo.STR.format(g[gc.c_chatSys_text],c[1],c[2],c[3]):5==c.length?r+=mo.STR.format(g[gc.c_chatSys_text],c[1],c[2],c[3],c[4]):6==c.length?r+=mo.STR.format(g[gc.c_chatSys_text],c[1],c[2],c[3],c[4],c[5]):7==c.length?r+=mo.STR.format(g[gc.c_chatSys_text],c[1],c[2],c[3],c[4],c[5],c[6]):8==c.length&&(r+=mo.STR.format(g[gc.c_chatSys_text],c[1],c[2],c[3],c[4],c[5],c[6],c[7]))}return r},a._updateData=function(e){var r=this,i=mo.getJSONWithFileName(gc.cfg_c_chatSys),a={},s=[];if(r._channelMsg.length>0){var n=r._channelMsg.slice(-1)[0];s.push({1:n[1],2:n[2],3:[n[3][0],n[3][1]]})}for(var o=0,c=0;c<e.length;c++){var g=e[c],l=g[gc.dsConsts.ChatData.type];if(l==gc.c_prop.chatTypeKey.sys||l==gc.c_prop.chatTypeKey.lottery){var _=g[gc.dsConsts.ChatData.sysArgs],u=_[0];if(51==u){var d=_[1];d!=t.userCtrl.getName()&&mo.showMsg(gc.id_c_msgCode.kingCome,_[1])}if(50==u){var d=_[2];d==t.userCtrl.getName()&&(t.userCtrl.setIsKing(!0),t.heroCtrl.calPropAndCombat())}if(60==u&&t.userCtrl.getIsKing()&&(t.heroCtrl.calPropAndCombat(),t.userCtrl.setIsKing(!1)),39==u){var p=_[1];t.guildCtrl.getData()&&p==t.guildCtrl.get(gc.dsConsts.GuildEntity.name)&&(o=1)}if(75==u){var m=_[3],f=_[4];f==t.userCtrl.getId()&&t.userCtrl.updateBagItems(m,function(){},r),_[3]="",_[4]=""}var h=i[u];h[gc.c_chatSys_ifNotice]?(a[0]=1,s.push(g)):h[gc.c_chatSys_ifImport]?(a[4]=1,r._pushImportantList(g)):(a[1]=1,r._pushAllList(g),r._pushVipList(g))}l==gc.c_prop.chatTypeKey.user&&(a[1]=1,r._pushAllList(g),(g[gc.dsConsts.ChatData.userArgs][0]==t.userCtrl.getName()||g[gc.dsConsts.ChatData.userArgs][1]>0||1==g[gc.dsConsts.ChatData.userArgs][6])&&r._pushVipList(g)),l==gc.c_prop.chatTypeKey.lottery&&(a[2]=1,r._pushLotteryList(g)),l==gc.c_prop.chatTypeKey.guildLottery&&(a[3]=1,r._pushGuildLotteryList(g)),r._lastId=g[gc.dsConsts.ChatData.uniqueId],o&&t.bossFightCtrl.syncInspire()}e.length>0&&(this._lastTime=Date.newDate()),a[0]&&t.hoodinnCtlr.pushNotices(s),a[1]&&r.onNewAll(),a[2]&&r.onNewLottery(),a[3]&&r.onNewGuildLottery(),a[4]&&r.onNewImportant()},a._updateGuildData=function(t,e){for(var r=this,i={},a=0;a<t.length;a++){var s=t[a],n=s[gc.dsConsts.ChatData.type];n==gc.c_prop.chatTypeKey.guild&&(i[1]=1,r._pushGuildAllList(s)),r._guildLastId=s[gc.dsConsts.ChatData.uniqueId]}i[1]&&r.onNewGuildChat()},a._pushAllList=function(t){var e=this;e._allList.push(t);var r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.chatCfg][2];e._allList.length>i&&e._allList.shift()},a._pushImportantList=function(t){var e=this;e._importantList.push(t);var r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.chatCfg][2];e._importantList.length>i&&e._importantList.shift()},a._pushGuildAllList=function(t){var e=this;e._guildList.push(t);var r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.chatCfg][2];e._guildList.length>i&&e._guildList.shift()},a._pushLotteryList=function(t){var e=this;e._lotteryList.push(t),e._lotteryList.length>10&&e._lotteryList.shift()},a._pushGuildLotteryList=function(t){var e=this;e._guildLotteryList.push(t),e._guildLotteryList.length>10&&e._guildLotteryList.shift()},a._pushVipList=function(t){var e=this;e._vipList.push(t);var r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.chatCfg][2];e._vipList.length>i&&e._vipList.shift()},a.newChannelNotice=function(t){var e=this;e._channelMsg.push(t)},a.onNewAll=function(){var t=this;t.pushNotify(t.__class.ON_CHAT_UPDATE,t.getAllList())},a.onNewLottery=function(){var t=this;t.pushNotify(t.__class.ON_LOTTERY_UPDATE,t.getLotteryList())},a.onNewGuildLottery=function(){var t=this;t.pushNotify(t.__class.ON_GUILD_LOTTERY_UPDATE,t.getGuildLotteryList())},a.onNewGuildChat=function(){var t=this;t.pushNotify(t.__class.ON_GUILD_CHAT_UPDATE,t.getGuildAllList())},a.onNewImportant=function(){var t=this;t.pushNotify(t.__class.ON_IMPOTANT_UPDATE,t.getImportantList())},r.ON_GUILD_CHAT_UPDATE="ON_GUILD_CHAT_UPDATE",r.ON_CHAT_UPDATE="ON_CHAT_UPDATE",r.ON_NOTICE_UPDATE="ON_NOTICE_UPDATE",r.ON_LOTTERY_UPDATE="ON_LOTTERY_UPDATE",r.ON_GUILD_LOTTERY_UPDATE="ON_GUILD_LOTTERY_UPDATE",r.ON_GUILD_CHANGED="ON_GUILD_CHANGED",r.ON_IMPOTANT_UPDATE="ON_IMPOTANT_UPDATE",r.ON_MODE_UPDATE="ON_MODE_UPDATE",r.ON_TREASURE_LOST="ON_TREASURE_LOST",r}(mo.DataController);t.ChatCtrl=e,egret.registerClass(e,"gd.ChatCtrl"),t.chatCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.getActionData=function(t){var e=Date.newDate().clearTime();t=t||Date.newDate();var r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.coffers),i=parseInt(r[20]),a=parseInt(r[21]),s=parseInt(r[22]),n=e.getMinutesBetween(t),o=Math.floor(n/i),c=60*i-e.getSecondsBetween(t)+o*i*60,g=a+o*s;return[g,c]}}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.CoffersEntity,this._lastData=[]},a.getInfo=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_coffers_getInfo,{},function(i){r.init(i),t&&t.call(e,i)})},a.getNextWinPoints=function(){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.coffers2),r=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.coffersWin),i=e[8];return r>0&&(i+=e[6]),i},a.getCoffersWin=function(){return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.coffersWin)},a.getPersonResource=function(){var e=this,r=t.userCtrl.getLvl(),i=e.get(gc.dsConsts.CoffersEntity.resource),a=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.coffers),s=a[5],n=s.split(","),o=gc.calCoffersPersonRecource(r,i,parseFloat(n[0]),parseFloat(n[1]));return o},a.getLootRecordArr=function(t,e){mo.requestWaiting4Server(gc.iface.a_coffers_getLootRecordArr,{},function(r){t.call(e,r.reverse())})},a.build=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_coffers_build,{},function(a){var s=a[gc.dsConsts.ExCoffers.coffers];i.updateEntity(s);var n=a[gc.dsConsts.ExCoffers.userData];t.userCtrl.updateEntityNotShow(n),mo.showMsg("金币+"+a[gc.dsConsts.ExCoffers.addGold]+" 建设值+"+a[gc.dsConsts.ExCoffers.addBuildValue]),e&&e.call(r,a)})},a.getBuildNum=function(){return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.coffersBuild)},a.addBuff=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_coffers_addBuff,{},function(a){var s=a[gc.dsConsts.ExCoffers.coffers];i.updateEntity(s);var n=a[gc.dsConsts.ExCoffers.userData],o=a[gc.dsConsts.ExCoffers.delBagItems]||{},c=t.userUtils.getNewBag(o,{});n[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntityNotShow(n),mo.showMsg("激励值+"+a[gc.dsConsts.ExCoffers.addBuffExpc]),e&&e.call(r,a)})},a.getAddBuffNum=function(){return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.coffersBuffNum)},a.getAddPropByBuff=function(){var e=t.coffersCtrl.get(gc.dsConsts.CoffersEntity.buffBase)/100,r=t.coffersCtrl.get(gc.dsConsts.CoffersEntity.buffLvl),i=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.coffers2),a=i[4].split(","),s=parseInt(a[r])/100;
return e+s},a.getReAction=function(){var e=this.getActionData(),r=e[0],i=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.coffersAction),a=r-i;return 0>a&&(a=0),a},a.getActionReseconds=function(){var t=this.getActionData();return t[1]},a.getDefeseData=function(t,e){mo.requestWaiting4Server(gc.iface.a_coffers_getDefeseData,{},function(r){t.call(e,r)})},a.getEnemyDefeseData=function(t,e,r,i){var a=this;a._lastData[0]=t,a._lastData[1]=e;var s={},n=gc.iface.a_coffers_getEnemyDefeseData_args;s[n.serverId]=t,mo.requestWaiting4Server(gc.iface.a_coffers_getEnemyDefeseData,s,function(a){a[gc.dsConsts.ExDefenceData.serverName]=e,a[gc.dsConsts.ExDefenceData.serverId]=t,r.call(i,a)})},a.getLastEnemyDefeseData=function(t,e){var r=this,i=r._lastData[0],a=r._lastData[1];r.getEnemyDefeseData(i,a,t,e)},a.getDefeseRecord=function(t,e){mo.requestWaiting4Server(gc.iface.a_coffers_getDefeseRecord,{},function(r){t.call(e,r.reverse())})},a.getServerArr=function(t,e){mo.requestWaiting4Server(gc.iface.a_coffers_getServerArr,{},function(r){t.call(e,r)})},a.fightStart=function(e,r,i,a){var s=this;if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(t.fightCtrl.isDie)return mo.showMsg("复活中，请稍后");var n={},o=gc.iface.a_coffers_fightStart_args;n[o.serverId]=e,n[o.door]=r,s._fightServerId=e,s._fightDoor=r,mo.requestWaiting4Server(gc.iface.a_coffers_fightStart,n,function(n){var o=n[gc.dsConsts.ExCoffers.status];if(1==o)return void mo.showMsg(gc.id_c_msgCode.gatesBroken,function(){t.coffersCtrl.getLastEnemyDefeseData(function(t){s.pushNotify(s.__class.ON_COFFERS_DEF_DATA_CHANGED,t)},s)});var c=n[gc.dsConsts.ExCoffers.userData];t.userCtrl.updateEntity(c);for(var g=n[gc.dsConsts.ExCoffers.heroList],l=n[gc.dsConsts.ExCoffers.otherDataList],_=n[gc.dsConsts.ExCoffers.fightData],u=[],d=0;d<g.length;d++){var p=g[d],m=t.HeroEntityCtrl.createNewEnemy(p,_,l[d]);u.push(m)}u.sort(t.heroCtrl._sortHeroList),t.fightCtrl.isSpFighting=!0;var f=t.heroCtrl.getFightList();t.fightCtrl.startPvpFight(f,u,gc.c_prop.fightTypeKey.coffers),process.nextTick(function(){process.nextTick(function(){process.nextTick(function(){process.nextTick(function(){s.pushNotify(s.__class.ON_COFFERS_FIGHT,e,r)})})})}),i&&i.call(a,u)})},a.fightEnd=function(e,r,i){var a=this,s={},n=gc.iface.a_coffers_fightEnd_args;s[n.serverId]=a._fightServerId,s[n.door]=a._fightDoor,s[n.isWin]=e,mo.requestWaiting4Server(gc.iface.a_coffers_fightEnd,s,function(e){var s=e[gc.dsConsts.FightResult.updateUser]||{},n=e[gc.dsConsts.FightResult.bagItems],o=t.userUtils.getNewBag({},n);s[gc.dsConsts.UserEntity.bag]=o,s&&t.userCtrl.updateEntity(s);var c=e[gc.dsConsts.FightResult.updateCoffers];c&&a.updateEntity(c);var g=e[gc.dsConsts.FightResult.coffersStatus];3==g&&mo.showMsg("跨服数据请求失败！"),r&&r.call(i,e)})},a.fightCoffersStart=function(e,r,i){var a=this;if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(t.fightCtrl.isDie)return mo.showMsg("复活中，请稍后");var s={},n=gc.iface.a_coffers_fightCoffersStart_args;s[n.serverId]=e,a._fightServerId=e,mo.requestWaiting4Server(gc.iface.a_coffers_fightCoffersStart,s,function(e){var a=e[gc.dsConsts.ExCoffers.userData];t.userCtrl.updateEntity(a);var s=e[gc.dsConsts.ExCoffers.coffersLvl],n=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,s);t.fightCtrl.isSpFighting=!0,mo.moduleMgr.curModule.name!=g_consts.moduleId.fight&&(mo.moduleMgr.runModule(g_consts.moduleId.fight),t.fightLayer.onEnterCopy({pveType:gc.c_prop.fightTypeKey.coffersBoss,copyID:4003,loots:[[]],bossId:n[gc.c_lvl_cofferBoss]})),r&&r.call(i,s)})},a.fightCoffersEnd=function(e,r,i){var a=this,s={},n=gc.iface.a_coffers_fightCoffersEnd_args;s[n.hurt]=e,s[n.serverId]=a._fightServerId,mo.requestWaiting4Server(gc.iface.a_coffers_fightCoffersEnd,s,function(e){var s=e[gc.dsConsts.FightResult.updateUser]||{},n=e[gc.dsConsts.FightResult.bagItems],o=t.userUtils.getNewBag({},n);s[gc.dsConsts.UserEntity.bag]=o,s&&t.userCtrl.updateEntity(s);var c=e[gc.dsConsts.FightResult.updateCoffers];c&&a.updateEntity(c);var g=e[gc.dsConsts.FightResult.coffersStatus];3==g&&mo.showMsg("跨服数据请求失败！"),r&&r.call(i,e)})},a.getTodayLootNum=function(){return 10},r.ON_COFFERS_FIGHT="ON_COFFERS_FIGHT",r.ON_COFFERS_DEF_DATA_CHANGED="ON_COFFERS_DEF_DATA_CHANGED",r}(mo.DataController);t.CoffersCtrl=e,egret.registerClass(e,"gd.CoffersCtrl"),t.coffersCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._curCopyId=-1,this._biCost=0}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this._copyProgressMap={},this._copyEquipArr=[],this._copyBossArr=[],this._copyStateArr=[],this._tempLootArr=[]},a.initData=function(e){for(var r=this,i=0;i<e.length;i++){var a=e[i],s=new t.CopyProgressEntityCtrl;s.init(a),r._copyProgressMap[a[gc.dsConsts.CopyProgressEntity.copyType]]=s}},a.getInfo=function(t,e){var r=this;async.parallel([function(t){r._initCtrlByType(gc.c_prop.copyTypeKey.vip,t,r)},function(t){r._initCtrlByType(gc.c_prop.copyTypeKey.guild,t,r)}],function(){t.call(e)})},a.getNormalCurCopyId=function(){var t=this,e=t.getCopyProgressCtrl(gc.c_prop.copyTypeKey.normal);if(!e)return 1;var r=e.get(gc.dsConsts.CopyProgressEntity.copyObj)||{},i=Object.keys(r),a=i[i.length-1]||1,s=parseInt(a.toString());return s},a.getWinningStreak=function(){var t=this,e=t.getNormalCurCopyId(),r=mo.getJSONWithFileName(gc.cfg_t_copy),i=r[e][gc.t_copy_monsterCount],a=t.getCopyProgressCtrl(gc.c_prop.copyTypeKey.normal),s=a.get(gc.dsConsts.CopyProgressEntity.winningStreak);return[s,i]},a.updateWinningStreak=function(t,e){var r=this,i=r.getNormalCurCopyId(),a=r.getWinningStreak(),s=a[0];if(!(a[0]>=a[1])){s++;var n=r.getCopyProgressCtrl(gc.c_prop.copyTypeKey.normal);n.set(gc.dsConsts.CopyProgressEntity.winningStreak,s);var o=gc.iface.a_copy_updateWinningStreak_args,c={};c[o.copyId]=i,mo.request4Server(gc.iface.a_copy_updateWinningStreak,c,function(r){t&&t.call(e)})}},a.getCopyProgressCtrl=function(t){var e=this;return e._copyProgressMap[t]},a.updateCopyProgressCtrl=function(e,r){var i=this,a=this.getCopyProgressCtrl(e);a?a.updateEntity(r):(a=new t.CopyProgressEntityCtrl,a.init(r),i._copyProgressMap[e]=a)},a.copyWipe=function(e,r,i){var a=this,s=mo.getJSONWithFileName(gc.cfg_t_copy),n=s[e][gc.t_copy_type];n==gc.c_prop.copyTypeKey.equip&&t.userCtrl.isEquipBagReddot()&&t.copyCtrl._checkHasEquip()&&mo.showMsg(gc.id_c_msgCode.bagMaxCantGet);var o=gc.iface.a_copy_copyWipe_args,c={};c[o.copyId]=e,mo.requestWaiting4Server(gc.iface.a_copy_copyWipe,c,function(s){var n=s[gc.dsConsts.ExCopyProgress.userData]||{},o=s[gc.dsConsts.ExCopyProgress.copyProgress]||{},c=s[gc.dsConsts.ExCopyProgress.bagItems]||{},g=s[gc.dsConsts.ExCopyProgress.equipBagItems]||{},l=s[gc.dsConsts.ExCopyProgress.delBagItems]||{},_=s[gc.dsConsts.ExCopyProgress.wipeCount]||0,u=s[gc.dsConsts.ExCopyProgress.items]||{},d=t.userUtils.getNewBag(l,c);n[gc.dsConsts.UserEntity.bag]=d;var p=t.userUtils.getNewEquipBag({},g);n[gc.dsConsts.UserEntity.equipBag]=p,n&&t.userCtrl.updateEntity(n),o&&a.updateCopyProgressCtrl(a.getCopyType(e),o),a.pushNotify(a.__class.ON_CHALLENGE_NUM),r.call(i,[u,_])})},a.start=function(e,r,i){var a=this,s=a.getCopyType(e);if(a.isCopyLocked(e))return mo.showMsg("副本未开启");var n=a.checkPassCon(e);if(n){var o=n[0],c=n[1];if(999==o)return mo.showMsg("副本暂未开启");if(1==o)return mo.showMsg(gc.id_c_msgCode.noRoleLvl,c);if(2==o)return mo.showMsg("副本未开启");if(3==o)return mo.showMsg("副本未开启")}if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(t.fightCtrl.isDie)return mo.showMsg("复活中，请稍后");this._curCopyId=e;var g=gc.iface.a_copy_start_args,l={};l[g.copyId]=e;var _=mo.getJSONWithFileName(gc.cfg_t_item),u=a.getCopyCount(e),d=0;if(s==gc.c_prop.copyTypeKey.equip){if(d=gc.c_prop.spItemIdKey.equipTessera,1>u)return void a.noCopyTimes1(e,function(){a.start(e,r,i)},this)}else if(s==gc.c_prop.copyTypeKey.hell){if(d=a.getBoosCopyEnterCost()[0],1>u)return void a.noCopyTimes(e,function(t){a._biCost=t,a.start(e,r,i)},this)}else if(s==gc.c_prop.copyTypeKey.state){if(d=gc.c_prop.spItemIdKey.realmTessera,1>u)return void a.noCopyTimes1(e,function(){a.start(e,r,i)},this)}else if(s==gc.c_prop.copyTypeKey.vip&&1>u)return mo.showMsg(gc.id_c_msgCode.vipNotimes);if(d){var p=t.userCtrl.getItemNum(d)||0;if(1>p){var m=_[d][gc.t_item_price]||0,f=t.userCtrl.getDiamond();if(m>f)return mo.showMsg(gc.id_c_msgCode.noDiamond)}}t.fightCtrl.isSpFighting=!0,l[g.biCost]=this._biCost,mo.requestWaiting4Server(gc.iface.a_copy_start,l,function(s){var n=s[gc.dsConsts.ExCopyProgress.userData]||{},o=s[gc.dsConsts.ExCopyProgress.delBagItems]||{},c=t.userUtils.getNewBag(o,{});n[gc.dsConsts.UserEntity.bag]=c;var g=s[gc.dsConsts.ExCopyProgress.copyProgress]||{};n&&t.userCtrl.updateEntity(n),g&&a.updateCopyProgressCtrl(a.getCopyType(e),g);var l=s[gc.dsConsts.ExCopyProgress.copyLoot]||[],_=Object.keys(l),u=_[_.length-1],d=[[u,l[u]]];a._tempLootArr=d,a._biCost=0,r.call(i,d)})},a.isCanStartHell=function(e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_c_open),s=a[gc.id_c_open.bossCopy][gc.c_open_lvlRequired];t.userCtrl.getLvl()<s&&e.call(r,!1),i.getCopyBossList(function(a){for(var s=t.userCtrl.getItemNum(gc.c_prop.spItemIdKey.bossTessera)||0,n=!1,o=0;o<a.length;o++){var c=a[o],g=i.getCopyCount(c);if(g>0){n=!0;break}}var l=s>0&&n;e.call(r,l)},i)},a._checkHasEquip=function(){for(var t=this,e=!1,r=mo.getJSONWithFileName(gc.cfg_t_itemEquip),i=0;i<t._tempLootArr.length;i++){var a=t._tempLootArr[i];if(a)for(var s=a[1]||[],n=0;n<s.length;n++){var o=s[n]||[],c=o[0];o[1];if(r[c]){e=!0;break}}}return e},a.end=function(e,r,i,a){if(-1!=this._curCopyId){var s=this;t.userCtrl.isEquipBagReddot()&&s._checkHasEquip()&&mo.showMsg(gc.id_c_msgCode.bagMaxCantGet);var n=gc.iface.a_copy_end_args,o={},c=this._curCopyId;s._curCopyId=-1,o[n.copyId]=c,o[n.fightData]=r,o[n.isWin]=e,mo.requestWaiting4Server(gc.iface.a_copy_end,o,function(e){var r=e[gc.dsConsts.ExCopyProgress.userData]||{},n=e[gc.dsConsts.ExCopyProgress.copyProgress]||{},o=e[gc.dsConsts.ExCopyProgress.bagItems]||{},g=e[gc.dsConsts.ExCopyProgress.equipBagItems]||{},l=t.userUtils.getNewBag({},o);r[gc.dsConsts.UserEntity.bag]=l;var _=t.userUtils.getNewEquipBag({},g);r[gc.dsConsts.UserEntity.equipBag]=_,r&&t.userCtrl.updateEntity(r),n&&s.updateCopyProgressCtrl(s.getCopyType(c),n),s.pushNotify(s.__class.ON_COPY_CHANGE),t.pointCtrl.cal(gc.c_prop.pointGreenKey.copy_equip);var u=e[gc.dsConsts.ExCopyProgress.guildData];u&&t.guildCtrl.updateData(u);var d=e[gc.dsConsts.ExCopyProgress.guildPersonalData];d&&t.guildPersonalCtrl.updateData(d),i.call(a,e)})}},a.getCopyLootList=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,t);if(!e[gc.t_copy_lootDisplay])return[];var r=mo.getJSONWithFileNameAndID(gc.cfg_t_copyLoot,e[gc.t_copy_lootDisplay]);return r[gc.t_copyLoot_showItems]||[]},a.getNormalCopyProfit=function(){for(var e=t.copyCtrl.getNormalCurCopyId(),r=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,e),i=t.heroCtrl.getAllHeroAttack(),a=0,s=r[gc.t_copy_randMonsters],n=s[0],o=mo.getJSONWithFileNameAndID(gc.cfg_t_monster,n),c=0,g=s.length;g>c;c++)o=mo.getJSONWithFileNameAndID(gc.cfg_t_monster,n),a+=o[gc.t_monster_maxHp];for(var l=i/a,_=mo.getJSONWithFileNameAndID(gc.cfg_t_copyLoot,r[gc.t_copy_loot]),u=_[gc.t_copyLoot_moneyMax],d=Math.floor(u*_[gc.t_copyLoot_moneyProbability]/1e4*3600),p=Math.floor((.06+.001*t.userCtrl.getLvl())*l*3600),m=0,f=r[gc.t_copy_monsterTotal],h=t.heroCtrl.getList(),c=0;c<h.length;c++){var y=h[c];m+=y.getDamagePerSec(o)}var C=5.3,v=f*o[gc.t_monster_maxHp],I=v/m+C;5>I&&(I=5);var E=Math.round(3600/I),D=o[gc.t_monster_userExp],b=0,S=mo.getJSONWithFileName(gc.cfg_t_talismanSkill),N=t.userCtrl.getData(),T=N[gc.dsConsts.UserEntity.exData]||{};if(T[gc.c_prop.userExDataKey.talismanSkill]&&T[gc.c_prop.userExDataKey.talismanSkill][gc.c_prop.talismanSkillTypeKey.exp])for(var k=T[gc.c_prop.userExDataKey.talismanSkill][gc.c_prop.talismanSkillTypeKey.exp],c=0;c<k.length;c++){var x=k[c];S[x]&&(b+=parseInt(S[x][gc.t_talismanSkill_effect][0][0]))}D*=b/1e4+1;var R=E*f*D,d=_[gc.t_copyLoot_moneyMax]*E,w=mo.getJSONWithFileName(gc.cfg_c_game),A=w[gc.id_c_game.lootLimit][0],L=o[gc.t_monster_level];t.userCtrl.getLvl()-L>A&&(D=0,p=0);var P=0,B=0,O=0;if(!t.userCtrl.isMaxLvl()){var q=t.userCtrl.getLvl();P=q+1;var M=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,q);B=M[gc.c_lvl_reqExp]-t.userCtrl.getExp(),O=B/R}var W=_[gc.t_copyLoot_exItems],F=[],U=[];if(W)for(var c=0;c<W.length;c++){var G=1800*W[c][2]/1e4*W[c][1],K=W[c][0];G=parseFloat(G.toFixed(1)),K/100>>0==53&&F.push([K,G]),K/100>>0==52&&F.push([K,G]),K/100>>0==51&&F.push([K,G]),(1545==K||1550==K||1551==K)&&U.push([K,G])}return[d,R,E,p,P,B,O,Math.round(D),F,U]},a.isCopyLocked=function(t){var e=this,r=e._copyEquipArr.indexOf(t);return-1!=r?e._copyEquipArr.length-1==r&&null!=e.checkPassCon(t):e.getCopyType(t)==gc.c_prop.copyTypeKey.hell?(r=e._copyBossArr.indexOf(t),0>r):(r=e._copyStateArr.indexOf(t),-1!=r?e._copyStateArr.length-1==r&&null!=e.checkPassCon(t):!1)},a.getPassCon=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,t);return e[gc.t_copy_cond]},a.getVipCopyReTimes=function(t){var e=this,r=e.getVipCopyCfg(t),i=r[0];return i?e.getCopyCount(r[0]):0},a.getVipCopyCfg=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_vipCopy,t),r=e[gc.c_vipCopy_copyIds];return r},a.getVipLootDesc=function(t){var e="",r=mo.getJSONWithFileName(gc.cfg_c_vipCopy),i=r[t];return i&&(e=i[gc.c_vipCopy_lootDesc]),e},a.checkPassCon=function(t){for(var e=this,r=e.getPassCon(t),i=0,a=r.length;a>i;i++){var s=r[i]||[],n=s[0],o=s[1],c=e._checkPassCon(n,o);if(!c)return[n,o]}return null},a._checkPassCon=function(e,r){var i=this,a=!0;switch(e){case 1:a=t.userCtrl.getLvl()>=r;break;case 2:var s=i.getCopyProgressCtrl(gc.c_prop.copyTypeKey.normal),n=s.get(gc.dsConsts.CopyProgressEntity.copyObj);a=!!n[r]||0==r||1==r;break;case 3:var o=t.heroCtrl.getMaxStateLvl();a=o>=r;break;case 4:a=t.userCtrl.getVip()>=r;break;case 999:a=!1}return a},a.getCurMaxWaveCount=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,t.getNormalCurCopyId());return e[gc.t_copy_monsterCount]},a.getCopyEquipList=function(t,e){var r=this,i=[],a=(mo.getJSONWithFileName(gc.cfg_t_copy),mo.getJSONWithFileName(gc.cfg_c_game)),s=a[gc.id_c_game.copyIdSection][gc.c_prop.copyTypeKey.equip].split(","),n=r.getCopyProgressCtrl(gc.c_prop.copyTypeKey.normal);r._initCtrlByType(gc.c_prop.copyTypeKey.equip,function(a){for(var o=(n.get(gc.dsConsts.CopyProgressEntity.copyObj),s[0]);o<=s[1];o++){if(null!=r.checkPassCon(o)){i.push(parseInt(o));break}i.push(parseInt(o))}r._copyEquipArr=i,t.call(e,i)},r)},a.getVipCopyList=function(e){for(var r=mo.getJSONWithFileNameAndID(gc.cfg_c_vipCopy,e)[gc.c_vipCopy_copyIds],i=[],a=parseInt(r[0]),s=parseInt(r[1]);s>=a;a++){i.push(a);var n=t.copyCtrl.checkPassCon(a);if(n)break}return i.reverse()},a._initCtrlByType=function(t,e,r){var i=this,a=i.getCopyProgressCtrl(t);if(a)return e(null,a);var s={},n=gc.iface.a_copy_getInfo_args;s[n.type]=t,mo.request4Server(gc.iface.a_copy_getInfo,s,function(r){i.updateCopyProgressCtrl(t,r);var a=i.getCopyProgressCtrl(gc.c_prop.copyTypeKey.equip);e(null,a)})},a.getCopyBossList=function(t,e){var r=this,i=[],a=mo.getJSONWithFileName(gc.cfg_c_game),s=(mo.getJSONWithFileName(gc.cfg_t_copy),a[gc.id_c_game.copyIdSection][gc.c_prop.copyTypeKey.hell].split(","));r._initCtrlByType(gc.c_prop.copyTypeKey.hell,function(a){for(var n=parseInt(s[0]),o=parseInt(s[1]);o>=n;n++)null==r.checkPassCon(n)&&i.push(n);r._copyBossArr=i,t.call(e,i)},r)},a.getCopyStateList=function(e,r){var i=this,a=[],s=mo.getJSONWithFileName(gc.cfg_c_game),n=(mo.getJSONWithFileName(gc.cfg_t_copy),s[gc.id_c_game.copyIdSection][gc.c_prop.copyTypeKey.state].split(","));i._initCtrlByType(gc.c_prop.copyTypeKey.state,function(s){var o=t.heroCtrl.getList(),c=0;for(var g in o){var l=o[g].get(gc.dsConsts.HeroEntity.realmLvl);l>c&&(c=l)}for(var _=n[0];_<=n[1];_++){if(null!=i.checkPassCon(_)){a.push(parseInt(_));break}a.push(parseInt(_))}i._copyStateArr=a,e.call(r,a)},i)},a.hasNotReadEquip=function(t,e,r){var i=this;i._getListByType(t,function(t){for(var a=!1,s=0;s<t.length-1;s++){var n=t[0],o=i.isRead(n);if(!o){a=!0;break}}e.call(r,a)},i)},a._getListByType=function(t,e,r){var i=this;switch(t){case gc.c_prop.copyTypeKey.equip:i.getCopyEquipList(e,r);break;case gc.c_prop.copyTypeKey.hell:i.getCopyBossList(e,r);break;case gc.c_prop.copyTypeKey.state:i.getCopyStateList(e,r);break;default:e.call(r,[])}},a.setRead=function(t){var e=this;if(!e.isRead(t)){var r=gc.iface.a_copy_setRead_args,i={};i[r.copyId]=t,mo.request4Server(gc.iface.a_copy_setRead,i,function(r){r&&e.updateCopyProgressCtrl(e.getCopyType(t),r)})}},a.isRead=function(t){var e=this,r=e.getCopyType(t),i=e.getCopyProgressCtrl(r),a=i.get(gc.dsConsts.CopyProgressEntity.readObj);return a[t]?!0:!1},a.getCopyType=function(t){var e=mo.getJSONWithFileName(gc.cfg_t_copy),r=e[t][gc.t_copy_type];return r},a.queryCopyNeedItem=function(t){var e,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.copyNeedItem);switch(t){case gc.c_prop.copyTypeKey.equip:e=r[0];break;case gc.c_prop.copyTypeKey.state:e=r[1];break;case gc.c_prop.copyTypeKey.hell:e=r[2]}return e?e.split(","):(mo.error("未找到副本类型为%s对应所需配置",t),null)},a.getBoosCopyEnterCost=function(){var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.bossTesseraReplace),i=r[0],a=r[1],s=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.bossTesseraReplace),n=gc.c_prop.spItemIdKey,o=e.queryCopyNeedItem(gc.c_prop.copyTypeKey.hell),c=n.bossTesseraReplace,g=o[0],l=o[1],_=t.userCtrl.getItemNum(g)>0?g:c;if(_==c){var u=t.userCtrl.getItemNum(c);_=u>=i?c:g,_=s>=a?g:_}var d=_==g?l:i;return[_,d]},a.getCopyCount=function(e){var r=this,i=mo.getJSONWithFileName(gc.cfg_c_vip),a=r.getCopyProgressCtrl(r.getCopyType(e)),s=r.getCopyType(e),n=t.userCtrl.getVip()||0,o=0,c=0,g=e;switch(s){case gc.c_prop.copyTypeKey.equip:o=i[n][gc.c_vip_equipCount],c=o-i[0][gc.c_vip_equipCount];break;case gc.c_prop.copyTypeKey.hell:o=i[n][gc.c_vip_bossCount],c=o-i[0][gc.c_vip_bossCount];break;case gc.c_prop.copyTypeKey.state:o=i[n][gc.c_vip_realmCount],c=o-i[0][gc.c_vip_realmCount];break;case gc.c_prop.copyTypeKey.vip:var l=r.getCopyVip(e);g=l,o=r.getMaxVipCopyTimes(l),c=o}if(!a.get(gc.dsConsts.CopyProgressEntity.refreshTime))return o;var _=Date.newDate(a.get(gc.dsConsts.CopyProgressEntity.refreshTime)),u=a.get(gc.dsConsts.CopyProgressEntity.timesPerDay);return _&&_.equalsDay(Date.newDate())&&u.hasOwnProperty(g)?parseInt(u[g])+c:o},a.getMaxVipCopyTimes=function(e){var r=t.userCtrl.getVip()||0,i=mo.getJSONWithFileName(gc.cfg_c_vip),a=0;return 7==e&&(a=i[r][gc.c_vip_copyCountV7]),10==e&&(a=i[r][gc.c_vip_copyCountV10]),14==e&&(a=i[r][gc.c_vip_copyCountV14]),17==e&&(a=i[r][gc.c_vip_copyCountV17]),19==e&&(a=i[r][gc.c_vip_copyCountV19]),a},a.getCopyVip=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_vipCopy);for(var r in e){var i=e[r],a=i[gc.c_vipCopy_copyIds];if(t>=parseInt(a[0])&&t<=parseInt(a[1]))return i[gc.c_vipCopy_vipLvl]}return 0},a.getBuyCopyCount=function(t){var e=this,r=e.getCopyProgressCtrl(e.getCopyType(t)),i=0,a=r.get(gc.dsConsts.CopyProgressEntity.resetTime),s=r.get(gc.dsConsts.CopyProgressEntity.resetCounts);return a&&Date.newDate(a).equalsDay(Date.newDate())||r.set(gc.dsConsts.CopyProgressEntity.resetCounts,{}),a&&Date.newDate(a).equalsDay(Date.newDate())&&s.hasOwnProperty(t)?s[t]:i},a.getCopyStar=function(t){var e=this,r=e.getCopyProgressCtrl(e.getCopyType(t)),i=r.get(gc.dsConsts.CopyProgressEntity.copyStar),a=i[t]||0;return a},a.getTesseraCount=function(e){var r=t.userCtrl.getItemNum(e);return r},a.getTesseraPrice=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_item,t);return e[gc.t_item_price]||0},a.getEquipCopyPrice=function(t){var e=this,r=1,i=e.getCopyProgressCtrl(e.getCopyType(t)),a=i.get(gc.dsConsts.CopyProgressEntity.resetTime),s=i.get(gc.dsConsts.CopyProgressEntity.resetCounts);return a&&Date.newDate(a).equalsDay(Date.newDate())||i.set(gc.dsConsts.CopyProgressEntity.resetCounts,{}),a&&Date.newDate(a).equalsDay(Date.newDate())&&s.hasOwnProperty(t)?(r=parseInt(s[t])+1,gc.calBuyEquip(r)):gc.calBuyEquip(r)},a.getBossCopyPrice=function(t){var e=this,r=1,i=e.getCopyProgressCtrl(e.getCopyType(t)),a=i.get(gc.dsConsts.CopyProgressEntity.resetTime),s=i.get(gc.dsConsts.CopyProgressEntity.resetCounts);return a&&Date.newDate(a).equalsDay(Date.newDate())||i.set(gc.dsConsts.CopyProgressEntity.resetCounts,{}),a&&Date.newDate(a).equalsDay(Date.newDate())&&s.hasOwnProperty(t)?(r=parseInt(s[t])+1,gc.calBuyBoss(r)):gc.calBuyBoss(r)},a.getRealmCopyPrice=function(t){var e=this,r=1,i=e.getCopyProgressCtrl(e.getCopyType(t)),a=i.get(gc.dsConsts.CopyProgressEntity.resetTime),s=i.get(gc.dsConsts.CopyProgressEntity.resetCounts);return a&&Date.newDate(a).equalsDay(Date.newDate())||i.set(gc.dsConsts.CopyProgressEntity.resetCounts,{}),a&&Date.newDate(a).equalsDay(Date.newDate())&&s.hasOwnProperty(t)?(r=parseInt(s[t])+1,gc.calBuyRealm(r)):gc.calBuyRealm(r)},a.buyCopyCount1=function(e,r,i){var a=this,s=a.getCopyType(e),n=gc.iface.a_copy_buyCopyCount_args,o={};o[n.copyId]=e,o[n.type]=s;var c=0;switch(s){case gc.c_prop.copyTypeKey.equip:c=a.getEquipCopyPrice(e);break;case gc.c_prop.copyTypeKey.state:c=a.getRealmCopyPrice(e)}mo.showMsg(gc.id_c_msgCode.buyCopyTimes1,c,function(){var s=t.userCtrl.get(gc.dsConsts.UserEntity.diamond);return c>s?mo.showMsg(gc.id_c_msgCode.noDiamond):void mo.requestWaiting4Server(gc.iface.a_copy_buyCopyCount,o,function(s){var n=s[gc.dsConsts.ExUserData.userData]||{},o=s[gc.dsConsts.ExUserData.copyProgressData]||{};t.userCtrl.updateEntity(n),a.updateCopyProgressCtrl(a.getCopyType(e),o),r.call(i,s)})})},a.buyCopyCount=function(e,r,i){var a=this,s=a.getCopyType(e),n=gc.iface.a_copy_buyCopyCount_args,o={};o[n.copyId]=e,o[n.type]=s;var c=mo.getJSONWithFileName(gc.cfg_c_vip),g=a.getBuyCopyCount(e),l=c[t.userCtrl.getVip()||0][gc.c_vip_buyBossCount];if(g>=l)return mo.showMsg(gc.id_c_msgCode.cantUseMax,g);var _=a.getBossCopyPrice(e),u=a.getBuyCopyCount(e),d=c[t.userCtrl.getVip()||0][gc.c_vip_buyBossCount];mo.showMsg(gc.id_c_msgCode.buyCopyTimes,_,u,d,function(){var s=t.userCtrl.get(gc.dsConsts.UserEntity.diamond);return _>s?mo.showMsg(gc.id_c_msgCode.noDiamond):void mo.requestWaiting4Server(gc.iface.a_copy_buyCopyCount,o,function(s){var n=s[gc.dsConsts.ExUserData.userData]||{},o=s[gc.dsConsts.ExUserData.copyProgressData]||{};t.userCtrl.updateEntity(n),a.updateCopyProgressCtrl(a.getCopyType(e),o),r.call(i,s)})})},a.buyTessera=function(t,e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_t_item),s=a[t][gc.t_item_price]||0;mo.showMsg(gc.id_c_msgCode.buyCopyItem,s,gc.c_prop.spItemId[t],function(){switch(t){case gc.c_prop.spItemIdKey.equipTessera:i.buyEquipTessera(e,r);break;case gc.c_prop.spItemIdKey.realmTessera:i.buyRealmTessera(e,r);break;default:mo.error("未知入场券id")}})},a.buyEquipTessera=function(e,r){var i=mo.getJSONWithFileName(gc.cfg_t_item),a=i[gc.c_prop.spItemIdKey.equipTessera][gc.t_item_price]||0,s=t.userCtrl.get(gc.dsConsts.UserEntity.diamond);return a>s?mo.showMsg(gc.id_c_msgCode.noDiamond):void mo.requestWaiting4Server(gc.iface.a_copy_buyEquipTessera,{},function(i){var a=i[gc.dsConsts.ExUserData.userData]||{},s=i[gc.dsConsts.ExUserData.bagItems]||{},n=i[gc.dsConsts.ExUserData.equipBagItems]||{},o=t.userUtils.getNewBag({},s);a[gc.dsConsts.UserEntity.bag]=o;var c=t.userUtils.getNewEquipBag({},n);a[gc.dsConsts.UserEntity.equipBag]=c,t.userCtrl.updateEntity(a),e.call(r,i)})},a.buyRealmTessera=function(e,r){var i=mo.getJSONWithFileName(gc.cfg_t_item),a=i[gc.c_prop.spItemIdKey.realmTessera][gc.t_item_price]||0,s=t.userCtrl.get(gc.dsConsts.UserEntity.diamond);return a>s?mo.showMsg(gc.id_c_msgCode.noDiamond):void mo.requestWaiting4Server(gc.iface.a_copy_buyRealmTessera,{},function(i){var a=i[gc.dsConsts.ExUserData.userData]||{},s=i[gc.dsConsts.ExUserData.bagItems]||{},n=i[gc.dsConsts.ExUserData.equipBagItems]||{},o=t.userUtils.getNewBag({},s);a[gc.dsConsts.UserEntity.bag]=o;var c=t.userUtils.getNewEquipBag({},n);a[gc.dsConsts.UserEntity.equipBag]=c,t.userCtrl.updateEntity(a),e.call(r,i)})},a.getBossCopyTempList=function(){for(var t=[],e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.copyIdSection)[1].split(","),r=parseInt(e[0]),i=parseInt(e[1]),a=r,s=i;s>=a;a++)t.push(a);return t},a.getBossCopyLength=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.copyIdSection)[1].split(","),e=parseInt(t[0]),r=parseInt(t[1]);return r-e+1},a.getCurBossCopyId=function(){var t=this;return t._copyBossArr.length==t.getBossCopyLength()?t._copyBossArr[t._copyBossArr.length-1]:t._copyBossArr[t._copyBossArr.length-1]||t.getBossCopyTempList()[0]},a.noCopyTimes1=function(e,r,i){var a=this,s=mo.getJSONWithFileName(gc.cfg_t_copy),n=s[e][gc.t_copy_type],o=0;switch(n){case gc.c_prop.copyTypeKey.equip:o=a.getEquipCopyPrice(e);break;case gc.c_prop.copyTypeKey.state:o=a.getRealmCopyPrice(e)}mo.showMsg(gc.id_c_msgCode.noCopyTimes1,o,function(){if(t.userCtrl.getDiamond()<o)return mo.showMsg(gc.id_c_msgCode.noDiamond);var s=a.getCopyType(e),n=gc.iface.a_copy_buyCopyCount_args,c={};c[n.copyId]=e,c[n.type]=s,mo.requestWaiting4Server(gc.iface.a_copy_buyCopyCount,c,function(s){var n=s[gc.dsConsts.ExUserData.userData]||{},o=s[gc.dsConsts.ExUserData.copyProgressData]||{};t.userCtrl.updateEntity(n),a.updateCopyProgressCtrl(a.getCopyType(e),o),r.call(i,s)})})},a.noCopyTimes=function(e,r,i){var a=this,s=mo.getJSONWithFileName(gc.cfg_c_vip),n=a.getBossCopyPrice(e),o=a.getBuyCopyCount(e),c=s[t.userCtrl.getVip()||0][gc.c_vip_buyBossCount];mo.showMsg(gc.id_c_msgCode.noCopyTimes,n,o,c,function(){if(o>=c)return mo.showMsg(gc.id_c_msgCode.cantUseMax,o);if(t.userCtrl.getDiamond()<n)return mo.showMsg(gc.id_c_msgCode.noDiamond);var s=a.getCopyType(e),g=gc.iface.a_copy_buyCopyCount_args,l={};l[g.copyId]=e,l[g.type]=s,mo.requestWaiting4Server(gc.iface.a_copy_buyCopyCount,l,function(s){var o=s[gc.dsConsts.ExUserData.userData]||{},c=s[gc.dsConsts.ExUserData.copyProgressData]||{};t.userCtrl.updateEntity(o),a.updateCopyProgressCtrl(a.getCopyType(e),c),r.call(i,n)})})},a.getOpenLvl=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_open),r=0;switch(t){case gc.c_prop.copyTypeKey.equip:r=e[gc.id_c_open.equipCopy][gc.c_open_lvlRequired];break;case gc.c_prop.copyTypeKey.state:r=e[gc.id_c_open.reamCopy][gc.c_open_lvlRequired];break;case gc.c_prop.copyTypeKey.hell:r=e[gc.id_c_open.bossCopy][gc.c_open_lvlRequired]}return r},a.getPracticeOpenLvl=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_open),r=0;switch(t){case gc.c_prop.practiceTypeKey.heart:r=e[gc.id_c_open.heartStunt1][gc.c_open_lvlRequired];break;case gc.c_prop.practiceTypeKey.medal:r=0;break;case gc.c_prop.practiceTypeKey.gift:r=e[gc.id_c_open.openTrump][gc.c_open_lvlRequired]}return r},a.getIsAwardArr=function(t){var e=this,r=e.getCopyProgressCtrl(gc.c_prop.copyTypeKey.paTa),i=r.get(gc.dsConsts.CopyProgressEntity.copyObj);return i[t]&&i[t][0]&&-1==i[t][0]?i[t][1]?[!1,!0]:[!0,!1]:[!1,!1]},a.getHighPata=function(){var e=mo.getJSONWithFileName(gc.cfg_c_game),r=e[gc.id_c_game.towerCopy][0].split(","),i=parseInt(r[0]),a=t.userCtrl.get(gc.dsConsts.UserEntity.highPaTa)||0;return i=a+i},a.isFirstTowerCopyId=function(){var t=this;return t.getHighPata()==t.getTowerCopyIdRange()[0]},a.getTowerCopyIdRange=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.towerCopy),e=t[0].split(","),r=parseInt(e[0]),i=parseInt(e[1]);return[r,i]},a.getFocusTowerCopyId=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.towerCopy),r=e[0].split(","),i=parseInt(r[0]),a=parseInt(r[1]),s=t.getHighPata(),n=s-1;if(n>=i){var o=t.getIsAwardArr(n);o[1]||(s=n)}return s>a&&(s=a),s},a.getPaTaTreasuryCount=function(){var t=this,e=gc.c_prop.copyTypeKey.paTa,r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.towerCopy][1],a=t.getCopyProgressCtrl(e);if(!a.get(gc.dsConsts.CopyProgressEntity.refreshTime))return i;var s=Date.newDate(a.get(gc.dsConsts.CopyProgressEntity.refreshTime)),n=a.get(gc.dsConsts.CopyProgressEntity.timesPerDay);return s&&s.equalsDay(Date.newDate())&&n.hasOwnProperty(e)?(i=n[e],0>i&&(i=0),i):i},a.getMaxFreeTowerTimes=function(){var t=mo.getJSONWithFileName(gc.cfg_c_game),e=t[gc.id_c_game.towerCopy][1];return e},a.getPaTaTreasuryBuyCount=function(){var t=this,e=gc.c_prop.copyTypeKey.paTa,r=t.getCopyProgressCtrl(e),i=0,a=r.get(gc.dsConsts.CopyProgressEntity.resetTime),s=r.get(gc.dsConsts.CopyProgressEntity.resetCounts);return a&&Date.newDate(a).equalsDay(Date.newDate())||r.set(gc.dsConsts.CopyProgressEntity.resetCounts,{}),a&&Date.newDate(a).equalsDay(Date.newDate())&&s.hasOwnProperty(e)?s[e]:i},a.getPaTaTreasuryNeedDia=function(){var e=this,r=0,i=e.getPaTaTreasuryCount();if(i>0)return r;var a=e.getPaTaTreasuryBuyCount()+1,s=t.userCtrl.get(gc.dsConsts.UserEntity.highPaTa)||0;return r=gc.calPaTaAward(a,s)},a.getPaTaInfo=function(t,e){var r=this,i=gc.c_prop.copyTypeKey.paTa,a=r.getCopyProgressCtrl(i);return a?t.call(e,a):void r._initCtrlByType(i,function(r){t.call(e,r)},r)},a.paTaAward=function(e,r,i){var a=this,s=gc.c_prop.copyTypeKey.paTa,n=mo.getJSONWithFileName(gc.cfg_c_game),o=n[gc.id_c_game.towerCopy][0].split(",");if(e<o[0]||e>o[1])return mo.showMsg("数据异常");var c=a.getCopyProgressCtrl(s),g=c.get(gc.dsConsts.CopyProgressEntity.copyObj)[e]||[];if(!g[0]||-1!=g[0])return mo.showMsg("还未通关该boss");if(g[1]&&1==g[1])return mo.showMsg("已领取过该奖励！");var l=gc.iface.a_copy_paTaAward_args,_={};_[l.copyId]=e,mo.requestWaiting4Server(gc.iface.a_copy_paTaAward,_,function(e){var a=e[gc.dsConsts.ExCopyProgress.userData]||{},n=e[gc.dsConsts.ExCopyProgress.copyProgress]||{},o=e[gc.dsConsts.ExCopyProgress.bagItems]||{},c=e[gc.dsConsts.ExCopyProgress.equipBagItems]||{},g=t.userUtils.getNewBag({},o);a[gc.dsConsts.UserEntity.bag]=g;var l=t.userUtils.getNewEquipBag({},c);a[gc.dsConsts.UserEntity.equipBag]=l,a&&t.userCtrl.updateEntity(a),n&&t.copyCtrl.updateCopyProgressCtrl(s,n),r.call(i,o)})},a.paTaTreasury=function(e,r){var i=this,a=t.userCtrl.getLvl(),s=gc.c_prop.copyTypeKey.paTa,n=mo.getJSONWithFileName(gc.cfg_c_open),o=n[gc.id_c_open.paTa][gc.c_open_lvlRequired];if(o>a)return mo.showMsg(gc.id_c_msgCode.towerNotOpen,o);var c=t.userCtrl.get(gc.dsConsts.UserEntity.highPaTa)||0;return 1>c?mo.showMsg(gc.id_c_msgCode.noLevelDown):i.getPaTaTreasuryNeedDia()>t.userCtrl.getDiamond()?mo.showMsg(gc.id_c_msgCode.noDiamond):void mo.requestWaiting4Server(gc.iface.a_copy_paTaTreasury,{},function(a){var n=a[gc.dsConsts.ExCopyProgress.userData]||{},o=a[gc.dsConsts.ExCopyProgress.copyProgress]||{},c=a[gc.dsConsts.ExCopyProgress.bagItems]||{},g=a[gc.dsConsts.ExCopyProgress.equipBagItems]||{},l=t.userUtils.getNewBag({},c);n[gc.dsConsts.UserEntity.bag]=l;var _=t.userUtils.getNewEquipBag({},g);n[gc.dsConsts.UserEntity.equipBag]=_,n&&t.userCtrl.updateEntity(n),o&&t.copyCtrl.updateCopyProgressCtrl(s,o),i.pushNotify(i.__class.ON_TOWER_TANBAO),e.call(r,c)})},a.getTowerMonList=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.towerCopy),r=e[0].split(","),i=parseInt(r[0]),a=parseInt(r[1]),s=t.getHighPata(),n=s-1;if(n>=i){var o=t.getIsAwardArr(n);o[1]||(s=n)}s>a&&(s=a);for(var c=s-i,g=Math.floor(c/3),l=[],_=0,u=3;u>_;_++){var d=i+3*g+_;l.push(d)}return l},a.getTowerIndex=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.towerCopy),r=e[0].split(","),i=parseInt(r[0]);return parseInt(t)-i+1},a.isTwerPassed=function(t){var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.towerCopy),i=r[0].split(",");parseInt(i[0]);return parseInt(t)<e.getHighPata()},a.findSpAward=function(t){for(var e=mo.getJSONWithFileName(gc.cfg_t_paTaTreasury),r=parseInt(t);;++r){var i=e[r];if(!i)break;if(i[gc.t_paTaTreasury_preview])return r}return null},a.getTowerBaokuNum=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.towerCopy),r=e[0].split(","),i=parseInt(r[0]),a=parseInt(r[1]),s=t.getHighPata();return i>s-1?i:s-1>=a?a:s-1},r.ON_COPY_CHANGE="ON_COPY_CHANGE",r.ON_TOWER_TANBAO="ON_TOWER_TANBAO",r.ON_CHALLENGE_NUM="ON_CHALLENGE_NUM",r}(mo.DataController);
t.CopyCtrl=e,egret.registerClass(e,"gd.CopyCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.CopyProgressEntity},e}(mo.DataController);t.CopyProgressEntityCtrl=e,egret.registerClass(e,"gd.CopyProgressEntityCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.use=function(e,r,i){if(""==e)return mo.showMsg(gc.id_c_msgCode.cdKeyNull);var a=gc.iface.a_coupon_use_args,s={};s[a.code]=e,mo.requestWaiting4Server(gc.iface.a_coupon_use,s,function(e){var a=e[gc.dsConsts.ExUserData.userData];t.userCtrl.updateEntity(a),mo.showMsg(gc.id_c_msgCode.redeemRewardMail),t.pointCtrl.cal(gc.c_prop.pointEffectKey.mail),r&&r.call(i,e)})},r}(mo.DataController);t.CouponCtrl=e,egret.registerClass(e,"gd.CouponCtrl"),t.couponCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.GuildEntity,this._isOpenBoss=!1},a.initData=function(t){if(t){var e=this;e.init(t),e._memberList=[]}},a.isOpenBoss=function(){return this._isOpenBoss},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.updateEntity=function(r){var i=this,a=JSON.parse(JSON.stringify(i.getData()));if(e.prototype.updateEntity.call(this,r),r[gc.dsConsts.GuildEntity.lvl]){var s=a[gc.dsConsts.GuildEntity.lvl],n=r[gc.dsConsts.GuildEntity.lvl];s!=n&&t.heroCtrl.calPropAndCombat()}},a.getLevel=function(){var t=this,e=t.get(gc.dsConsts.GuildEntity.lvl);return e&&e>=5?e>=5&&15>e?1:e>=15&&30>e?2:e>=30?3:void 0:0},a.getLvl=function(){var t=this;return t._data?t.get(gc.dsConsts.GuildEntity.lvl):0},a.getId=function(){var t=this;return t._data?t.get(gc.dsConsts.GuildEntity.id):0},a.getExitGuildCD=function(){return mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.guildSet)[5]},a.getMaxMember=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,t);return e[gc.c_lvl_guildMan]},a.getNeedExp=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,t);return e[gc.c_lvl_guildExp]},a.getRank=function(t,e){},a.getInfo=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_guild_getInfo,{},function(a){var s=a[gc.dsConsts.ExGuildData.isGuild],n=a[gc.dsConsts.ExGuildData.guildPersonalData]||{},o=a[gc.dsConsts.ExGuildData.guildData]||{},c=a[gc.dsConsts.ExGuildData.chairmanName]||"",g=a[gc.dsConsts.ExGuildData.rank]||0;t.guildPersonalCtrl.getData()?t.guildPersonalCtrl.updateEntity(n):t.guildPersonalCtrl.initData(n),i.getData()?i.updateEntity(o):i.initData(o),t.heroCtrl.calPropAndCombat(),a[gc.dsConsts.ExGuildData.isOpenBoss]?i._isOpenBoss=!0:i._isOpenBoss=!1;var l=a[gc.dsConsts.ExGuildData.isOpenGuildWar];t.guildWarCtrl.setIsOpen(l);var _=a[gc.dsConsts.ExGuildData.cfgData];t.guildWarCtrl.setCfgData(_),e.call(r,[s,n,o,c,g])})},a.establishGuild=function(e,r,i){var a=this,s=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.fuckWord)[0].split(",");if(null==e||""==e)return mo.showMsg(gc.id_c_msgCode.guildNameIsNull);if(mo.STR.getStringLength(e)>12)return mo.showMsg(gc.id_c_msgCode.guildNameTooLong);if(mo.STR.checkSensitiveWord(e,s))return mo.showMsg(gc.id_c_msgCode.guildNameIllegal);if(e.indexOf("'")>-1)return mo.showMsg("不能包含单引号");if(e.indexOf('"')>-1)return mo.showMsg("不能包含双引号");if(e.indexOf("\\")>-1)return mo.showMsg("不能包含斜杠");var n=mo.getJSONWithFileName(gc.cfg_c_game),o=t.userCtrl.getLvl(),c=n[gc.id_c_game.guildSet][0];if(c>o)return mo.showMsg("未开启行会系统");var g=gc.iface.a_guild_establishGuild_args,l={};l[g.name]=e,mo.requestWaiting4Server(gc.iface.a_guild_establishGuild,l,function(e){var s=e[gc.dsConsts.ExGuildData.userData]||{},n=e[gc.dsConsts.ExGuildData.guildData]||{},o=e[gc.dsConsts.ExGuildData.guildPersonalData]||{};t.guildPersonalCtrl.updateEntity(o),a.getData()?a.updateEntity(n):a.initData(n),t.userCtrl.updateEntity(s),t.heroCtrl.calPropAndCombat(),r.call(i,n)})},a.seekGuild=function(t,e,r){if(""==t)return mo.showMsg(gc.id_c_msgCode.guildIdIsNull);var i=gc.iface.a_guild_seekGuild_args,a={};a[i.guildId]=t,mo.requestWaiting4Server(gc.iface.a_guild_seekGuild,a,function(t){e.call(r,t)})},a.joinGuild=function(e,r,i){var a=this;if(t.accountCtrl.isGuest())return mo.showMsg(gc.id_c_msgCode.touristForbidGuild);var s=t.guildPersonalCtrl.get(gc.dsConsts.GuildPersonalEntity.lastQuipGuildTime);if(s){var n=60*parseInt(a.getExitGuildCD())*60,o=Date.newDate(s).getTime()+1e3*n;if(Date.newDate(o)>Date.newDate()){var c=Math.ceil((o-Date.newDate().getTime())/36e5);return mo.showMsg(gc.id_c_msgCode.cantEnterGuildCd,c)}a._joinGuild(e,r,i)}else a._joinGuild(e,r,i)},a._joinGuild=function(e,r,i){var a=this,s=gc.iface.a_guild_joinGuild_args,n={};n[s.guildId]=e;var o=mo.getJSONWithFileName(gc.cfg_c_lvl);a.seekGuild(e,function(e){if(!e)return mo.showMsg("该行会已经不存在！");var s=o[e[gc.dsConsts.GuildEntity.lvl]][gc.c_lvl_guildMan],c=e[gc.dsConsts.GuildEntity.guildPopulation];c>=s?mo.showMsg(gc.id_c_msgCode.guildMembersMax,function(){mo.requestWaiting4Server(gc.iface.a_guild_joinGuild,n,function(e){var s=e[gc.dsConsts.ExGuildData.isJoin],n=e[gc.dsConsts.ExGuildData.guildData]||{},o=e[gc.dsConsts.ExGuildData.guildPersonalData]||{};t.guildPersonalCtrl.updateEntity(o),a.getData()?a.updateEntity(n):a.initData(n),r.call(i,s)})}):mo.requestWaiting4Server(gc.iface.a_guild_joinGuild,n,function(e){var s=e[gc.dsConsts.ExGuildData.isJoin],n=e[gc.dsConsts.ExGuildData.guildData]||{},o=e[gc.dsConsts.ExGuildData.guildPersonalData]||{};t.guildPersonalCtrl.updateEntity(o),a.getData()?a.updateEntity(n):a.initData(n),r.call(i,s)})},a)},a.getAppliedMembers=function(t,e){mo.requestWaiting4Server(gc.iface.a_guild_getAppliedMembers,{},function(r){t.call(e,r)})},a.appliedMembersSet=function(e,r,i,a){var s=this,n=gc.iface.a_guild_appliedMembersSet_args,o={};o[n.tUserId]=e,o[n.isConsent]=r,mo.requestWaiting4Server(gc.iface.a_guild_appliedMembersSet,o,function(e){var r=e[gc.dsConsts.ExGuildData.guildData]||{},n=e[gc.dsConsts.ExGuildData.guildPersonalData]||{},o=e[gc.dsConsts.ExGuildData.isAtherGuild],c=e[gc.dsConsts.ExGuildData.isMembersMax];t.guildPersonalCtrl.updateEntity(n),s.getData()?s.updateEntity(r):s.initData(r),o&&mo.showMsg(gc.id_c_msgCode.otherGuildEntered),c&&mo.showMsg(gc.id_c_msgCode.MembersMax),i.call(a,r),s.pushNotify(t.GuildCtrl.ON_GUILD_INFO_CHANGED)})},a.guildSetting=function(e,r,i,a){var s=this,n=gc.iface.a_guild_guildSetting_args,o={};o[n.joinCon]=e,o[n.joinLvl]=r,mo.requestWaiting4Server(gc.iface.a_guild_guildSetting,o,function(e){var r=e[gc.dsConsts.ExGuildData.guildData]||{};s.getData()?s.updateEntity(r):s.initData(r),i.call(a,r),s.pushNotify(t.GuildCtrl.ON_GUILD_INFO_CHANGED,r)})},a.setNotice=function(e,r,i){var a=this,s=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.fuckWord)[0].split(",");if(mo.STR.getStringLength(e)>60)return mo.showMsg(gc.id_c_msgCode.noticeTooLong);if(mo.STR.checkSensitiveWord(e,s))return mo.showMsg("公告内容不合法");var n=gc.iface.a_guild_setNotice_args,o={};o[n.notice]=e,mo.requestWaiting4Server(gc.iface.a_guild_setNotice,o,function(e){var s=e[gc.dsConsts.ExGuildData.guildData]||{},n=e[gc.dsConsts.ExGuildData.guildPersonalData]||{};t.guildPersonalCtrl.updateEntity(n),a.getData()?a.updateEntity(s):a.initData(s),r.call(i,s),a.pushNotify(t.GuildCtrl.ON_GUILD_INFO_CHANGED,s)})},a.exitGuild=function(t,e,r){var i=this;t==gc.c_prop.guildMemberOpKey.quitGuild&&i._exitGuild(e,r),t==gc.c_prop.guildMemberOpKey.dissolveGuild&&i._exitGuild(e,r)},a._exitGuild=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_guild_exitGuild,{},function(a){var s=a[gc.dsConsts.ExGuildData.dissolveId],n=a[gc.dsConsts.ExGuildData.guildPersonalData]||{};if(t.guildPersonalCtrl.updateEntity(n),s)i._data=null;else{var o=a[gc.dsConsts.ExGuildData.guildData]||{};i.getData()?i.updateEntity(o):i.initData(o)}t.heroCtrl.calPropAndCombat(),e.call(r,a)})},a.getRankFileLvl=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_lvl),r=0;if(t<e[1][gc.c_lvl_rankFileNeedAct])return r;for(var i=30;i>=1;i--)if(t>=e[i][gc.c_lvl_rankFileNeedAct]){r=i;break}return r},a.getAwardUi=function(){for(var t=this,e=[],r=mo.getJSONWithFileName(gc.cfg_c_guildEnnoble),i=mo.getJSONWithFileName(gc.cfg_c_guildLvl),a=t.get(gc.dsConsts.GuildEntity.lvl),s=t.get(gc.dsConsts.GuildEntity.ennobleData),n=0,o={},c=i[a][gc.c_guildLvl_ennobleCount],g=0;g<c.length;g++){var l=0,_=c[g][0],u=r[_][gc.c_guildEnnoble_ennobleLvlCfg];s[_]&&(l=s[_]),_>n&&(n=_),o[_]=[l,c[g][1],u]}for(var d in o){var p=o[d];e.push([d,p[1]-p[0],p[1],p[2]])}if(r[n+1]){var m=r[n+1][gc.c_guildEnnoble_ennobleGuildLvlCfg];e.push([n+1,999,999,r[n+1][gc.c_guildEnnoble_ennobleLvlCfg],r[n+1][gc.c_guildEnnoble_props],m])}return e},a.getMembers=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_guildPerson_getMemberList,{},function(i){i.sort(function(t,e){var r=t[gc.dsConsts.GuildMember.position]-e[gc.dsConsts.GuildMember.position];if(0!=r)return r;var i=e[gc.dsConsts.GuildMember.guildAct]-t[gc.dsConsts.GuildMember.guildAct];if(0!=i)return i;var a=e[gc.dsConsts.GuildMember.lvl]-t[gc.dsConsts.GuildMember.lvl];if(0!=a)return a;var s=t[gc.dsConsts.GuildMember.lastUpdateTime]-e[gc.dsConsts.GuildMember.lastUpdateTime];return 0!=s?s:void 0}),r._memberList=i,t.call(e,i)})},a.getMemberList=function(){var t=this;return t._memberList},a.getMemberByUserId=function(t){for(var e=this,r=0;r<e._memberList.length;++r){var i=e._memberList[r];if(i[gc.dsConsts.GuildMember.userId]==t)return i}return null},a.getMemberData=function(t,e,r){for(var i=this,a=null,s=0;s<i._memberList.length;s++){var n=i._memberList[s],o=n[gc.dsConsts.GuildMember.userId];if(o==t){a=n;break}}e.call(r,a)},a.setEnnoble=function(e,r,i,a){var s=this,n=gc.iface.a_guild_setEnnoble_args,o={};o[n.targetUserId]=e,o[n.ennobleType]=r,mo.requestWaiting4Server(gc.iface.a_guild_setEnnoble,o,function(r){var n=r[gc.dsConsts.ExGuildData.guildData]||{};if(s.updateEntity(n),e==t.userCtrl.getId()){var o=r[gc.dsConsts.ExGuildData.guildPersonalData]||{};t.guildPersonalCtrl.updateEntity(o),t.heroCtrl.calPropAndCombat()}s.pushNotify(s.__class.ON_MEMBER_JOB_CHANGE,e),i.call(a,r)})},a.opMember=function(e,r,i,a,s,n){var o=this,c=0;if(e==gc.c_prop.guildMemberOpKey.increase?c=0:e==gc.c_prop.guildMemberOpKey.trans?c=gc.id_c_msgCode.ifRetiringGuildMaster:e==gc.c_prop.guildMemberOpKey.kick?c=0:e==gc.c_prop.guildMemberOpKey.dissolveGuild&&(c=0),n||0==c){var g=gc.iface.a_guildPerson_opMember_args,l={};return l[g.targetUserId]=r,l[g.op]=e,void mo.requestWaiting4Server(gc.iface.a_guildPerson_opMember,l,function(e){var r=e[gc.dsConsts.ExGuildData.guildData]||{};o.updateEntity(r);var i=e[gc.dsConsts.ExGuildData.guildPersonalData]||{};t.guildPersonalCtrl.updateEntity(i),a.call(s,e),o.pushNotify(t.GuildCtrl.ON_MANAGER_POSITION_CHANGED)})}if(0!=c){if(t.guildWarCtrl.isOpening())return void mo.showMsg(gc.id_c_msgCode.noGuildTransfer);mo.showMsg(c,i,function(){o.opMember(e,r,i,a,s,!0)})}},a.lottery=function(e,r,i){var a=gc.iface.a_guild_lottery_args,s={};s[a.count]=e;var n=mo.getJSONWithFileName(gc.cfg_c_game),o=n[gc.id_c_game.guildAct][2],c=t.guildPersonalCtrl.get(gc.dsConsts.GuildPersonalEntity.addUpAct);mo.getJSONWithFileNameAndID(gc.cfg_c_vip,t.userCtrl.getVip()),t.guildPersonalCtrl.getData();return o>c?mo.showMsg("贡献值不足"):void mo.requestWaiting4Server(gc.iface.a_guild_lottery,s,function(e){var a=e[gc.dsConsts.ExGuildData.userData]||{},s=e[gc.dsConsts.ExGuildData.guildPersonalData]||{},n=e[gc.dsConsts.ExGuildData.items]||{},o=e[gc.dsConsts.ExGuildData.bagItems]||{},c=e[gc.dsConsts.ExGuildData.equipBagItems]||{},g=t.userUtils.getNewBag({},o);a[gc.dsConsts.UserEntity.bag]=g;var l=t.userUtils.getNewEquipBag({},c);a[gc.dsConsts.UserEntity.equipBag]=l,t.userCtrl.updateEntity(a),t.guildPersonalCtrl.updateEntity(s),r.call(i,n)})},a._getPropByIndex=function(t){var e=this;if(!e._data)return 0;for(var r=e.get(gc.dsConsts.GuildEntity.lvl),i=mo.getJSONWithFileName(gc.cfg_c_guildLvl),a=i[r],s=a[gc.c_guildLvl_props],n=0,o=0;o<s.length;o++){var c=s[o],g=c[0],l=c[1];if(g==t){n=l;break}}return n},a.getAddCombat=function(){var e=this,r=mo.getJSONWithFileName(gc.cfg_c_game),i=mo.getJSONWithFileName(gc.cfg_c_guildEnnoble),a=t.guildPersonalCtrl.getEnnoble(),s=0;i[a]&&(s=i[a][gc.c_guildEnnoble_props]||0,s/=1e4);var n=e._getPropByIndex(33)*(1+s),o=e._getPropByIndex(34)*(1+s),c=e._getPropByIndex(35)*(1+s),g=e._getPropByIndex(36)*(1+s),l=e._getPropByIndex(39)*(1+s),_=e._getPropByIndex(40)*(1+s),u=e._getPropByIndex(38)*(1+s),d=e._getPropByIndex(37)*(1+s),p=500;n=Math.floor(n),o=Math.floor(o),c=Math.floor(c),g=Math.floor(g),l=Math.floor(l),_=Math.floor(_),u=Math.floor(u),d=Math.floor(d);var m=r[gc.id_c_game.combatMult],f=m[0]/1e4,h=m[1]/1e4,y=m[2]/1e4,C=m[3]/1e4,v=m[4]/1e4,I=m[5]/1e4,E=m[6]/1e4,D=m[7]/1e4,b=m[8],S=gc.calBaseCombat(n,f,o,h,c,y,g,C,l,E,_,D,u,I,d,v,p,b);S=parseInt(S.toString());var N=t.heroCtrl.getList().length;return S*N},a.getCopyResetTimes=function(){var t=this;return t.getData()?t.get(gc.dsConsts.GuildEntity.resetCount)||0:0},r.ON_MANAGER_POSITION_CHANGED="on_manager_position_changed",r.ON_GUILD_INFO_CHANGED="on_guildinfo_changed",r.ON_MEMBER_JOB_CHANGE="ON_MEMBER_JOB_CHANGE",r}(mo.DataController);t.GuildCtrl=e,egret.registerClass(e,"gd.GuildCtrl"),t.guildCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this._guildCopyArr=[-1]},a.initData=function(t){if(t){var e=this;e.init(t)}},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.getGuildSection=function(){for(var t=mo.getJSONWithFileName(gc.cfg_t_guildCopy),e=[],r=1,i=Object.keys(t).length;i>=r;++r)e.push(t[r]);return e},a.getSectionInfo=function(t){return mo.getJSONWithFileNameAndID(gc.cfg_t_guildCopy,t)},a.getGuildBossList=function(t){for(var e=this,r=e.getSectionInfo(t),i=r[gc.t_guildCopy_section],a=[],s=parseInt(i[0]),n=parseInt(i[1]);n>=s;++s)a.push(s);return a},a.getGuildBossListLength=function(t){var e=this,r=e.getSectionInfo(t),i=r[gc.t_guildCopy_section];return parseInt(i[1])-parseInt(i[0])+1},a.getGuildProgress=function(e){var r=0,i=t.guildCtrl.get(gc.dsConsts.GuildEntity.guildCopyData);return i[e]?(i[e][0]&&(r=i[e][0]),r):0},a.getNewGuildBossId=function(){var e={};if(!t.guildCtrl.getData())return e;var r=t.guildCtrl.get(gc.dsConsts.GuildEntity.guildCopyData),i=mo.getJSONWithFileName(gc.cfg_t_guildCopy),a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.guildCopyCfg][2];for(var n in i){for(var o=i[n][gc.t_guildCopy_section],c=o[0],g=o[1],l=!0,_=c;g>=_;_++)if(!r[_]||!r[_][0]||r[_][0]<s){e[n]=_,l=!1;break}l&&(e[n]=-1)}return e},a.getCurBossId=function(t){var e=this,r=e.getNewGuildBossId()[t];if(0>r){var i=e.getSectionInfo(t);r=parseInt(i[gc.t_guildCopy_section][1])}return r},a.isBossKilled=function(t,e){var r=this,i=r.getNewGuildBossId()[t];return i>0?parseInt(i)>parseInt(e):!0},a.getGuildCopyCdState=function(){var t=this,e={threshold:mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.guildCopyCfg)[3],needBuy:!1};return e.needBuy=t.isNeedClearFightCD(),e},a.isNeedClearFightCD=function(){var e=!1,r=t.copyCtrl.getCopyProgressCtrl(gc.c_prop.copyTypeKey.guild),i=r.get(gc.dsConsts.CopyProgressEntity.refreshTime);if(i){var a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.guildCopyCfg][3],n=r.get(gc.dsConsts.CopyProgressEntity.pCopyId)||0,o=(Date.newDate().getTime()-Date.newDate(i).getTime())/1e3;n>=s&&n>o&&(e=!0)}return e},a.getGuildCopyCd=function(){var e=t.copyCtrl.getCopyProgressCtrl(gc.c_prop.copyTypeKey.guild),r=e.get(gc.dsConsts.CopyProgressEntity.pCopyId)||0,i=e.get(gc.dsConsts.CopyProgressEntity.refreshTime);if(i){var a=(Date.newDate().getTime()-Date.newDate(i).getTime())/1e3;r-=a}return 0>r&&(r=0),r},a.getResetCd=function(){var e=mo.getJSONWithFileName(gc.cfg_c_game),r=e[gc.id_c_game.guildCopyCfg][1],i=0,a=t.guildCtrl.get(gc.dsConsts.GuildEntity.resetTime);if(!a)return i;var s=Date.newDate(a).addDays(r);return Date.newDate()>=s?i:i=(s.getTime()-Date.newDate().getTime())/1e3},a.getCompletedNum=function(t){var e=this,r=parseInt(e.getNewGuildBossId()[t]);if(r>0){var i=e.getSectionInfo(t);return r-parseInt(i[gc.t_guildCopy_section][0])}return e.getGuildBossListLength(t)},a.guildStart=function(e,r,i,a){var s=this;if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(t.fightCtrl.isDie)return mo.showMsg("复活中，请稍后");var n=s.getGuildCopyCd(),o=s.getGuildCopyCdState().needBuy;if(n&&o){var c=gc.calGuildCopyCd(t.guildCopyCtrl.getGuildCopyCd());return void mo.showMsg(gc.id_c_msgCode.buyTime,c,function(){t.userCtrl.getGold()<c?t.userCtrl.noGolds(function(){s.clearGuildCopy(r,function(){},s)},s):s.clearGuildCopy(r,function(){},s)})}var g=mo.getJSONWithFileName(gc.cfg_t_guildCopy);if(!g[e])return mo.showMsg("数据异常");var l=g[e][gc.t_guildCopy_section];if(r<l[0]||r>l[1])return mo.showMsg("数据异常");var _=g[e][gc.t_guildCopy_openLvl];if(!t.guildCtrl.getData())return mo.showMsg("数据异常");var u=t.guildCtrl.get(gc.dsConsts.GuildEntity.lvl);if(_>u)return mo.showMsg("行会等级不足");this._guildCopyArr[0]=e,this._guildCopyArr[1]=r;var d=gc.iface.a_copy_guildStart_args,p={};p[d.copyId]=e,p[d.bossId]=r,s.curFightGuildBossId=r,mo.requestWaiting4Server(gc.iface.a_copy_guildStart,p,function(e){t.fightCtrl.isSpFighting=!0;var s=mo.getJSONWithFileNameAndID(gc.cfg_t_guildCopyBoss,r),n=s[gc.t_guildCopyBoss_copyId];mo.moduleMgr.curModule.name!=g_consts.moduleId.fight&&mo.moduleMgr.runModule(g_consts.moduleId.fight),t.fightLayer.onEnterCopy({pveType:gc.c_prop.fightTypeKey.guildCopy,copyID:n,bossId:r}),i.call(a,e)})},a.guildEnd=function(e,r,i){if(-1!=this._guildCopyArr[0]){var a=this,s=this._guildCopyArr[0],n=this._guildCopyArr[1],o=gc.iface.a_copy_guildEnd_args,c={};c[o.copyId]=s,c[o.bossId]=n,c[o.isWin]=e,a._guildCopyArr[0]=-1,mo.requestWaiting4Server(gc.iface.a_copy_guildEnd,c,function(e){var a=e[gc.dsConsts.ExCopyProgress.msg]||"";if(a.length>0)return mo.showMsg(a),r.call(i,[0,0,{}]);var s=e[gc.dsConsts.ExCopyProgress.userData]||{},n=e[gc.dsConsts.ExCopyProgress.copyProgress]||{},o=e[gc.dsConsts.ExCopyProgress.bagItems]||{},c=e[gc.dsConsts.ExCopyProgress.equipBagItems]||{},g=e[gc.dsConsts.ExCopyProgress.isWin],l=e[gc.dsConsts.ExCopyProgress.progress]||0,_=e[gc.dsConsts.ExCopyProgress.items]||{},u=t.userUtils.getNewBag({},o);s[gc.dsConsts.UserEntity.bag]=u;var d=t.userUtils.getNewEquipBag({},c);s[gc.dsConsts.UserEntity.equipBag]=d,s&&t.userCtrl.updateEntity(s),n&&t.copyCtrl.updateCopyProgressCtrl(gc.c_prop.copyTypeKey.guild,n);var p=e[gc.dsConsts.ExCopyProgress.guildData];p&&t.guildCtrl.updateData(p),r.call(i,[g,l,_])})}},a.guildCopyReset=function(e,r){mo.showMsg(gc.id_c_msgCode.resetCopy,function(){mo.requestWaiting4Server(gc.iface.a_copy_guildCopyReset,{},function(i){i&&(t.guildCtrl.getData()?t.guildCtrl.updateEntity(i):t.guildCtrl.initData(i)),e.call(r,i)})})},a.clearGuildCopy=function(e,r,i){var a=this,s=gc.iface.a_copy_clearGuildCopy_args,n={};n[s.bossId]=e,mo.requestWaiting4Server(gc.iface.a_copy_clearGuildCopy,n,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.copyProgressData]||{};t.userCtrl.updateEntity(s),t.copyCtrl.updateCopyProgressCtrl(gc.c_prop.copyTypeKey.guild,n),a.pushNotify(a.__class.ON_GUILD_COPY_CD_CLEAR),r.call(i,e)})},a.getBuyCopyCount=function(){var e=gc.c_prop.copyTypeKey.guild,r=t.copyCtrl.getCopyProgressCtrl(e),i=1,a=r.get(gc.dsConsts.CopyProgressEntity.resetTime),s=r.get(gc.dsConsts.CopyProgressEntity.resetCounts);return a?(a&&Date.newDate(a).equalsDay(Date.newDate())||(s={}),a&&Date.newDate(a).equalsDay(Date.newDate())&&s.hasOwnProperty(e)?s[e]+1:i):i},a.getCopyCount=function(e){var r=mo.getJSONWithFileName(gc.cfg_c_vip),i=t.copyCtrl.getCopyProgressCtrl(gc.c_prop.copyTypeKey.guild),a=t.userCtrl.getVip()||0,s=r[a][gc.c_vip_guildFbCount],n=s-r[0][gc.c_vip_guildFbCount];if(!i.get(gc.dsConsts.CopyProgressEntity.refreshTime))return s;var o=Date.newDate(i.get(gc.dsConsts.CopyProgressEntity.refreshTime)),c=i.get(gc.dsConsts.CopyProgressEntity.timesPerDay);return o&&o.equalsDay(Date.newDate())&&c.hasOwnProperty(e)?parseInt(c[e])+n:s},a.getMaxCopyCount=function(){return mo.getJSONWithFileNameAndID(gc.cfg_c_vip,t.userCtrl.getVip())[gc.c_vip_guildFbCount]},a.guildCopyAward=function(e,r,i,a){var s=gc.iface.a_copy_guildCopyAward_args,n={};n[s.type]=e,n[s.typeId]=r,mo.requestWaiting4Server(gc.iface.a_copy_guildCopyAward,n,function(e){var r=e[gc.dsConsts.ExCopyProgress.userData]||{},s=e[gc.dsConsts.ExCopyProgress.copyProgress]||{},n=e[gc.dsConsts.ExCopyProgress.bagItems]||{},o=e[gc.dsConsts.ExCopyProgress.equipBagItems]||{},c=t.userUtils.getNewBag({},n);r[gc.dsConsts.UserEntity.bag]=c;var g=t.userUtils.getNewEquipBag({},o);r[gc.dsConsts.UserEntity.equipBag]=g,r&&t.userCtrl.updateEntity(r),s&&t.copyCtrl.updateCopyProgressCtrl(gc.c_prop.copyTypeKey.guild,s),i.call(a,s)})},a._calProgress=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_game),r=e[gc.id_c_game.guildCopyCfg][2];return t=Math.floor(t/r*1e4)/100,t>100&&(t=100),t},a.getSectionIdByBossId=function(t){var e=mo.getJSONWithFileName(gc.cfg_t_guildCopy);for(var r in e){var i=e[r][gc.t_guildCopy_section];if(parseInt(t)>=parseInt(i[0])&&parseInt(t)<=parseInt(i[1]))return parseInt(r)}return-1},a.getMaxKillTimes=function(){return mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.guildCopyCfg)[2]},r.ON_GUILD_COPY_CD_CLEAR="on_guild_copy_cd_clear",r}(mo.DataController);t.GuildCopyCtrl=e,egret.registerClass(e,"gd.GuildCopyCtrl"),t.guildCopyCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.GuildPersonalEntity},a.initData=function(t){if(t){var e=this;e.init(t)}},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.getEnnoble=function(){var t=this,e=t.get(gc.dsConsts.GuildPersonalEntity.ennoble)||0;return e},a.getPosition=function(){var t=this,e=t.get(gc.dsConsts.GuildPersonalEntity.position)||3;return e},a.getGuildId=function(){var t=this,e=t.get(gc.dsConsts.GuildPersonalEntity.guildId)||0;return e},a.getContributeValue=function(){var t=this,e=t.get(gc.dsConsts.GuildPersonalEntity.guildAct)||0;return e},a.getSumContribute=function(){var t=this,e=t.get(gc.dsConsts.GuildPersonalEntity.addUpAct)||0;return e},a.getActMaxNum=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_guildAct),r=e[t];return r[gc.c_guildAct_num]},a.getActNum=function(t){var e=this;e._calRefreshData();var r=e.get(gc.dsConsts.GuildPersonalEntity.actData)||{},i=r[t]||[];return i[0]||0},a._calRefreshData=function(){var t=this,e=t.get(gc.dsConsts.GuildPersonalEntity.actLastTime),r=t.get(gc.dsConsts.GuildPersonalEntity.actData),i=t.get(gc.dsConsts.GuildPersonalEntity.todayAct),a=t.get(gc.dsConsts.GuildPersonalEntity.noticeCount),s=t.get(gc.dsConsts.GuildPersonalEntity.exitGuildCount),n=t.get(gc.dsConsts.GuildPersonalEntity.lotteryCount);e||(e=Date.newDate(),r={},i=0,a=0,s=0,n=0,t.set(gc.dsConsts.GuildPersonalEntity.actLastTime,e),t.set(gc.dsConsts.GuildPersonalEntity.actData,r),t.set(gc.dsConsts.GuildPersonalEntity.todayAct,i),t.set(gc.dsConsts.GuildPersonalEntity.noticeCount,a),t.set(gc.dsConsts.GuildPersonalEntity.exitGuildCount,s),t.set(gc.dsConsts.GuildPersonalEntity.lotteryCount,n)),e=new Date(e),e.equalsDay(Date.newDate())||(e=Date.newDate(),r={},i=0,a=0,s=0,n=0,t.set(gc.dsConsts.GuildPersonalEntity.actLastTime,e),t.set(gc.dsConsts.GuildPersonalEntity.actData,r),t.set(gc.dsConsts.GuildPersonalEntity.todayAct,i),t.set(gc.dsConsts.GuildPersonalEntity.noticeCount,a),t.set(gc.dsConsts.GuildPersonalEntity.exitGuildCount,s),t.set(gc.dsConsts.GuildPersonalEntity.lotteryCount,n))},a.pickAct=function(e,r,i){var a=this,s=gc.iface.a_guildPerson_pickAct_args,n={};n[s.actId]=e,mo.requestWaiting4Server(gc.iface.a_guildPerson_pickAct,n,function(s){var n=s[gc.dsConsts.ExGuildData.guildData]||{};t.guildCtrl.updateEntity(n);var o=s[gc.dsConsts.ExGuildData.userData]||{};t.userCtrl.updateEntityNotShow(o);var c=s[gc.dsConsts.ExGuildData.guildPersonalData]||{};a.updateEntity(c);var g=mo.getJSONWithFileNameAndID(gc.cfg_c_guildAct,e),l=g[gc.c_guildAct_act]||0,_=g[gc.c_guildAct_gold]||0,u="";l>0&&(u="贡献值 +"+l),_>0&&(l>0&&(u+=" "),u+="金币 +"+_),mo.showMsg(u),r.call(i,s)})},r}(mo.DataController);t.GuildPersonalCtrl=e,egret.registerClass(e,"gd.GuildPersonalCtrl"),t.guildPersonalCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.getLastMyData=function(){var t=this;return t._lastMyData?t._lastMyData:[null,null,null]},this._calGuildWarList=function(t){var e=this;t=e._sortGuildWarList(t);for(var r=[],i=[],a=0;a<t.length;a++){var s=t[a],n=s[gc.dsConsts.GuildServer.doorLives];n>0?r.push(s):i.push(s)}var o=r.concat(i);return o},this._sortGuildWarList=function(t){var e=this;e._sortGuildWarList1(t);var r=t[0],i=0;r&&(i=r[gc.dsConsts.GuildServer.points]);for(var a=0;a<t.length;a++){var s=t[a];s[gc.dsConsts.GuildServer.maxPoints]=i,s[gc.dsConsts.GuildServer.progress]=Math.floor(Math.floor(s[gc.dsConsts.GuildServer.points])/Math.floor(s[gc.dsConsts.GuildServer.maxPoints])*100)}return t}}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.MyGuildWarData,this._fightRecordArr=[],this._isEnter=!1,this._lastRecordId=0,this._isOpen=0,this._guildListUpdateNum=0,this._updateAttackWarDic={},this._isFighting=!1},a.setSyncSceneType=function(t){this._sceneType=t},a.exitSyncScenne=function(){this._sceneType=0},a.getInfo=function(e,r){var i=this;t.guildCtrl.getId();mo.requestWaiting4Server(gc.iface.a_guildWar_getInfo,{},function(t){i.init(t),e&&e.call(r,t)})},a.setCfgData=function(t){this._cfgData=t},a.getCfgData=function(){return this._cfgData},a.isOpening=function(){return this._isOpen},a.setIsOpen=function(t){var e=this,r=e._isOpen;r!=t&&(e._isOpen=t,1==t?(e.pushNotify(e.__class.ON_GUILD_OPEN_CHANGE),e._overTime=null):e._overTime=Date.newDate())},a.getOpenReSeconds=function(){return 108e3},a.getSignUpData=function(e,r){var i=this,a=t.guildCtrl.getId();if(!a)return e.call(r,[0,0]);var s=gc.iface.a_guildWar_getSignUpData_args,n={};n[s.guildId]=a,mo.requestWaiting4Server(gc.iface.a_guildWar_getSignUpData,n,function(t){var a=t[gc.dsConsts.SignData.signGroupId],s=t[gc.dsConsts.SignData.lastGroupId],n=t[gc.dsConsts.SignData.lastGuildRank],o=t[gc.dsConsts.SignData.lastUserRank],c=t[gc.dsConsts.SignData.isPrize];i._lastMyData=[s,n,o,c],e&&e.call(r,[a])})},a.signUp=function(t,e,r){var i=gc.iface.a_guildWar_signUp_args,a={};a[i.groupId]=t,mo.requestWaiting4Server(gc.iface.a_guildWar_signUp,a,function(t){e&&e.call(r,t)})},a.getGuildList=function(e,r){var i=this,a={},s=t.guildCtrl.getId();if(!s)return e.call(r,[]);if(i._guildWarList)return e.call(r,i._guildWarList);var n=gc.iface.a_guildWar_getGuildList_args,a={};a[n.guildId]=s,mo.requestWaiting4Server(gc.iface.a_guildWar_getGuildList,a,function(t){var a=i._calGuildWarList(t);i._guildWarList=a,e&&e.call(r,a)})},a._sortGuildWarList1=function(t){var e=[gc.dsConsts.GuildServer.points,gc.dsConsts.GuildServer.doorLives,gc.dsConsts.GuildServer.lastLootTime],r=[-1,1,1];return t.sort(function(t,i){for(var a=0;3>a;a++){var s=r[a];if(t[e[a]]>i[e[a]])return 0>=s?-1:1;if(t[e[a]]<i[e[a]])return 0>=s?1:-1}return 0}),t},a.getWarAttackData=function(t,e,r,i){var a=this;a._attackWarServerId=t,a._attackWarGuildId=e;var s=a._updateAttackWarDic[t+"|"+e];if(s)return r.call(i,s);var n=gc.iface.a_guildWar_getWarAttackData_args,o={};o[n.serverId]=t,o[n.guildId]=e,mo.requestWaiting4Server(gc.iface.a_guildWar_getWarAttackData,o,function(s){a._updateAttackWarDic[t+"|"+e]=s,r&&r.call(i,s)})},a.getWarDefenceData=function(e,r){var i=this,a=t.guildCtrl.getId();if(!a)return e.call(r,null);if(i._defenceData)return e.call(r,i._defenceData);var s=gc.iface.a_guildWar_getWarDefenceData_args,n={};n[s.guildId]=a,mo.requestWaiting4Server(gc.iface.a_guildWar_getWarDefenceData,n,function(t){i._defenceData=t,e&&e.call(r,t)})},a.upDoor=function(e,r,i){var a=this;if(t.fightCtrl.isSpFighting&&a._isFighting)return mo.showMsg(gc.id_c_msgCode.nowAttack);var s=gc.iface.a_guildWar_upDoor_args,n={};n[s.door]=e,mo.requestWaiting4Server(gc.iface.a_guildWar_upDoor,n,function(t){1==t&&mo.showMsg(gc.id_c_msgCode.haveGuard),a._defenceData=null,a.syncData(),r&&r.call(i,t)})},a.downDoor=function(t,e,r){var i=this,a=gc.iface.a_guildWar_downDoor_args,s={};s[a.door]=t,mo.requestWaiting4Server(gc.iface.a_guildWar_downDoor,s,function(t){i._defenceData=null,i.syncData(),e&&e.call(r,t)})},a.getGuildWarAllRank=function(t,e){var r={},i=this;mo.requestWaiting4Server(gc.iface.a_guildWar_getGuildWarAllRank,r,function(r){i._pointsRankList=r[gc.dsConsts.GuildWarAllRank.guildArr],i._chairRankList=r[gc.dsConsts.GuildWarAllRank.chairArr],i._userRankList=r[gc.dsConsts.GuildWarAllRank.userArr],t&&t.call(e,r)})},a.getLastRankList=function(t,e,r){var i=this,a=gc.iface.a_guildWar_getLastRankList_args,s={};s[a.groupId]=t,mo.requestWaiting4Server(gc.iface.a_guildWar_getLastRankList,s,function(t){i._pointsRankList=t[gc.dsConsts.GuildWarAllRank.guildArr],i._chairRankList=t[gc.dsConsts.GuildWarAllRank.chairArr],i._userRankList=t[gc.dsConsts.GuildWarAllRank.userArr],e&&e.call(r,t)})},a.getMyPointRank=function(){for(var e=this,r=t.guildCtrl.getId(),i=t.userCtrl.get(gc.dsConsts.UserEntity.serverId),a=0;a<e._pointsRankList.length;a++){var s=e._pointsRankList[a],n=s[gc.dsConsts.GuildWarRank.guildId],o=s[gc.dsConsts.GuildWarRank.serverId];if(r==n&&o==i)return s}return null},a.getMyChairRank=function(){for(var e=this,r=t.userCtrl.getId(),i=t.userCtrl.get(gc.dsConsts.UserEntity.serverId),a=0;a<e._chairRankList.length;a++){var s=e._chairRankList[a],n=s[gc.dsConsts.GuildWarUserRank.userId],o=s[gc.dsConsts.GuildWarUserRank.serverId];if(n==r&&o==i)return s}return null},a.getMyUserRank=function(){for(var e=this,r=t.userCtrl.getId(),i=t.userCtrl.get(gc.dsConsts.UserEntity.serverId),a=0;a<e._userRankList.length;a++){var s=e._userRankList[a],n=s[gc.dsConsts.GuildWarUserRank.userId],o=s[gc.dsConsts.GuildWarUserRank.serverId];if(n==r&&o==i)return s}return null},a.getDefenceRecordList=function(t,e){var r={};mo.requestWaiting4Server(gc.iface.a_guildWar_getDefenceRecordList,r,function(r){t&&t.call(e,r)})},a.getAttackRecordList=function(t,e){var r={};mo.requestWaiting4Server(gc.iface.a_guildWar_getAttackRecordList,r,function(r){t&&t.call(e,r)})},a.fightStartDoor=function(e,r,i,a,s){var n=this;if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(t.fightCtrl.isDie)return mo.showMsg("复活中，请稍后");var o=gc.iface.a_guildWar_fightStartDoor_args,c={};c[o.serverId]=e,c[o.guildId]=r,c[o.door]=i,n._fightServerId=e,n._fightGuildId=r,n._fightDoor=i;var g=n.get(gc.dsConsts.MyGuildWarData.isDefence);if(g)return mo.showMsg("防守中，请先进行下阵!");var l=n.get(gc.dsConsts.MyGuildWarData.doorLives);return 0>=l?mo.showMsg(gc.id_c_msgCode.noSnatch):n.getFightCd()>0?void mo.showMsg(gc.id_c_msgCode.buyManyCD,n.getClearCdCount(),n.getClearCdCost(),function(){n.clearCd(function(){n.fightStartDoor(e,r,i,a,s)},n)}):void mo.requestWaiting4Server(gc.iface.a_guildWar_fightStartDoor,c,function(o){var c=o[gc.dsConsts.GuildFightData.myGuildWarData];c&&n.updateEntity(c);var g=o[gc.dsConsts.GuildFightData.isBreak];if(g)return void mo.showMsg(gc.id_c_msgCode.guardDown,function(){n._updateAttackWarDic={},n.pushNotify(n.__class.ON_GUILD_ATK_UPDATE,e,r)});var l=o[gc.dsConsts.GuildFightData.directWin],_=o[gc.dsConsts.GuildFightData.getPoints];if(l)return void mo.showMsg(gc.id_c_msgCode.noGuard,_,function(){n._updateAttackWarDic={},n.pushNotify(n.__class.ON_GUILD_ATK_UPDATE,e,r)});for(var u=o[gc.dsConsts.GuildFightData.heroList],d=o[gc.dsConsts.GuildFightData.otherDataList],p=o[gc.dsConsts.GuildFightData.fightData],m=[],f=0;f<u.length;f++){var h=u[f],y=t.HeroEntityCtrl.createNewEnemy(h,p,d[f]);
m.push(y)}m.sort(t.heroCtrl._sortHeroList),t.fightCtrl.isSpFighting=!0,n._isFighting=!0;var C=t.heroCtrl.getFightList();t.fightCtrl.startPvpFight(C,m,gc.c_prop.fightTypeKey.guildWar),process.nextTick(function(){process.nextTick(function(){process.nextTick(function(){process.nextTick(function(){n.pushNotify(n.__class.ON_GUILD_WAR_FIGHT,e,i)})})})}),a&&a.call(s,m)})},a.fightEndDoor=function(t,e,r){var i=this;i._isFighting=!1;var a=gc.iface.a_guildWar_fightEndDoor_args,s={};s[a.serverId]=i._fightServerId,s[a.guildId]=i._fightGuildId,s[a.door]=i._fightDoor,s[a.isWin]=t,mo.requestWaiting4Server(gc.iface.a_guildWar_fightEndDoor,s,function(t){var a=t[gc.dsConsts.FightResult.coffersStatus];1==a&&i.set(gc.dsConsts.MyGuildWarData.nextFightTime,Date.newDate());var s=t[gc.dsConsts.FightResult.guildWarStatus];2==s&&mo.showMsg("活动已经结束！"),3==s&&(mo.showMsg("抢夺失败！CD重置！"),i.set(gc.dsConsts.MyGuildWarData.nextFightTime,Date.newDate())),e&&e.call(r,t)})},a.enter=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_guildWar_enter,{},function(i){r._isEnter=!0,t&&t.call(e,i)})},a.getLastPointsRankList=function(t,e,r){e&&e.call(r)},a.clearCd=function(e,r){var i=this,a={};mo.requestWaiting4Server(gc.iface.a_guildWar_clearCd,a,function(a){var s=a[gc.dsConsts.ExMyGuildWarData.userData];t.userCtrl.updateEntity(s);var n=a[gc.dsConsts.ExMyGuildWarData.myGuildWarData];i.updateEntity(n),e.call(r,a)})},a.inspire=function(e,r){var i=this,a={};mo.requestWaiting4Server(gc.iface.a_guildWar_inspire,a,function(a){var s=a[gc.dsConsts.ExMyGuildWarData.userData];t.userCtrl.updateEntity(s);var n=a[gc.dsConsts.ExMyGuildWarData.myGuildWarData];i.updateEntity(n),e.call(r,a)})},a.getInspireCost=function(){var e=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.inspireGuildWar),r=gc.calInspireGuildWar(e+1);return r},a.getClearCdCost=function(){var e=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.clearGuildWarCount),r=gc.calClearGuildWarCd(e+1);return r},a.getInspireCount=function(){var e=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.inspireGuildWar);return e+1},a.getClearCdCount=function(){var e=t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.clearGuildWarCount);return e+1},a.syncData=function(){var t=this;if(t.getData()&&t._isEnter){if(!t.isOpening()){if(!t._overTime)return;var e=t._overTime.getSecondsBetween(new Date);if(e>60)return}var r=gc.iface.a_guildWar_syncData_args,i={};i[r.sceneType]=t._sceneType;var a=[t._attackWarServerId,t._attackWarGuildId];2==t._sceneType&&(i[r.attackData]=a);t.get(gc.dsConsts.MyGuildWarData.myGuildRefreshId);mo.request4Server(gc.iface.a_guildWar_syncData,i,function(e){var r=e[gc.dsConsts.GuildWarSyncData.myGuildWarData];r&&t.updateEntity(r);var i=e[gc.dsConsts.GuildWarSyncData.fightRecordArr];t._calFightRecord(i);var s=e[gc.dsConsts.GuildWarSyncData.guildList];if(s){var n=t._calGuildWarList(s);t._guildWarList=n,t.pushNotify(t.__class.ON_GUILD_LIST_UPDATE)}var o=e[gc.dsConsts.GuildWarSyncData.attackData];o&&(t._updateAttackWarDic[a[0]+"|"+a[1]]=o,t.pushNotify(t.__class.ON_GUILD_ATK_UPDATE,t._attackWarServerId,t._attackWarGuildId));var c=e[gc.dsConsts.GuildWarSyncData.defenceData];c&&(t._defenceData=c,t.pushNotify(t.__class.ON_GUILD_DEF_UPDATE))})}},a._calFightRecord=function(e){for(var r=this,i=[],a=e.length-1;a>=0;a--){var s=e[a],n=s[gc.dsConsts.GuildWarFightRecord.id],o=s[gc.dsConsts.GuildWarFightRecord.type];if(1==o){var c=s[gc.dsConsts.GuildWarFightRecord.attackData],g=c[0];if(g==t.userCtrl.getName())continue}if(n>r._lastRecordId&&i.unshift(s),i.length>=6)break}if(r._fightRecordArr=i,!(i.length<=0)){r._lastRecordId=i[i.length-1][gc.dsConsts.GuildWarFightRecord.id];for(var l="[ubb size=20 color=#00b1f1]%s[/ubb][ubb size=20 color=#ffff00]攻打了[/ubb][ubb size=20 color=#7030a1][%s][/ubb][ubb size=20 color=#ffe599]%s门[/ubb]",_="[ubb size=20 color=#ffe599]行会%s门正在被[/ubb][ubb size=20 color=#7030a1][%s][/ubb][ubb size=20 color=#ff0000]%s[/ubb][ubb size=20 color=#ffe599]攻打[/ubb]",u="",a=0;a<i.length;++a){var s=i[a],d=s[gc.dsConsts.GuildWarFightRecord.type];if(1==d){var p=s[gc.dsConsts.GuildWarFightRecord.attackData];u=mo.STR.format(l,p[0],p[2],gc.c_prop.guildWarDoor[p[3]])}else if(2==d){var m=s[gc.dsConsts.GuildWarFightRecord.beAttackData];u=mo.STR.format(_,gc.c_prop.guildWarDoor[m[0]],m[2],m[3])}g_msg.UIMsgTextCtrl.push(u)}}},a.getFightCd=function(){var t=this,e=t.get(gc.dsConsts.MyGuildWarData.nextFightTime);e=Date.newDate(e);var r=Date.newDate().getSecondsBetween(e);return 0>=r&&(r=0),r},a.getInspireReSeconds=function(){var t=this,e=t.get(gc.dsConsts.MyGuildWarData.inspireEndTime);e=Date.newDate(e);var r=Date.newDate().getSecondsBetween(e);return 0>=r&&(r=0),r},a.getOverReSeconds=function(){var t=this,e=t.get(gc.dsConsts.MyGuildWarData.warEndTime);e=Date.newDate(e);var r=Date.newDate().getSecondsBetween(e);return 0>=r&&(r=0),r},r.ON_GUILD_WAR_FIGHT="ON_GUILD_WAR_FIGHT",r.ON_GUILD_LIST_UPDATE="ON_GUILD_LIST_UPDATE",r.ON_GUILD_ATK_UPDATE="ON_GUILD_ATK_UPDATE",r.ON_GUILD_DEF_UPDATE="ON_GUILD_DEF_UPDATE",r.ON_GUILD_OPEN_CHANGE="ON_GUILD_OPEN_CHANGE",r}(mo.DataController);t.GuildWarCtrl=e,egret.registerClass(e,"gd.GuildWarCtrl"),t.guildWarCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.custing=!1}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.getCustomTicket=function(e){var r=[],i=mo.getJSONWithFileName(gc.cfg_c_customParameter),a=0;for(var s in i)if(a=t.userCtrl.getBag()[s]){if(null!=e&&i[s][gc.c_customParameter_color]!=e)continue;for(var n=0;a>n;n++)r.push(s)}return r},a.getCustomEquips=function(){var e=t.userCtrl.getEquipBag(),r=[];for(var i in e)t.equipCtrl.isCustomEquip(i)&&r.push(i);return r},a.canCustomTicket=function(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_c_customParameter,e);return r[gc.c_customParameter_gainType]>1?!0:t.userCtrl.getVip()>=r[gc.c_customParameter_vip]},a.isCustomRed=function(){var t=this,e=t.getCustomTicket();if(e.length>0)for(var r=0,i=e.length;i>r;r++)if(t.canCustomTicket(e[r]))return!0;for(var a=t.getCustomEquips(),r=0,i=a.length;i>r;r++){var s=t.getInheritedEquipOpt(a[r]);if(s.nextEquipNeedLvlEnough&&s.isItemEnough)return!0}return!1},a.getCustomListInfo=function(){var e=this,r=[],i=e.getCustomTicket();i.sort(function(t,r){var i=e.canCustomTicket(t)?0:-1,a=e.canCustomTicket(r)?0:-1;return i>a?-1:1});for(var a=0,s=i.length;s>a;a++)r.push({itemId:i[a]});var n=e.getCustomEquips();n.sort(function(r,i){var a=e.getInheritedEquipOpt(r).nextEquipNeedLvlEnough?1:-1,s=e.getInheritedEquipOpt(i).nextEquipNeedLvlEnough?1:-1;return a==s&&(t.equipCtrl.getEquipItemLvl(r)>=t.equipCtrl.getEquipItemLvl(i)?a-=1:s-=1),a>s?-1:1});for(var a=0,s=n.length;s>a;a++)r.push({equipId:n[a]});return r},a.getCustomLvlLimt=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_customParameter,t);return e[gc.c_customParameter_equip_lvl_range]},a.getTicketInfo=function(t,e,r){var i=this,a={};return a[gc.c_prop.heroJobKey.zs]=i.getCustomizationId(t,gc.c_prop.heroJobKey.zs,e,r),a[gc.c_prop.heroJobKey.fs]=i.getCustomizationId(t,gc.c_prop.heroJobKey.fs,e,r),a[gc.c_prop.heroJobKey.ds]=i.getCustomizationId(t,gc.c_prop.heroJobKey.ds,e,r),a},a.getExtrPropAddRatio=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.customizationCfg);return t[1]},a.getMaxCustomPropNum=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.customizationCfg);return t[12]},a.getCustomizationId=function(t,e,r,i){var a=e.toString(),s=mo.getJSONWithFileName(gc.cfg_c_customParameter),n=parseInt(s[t][gc.c_customParameter_color]);6==n&&(a=(parseInt(e)+3).toString());var o="9"+a+i.toString()+(10*Math.ceil(r/10)).toString();return parseInt(o)},a.customization=function(e,r,i,a,s,n,o,c){var g=this;if(1!=g.custing){var l=t.userCtrl.getBag(),_=mo.getJSONWithFileName(gc.cfg_c_game),u=mo.getJSONWithFileName(gc.cfg_t_itemEquip),d=_[gc.id_c_game.fuckWord][0].split(",");if(i.indexOf(" ")>=0)return mo.showMsg("名称不能包含空格");if(null==i||""==i)return mo.showMsg(gc.id_c_msgCode.noItemName);if(mo.STR.getStringLength(i)>12)return mo.showMsg(gc.id_c_msgCode.nameToolong);if(mo.STR.checkSensitiveWord(i,d))return mo.showMsg(gc.id_c_msgCode.fuckword);if(-1==_[gc.id_c_game.customizationCfg][3].indexOf(e.toString()))return mo.showMsg("定制凭证错误");var p=g.getCustomizationId(e,r,a,n);if(!u[p])return mo.showMsg("没有该定制装备");if(s.length-1!=g.getMaxCustomPropNum())return mo.showMsg(gc.id_c_msgCode.choseProperty,g.getMaxCustomPropNum());for(var m=u[p],f=m[gc.t_itemEquip_propertys],h=0;h<s.length;h++)if(!f[s[h]])return mo.showMsg("属性勾选出错");return l[e]&&0!=l[e]?void mo.showMsg(gc.id_c_msgCode.makeItem,function(){var l=mo.getJSONWithFileNameAndID(gc.cfg_t_item,p)[gc.t_item_level];t.userCtrl.getLvl()<l?mo.showMsg(gc.id_c_msgCode.makeLvlBigger,function(){g._doCustomization(e,r,i,a,s,n,o,c)}):g._doCustomization(e,r,i,a,s,n,o,c)}):mo.showMsg("缺少定制凭证")}},a._doCustomization=function(e,r,i,a,s,n,o,c){var g=this,l=gc.iface.a_equip_customization_args,_={};_[l.certificate]=e,_[l.job]=r,_[l.name]=i,_[l.lvl]=a,_[l.abilityIndex]=s,_[l.equipType]=n,g.custing=!0,mo.requestWaiting4Server(gc.iface.a_equip_customization,_,function(e){g.custing=!1;var r=e[gc.dsConsts.ExUserData.isMail];r&&mo.showMsg(gc.id_c_msgCode.bagMaxMail);var i={},a=e[gc.dsConsts.ExUserData.equipBagItems]||{},s=e[gc.dsConsts.ExUserData.delBagItems]||{},n=t.userUtils.getNewBag(s,{}),l=t.userUtils.getNewEquipBag({},a);i[gc.dsConsts.UserEntity.bag]=n,i[gc.dsConsts.UserEntity.equipBag]=l,t.userCtrl.updateEntity(i),o.call(c,e),g.pushNotify(g.__class.ON_CUSTOM),t.pointCtrl.cal(gc.c_prop.pointEffectKey.custom)})},a.upCustomization=function(e,r,i){var a=this,s=e.equipId,n=t.userCtrl.getEquipBag();if(!n[s])return mo.showMsg("背包没有该装备");if(e.isMaxLvl)return mo.showMsg("定制武器已升到最高级");if(!e.isItemEnough)return mo.showMsg("材料不足");var o=gc.iface.a_equip_upCustomization_args,c={};c[o.equipId]=s,mo.requestWaiting4Server(gc.iface.a_equip_upCustomization,c,function(e){var s={},n=e[gc.dsConsts.ExUserData.equipBagItems]||{},o=e[gc.dsConsts.ExUserData.delBagItems]||{},c=t.userUtils.getNewBag(o,{}),g=t.userUtils.getNewEquipBag({},n);s[gc.dsConsts.UserEntity.bag]=c,s[gc.dsConsts.UserEntity.equipBag]=g,t.userCtrl.updateEntity(s),r.call(i,e),a.pushNotify(a.__class.ON_INHERITED),t.heroCtrl.calPropAndCombat(),t.pointCtrl.cal(gc.c_prop.pointEffectKey.custom)})},a.getInheritedEquipOpt=function(e){var r={equipId:e,nextEquipInfo:null,nextEquipNeedLvl:0,nextEquipNeedLvlEnough:!1,isMaxLvl:!1,costItemId:null,costCount:null,isItemEnough:!1},i=t.equipCtrl.equipTrans(e),a=i.tempId,s=parseInt(a)+10,n=t.userCtrl.getEquipBag()[e][5],o=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,s);if(o){for(var c=o[gc.t_itemEquip_propertys],g=[],l=0,_=n.length;_>l;l++)g.push(c[n[l]]);var u={tempId:s,name:i.name,basePropArr:g,extraPropArr:i.extraPropArr,scrore:t.userUtils.getEquipGrade(s,i.extraPropArr,n)};r.nextEquipInfo=u;var d=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.customizationCfg),p=d[4].split(",");r.costItemId=d[2];var m=999999,f=mo.getJSONWithFileNameAndID(gc.cfg_t_item,a);switch(parseInt(f[gc.t_item_itemLvl])){case 120:m=parseInt(p[0]);break;case 130:m=parseInt(p[1]);break;case 140:m=parseInt(p[2]);break;case 150:m=parseInt(p[3]);break;case 160:m=parseInt(p[4]);break;case 170:m=parseInt(p[5]);break;case 180:m=parseInt(p[6]);break;case 190:m=parseInt(p[7])}r.costCount=m,r.nextEquipNeedLvl=mo.getJSONWithFileNameAndID(gc.cfg_t_item,s)[gc.t_item_level],r.nextEquipNeedLvlEnough=t.userCtrl.getLvl()>=r.nextEquipNeedLvl,r.isItemEnough=t.userCtrl.getItemNum(r.costItemId)>=r.costCount}else r.isMaxLvl=!0;return r},r.ON_INHERITED="ON_INHERITED",r.ON_CUSTOM="ON_CUSTOM",r}(mo.DataController);t.CustomCtrl=e,egret.registerClass(e,"gd.CustomCtrl"),t.customCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.ybInjectTipsed=!1}__extends(r,e);var i=__define,a=r,s=a.prototype;return s._initProp=function(){e.prototype._initProp.call(this),this._heroMap={},this._skillCd=0,this.isSelf=!0,this.isUseStoneOpt=!1,this.wingUpgradeTypeStr="",this.curSelRoleIdx=0},s.initData=function(e){for(var r=this,i=0;i<e.length;i++){var a=e[i],s=new t.HeroEntityCtrl;s.init(a),r._heroMap[a[gc.dsConsts.HeroEntity.id]]=s}t.userCtrl.updateCombat()},i(s,"skillCd",function(){return this._skillCd}),s.getList=function(){var t=this,e=[];for(var r in t._heroMap){var i=t._heroMap[r];e.push(i)}return e.sort(t._sortHeroFuc),e},s.isGetAllHero=function(){var t=this,e=4;return t.getList().length>=e},s.getNextIdxToBeOpen=function(){for(var t=this,e=4,r=1,i=e;i>r;r++)if(t.isToBeOpen(r))return r;return-1},s.hasHeroByIndex=function(t){var e=this.getList();return null!=e[t]},s.hasHeroByJob=function(t){for(var e=this.getList(),r=0,i=e.length;i>r;r++)if(e[r].job==t)return!0;return!1},s.hasHeroJobData=function(t){var e=this;for(var r in e._heroMap){var i=e._heroMap[r];if(i.get(gc.dsConsts.HeroEntity.tempId)==t)return i}return 0},s.getHeroByJob=function(t){for(var e=this.getList(),r=0,i=e.length;i>r;r++)if(e[r].job==t)return e[r];return null},s.isToBeOpen=function(t){var e=this.getList();return t==e.length&&!this.hasHeroByIndex(t)},s.getHeroOpenCfg=function(t){for(var e,r=mo.getJSONWithFileName(gc.cfg_c_open),i=mo.getJSONWithFileName(gc.cfg_c_vip),a=(mo.getJSONWithFileName(gc.cfg_c_game),0),s=0,n=0;null!=(e=i[a]);){var o=e[gc.c_vip_openRole2],c=e[gc.c_vip_openRole3];if(0==s&&o>0&&(s=a),0==n&&c>0&&(n=a),s>0&&n>0)break;a++}var g=r[gc.id_c_open.openRole2][gc.c_open_lvlRequired],l=r[gc.id_c_open.openRole3][gc.c_open_lvlRequired],_=[g,s],u=[l,n],d=[[0,0],_,u];return d[t]||[0,0]},s.getSpHeroOpenCfg=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_open),r=mo.getJSONWithFileName(gc.cfg_c_vip),i=mo.getJSONWithFileName(gc.cfg_c_game);if(3>t)return[];if(3==t){for(var a,s=0,n=0;null!=(a=r[s]);){var o=a[gc.c_vip_openRole4];if(0==n&&o>0&&(n=s),n>0)break;s++}var c=e[gc.id_c_open.openRole4][gc.c_open_lvlRequired];return[[145,3,s,i[gc.id_c_game.fourRole][11]],[c,3,0,i[gc.id_c_game.fourRole][1]]]}},s.isOpenCfgOk=function(e){var r,i=this;if(3>e)return r=i.getHeroOpenCfg(e),t.userCtrl.getLvl()>=r[0]||t.userCtrl.getVip()>=r[1];if(3==e){r=i.getSpHeroOpenCfg(e);for(var a=0,s=r.length;s>a;a++){var n=r[a];if(t.userCtrl.getLvl()>=n[0]&&i.getList().length>=n[1]&&t.userCtrl.getVip()>=n[2]&&t.userCtrl.getRebirthLvl()>=n[3])return!0}return!1}return!1},s._sortHeroFuc=function(t,e){return parseInt(t.id)>parseInt(e.id)?1:-1},s.calPropAndCombat=function(){var t=this,e={};mo.request4Server(gc.iface.a_hero_calPropAndCombat,e,function(e){for(var r=0;r<e.length;r++){var i=e[r];t.updateHeroEntityCtrl(i[gc.dsConsts.HeroEntity.id],i)}})},s.autoInfuseSwitch=function(e,r,i){var a=gc.iface.a_hero_autoInfuseSwitch_args,s={};s[a.isOpenIn]=e,mo.request4Server(gc.iface.a_hero_autoInfuseSwitch,s,function(e){e&&t.userCtrl.updateEntity(e),r.call(i,e)})},s.getInjectCost=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.fourRole);return t==gc.c_prop.extraInfuseTypeKey.diamond?e[7]:e[3]},s.extraInfuse=function(e,r,i){var a=gc.iface.a_hero_extraInfuse_args,s={};s[a.type]=e,mo.request4Server(gc.iface.a_hero_extraInfuse,s,function(e){var a=e[gc.dsConsts.ExDemonLotusData.isSucceed],s=e[gc.dsConsts.ExDemonLotusData.userData],n=e[gc.dsConsts.ExDemonLotusData.expSum],o=e[gc.dsConsts.ExDemonLotusData.genuineQiArr];o.length>0&&(t.demonLotusCtrl._genuineQi=parseInt(o[0]),t.demonLotusCtrl._lastUpTime=Date.newDate().toString()),t.userCtrl.updateEntity(s),r.call(i,[a,n])})},s.getMainHeroDisplay=function(t,e,r){var i=gc.iface.a_hero_getMainHeroDisplay_args,a={};a[i.userId]=t,mo.request4Server(gc.iface.a_hero_getMainHeroDisplay,a,function(t){e.call(r,t)})},s.getHeroDisplayByTempId=function(t,e,r,i){var a=gc.iface.a_hero_getHeroDisplayByTempId_args,s={};s[a.userId]=t,s[a.tempId]=e,mo.request4Server(gc.iface.a_hero_getHeroDisplayByTempId,s,function(t){r.call(i,t)})},s.getTotalCombat=function(){for(var t=this,e=t.getList(),r=0,i=0;i<e.length;i++){var a=e[i];r+=a.combat}return r},s.calSkill=function(){for(var t=this,e=t.getList(),r=0;r<e.length;r++){var i=e[r];i.initSkill()}},s.getMainHeroCtrl=function(){var t=this,e=t.getList();return e[0]},s.getHeroByIndex=function(t){var e=this,r=e.getList();return r[t]},s.getHeroIndex=function(t){for(var e=this,r=e.getList(),i=0;i<r.length;++i)if(t==r[i])return i;return-1},s.getHeroMap=function(){return this._heroMap},s.getHeroEntityCtrl=function(t){var e=this;return e._heroMap[t]},s.updateHeroEntityCtrl=function(e,r){var i=this,a=i.getHeroEntityCtrl(e);a?a.updateEntity(r):(a=new t.HeroEntityCtrl,a.init(r),i._heroMap[e]=a)},s.getMaxStateLvl=function(){for(var t=this,e=t.getList(),r=0,i=0;i<e.length;i++){var a=e[i],s=a.get(gc.dsConsts.HeroEntity.realmLvl)||0;s>r&&(r=s)}return r},s.getEquipData=function(t){var e=this,r=e.getHeroEntityCtrl(t);return r.get(gc.dsConsts.HeroEntity.equipData)||{}},s.callHero=function(t,e,r,i){var a=this,s=gc.iface.a_hero_callHero_args,n={};n[s.tempId]=t,n[s.sex]=e,mo.requestWaiting4Server(gc.iface.a_hero_callHero,n,function(t){var e=t;a.updateHeroEntityCtrl(e[gc.dsConsts.HeroEntity.id],e),a.calPropAndCombat(),r.call(i),a.pushNotify(a.__class.ON_CALL_HERO)})},s.getHeroSkillArr=function(e){for(var r=this,i=r.getHeroEntityCtrl(e),a=t.userCtrl.get(gc.dsConsts.UserEntity.lvl),s=t.userCtrl.get(gc.dsConsts.UserEntity.skillCd)||0,n=i.get(gc.dsConsts.HeroEntity.skillLvlArr)||[],o=mo.getJSONWithFileName(gc.cfg_c_game),c=o[gc.id_c_game.skillRate][4].split(","),g=0;g<c.length;g++)null!=n[g]&&n[g]||a>c[g]&&(n[g]=1);return r._skillCd=s,n},s.getSkillCd=function(){var e=t.userCtrl.get(gc.dsConsts.UserEntity.skillCd),r=Date.newDate(),i=0,a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.skillRate][5],n=t.userCtrl.get(gc.dsConsts.UserEntity.lastSkillTime),o=Date.newDate(n).addSeconds(e);return i=(o.getTime()-r.getTime())/1e3,i=parseInt(i.toString()),0>=i?[0,0]:e>s?[1,i]:[0,i]},s.upSkill=function(e,r,i,a){var s=this,n=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),o=gc.iface.a_hero_upSkill_args,c={};c[o.tempId]=n,c[o.index]=r;var g=(Date.newDate(),mo.getJSONWithFileName(gc.cfg_c_lvl)),l=(mo.getJSONWithFileName(gc.cfg_c_game),t.userCtrl.get(gc.dsConsts.UserEntity.lvl)),_=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.skillLvlArr)[r]||1;if(_>=l)return mo.showMsg("技能等级不能超过角色等级");var u=1;0!=_&&(u=_);var d=g[u][gc.c_lvl_skillNeedGold],p=t.userCtrl.get(gc.dsConsts.UserEntity.gold);return d>p?void t.userCtrl.noGolds(function(){},this):void mo.requestWaiting4Server(gc.iface.a_hero_upSkill,c,function(r){var n=r[gc.dsConsts.ExUserData.userData]||{},o=r[gc.dsConsts.ExUserData.heroData]||{};t.userCtrl.updateEntity(n),s.updateHeroEntityCtrl(e,o),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_skill),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_skill),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_skill),s._skillCd=t.userCtrl.get(gc.dsConsts.UserEntity.skillCd),i.call(a,r)})},s.clearSkillCd=function(e,r){var i=this,a=0,s=Date.newDate(),n=t.userCtrl.get(gc.dsConsts.UserEntity.skillCd),o=t.userCtrl.get(gc.dsConsts.UserEntity.diamond),c=t.userCtrl.get(gc.dsConsts.UserEntity.lastSkillTime),g=Date.newDate(c).addSeconds(n);if(a=(g.getTime()-s.getTime())/1e3,a=parseInt(a.toString()),0>a&&(a=0),0>=a)return mo.showMsg("当前无CD");var l=gc.calSkillDiamond(a);mo.showMsg(gc.id_c_msgCode.cleanArenaTime,l,function(){return l>o?mo.showMsg(gc.id_c_msgCode.noDiamond):void mo.requestWaiting4Server(gc.iface.a_hero_clearSkillCd,{},function(a){t.userCtrl.updateEntity(a),i._skillCd=0,e.call(r,a)})})},s.getRealmCount=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.bag);return r[e]&&0!=r[e]?r[e]:0},s.isRuneCom=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_compound);return e[t]?!0:!1},s.canRuneCom=function(e){var r=1,i={},a=t.userCtrl.get(gc.dsConsts.UserEntity.bag),s=mo.getJSONWithFileName(gc.cfg_c_compound),n=s[e][gc.c_compound_reqItems1];0!=n&&(i[n]=s[e][gc.c_compound_reqCount1]);var o=s[e][gc.c_compound_reqItems2];0!=o&&(i[o]=s[e][gc.c_compound_reqCount2]);var c=s[e][gc.c_compound_reqItems3];0!=c&&(i[c]=s[e][gc.c_compound_reqCount3]);var g=s[e][gc.c_compound_reqItems4];0!=g&&(i[g]=s[e][gc.c_compound_reqCount4]);for(var l in i)(!a[l]||a[l]<i[l])&&(r=0);return 1==r?1:0},s.wearRune=function(e,r,i,a){var s=this,n=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),o=mo.getJSONWithFileName(gc.cfg_t_item),c=mo.getJSONWithFileName(gc.cfg_c_realm),g=t.userCtrl.get(gc.dsConsts.UserEntity.lvl),l=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.realmLvl),_=0==l?0:l,u=c[_][gc.c_realm_reqItems][r],d=o[u][gc.t_item_level];if(d>g)return mo.showMsg("等级不足");var p=gc.iface.a_hero_wearRune_args,m={};m[p.tempId]=n,m[p.index]=r,mo.requestWaiting4Server(gc.iface.a_hero_wearRune,m,function(r){var n={},o=r[gc.dsConsts.ExUserData.heroData]||{},c=r[gc.dsConsts.ExUserData.delBagItems]||{},g=t.userUtils.getNewBag(c,{});n[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(n),s.updateHeroEntityCtrl(e,o),i.call(a,r),s.pushNotify(s.__class.ON_WEAR_RUNE)})},s.wearAllRune=function(e,r,i){var a=this,s=a.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),n=a.getHeroEntityCtrl(e).getHeroRealmList()[2]||[];if(n.length<1)return mo.showMsg("无可装备元神");var o=gc.iface.a_hero_wearAllRune_args,c={};c[o.tempId]=s,mo.requestWaiting4Server(gc.iface.a_hero_wearAllRune,c,function(s){var n={},o=s[gc.dsConsts.ExUserData.heroData]||{},c=s[gc.dsConsts.ExUserData.delBagItems]||{},g=t.userUtils.getNewBag(c,{});n[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(n),a.updateHeroEntityCtrl(e,o),r.call(i,s),a.pushNotify(a.__class.ON_WEAR_RUNE)})},s.getPropsStr=function(t){for(var e="",r=0;r<t.length;++r)if(2==t[r].length){var i=t[r][0],a=t[r][1];g_base.PropBase.isPercentProp(i)&&(a=Math.round(t[r][1]/g_base.PropBase.Scale_Num*100)+"%"),i==gc.c_prop.heroPropKey.reviveCount||i==gc.c_prop.heroPropKey.reviveHPScale||i==gc.c_prop.heroPropKey.disMaxHp2?a+="(只在PK中有效)":i==gc.c_prop.heroPropKey.maxHp2&&(a+="(只在PK中生效，可免疫麻痹)");var s=mo.STR.format("%s %s\n",gc.c_prop.heroProp[i],a);e+=s}return e},s.upRealm=function(e,r,i){var a=this,s=a.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId);if(!a.canUpRealm(e))return mo.showMsg(gc.id_c_msgCode.cantRebirth);var n=gc.iface.a_hero_upRealm_args,o={};o[n.tempId]=s,mo.requestWaiting4Server(gc.iface.a_hero_upRealm,o,function(s){a.updateHeroEntityCtrl(e,s),t.pointCtrl.cal(gc.c_prop.pointGreenKey.copy_realm),r.call(i,s)})},s.canUpRealm=function(t){var e=this,r=e.getHeroEntityCtrl(t).get(gc.dsConsts.HeroEntity.realmArr)||[];if(r.length<6)return mo.showMsg(gc.id_c_msgCode.cantRebirth);for(var i=0;i<r.length;i++)if(null==r[i])return!1;return!0},s.getStrengthLvlList=function(t){var e=this,r=e.getHeroEntityCtrl(t).get(gc.dsConsts.HeroEntity.intensifyArr);return r},s.getIndexStrengthArr=function(e,r){var i=this,a=[],s=mo.getJSONWithFileName(gc.cfg_c_lvl),n=mo.getJSONWithFileName(gc.cfg_t_itemEquip),o=t.userCtrl.get(gc.dsConsts.UserEntity.bag),c=i.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.intensifyArr)[r]||0,g=i.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.equipData)[r]||0;return a[0]=n[g][gc.t_itemEquip_slotStrengthProperty],a[1]=n[g][gc.t_itemEquip_propValue]*c,a[2]=n[g][gc.t_itemEquip_propValue]*(c+1),a[3]=o[gc.c_prop.spItemIdKey.intensify]||0,a[4]=s[c+1][gc.c_lvl_equipStrengthNum],a[5]=s[c+1][gc.c_lvl_equipStrengthGold],a},s.getStarLvlList=function(t){var e=this,r=e.getHeroEntityCtrl(t).get(gc.dsConsts.HeroEntity.starArr);return r},s.getIndexStarArr=function(e,r){var i=this,a=[],s=mo.getJSONWithFileName(gc.cfg_c_lvl),n=t.userCtrl.get(gc.dsConsts.UserEntity.bag),o=i.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.starArr)[r]||0;return a[0]=s[o][gc.c_lvl_upStarPropAdd],a[1]=s[o+1][gc.c_lvl_upStarPropAdd],a[2]=n[gc.c_prop.spItemIdKey.starStone]||0,a[3]=s[o+1][gc.c_lvl_upStarNum],a[4]=s[o+1][gc.c_lvl_upStarGold],a},s.getGemIdList=function(t){var e=this,r=e.getHeroEntityCtrl(t).get(gc.dsConsts.HeroEntity.gemArr);return r},s.strength=function(e,r,i,a){var s=this,n=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),o=mo.getJSONWithFileName(gc.cfg_c_lvl),c=mo.getJSONWithFileName(gc.cfg_c_game),g=t.userCtrl.get(gc.dsConsts.UserEntity.gold),l=t.userCtrl.get(gc.dsConsts.UserEntity.bag),_=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.intensifyArr)[r]||0,u=c[gc.id_c_game.initCfg][2],d=o[_+1][gc.c_lvl_equipStrengthGold],p=l[gc.c_prop.spItemIdKey.intensify]||0,m=o[_+1][gc.c_lvl_equipStrengthNum];if(_>=u)return mo.showMsg("已达到强化上限");if(d>g)return void t.userCtrl.noGolds(function(){},this);if(m>p)return mo.showMsg("强化石不足");var f=gc.iface.a_hero_strength_args,h={};h[f.tempId]=n,h[f.index]=r,mo.requestWaiting4Server(gc.iface.a_hero_strength,h,function(r){var n=r[gc.dsConsts.ExUserData.userData]||{},o=r[gc.dsConsts.ExUserData.heroData]||{};t.userCtrl.updateEntity(n),s.updateHeroEntityCtrl(e,o),i.call(a,r)})},s.upStar=function(e,r,i,a){var s=this,n=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),o=mo.getJSONWithFileName(gc.cfg_c_lvl),c=mo.getJSONWithFileName(gc.cfg_c_game),g=t.userCtrl.get(gc.dsConsts.UserEntity.gold),l=t.userCtrl.get(gc.dsConsts.UserEntity.bag),_=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.starArr)[r]||0,u=c[gc.id_c_game.initCfg][3],d=o[_+1][gc.c_lvl_upStarGold],p=l[gc.c_prop.spItemIdKey.starStone]||0,m=o[_+1][gc.c_lvl_upStarNum];if(_>=u)return mo.showMsg("已达到升星上限");if(d>g)return void t.userCtrl.noGolds(function(){},this);if(m>p)return mo.showMsg("升星石不足");var f=gc.iface.a_hero_upStar_args,h={};h[f.tempId]=n,h[f.index]=r,mo.requestWaiting4Server(gc.iface.a_hero_upStar,h,function(r){var n=r[gc.dsConsts.ExUserData.userData]||{},o=r[gc.dsConsts.ExUserData.heroData]||{};t.userCtrl.updateEntity(n),s.updateHeroEntityCtrl(e,o),i.call(a,r)})},s.upGem=function(e,r,i,a){var s=this,n=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),o=r;r>7&&(o=r-4);var c=mo.getJSONWithFileName(gc.cfg_c_gem),g=mo.getJSONWithFileName(gc.cfg_c_game),l=t.userCtrl.get(gc.dsConsts.UserEntity.bag),_=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.gemArr)[r]||g[gc.id_c_game.gemInitial][o],u=g[gc.id_c_game.gemLimit][o],d=c[_][gc.c_gem_itemID],p=c[_][gc.c_gem_count],m=l[d]||0;if(_>=u)return mo.showMsg("已升到最高等级");if(p>m)return mo.showMsg("宝石碎片数量不足");var f=gc.iface.a_hero_upGem_args,h={};h[f.tempId]=n,h[f.index]=r,mo.requestWaiting4Server(gc.iface.a_hero_upGem,h,function(r){var n=r[gc.dsConsts.ExUserData.userData]||{},o=r[gc.dsConsts.ExUserData.heroData]||{};t.userCtrl.updateEntity(n),s.updateHeroEntityCtrl(e,o),i.call(a,r)})},s.getWingArr=function(e){var r=this,i=[],a={},s={},n=mo.getJSONWithFileName(gc.cfg_c_game),o=mo.getJSONWithFileName(gc.cfg_t_wing),c=t.userCtrl.get(gc.dsConsts.UserEntity.bag),g=r.getMainHeroCtrl().wingData,l=g[0]||1,_=g[1]||1;return a[gc.c_prop.heroPropKey.attackTemp]=o[l][gc.t_wing_attack],a[gc.c_prop.heroPropKey.maxHpTemp]=o[l][gc.t_wing_maxHp],a[gc.c_prop.heroPropKey.defenceTemp]=o[l][gc.t_wing_defence],a[gc.c_prop.heroPropKey.magicDefenceTemp]=o[l][gc.t_wing_magicDefence],o[l+1]&&(s[gc.c_prop.heroPropKey.attackTemp]=o[l+1][gc.t_wing_attack],s[gc.c_prop.heroPropKey.maxHpTemp]=o[l+1][gc.t_wing_maxHp],s[gc.c_prop.heroPropKey.defenceTemp]=o[l+1][gc.t_wing_defence],s[gc.c_prop.heroPropKey.magicDefenceTemp]=o[l+1][gc.t_wing_magicDefence]),i[0]=l,i[1]=o[l][gc.t_wing_name],i[2]=_,i[3]=a,i[4]=s,i[5]=g[2]||0,i[6]=g[3]||0,i[7]=n[gc.id_c_game.wingCrit][4],i[8]=n[gc.id_c_game.wingCrit][3],i[9]=c[gc.c_prop.spItemIdKey.plumage]||0,i},s.wingComFos=function(t,e,r){var i=this;i.wingFos(t,gc.c_prop.wingFosTypeKey.comFoster,e,r)},s.wingAdvFos=function(t,e,r){var i=this;i.wingFos(t,gc.c_prop.wingFosTypeKey.advFoster,e,r)},s.wingFos=function(e,r,i,a){var s=this,n=mo.getJSONWithFileName(gc.cfg_c_game),o=n[gc.id_c_game.initCfg][4],c=t.userCtrl.get(gc.dsConsts.UserEntity.bag),g=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),l=s.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.wingArr)[0]||1;if(l>=o)return mo.showMsg("翅膀等级已到上限");switch(r){case gc.c_prop.wingFosTypeKey.comFoster:var _=t.userCtrl.get(gc.dsConsts.UserEntity.gold);if(_<n[gc.id_c_game.wingCrit][4])return void t.userCtrl.noGolds(function(){},this);break;case gc.c_prop.wingFosTypeKey.advFoster:var u=t.userCtrl.get(gc.dsConsts.UserEntity.diamond);(!c[gc.c_prop.spItemIdKey.plumage]||c[gc.c_prop.spItemIdKey.plumage]<=0)&&u<n[gc.id_c_game.wingCrit][3]&&mo.showMsg(gc.id_c_msgCode.noDiamond)}var d=gc.iface.a_hero_wingFos_args,p={};p[d.tempId]=g,p[d.fosType]=r,mo.requestWaiting4Server(gc.iface.a_hero_wingFos,p,function(r){var n=r[gc.dsConsts.ExUserData.userData]||{},o=r[gc.dsConsts.ExUserData.heroData]||{};t.userCtrl.updateEntity(n),s.updateHeroEntityCtrl(e,o),i.call(a,r)})},s.wingFos2Top=function(e,r,i,a,s){var n=this,o=mo.getJSONWithFileName(gc.cfg_c_game),c=o[gc.id_c_game.initCfg][4],g=t.userCtrl.get(gc.dsConsts.UserEntity.bag),l=n.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),_=n.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.wingArr)[0]||1;if(_>=c)return mo.showMsg("翅膀等级已到上限");switch(r){case gc.c_prop.wingFosTypeKey.comFoster:var u=t.userCtrl.get(gc.dsConsts.UserEntity.gold);if(u<o[gc.id_c_game.wingCrit][4])return void t.userCtrl.noGolds(function(){},this);break;case gc.c_prop.wingFosTypeKey.advFoster:var d=t.userCtrl.get(gc.dsConsts.UserEntity.diamond);if(!g[gc.c_prop.spItemIdKey.plumage]||g[gc.c_prop.spItemIdKey.plumage]<=0){if(0==i)return void mo.showMsg(gc.id_c_msgCode.notEnoughFeather);if(d<o[gc.id_c_game.wingCrit][3])return void mo.showMsg(gc.id_c_msgCode.noDiamond)}}var p=gc.iface.a_hero_wingFos2Top_args,m={};m[p.tempId]=l,m[p.fosType]=r,m[p.isUseDiamond]=i,mo.requestWaiting4Server(gc.iface.a_hero_wingFos2Top,m,function(r){var i=r[gc.dsConsts.ExUserData.userData]||{},o=r[gc.dsConsts.ExUserData.heroData]||{},c=r[gc.dsConsts.ExUserData.wingExp],g=(r[gc.dsConsts.ExUserData.isWingCrit],r[gc.dsConsts.ExUserData.delBagItems]||{}),l=t.userUtils.getNewBag(g,{});i[gc.dsConsts.UserEntity.bag]=l,t.userCtrl.updateEntity(i),n.updateHeroEntityCtrl(e,o),c&&g_msg.UIMsgTextCtrl.push("+"+c),a.call(s,r)})},s.upWing=function(t,e,r){var i=this,a=i.getHeroEntityCtrl(t).get(gc.dsConsts.HeroEntity.tempId),s=gc.iface.a_hero_upWing_args,n={};n[s.tempId]=a,mo.requestWaiting4Server(gc.iface.a_hero_upWing,n,function(a){i.updateHeroEntityCtrl(t,a),e.call(r,a)})},s.getAllHeroAttack=function(){for(var t=this,e=t.getList(),r=0,i=0,a=e.length;a>i;i++){var s=e[i];r+=s.attackFight}return r},s.isMy4thRole=function(t){return 3==t},s.isMy4thRoleByHec=function(t){return 3==this.getHeroIndex(t)},s.setIsUseStoneOpt=function(t){var e=this;e.isUseStoneOpt=t},s.getIsUseStoneOpt=function(){var t=this;return t.isUseStoneOpt},s.setWingUpgradeTypeStr=function(t){var e=this;e.wingUpgradeTypeStr=t},s.getWingUpgradeTypeStr=function(){var t=this;return t.wingUpgradeTypeStr},s.getFightList=function(){var t=this,e=[];for(var r in t._heroMap){var i=t._heroMap[r];e.push(i)}return e.sort(t._sortHeroList),e},s.saveFightList=function(t,e,r){for(var i=this,a=[],s=t,n=0;n<s.length;n++)a[n]=s[n].get(gc.dsConsts.HeroEntity.id);var o=gc.iface.a_hero_saveFightList_args,c={};c[o.fightArr]=a,mo.requestWaiting4Server(gc.iface.a_hero_saveFightList,c,function(t){for(var a=0;a<t.length;a++){var s=t[a];s&&i.updateHeroEntityCtrl(s[gc.dsConsts.HeroEntity.id],s)}e.call(r,t),mo.emitter.emit(i.__class.ON_FIGHT_HERO_CHANGE)})},s._sortHeroList=function(t,e){return t[gc.dsConsts.HeroEntity.fightSort]?parseInt(t[gc.dsConsts.HeroEntity.fightSort])>parseInt(e[gc.dsConsts.HeroEntity.fightSort])?1:-1:parseInt(t.get(gc.dsConsts.HeroEntity.fightSort))>parseInt(e.get(gc.dsConsts.HeroEntity.fightSort))?1:-1},r.ON_WEAR_RUNE="ON_WEAR_RUNE",r.ON_CALL_HERO="ON_CALL_HERO",r.ON_FIGHT_HERO_CHANGE="ON_FIGHT_HERO_CHANGE",r}(mo.DataController);t.HeroCtrl=e,egret.registerClass(e,"gd.HeroCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._getCriticalRate=function(t){return this.criticalFight/(this.criticalFight+t)},this._getCritDamage=function(t){return this.criticalFight/(this.criticalFight+t)*3
},this._getDefence=function(e,r){var i,a=this.job,s=t.userCtrl.getLvl(),n=this.attackFight,o=a==g_base.PropBase.BehaviorPhysics?e:a==g_base.PropBase.BehaviorMagic?r:(r+e)/2;return 1e4>=o?(i=.002*o/(1+.015*s+.002*o),i=Math.min(i,.6)):6e4>o?(i=100/(1+.8*s+100)+.001*(o-1e4)/(1+1.25*s+.001*(o-1e4)),i=Math.min(i,.9)):(i=12e4>n?.8+o/(o+4e6):o/(o+.125*n),i=Math.min(i,.9)),i},this._getHpCoefficient=function(t,e){return(t[gc.t_skill_damage]+t[gc.t_skill_damageScaleA]*(e-1))/1e4}}__extends(r,e);var i=__define,a=r,s=a.prototype;return s._initProp=function(){var t=this;e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.HeroEntity,t.props=[],t.skillIds=[],t.skillLevels=[],t.isSelf=!0,t.otherData=[],t.fightData=[]},s.init=function(t){var r=this;e.prototype.init.call(this,t),r.props=r.get(gc.dsConsts.HeroEntity.propArr),r.initSkill()},s.updateEntity=function(r){var i=this,a=i._getCurProp();e.prototype.updateEntity.call(this,r),i.props=i.get(gc.dsConsts.HeroEntity.propArr),i.initSkill();var s=i._getCurProp();i._calProChanged(a,s),r[gc.dsConsts.HeroEntity.combat]&&t.userCtrl.updateCombat()},s._getCurProp=function(){var t=this,e={maxHpFight:t.maxHpFight,attackFight:t.attackFight,defenceFight:t.defenceFight,magicDefenceFight:t.magicDefenceFight,hitFight:t.hitFight,dodgeFight:t.dodgeFight,criticalFight:t.criticalFight,disCriticalFight:t.disCriticalFight};return e},s._calProChanged=function(t,e){var r=this,i={maxHpFight:e.maxHpFight-t.maxHpFight,attackFight:e.attackFight-t.attackFight,defenceFight:e.defenceFight-t.defenceFight,magicDefenceFight:e.magicDefenceFight-t.magicDefenceFight,hitFight:e.hitFight-t.hitFight,dodgeFight:e.dodgeFight-t.dodgeFight,criticalFight:e.criticalFight-t.criticalFight,disCriticalFight:e.disCriticalFight-t.disCriticalFight},a={};for(var s in i)i[s]>0&&(a[s]=i[s]);Object.keys(a).length>0&&g_msg.UIMsgHeroPropCtrl.push({hec:r,changeProp:a})},s.getTalismanSkill=function(){var t=this,e=[],r=t.get(gc.dsConsts.HeroEntity.talismanData)||{};for(var i in r){var a=r[i][4]||{};for(var s in a)e.push(a[s])}return e},s.getTalismanAdorn=function(){var t=this,e=t.get(gc.dsConsts.HeroEntity.talismanAdorn)||0;return e},s.initSkill=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_t_hero),r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.skillRate][4];i=i.split(",");var a=t.get(gc.dsConsts.HeroEntity.skillLvlArr),s=t.get(gc.dsConsts.HeroEntity.tempId),n=e[s];t.skillIds.length=0,t.skillLevels.length=0;for(var o=n[gc.t_hero_skillIds],c=0;c<o.length;c++){var g=o[c],l=t._getReplaceTalentSkillId(c);l&&(g=l),t.skillIds.push(g);var _=parseInt(i[c]);t.lvl>=_?t.skillLevels.push(a[c]||1):t.skillLevels.push(0)}t._initHearSkill(),t.pushNotify(t.__class.ON_SKILL_CHANGED)},s._getReplaceTalentSkillId=function(t){for(var e=this,r=e.getTalismanSkill(),i=0,a=mo.getJSONWithFileName(gc.cfg_t_talismanSkill),s=0;s<r.length;s++){var n=r[s];if(n){var o=a[n],c=o[gc.t_talismanSkill_type];if(c==gc.c_prop.talismanSkillTypeKey.replaceSkill){var g=o[gc.t_talismanSkill_effect]||[];if(g=g[0]){var l=g[0],_=g[1];t==l&&_>i&&(i=_)}}}}return i},s._initHearSkill=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_heartStunt),r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.heartStuntCfg][1],a=t.heartData;for(var s in a){var n=e[s],o=parseInt(n[gc.c_heartStunt_layer]),c=parseInt(n[gc.c_heartStunt_series]);if(n){var g=a[s]||0,l=n[gc.c_heartStunt_skillId],_=n[gc.c_heartStunt_skillId2];o>i&&(l=_),t.skillIds.push(l);var u=Math.floor(g/c)+1;u>o&&(u=o),t.skillLevels.push(u)}}},i(s,"heartData",function(){var e=this,r={};r=e.isSelf?t.userCtrl.get(gc.dsConsts.UserEntity.propertyData)||{}:e.fightData[7]||{};var i=r[gc.c_prop.propertyDataKey.heartStunt]||{};return i}),i(s,"lvl",function(){var e=this,r=0;return r=e.isSelf?t.userCtrl.getLvl():e.fightData[0]||0}),i(s,"job",function(){var t=this.get(gc.dsConsts.HeroEntity.tempId),e=mo.getJSONWithFileName(gc.cfg_t_hero);return e[t][gc.t_hero_job]}),s.setPropByIndex=function(t,e){this.props[t]=e},s.getPropByIndex=function(t){return this.props[t]},s.getFightPropByIndex=function(t,e,i){return Math.floor(this.getPropByIndex(t)*(1+this.getPropByIndex(e)/r.Scale_Num)+this.getPropByIndex(i))},i(s,"maxHpFight",function(){return this.getFightPropByIndex(1,2,33)}),i(s,"attackFight",function(){return this.getFightPropByIndex(3,4,34)}),i(s,"defenceFight",function(){return this.getFightPropByIndex(5,6,35)}),i(s,"magicDefenceFight",function(){return this.getFightPropByIndex(7,8,36)}),i(s,"hitFight",function(){return this.getFightPropByIndex(9,10,37)}),i(s,"dodgeFight",function(){return this.getFightPropByIndex(11,12,38)}),i(s,"criticalFight",function(){return this.getFightPropByIndex(13,14,39)}),i(s,"disCriticalFight",function(){return this.getFightPropByIndex(15,16,40)}),i(s,"luckyValueFight",function(){return this.getFightPropByIndex(17,18,41)}),i(s,"moveSpeedFight",function(){return this.getFightPropByIndex(19,20,42)}),i(s,"attackIntervalFight",function(){return this.getFightPropByIndex(21,22,43)}),i(s,"damageIncreaseFight",function(){var t=this.getPropByIndex(23)+this.getPropByIndex(44);return t/=r.Scale_Num,t=Math.floor(100*t)/100}),i(s,"damageDecreaseFight",function(){var t=this.getPropByIndex(24)+this.getPropByIndex(45);return t/=r.Scale_Num,t=Math.floor(100*t)/100}),i(s,"benumbProFight",function(){return this.getPropByIndex(25)/r.Scale_Num}),i(s,"disBenumbProFight",function(){return this.getPropByIndex(26)/r.Scale_Num}),i(s,"benumbProSpanFight",function(){return this.getPropByIndex(28)}),i(s,"reviveCountFight",function(){return this.getPropByIndex(29)}),i(s,"reviveHPScaleFight",function(){return this.getPropByIndex(30)}),i(s,"maxHp2Fight",function(){var t=this.maxHpFight;return t=t*this.getPropByIndex(31)/r.Scale_Num}),i(s,"disMaxHp2Fight",function(){return this.getPropByIndex(32)/r.Scale_Num}),s._getHitRate=function(t){return this.hitFight/(this.hitFight+t)},s.getDamagePerSec=function(t){var e,r,i,a,s,n;r=this._getHitRate(t[gc.t_monster_dodge]),i=this._getCriticalRate(t[gc.t_monster_disCritical]),a=this._getCritDamage(t[gc.t_monster_disCritical]),s=this._getDefence(t[gc.t_monster_defense],t[gc.t_monster_magicDefence]);for(var o=0,c=0;c<this.skillIds.length;++c){var g=this.skillIds[c];e=mo.getJSONWithFileNameAndID(gc.cfg_t_skill,g);var l=this.skillLevels[c],_=this._getHpCoefficient(e,l);0>_?(n=this.attackFight,n*=1-s,n=(n+n*i*a)/(1+i),n*=1+this.damageIncreaseFight-t[gc.t_monster_damageDecrease],n*=_,n*=r,o+=1e3*-n/(10*e[gc.t_skill_cd])):n=0}return o},i(s,"equipData",function(){return this.get(gc.dsConsts.HeroEntity.equipData)||{}}),i(s,"tempId",function(){return this.get(gc.dsConsts.HeroEntity.tempId)}),i(s,"combat",function(){return this.get(gc.dsConsts.HeroEntity.combat)}),i(s,"sex",function(){return this.get(gc.dsConsts.HeroEntity.sex)}),i(s,"id",function(){return this.get(gc.dsConsts.HeroEntity.id)}),i(s,"wingData",function(){var t=this.get(gc.dsConsts.HeroEntity.wingArr);return null!=t[0]?t:[0,0,0,0]}),i(s,"gemData",function(){var t=this.get(gc.dsConsts.HeroEntity.gemArr);return t}),s.isWingActived=function(){var t=this;return!!t.wingData[1]},s.isWingLimit=function(){var t=this,e=!1,r=parseInt(t.wingData[0])+1,i=mo.getJSONWithFileName(gc.cfg_t_wing);return i[r]||(e=!0),e},s.isWingOpen=function(){var e=mo.getJSONWithFileName(gc.cfg_c_game),r=e[gc.id_c_game.wingCrit][6];return t.userCtrl.getLvl()>=r},s.getGemInfoByPart=function(t){var e=this,r=mo.getJSONWithFileName(gc.cfg_c_gem),i=mo.getJSONWithFileName(gc.cfg_c_game),a=e.gemData,s=a[t];return s?s=a[t]:(t>7&&(t-=4),s=i[gc.id_c_game.gemInitial][t]),r[s]},s.getStrLvlByEquipPart=function(t){var e=this,r=e.get(gc.dsConsts.HeroEntity.intensifyArr)||[];return r[t]||0},s.getRefLvlByEquipPart=function(t){var e=this,r=e.get(gc.dsConsts.HeroEntity.refineArr)||[];return r[t]||0},s.getStrLvlInfoByEquipPart=function(t){var e=this,r=e.getStrOpt(t);return r.curStrInfo},s.getStarLvlByEquipPart=function(t){var e=this,r=e.get(gc.dsConsts.HeroEntity.starArr)||[];return r[t]||0},s.getStarLvlInfoByEquipPart=function(t){var e=this,r=e.getStarLvlByEquipPart(t),i=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,r);return[r,i[gc.c_lvl_upStarPropAdd]/100]},s.getClothDisplayID=function(){var t=this;if(t.isSelf){var e=t.getEquipTempIdByPart(gc.c_prop.heroEquipIndexKey.clothes),r=[];if(e){var i=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,e);r=i[gc.t_itemEquip_displayID].split(",")}else{var a=mo.getJSONWithFileNameAndID(gc.cfg_t_hero,t.tempId);r=a[gc.t_hero_displayID].split(",")}return t.sex==gc.c_prop.sexKey.male?r[0]:r[1]}return t.otherData[0]},s.getWeaponDisplayID=function(){var t=this;if(t.isSelf){var e=t.getEquipTempIdByPart(gc.c_prop.heroEquipIndexKey.weapon),r=null;if(e){var i=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,e);r=i[gc.t_itemEquip_displayID]}return r}return t.otherData[1]},s.getWingDisplayID=function(){var t=this,e=this.getWingOpt();if(t.isSelf){var r=null,i=e.wingId,a=mo.getJSONWithFileNameAndID(gc.cfg_t_wing,i);return a&&e.wingLvl>0&&(r=a[gc.t_wing_displayID]),r}return t.otherData[2]},s.getIsKing=function(){var e=this;return e.isSelf?t.userCtrl.getIsKing():e.fightData[3]},s.getMedalTitle=function(){var e=this;return e.isSelf?t.userCtrl.get(gc.dsConsts.UserEntity.medalTitle):e.fightData[6]},s.getRebirthLvl=function(){var e=this;return e.isSelf?t.userCtrl.get(gc.dsConsts.UserEntity.rebirthLvl)||0:e.fightData[5]||0},s.getEquipInfoByPart=function(e){var r=this,i=r.equipData[e],a=r.isSelf?t.userCtrl.getEquipBag():r.fightData[1];return a[i]},s.getEquipTempIdByPart=function(t){var e=this,r=e.getEquipInfoByPart(t);return r?r[0]:null},s.getPartByEquipId=function(e){var r=this,i=r.equipData,a=gc.c_prop.heroEquipIndex;gc.c_prop.heroEquipIndexKey;for(var s in a)if(!t.equipCtrl.isBreakRing(s)&&i[s]==e)return parseInt(s);return null},s.getEquipIdByPart=function(t){var e=this,r=e.equipData[t];return r},s.isPartEquiped=function(t){return null!=this.getEquipIdByPart(t)},s.isEquiped=function(){return Object.keys(this.equipData).length>0},s.isNormalEquiped=function(){return null!=this.getFirstEquipedPart()},s.getStanbyEquip=function(e){var r=this;if(!r.isSelf)return[];mo.getJSONWithFileName(gc.cfg_t_itemEquip);return t.equipCtrl.getEquipList(this.job,t.equipCtrl.getEquipTypeByPart(e)).filter(function(e){return t.userCtrl.getLvl()>=t.equipCtrl.getEquipWearLvl(t.userCtrl.getEquipBag()[e][0])})},s.getStanbyBreakId=function(e){var r=this;if(!r.isSelf)return null;var i=null!=r.getEquipIdByPart(e),a=t.equipCtrl.getInitBreakRing(e);return!i&&t.userCtrl.getItemNum(a)>0?a:null},s.getFirstEquipedPart=function(){var e=this,r=e.equipData,i=gc.c_prop.heroEquipIndex;gc.c_prop.heroEquipIndexKey;for(var a in i)if(!t.equipCtrl.isBreakRing(a)&&r[a])return parseInt(a);return null},s.getAllSpecialEquip=function(){var e=this,r=e.equipData,i=gc.c_prop.heroEquipIndex,a=(gc.c_prop.heroEquipIndexKey,[]);for(var s in i)!t.equipCtrl.isBreakRing(s)&&r[s]&&t.equipCtrl.isSpecialEquip(t.equipCtrl.getTempIdByEquipId(r[s]))&&a.push(r[s]);return a},s.getAllCanInherEquip=function(){var e=this,r=e.getAllSpecialEquip();return r.filter(function(e){return t.equipCtrl.getInheritedEquipOpt(e).nextEquipNeedLvlEnough})},s.getStrOpt=function(e){var r=this,i=r.getEquipTempIdByPart(e);if(!i)return null;var a={part:e,strMax:!1,curStrInfo:[],nextStrInfo:[],stone:0,gold:0,costStone:0,costGold:0,strengthLimit:0,strengthLvl:0,stoneEnough:!1,goldEnough:!1},s=r.getStrLvlByEquipPart(e),n=s+1,o=1;0!=s&&(o=s);var c=mo.getJSONWithFileName(gc.cfg_c_lvl),g=mo.getJSONWithFileName(gc.cfg_c_game),l=t.userCtrl.getGold(),_=g[gc.id_c_game.initCfg][2],u=c[o][gc.c_lvl_equipStrengthGold],d=t.userCtrl.getItemNum(gc.c_prop.spItemIdKey.intensify),p=c[o][gc.c_lvl_equipStrengthNum];a.strengthLvl=s,a.strMax=s>=_,a.stone=d,a.gold=l;var m=parseInt(r.getRefLvlByEquipPart(a.part)),f=t.equipCtrl.queryRefineLvlInfo(i,m);return a.strMax?(a.curStrInfo=t.equipCtrl.queryStrLvlInfo(i,s),a.curStrInfo[2]=a.curStrInfo[2]*(1+f[2])>>0):(a.curStrInfo=t.equipCtrl.queryStrLvlInfo(i,s),a.curStrInfo[2]=a.curStrInfo[2]*(1+f[2])>>0,a.nextStrInfo=t.equipCtrl.queryStrLvlInfo(i,n),a.nextStrInfo[2]=a.nextStrInfo[2]*(1+f[2])>>0,a.costStone=p,a.costGold=u,a.strengthLimit=_,a.stoneEnough=d>=p,a.goldEnough=l>=u),a},s.getRefineOpt=function(e){var r=this,i=r.getEquipTempIdByPart(e);if(!i)return null;var a={part:e,isMax:!1,curRefineInfo:[],nextRefineInfo:[],stone:0,gold:0,costStone:0,costGold:0,strengthLvl:0,needStrLv:0,refineLv:0,stoneEnough:!1,goldEnough:!1},s=r.getStrLvlByEquipPart(e),n=parseInt(r.getRefLvlByEquipPart(a.part)),o=mo.getJSONWithFileName(gc.cfg_t_strengthRefine),c=o[n][gc.t_strengthRefine_needStrLvl],g=o[n][gc.t_strengthRefine_consumeGold],l=o[n][gc.t_strengthRefine_consumeStr],_=t.userCtrl.getGold(),u=t.userCtrl.getItemNum(gc.c_prop.spItemIdKey.intensify);return a.isMax=!o[n+1],a.strengthLvl=s,a.refineLv=n,a.needStrLv=c,a.stone=u,a.gold=_,a.isMax?a.curRefineInfo=t.equipCtrl.queryRefineLvlInfo(i,n):(a.curRefineInfo=t.equipCtrl.queryRefineLvlInfo(i,n),a.nextRefineInfo=t.equipCtrl.queryRefineLvlInfo(i,n+1),a.costStone=l,a.costGold=g,a.stoneEnough=u>=l,a.goldEnough=_>=g),a},s.strength=function(e,r,i){var a=this,s=a.get(gc.dsConsts.HeroEntity.tempId);if(e.strMax)return mo.showMsg("已达到强化上限");if(!e.stoneEnough)return mo.showMsg("强化石不足");if(!e.goldEnough)return void t.userCtrl.noGolds(function(){},this);var n=gc.iface.a_hero_strength_args,o={};o[n.tempId]=s,o[n.index]=e.part,mo.requestWaiting4Server(gc.iface.a_hero_strength,o,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.delBagItems]||{},c=t.userUtils.getNewBag(o,{});s[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntity(s),a.updateEntity(n),r.call(i,e),a.pushNotify(a.__class.ON_EQUIP_STR)})},s.equipRefine=function(e,r,i){var a=this,s=parseInt(a.getRefLvlByEquipPart(e.part)),n=mo.getJSONWithFileName(gc.cfg_t_strengthRefine);if(!n[s+1])return mo.showMsg("精炼等级已达最高");var o=n[s][gc.t_strengthRefine_needStrLvl];if(o>e.strengthLvl)return mo.showMsg("本装备栏强化至"+o+"时可继续精炼");var c=n[s][gc.t_strengthRefine_consumeGold],g=n[s][gc.t_strengthRefine_consumeStr];if(e.gold<c)return void t.userCtrl.noGolds(function(){},this);if(e.stone<g)return mo.showMsg("强化石不足");var l=a.get(gc.dsConsts.HeroEntity.tempId),_=gc.iface.a_hero_equipRefine_args,u={};u[_.tempId]=l,u[_.index]=e.part,mo.requestWaiting4Server(gc.iface.a_hero_equipRefine,u,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.strengthArr],c=e[gc.dsConsts.ExUserData.delBagItems]||{},g=t.userUtils.getNewBag(c,{});s[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(s),a.updateEntity(n),r.call(i,o)})},s.getUpStarOpt=function(e){var r=this,i=r.getEquipTempIdByPart(e);if(!i)return null;var a={part:e,curProp:[],nextProp:[],starLvl:0,stone:0,gold:0,costStone:0,costGold:0,strengthLimit:0,strMax:!1,stoneEnough:!1,goldEnough:!1,topLv:0,topCostStone:0,topCostGold:0,topStoneEnough:!1,topGoldEnough:!1,topNeed:!1,topMax:!1,topCurProp:[]},s=mo.getJSONWithFileName(gc.cfg_c_lvl),n=(mo.getJSONWithFileName(gc.cfg_c_game),t.userCtrl.get(gc.dsConsts.UserEntity.gold)),o=r.getStarLvlByEquipPart(e),c=0;0!=o&&(c=o);var g=s[c][gc.c_lvl_upStarGold],l=t.userCtrl.getItemNum(gc.c_prop.spItemIdKey.starStone),_=s[c][gc.c_lvl_upStarNum],u=r.get(gc.dsConsts.HeroEntity.starTopArr)||[],d=u[a.part]||0,p=parseInt(s[d][gc.c_lvl_maxUpStarLvl]);return a.strMax=o>=p,a.strMax?(a.curProp=t.equipCtrl.queryStarInfo(o),a.nextProp=[o,0]):(a.costStone=_,a.costGold=g,a.curProp=t.equipCtrl.queryStarInfo(o),a.nextProp=t.equipCtrl.queryStarInfo(o+1)),a.stone=l,a.gold=n,a.strengthLimit=p,a.stoneEnough=l>=_,a.goldEnough=n>=g,a.starLvl=o,a.topLv=d,a.topMax=!s[d+1][gc.c_lvl_upStarTop],a.topNeed=p<=a.starLvl&&!a.topMax,a.topCostStone=s[d][gc.c_lvl_topCosNum],a.topCostGold=s[d][gc.c_lvl_topCosGold],a.topStoneEnough=a.stone>=a.topCostStone,a.topGoldEnough=a.gold>=a.topCostGold,a.topCurProp=s[d][gc.c_lvl_propertys][e>=8?e-4:e],a},s.upStar=function(e,r,i){var a=this,s=a.get(gc.dsConsts.HeroEntity.tempId);if(e.strMax)return mo.showMsg("已达到升星上限");if(!e.stoneEnough)return mo.showMsg("升星石不足");if(!e.goldEnough)return void t.userCtrl.noGolds(function(){},this);var n=gc.iface.a_hero_upStar_args,o={};o[n.tempId]=s,o[n.index]=e.part,mo.requestWaiting4Server(gc.iface.a_hero_upStar,o,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.delBagItems]||{},c=t.userUtils.getNewBag(o,{});s[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntity(s),a.updateEntity(n),r.call(i,e),a.pushNotify(a.__class.ON_EQUIP_UPSTAR)})},s.starTop=function(e,r,i){var a=this,s=mo.getJSONWithFileName(gc.cfg_c_lvl),n=a.get(gc.dsConsts.HeroEntity.starTopArr)||[],o=n[e.part]||0;if(!s[o+1][gc.c_lvl_upStarTop])return mo.showMsg("当前升星突破重数已打上限");var c=s[o][gc.c_lvl_maxUpStarLvl];if(c>e.starLvl)return mo.showMsg("当前还可以继续升星");var g=s[o][gc.c_lvl_topCosNum],l=s[o][gc.c_lvl_topCosGold],_=t.userCtrl.get(gc.dsConsts.UserEntity.gold),u=t.userCtrl.getItemNum(gc.c_prop.spItemIdKey.starStone);if(g>u)return mo.showMsg("升星石不足");if(l>_)return void t.userCtrl.noGolds(function(){},this);var d=a.get(gc.dsConsts.HeroEntity.tempId),p=gc.iface.a_hero_starTop_args,m={};m[p.tempId]=d,m[p.index]=e.part,mo.requestWaiting4Server(gc.iface.a_hero_starTop,m,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.strengthArr],c=e[gc.dsConsts.ExUserData.delBagItems]||{},g=t.userUtils.getNewBag(c,{});s[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(s),a.updateEntity(n),r.call(i,o)})},s.getUpGemOpt=function(e){var r=this,i=r.getEquipTempIdByPart(e);if(!i)return null;var a={part:e,gemLvl:0,gemId:0,gemDebrisId:0,gemDebris:0,costGemDebris:0,strMax:!1,stoneEnough:!1,nextNeedLvl:0,roleLvlEnough:!1},s=mo.getJSONWithFileName(gc.cfg_c_game),n=mo.getJSONWithFileName(gc.cfg_c_gem),o=r.getGemInfoByPart(e),c=o[gc.c_gem_id],g=o[gc.c_gem_gemLvl],l=0,_=0,u=parseInt(c)+1,d=parseInt(s[gc.id_c_game.gemLvlLimit][0].split(",")[0]),p=s[gc.id_c_game.gemLvlLimit],m=p[p.length-1].split(",");if(n[u]){l=n[c][gc.c_gem_itemID],_=n[c][gc.c_gem_count];var f=n[u][gc.c_gem_gemLvl];if(f>=d){f>=m[0]&&(a.nextNeedLvl=m[1]);for(var h=0;h<s[gc.id_c_game.gemLvlLimit].length;h++)if(parseInt(s[gc.id_c_game.gemLvlLimit][h].split(",")[0])>f){a.nextNeedLvl=parseInt(s[gc.id_c_game.gemLvlLimit][h-1].split(",")[1]);break}}else{var y=mo.getJSONWithFileName(gc.cfg_c_open);a.nextNeedLvl=y[gc.id_c_open.stone][gc.c_open_lvlRequired]}}else a.strMax=!0,a.nextNeedLvl=-1;var C=t.userCtrl.getItemNum(l);return a.gemLvl=g,a.gemId=c,a.gemDebrisId=l,a.gemDebris=C,a.strMax||(a.costGemDebris=_),a.stoneEnough=a.gemDebris>=a.costGemDebris,a.roleLvlEnough=t.userCtrl.getLvl()>=a.nextNeedLvl,a},s.upGem=function(e,r,i){var a=this,s=a.get(gc.dsConsts.HeroEntity.tempId),n=t.userCtrl.getLvl();if(e.strMax)return mo.showMsg("已升到最高等级");if(n<e.nextNeedLvl)return mo.showMsg("等级不足");if(e.gemDebris<e.costGemDebris)return mo.showMsg("宝石碎片数量不足");var o=gc.iface.a_hero_upGem_args,c={};c[o.tempId]=s,c[o.index]=e.part,mo.requestWaiting4Server(gc.iface.a_hero_upGem,c,function(e){var s={},n=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.delBagItems]||{},c=t.userUtils.getNewBag(o,{});s[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntity(s),a.updateEntity(n),r.call(i,e),a.pushNotify(a.__class.ON_EQUIP_UPGEM)})},s.getWingOpt=function(){var e=this,r={wingId:0,wingIdLimit:0,wingName:"",wingLvl:0,gold:0,diamond:0,plumageCount:0,nowPro:{},nextPro:{},nowStarCount:0,nowExp:0,needExp:0,nowExpPer:0,comTrain:0,advTrain:0,featherCount:0,strengthOpenLvl:0,leftLvl:0,rightLvl:0},i={},a={},s=mo.getJSONWithFileName(gc.cfg_c_game),n=mo.getJSONWithFileName(gc.cfg_t_wing),o=mo.getJSONWithFileName(gc.cfg_t_wingStrength),c=t.userCtrl.get(gc.dsConsts.UserEntity.bag),g=t.userCtrl.get(gc.dsConsts.UserEntity.gold),l=t.userCtrl.get(gc.dsConsts.UserEntity.diamond),_=c[gc.c_prop.spItemIdKey.plumage]||0,u=s[gc.id_c_game.initCfg][4],d=e.wingData,p=d[0],m=d[1]||0,f=parseInt(d[3]||0),h=parseInt(n[p][gc.t_wing_needExp]),y=0,C=parseInt(d[4]||0),v=parseInt(d[5]||0);return 0!=h&&(y=f/h*100),y=parseInt(y.toString()),i[gc.c_prop.heroPropKey.attackTemp]=n[p][gc.t_wing_attack]*(1+o[C][gc.t_wingStrength_attack]/1e4)>>0,i[gc.c_prop.heroPropKey.maxHpTemp]=n[p][gc.t_wing_maxHp]*(1+o[v][gc.t_wingStrength_maxHp]/1e4)>>0,i[gc.c_prop.heroPropKey.defenceTemp]=n[p][gc.t_wing_defence]*(1+o[C][gc.t_wingStrength_defence]/1e4)>>0,i[gc.c_prop.heroPropKey.magicDefenceTemp]=n[p][gc.t_wing_magicDefence]*(1+o[v][gc.t_wingStrength_magicDefence]/1e4)>>0,n[p+1]&&(a[gc.c_prop.heroPropKey.attackTemp]=n[p+1][gc.t_wing_attack]*(1+o[C][gc.t_wingStrength_attack]/1e4)>>0,a[gc.c_prop.heroPropKey.maxHpTemp]=n[p+1][gc.t_wing_maxHp]*(1+o[v][gc.t_wingStrength_maxHp]/1e4)>>0,a[gc.c_prop.heroPropKey.defenceTemp]=n[p+1][gc.t_wing_defence]*(1+o[C][gc.t_wingStrength_defence]/1e4)>>0,a[gc.c_prop.heroPropKey.magicDefenceTemp]=n[p+1][gc.t_wing_magicDefence]*(1+o[v][gc.t_wingStrength_magicDefence]/1e4)>>0),r.wingId=p,r.wingIdLimit=u,r.wingName=n[p][gc.t_wing_name],r.wingLvl=m,r.gold=g,r.diamond=l,r.plumageCount=_,r.nowPro=i,r.nextPro=a,r.nowStarCount=d[2]||0,r.nowExp=f,r.needExp=h,r.nowExpPer=y,r.comTrain=s[gc.id_c_game.wingCrit][4],r.advTrain=s[gc.id_c_game.wingCrit][3],r.featherCount=c[gc.c_prop.spItemIdKey.plumage]||0,r.strengthOpenLvl=parseInt(s[gc.id_c_game.wingCrit][7]),r.leftLvl=C,r.rightLvl=v,r},s.wingActivate=function(t,e){var r=this,i=r.get(gc.dsConsts.HeroEntity.tempId),a=gc.iface.a_hero_wingActivate_args,s={};s[a.tempId]=i,mo.requestWaiting4Server(gc.iface.a_hero_wingActivate,s,function(i){r.updateEntity(i),t.call(e,i),r.pushNotify(r.__class.ON_WING_CHANGED)})},s.wingComFos=function(t,e,r){var i=this;i.wingFos(t,gc.c_prop.wingFosTypeKey.comFoster,e,r)},s.wingAdvFos=function(t,e,r){var i=this;i.wingFos(t,gc.c_prop.wingFosTypeKey.advFoster,e,r)},s.wingFos=function(e,r,i,a){var s=this,n=s.get(gc.dsConsts.HeroEntity.tempId);if(e.wingId>=e.wingIdLimit)return mo.showMsg("翅膀等级已到上限");switch(r){case gc.c_prop.wingFosTypeKey.comFoster:if(e.gold<e.comTrain)return void t.userCtrl.noGolds(function(){},this);break;case gc.c_prop.wingFosTypeKey.advFoster:if(e.plumageCount<=0&&e.diamond<e.advTrain)return mo.showMsg(gc.id_c_msgCode.noDiamond)}var o=gc.iface.a_hero_wingFos_args,c={};c[o.tempId]=n,c[o.fosType]=r,mo.requestWaiting4Server(gc.iface.a_hero_wingFos,c,function(e){var r=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.wingExp],c=e[gc.dsConsts.ExUserData.isWingCrit],g=e[gc.dsConsts.ExUserData.delBagItems]||{},l=t.userUtils.getNewBag(g,{});r[gc.dsConsts.UserEntity.bag]=l,t.userCtrl.updateEntity(r),s.updateEntity(n),o&&g_msg.UIMsgTextCtrl.push("+"+o),i.call(a,[o,c])})},s.wingStrength=function(e,r,i,a,s){var n=this,o=mo.getJSONWithFileName(gc.cfg_t_wingStrength),c=e.wingLvl,g=e.strengthOpenLvl;if(g>c)return mo.showMsg(gc.id_c_msgCode.wingLevelRequire,g);var l=0;if(r==gc.c_prop.wingStrengthKey.left)l=e.leftLvl;else{if(r!=gc.c_prop.wingStrengthKey.right)return mo.showMsg("翅膀强化位置错误");l=e.rightLvl}if(!o[l])return mo.showMsg("翅膀强化等级已到上限");if(parseInt(o[l][gc.t_wingStrength_needWingLvl])>c)return mo.showMsg("翅膀到达"+o[l][gc.t_wingStrength_needWingLvl]+"阶后可继续强化");var _=n.get(gc.dsConsts.HeroEntity.tempId),u=gc.iface.a_hero_wingStrength_args,d={};d[u.tempId]=_,d[u.part]=r,d[u.isReplace]=i,mo.requestWaiting4Server(gc.iface.a_hero_wingStrength,d,function(e){var r=e[gc.dsConsts.ExUserData.userData]||{},i=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.strengthArr],c=e[gc.dsConsts.ExUserData.delBagItems]||{},g=t.userUtils.getNewBag(c,{});r[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(r),n.updateEntity(i),a.call(s,o)})},s.upWing=function(t,e){var r=this,i=r.get(gc.dsConsts.HeroEntity.tempId),a=gc.iface.a_hero_upWing_args,s={};s[a.tempId]=i,mo.requestWaiting4Server(gc.iface.a_hero_upWing,s,function(i){r.updateEntity(i),t.call(e,i),r.pushNotify(r.__class.ON_WING_CHANGED)})},r.createNewEnemy=function(t,e,i){var a=new r;return a.fightData=e,a.otherData=i,a.isSelf=!1,a.init(t),a},s.changeEquip=function(e,r,i,a){var s=this,n=s.tempId,o=t.userCtrl.getLvl(),c=t.userCtrl.getEquipBag(),g=mo.getJSONWithFileName(gc.cfg_t_itemEquip),l=mo.getJSONWithFileName(gc.cfg_t_item),_=g[c[r][0]][gc.t_itemEquip_job],u=g[c[r][0]][gc.t_itemEquip_type],d=l[c[r][0]][gc.t_item_level],p=0;switch(parseInt(e)){case gc.c_prop.heroEquipIndexKey.weapon:p=gc.c_prop.equipTypeKey.weapon;break;case gc.c_prop.heroEquipIndexKey.clothes:p=gc.c_prop.equipTypeKey.clothes;break;case gc.c_prop.heroEquipIndexKey.bracelet1:p=gc.c_prop.equipTypeKey.bracelet;break;case gc.c_prop.heroEquipIndexKey.ring1:p=gc.c_prop.equipTypeKey.ring;break;case gc.c_prop.heroEquipIndexKey.ring2:p=gc.c_prop.equipTypeKey.ring;break;case gc.c_prop.heroEquipIndexKey.bracelet2:p=gc.c_prop.equipTypeKey.bracelet;break;case gc.c_prop.heroEquipIndexKey.helmet:p=gc.c_prop.equipTypeKey.helmet;break;case gc.c_prop.heroEquipIndexKey.necklace:p=gc.c_prop.equipTypeKey.necklace}if(!c[r])return mo.showMsg("背包没有该装备");if(1==c[r][3])return mo.showMsg("该装备已装备");if(u!=p)return mo.showMsg("该装备不属于该部位");if(_!=n)return mo.showMsg("不属于该职业装备");if(d>o)return mo.showMsg("等级不够");var m=s.isPartEquiped(e),f=gc.iface.a_equip_changeEquip_args,h={};h[f.tempId]=n,h[f.index]=e,h[f.equipId]=r,mo.requestWaiting4Server(gc.iface.a_equip_changeEquip,h,function(o){var c={},g=o[gc.dsConsts.ExUserData.heroData]||{},l=o[gc.dsConsts.ExUserData.equipBagItems]||{},_=t.userUtils.getNewEquipBag({},l);c[gc.dsConsts.UserEntity.equipBag]=_,t.userCtrl.updateEntity(c),s.updateEntity(g),i.call(a,o),s.pushNotify(s.__class.ON_EQUIP_CHANGED,n,e,r),m?g_cache.recordGuideDone(g_consts.GUIDE_LCK.eqpChged):g_cache.recordGuideDone(g_consts.GUIDE_LCK.everEquiped)})},s.isEquipReddot=function(){var e=this,r=[];if(!e.isSelf)return r;var i=e.get(gc.dsConsts.HeroEntity.tempId),a=mo.getJSONWithFileName(gc.cfg_t_item),s=mo.getJSONWithFileName(gc.cfg_t_itemEquip),n=e.get(gc.dsConsts.HeroEntity.equipData),o=t.userCtrl.getEquipBag()||{},c=t.userCtrl.getLvl();for(var g in o){var l=o[g][0],_=o[g][3],u=a[l][gc.t_item_level],d=s[l][gc.t_itemEquip_job];if(!(u>c)&&1!=_&&d==i){var l=o[g][0],p=o[g][2],m=s[l][gc.t_itemEquip_type],f=[];switch(m){case gc.c_prop.equipTypeKey.weapon:f=[gc.c_prop.heroEquipIndexKey.weapon];break;case gc.c_prop.equipTypeKey.clothes:f=[gc.c_prop.heroEquipIndexKey.clothes];break;case gc.c_prop.equipTypeKey.helmet:f=[gc.c_prop.heroEquipIndexKey.helmet];break;case gc.c_prop.equipTypeKey.necklace:f=[gc.c_prop.heroEquipIndexKey.necklace];break;case gc.c_prop.equipTypeKey.ring:f=[gc.c_prop.heroEquipIndexKey.ring1,gc.c_prop.heroEquipIndexKey.ring2];break;case gc.c_prop.equipTypeKey.bracelet:f=[gc.c_prop.heroEquipIndexKey.bracelet1,gc.c_prop.heroEquipIndexKey.bracelet2]}for(var h=0;h<f.length;h++){var y=0;n[f[h]]&&(y=o[n[f[h]]][2]),p>y&&-1==r.indexOf(f[h])&&r.push(f[h])}}}return r},s.isTringReddot=function(){var e=this,r=[];if(!e.isSelf)return r;for(var i=mo.getJSONWithFileName(gc.cfg_c_game),a=mo.getJSONWithFileName(gc.cfg_c_compound),s=t.userCtrl.getBag(),n=e.get(gc.dsConsts.HeroEntity.equipData),o=gc.c_prop.heroEquipIndexKey.paralysisRing;o<=gc.c_prop.heroEquipIndexKey.harmRing;o++){var c=0,g=0;if(n[o]){if(a[parseInt(n[o])+1]){c=s[a[parseInt(n[o])+1][gc.c_compound_reqItems1]]||0,g=a[parseInt(n[o])+1][gc.c_compound_reqCount1];var l=a[parseInt(n[o])+1][gc.c_compound_needLvl],_=t.userCtrl.getLvl();c>=g&&_>=l&&r.push(o)}}else c=s[a[i[gc.id_c_game.parRingCfg][o-4]][gc.c_compound_reqItems1]]||0,g=a[i[gc.id_c_game.parRingCfg][o-4]][gc.c_compound_reqCount1],(c>=g||s[i[gc.id_c_game.parRingCfg][o-4]])&&r.push(o)}return r},s.isSkillReddot=function(){for(var e=this,r=[],i=t.userCtrl.getLvl(),a=t.userCtrl.getGold(),s=t.userCtrl.get(gc.dsConsts.UserEntity.skillCd),n=t.userCtrl.get(gc.dsConsts.UserEntity.lastSkillTime),o=mo.getJSONWithFileName(gc.cfg_c_lvl),c=mo.getJSONWithFileName(gc.cfg_c_game),g=e.get(gc.dsConsts.HeroEntity.skillLvlArr),l=c[gc.id_c_game.skillRate][5],_=c[gc.id_c_game.skillRate][4].split(","),u=Date.newDate(n).addSeconds(s),d=s,p=_.length,m=0;p>m;m++){var f=_[m],h=g[m]||1,y=o[parseInt(h)+1][gc.c_lvl_skillNeedGold];if(!(f>i||h>=i)){if(d=(u.getTime()-Date.newDate().getTime())/1e3,s>l){if(d>0)continue}else if(d>l)continue;y>a||r.push(m)}}return r},s.isStateReddot=function(){var e=this,r=[!0,[]],i=t.userCtrl.getLvl(),a=t.userCtrl.getBag()||{},s=mo.getJSONWithFileName(gc.cfg_t_item),n=mo.getJSONWithFileName(gc.cfg_c_realm),o=e.get(gc.dsConsts.HeroEntity.realmLvl),c=e.get(gc.dsConsts.HeroEntity.realmArr)||[];c.length<6&&(r[0]=!1);for(var g=0;g<c.length;g++)null==c[g]&&(r[0]=!1);for(var l=n[o][gc.c_realm_reqItems],g=0;g<l.length;g++)l[g]!=c[g]&&(r[0]=!1);for(var _=[],g=0;5>=g;g++){var u=l[g];if(c[g]!=u&&a[u]&&0!=a[u]){var d=s[u][gc.t_item_level];d>i||_.push(g)}}return r[1]=_,r},s.isStrengthReddot=function(){for(var e=this,r=[],i=t.userCtrl.getGold(),a=t.userCtrl.getBag()||{},s=mo.getJSONWithFileName(gc.cfg_c_lvl),n=mo.getJSONWithFileName(gc.cfg_c_game),o=n[gc.id_c_game.initCfg][2],c=a[gc.c_prop.spItemIdKey.intensify]||0,g=e.get(gc.dsConsts.HeroEntity.intensifyArr)||[],l=e.get(gc.dsConsts.HeroEntity.equipData)||{},_=gc.c_prop.heroEquipIndexKey.weapon;_<=gc.c_prop.heroEquipIndexKey.necklace;_++)if(_!=gc.c_prop.heroEquipIndexKey.paralysisRing&&_!=gc.c_prop.heroEquipIndexKey.reviveRing&&_!=gc.c_prop.heroEquipIndexKey.protectRing&&_!=gc.c_prop.heroEquipIndexKey.harmRing&&l[_]){var u=g[_]||1,d=s[u][gc.c_lvl_equipStrengthGold],p=s[u][gc.c_lvl_equipStrengthNum];u>=o||d>i||p>c||r.push(_)}return r},s.isUpStarReddot=function(){for(var e=this,r=[],i=t.userCtrl.getGold(),a=t.userCtrl.getBag()||{},s=mo.getJSONWithFileName(gc.cfg_c_lvl),n=e.get(gc.dsConsts.HeroEntity.starTopArr)||[],o=a[gc.c_prop.spItemIdKey.starStone]||0,c=e.get(gc.dsConsts.HeroEntity.starArr)||[],g=e.get(gc.dsConsts.HeroEntity.equipData)||{},l=gc.c_prop.heroEquipIndexKey.weapon;l<=gc.c_prop.heroEquipIndexKey.necklace;l++){var _=n[l]||0,u=parseInt(s[_][gc.c_lvl_maxUpStarLvl]);if(l!=gc.c_prop.heroEquipIndexKey.paralysisRing&&l!=gc.c_prop.heroEquipIndexKey.reviveRing&&l!=gc.c_prop.heroEquipIndexKey.protectRing&&l!=gc.c_prop.heroEquipIndexKey.harmRing&&g[l]){var d=c[l]||1,p=s[d][gc.c_lvl_upStarGold],m=s[d][gc.c_lvl_upStarNum];d>=u||p>i||m>o||r.push(l)}}return r},s.isUpGemReddot=function(){for(var e=this,r=[],i=t.userCtrl.getBag()||{},a=mo.getJSONWithFileName(gc.cfg_c_gem),s=mo.getJSONWithFileName(gc.cfg_c_game),n=e.get(gc.dsConsts.HeroEntity.gemArr)||[],o=e.get(gc.dsConsts.HeroEntity.equipData)||{},c=gc.c_prop.heroEquipIndexKey.weapon;c<=gc.c_prop.heroEquipIndexKey.necklace;c++)if(c!=gc.c_prop.heroEquipIndexKey.paralysisRing&&c!=gc.c_prop.heroEquipIndexKey.reviveRing&&c!=gc.c_prop.heroEquipIndexKey.protectRing&&c!=gc.c_prop.heroEquipIndexKey.harmRing&&o[c]){var g=c;c>7&&(g=c-4);var l=n[c]||s[gc.id_c_game.gemInitial][g],_=s[gc.id_c_game.gemLimit][g],u=a[l][gc.c_gem_itemID],d=a[l][gc.c_gem_count],p=i[u]||0;if(!(l>=_)){var m=parseInt(a[l][gc.c_gem_gemLvl])+1,f=t.userCtrl.getLvl(),h=parseInt(s[gc.id_c_game.gemLvlLimit][0].split(",")[0]),y=!1;if(m>=h)for(var C=0;C<s[gc.id_c_game.gemLvlLimit].length;C++)if(parseInt(s[gc.id_c_game.gemLvlLimit][C].split(",")[0])>m){f<parseInt(s[gc.id_c_game.gemLvlLimit][C-1].split(",")[1])&&(y=!0);break}y||d>p||r.push(c)}}return r},s.getHeroRealmList=function(){for(var e=this,r=[],i=0,a=0,s=[],n=mo.getJSONWithFileName(gc.cfg_c_realm),o=(mo.getJSONWithFileName(gc.cfg_c_compound),mo.getJSONWithFileName(gc.cfg_t_item)),c=t.userCtrl.getLvl(),g=t.userCtrl.get(gc.dsConsts.UserEntity.bag),l=e.get(gc.dsConsts.HeroEntity.realmLvl),_=e.get(gc.dsConsts.HeroEntity.realmArr),u=n[l][gc.c_realm_reqItems],d=0;d<u.length;d++)u[d]==_[d]&&(i+=1),null!=_[d]&&_[d]||(g[u[d]]&&g[u[d]]>=1?c>=o[u[d]][gc.t_item_level]&&s.push(d):t.heroCtrl.isRuneCom(u[d])&&1==t.heroCtrl.canRuneCom(u[d])&&c>=o[u[d]][gc.t_item_level]&&s.push(d));return 6==_.length&&6==i&&(a=1),r[0]=l,r[1]=_,r[2]=s,r[3]=a,r
},s.getHeroRealmRune=function(t){var e=this,r=mo.getJSONWithFileName(gc.cfg_c_realm),i=e.get(gc.dsConsts.HeroEntity.realmLvl),a=0==i?0:i,s=r[a][gc.c_realm_reqItems][t];return s},r.ON_EQUIP_CHANGED="onEquipChanged",r.ON_EQUIP_STR="onEquipStr",r.ON_EQUIP_UPSTAR="onEquipStar",r.ON_WING_CHANGED="ON_WING_CHANGED",r.ON_EQUIP_UPGEM="onEquipUpGem",r.ON_SKILL_CHANGED="ON_SKILL_CHANGED",r.ON_GIFT_SKILL_CHANGED="ON_GIFT_SKILL_CHANGED",r.Scale_Num=1e4,r}(mo.DataController);t.HeroEntityCtrl=e,egret.registerClass(e,"gd.HeroEntityCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t.isSelf=!1},a.getLvl=function(){return this.heroCtrlList[0].fightData[0]},a.getUserName=function(){return this.heroCtrlList[0].fightData[2]},a.getMainHeroCtrl=function(){return this.heroCtrlList[0]},a.getHeroByIndex=function(t){return this.heroCtrlList[t]},a.hasHeroByIndex=function(t){return null!=this.heroCtrlList[t]},a.isToBeOpen=function(t){return!1},a.isMy4thRole=function(t){return!1},a.getFightList=function(){var e=this,r=e.heroCtrlList;return r.sort(t.heroCtrl._sortHeroList),r},a.getShowHeroData=function(e,r,i){var a=this,s=gc.iface.a_hero_getShowHeroData_args,n={};n[s.userId]=e,mo.requestWaiting4Server(gc.iface.a_hero_getShowHeroData,n,function(e){for(var s=e[gc.dsConsts.ShowHeroData.heroList],n=e[gc.dsConsts.ShowHeroData.otherDataList],o=e[gc.dsConsts.ShowHeroData.fightData],c=[],g=0;g<s.length;g++){var l=s[g],_=t.HeroEntityCtrl.createNewEnemy(l,o,n[g]);c.push(_)}a.heroCtrlList=c,r.call(i,c)})},r}(mo.DataController);t.EnemyHeroCtrl=e,egret.registerClass(e,"gd.EnemyHeroCtrl"),t.enemyHeroCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a.init=function(t){e.prototype.init.call(this,t),t&&this._initFromCfg()},a.initData=function(t){this.getList(function(){},this)},a.getList=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_mail_getList,{},function(a){i.init(a),i._calAllDel(),i._sort(),t.pointCtrl.cal(gc.c_prop.pointEffectKey.mail),e&&e.call(r,i._data)})},a.getInfoById=function(t){for(var e=gc.dsConsts.MailEntity.id,r=0;r<this._data.length;r++){var i=this._data[r];if(i[e]==t)return i}},a.setRead=function(e,r,i){var a=this,s=a.getInfoById(e);if(s[gc.dsConsts.MailEntity.isRead])return void(r&&r.call(i));s[gc.dsConsts.MailEntity.isRead]=1,a._calExpireDel(e,a.__class.OPERATE_READ);var n={},o=gc.iface.a_mail_setRead_args;n[o.mailId]=e,mo.request4Server(gc.iface.a_mail_setRead,n,function(){t.pointCtrl.cal(gc.c_prop.pointEffectKey.mail),r&&r.call(i)})},a.pickItems=function(e,r,i){var a=this,s={},n=gc.iface.a_mail_pickItems_args;s[n.mailId]=e,mo.requestWaiting4Server(gc.iface.a_mail_pickItems,s,function(s){var n=s[gc.dsConsts.ExUserData.isMail];n&&mo.showMsg(gc.id_c_msgCode.bagMaxMail);var o=s[gc.dsConsts.ExUserData.isFull];o&&mo.showMsg(gc.id_c_msgCode.bagMax);var c=a.getInfoById(e);c&&(c[gc.dsConsts.MailEntity.items]=s[gc.dsConsts.ExUserData.items],c[gc.dsConsts.MailEntity.isPicked]=a._getIsPicked(c)),a._calExpireDel(e,a.__class.OPERATE_PICK);var g=s[gc.dsConsts.ExUserData.userData]||{},l=s[gc.dsConsts.ExUserData.bagItems],_=s[gc.dsConsts.ExUserData.equipBagItems],u=t.userUtils.getNewBag({},l);g[gc.dsConsts.UserEntity.bag]=u;var d=t.userUtils.getNewEquipBag({},_);return g[gc.dsConsts.UserEntity.equipBag]=d,t.userCtrl.updateEntity(g),t.pointCtrl.cal(gc.c_prop.pointEffectKey.mail),r?r.call(i,!c):void 0})},a.pickAllItems=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_mail_pickAllItems,{},function(a){var s=a[gc.dsConsts.ExUserData.isMail];s&&mo.showMsg(gc.id_c_msgCode.bagMaxMail);var n=a[gc.dsConsts.ExUserData.isFull];n&&mo.showMsg(gc.id_c_msgCode.bagMax);for(var o=a[gc.dsConsts.ExUserData.pickAllItemsArr],c=a[gc.dsConsts.ExUserData.pickAllItemsList],g=0;g<o.length;g++){var l=i.getInfoById(o[g]);l&&(l[gc.dsConsts.MailEntity.items]=c[g],l[gc.dsConsts.MailEntity.isPicked]=i._getIsPicked(l),i._calExpireDel(o[g],i.__class.OPERATE_PICK))}var _=a[gc.dsConsts.ExUserData.userData]||{},u=a[gc.dsConsts.ExUserData.bagItems],d=a[gc.dsConsts.ExUserData.equipBagItems],p=t.userUtils.getNewBag({},u);_[gc.dsConsts.UserEntity.bag]=p;var m=t.userUtils.getNewEquipBag({},d);return _[gc.dsConsts.UserEntity.equipBag]=m,t.userCtrl.updateEntity(_),t.pointCtrl.cal(gc.c_prop.pointEffectKey.mail),e?e.call(r,!l):void 0})},a.isNeedOperate=function(t,e){mo.requestWaiting4Server(gc.iface.a_mail_getIsNeedOperate,{},function(r){return t?t.call(e,r):void 0})},a._calExpireDel=function(t,e){var r=this,i=this.getInfoById(t);e==r.__class.OPERATE_READ?i[gc.dsConsts.MailEntity.items]||(i[gc.dsConsts.MailEntity.delTime]=Date.newDate().addHours(i[gc.dsConsts.MailEntity.delHours])):e==r.__class.OPERATE_PICK&&(i[gc.dsConsts.MailEntity.type]==gc.c_prop.mailTypeKey.equipChest&&i[gc.dsConsts.MailEntity.items]&&"{}"!=JSON.stringify(i[gc.dsConsts.MailEntity.items])||(i[gc.dsConsts.MailEntity.delTime]=Date.newDate().addHours(i[gc.dsConsts.MailEntity.delHours]))),r._isNeedToDel(t)&&r._del(t)},a._isNeedToDel=function(t){var e=this,r=e.getInfoById(t),i=r[gc.dsConsts.MailEntity.expireTime];i&&"string"==typeof i&&(i=Date.newDate(i));var a=r[gc.dsConsts.MailEntity.delTime],s=Date.newDate();return i.isBefore(s)||i.equals(s)?!0:(a&&"string"==typeof a&&(a=Date.newDate(a)),a&&(a.isBefore(s)||a.equals(s))?!0:!1)},a._sort=function(){for(var t=[],e=[],r=[],i=this._data,a=0;a<i.length;a++){var s=i[a],n=s[gc.dsConsts.MailEntity.isRead],o=s[gc.dsConsts.MailEntity.isPicked],c=s[gc.dsConsts.MailEntity.items];c&&Object.keys(c).length<=0&&(s[gc.dsConsts.MailEntity.items]=null),n?o?r.push(s):e.push(s):t.push(s)}var g=gc.dsConsts.MailEntity.id,l=function(t,e){return t[g]>e[g]?-1:1};t.sort(l),e.sort(l),r.sort(l),this._data=t.concat(e).concat(r)},a._calAllDel=function(){for(var t=this,e=this._data,r=0,i=e.length;i>r;r++){var a=e[r][gc.dsConsts.MailEntity.id];t._isNeedToDel(a)&&(e.splice(r,1),r--)}},a._del=function(t){for(var e=this._data,r=0,i=e.length;i>r;r++)if(e[r][gc.dsConsts.MailEntity.id]==t){e.splice(r,1);break}},a._initFromCfg=function(){for(var t=this._data,e=mo.getJSONWithFileName(gc.cfg_c_mail),r=0,i=t.length;i>r;r++){var a=t[r],s=e[a[gc.dsConsts.MailEntity.type]];if(s){a[gc.dsConsts.MailEntity.fromName]=s[gc.c_mail_fromName],a[gc.dsConsts.MailEntity.title]=s[gc.c_mail_title];var n=s[gc.c_mail_content];a[gc.dsConsts.MailEntity.replaceArgs];a[gc.dsConsts.MailEntity.content]=n}}},a._getIsPicked=function(t){if(t[gc.dsConsts.MailEntity.type]==gc.c_prop.mailTypeKey.equipChest){var e=t[gc.dsConsts.MailEntity.items];return Object.keys(e).length>0?0:1}return 1},r.OPERATE_READ=1,r.OPERATE_PICK=2,r}(mo.DataController);t.MailCtrl=e,egret.registerClass(e,"gd.MailCtrl"),t.mailCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.UserEntity,this.isNewPrintActived=!1},a.initData=function(t){if(t){var e=this;e.init(t)}},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.isActiveMedal=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.medalData)||{};return r[e]?!0:!1},a.isMedalUp=function(){var e=[],r=t.userCtrl.getLvl(),i=t.userCtrl.get(gc.dsConsts.UserEntity.bag)||{},a=t.userCtrl.get(gc.dsConsts.UserEntity.medalData)||{},s=mo.getJSONWithFileName(gc.cfg_t_medalLvl);for(var n in a){var o=a[n][0],c=o+1;if(s[c]&&!(r<s[c][gc.t_medalLvl_needLvl])){for(var g=s[c][gc.t_medalLvl_reqItems]||[],l=!0,_=0,u=g.length;u>_;_++){var d=g[_],p=d[0],m=d[1],f=i[p]||0;if(!f||m>f){l=!1;break}}l&&e.push(parseInt(n))}}return e},a.isMedalItemEnough=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.bag)||{},i=t.userCtrl.get(gc.dsConsts.UserEntity.medalData)||{},a=mo.getJSONWithFileName(gc.cfg_t_medalLvl);if(!i[e])return!1;var s=i[e][0],n=s+1;if(!a[n])return!1;for(var o=a[n][gc.t_medalLvl_reqItems]||[],c=!0,g=0,l=o.length;l>g;g++){var _=o[g],u=_[0],d=_[1],p=r[u]||0;if(!p||d>p){c=!1;break}}return c},a.setMedalTitle=function(e,r,i){var a=gc.iface.a_user_setMedalTitle_args,s={};s[a.warPrintedId]=e,mo.requestWaiting4Server(gc.iface.a_user_setMedalTitle,s,function(e){var a=e[gc.dsConsts.ExWarPrintedData.medalTitle];t.userCtrl.set(gc.dsConsts.UserEntity.medalTitle,a),r&&r.call(i,a)})},a.activeMedal=function(e,r,i){var a=this,s=gc.iface.a_user_activeMedal_args,n={};n[s.warPrintedId]=e,mo.requestWaiting4Server(gc.iface.a_user_activeMedal,n,function(e){var s=e[gc.dsConsts.ExWarPrintedData.medalData],n=e[gc.dsConsts.ExWarPrintedData.delBagItems];if(Object.keys(n).length>0){var o=t.userUtils.getNewBag(n,{});t.userCtrl.set(gc.dsConsts.UserEntity.bag,o)}t.userCtrl.set(gc.dsConsts.UserEntity.medalData,s),t.heroCtrl.calPropAndCombat(),a.pushNotify(a.__class.ON_ACTVATE_SUCC),r&&r.call(i,s)})},a.getMedalTitle=function(){return t.userCtrl.get(gc.dsConsts.UserEntity.medalTitle)},a.getWarPrintedList=function(e){void 0===e&&(e=0);var r=this;r.isNewPrintActived=!1;var i=t.userCtrl.get(gc.dsConsts.UserEntity.medalData)||{},a=mo.getJSONWithFileName(gc.cfg_t_medal),s=t.userCtrl.getBag();for(var n in a){var o=a[n][gc.t_medal_id];if(!i[o]&&s[o]&&s[o]>0){r.isNewPrintActived=!0;break}}var c=[];if(Object.keys(i).length>0){for(var n in i)n==r.getMedalTitle()&&e||c.push(r.transWarPrintData(n));c=r.sortList(c)}return c},a.getToBeActivatedList=function(){var e=this,r=[],i=t.userCtrl.get(gc.dsConsts.UserEntity.medalData)||{},a=mo.getJSONWithFileName(gc.cfg_t_medal),s=t.userCtrl.getBag();for(var n in a){var o=a[n][gc.t_medal_id];!i[o]&&s[o]&&s[o]>0&&r.push(e.transWarPrintData(o))}return r=e.sortList(r)},a.getAllWarPrintList=function(){var t=this,e=t.getWarPrintedList(),r=t.getToBeActivatedList();return e=r.concat(e)},a.warPrintedStrength=function(e,r,i){var a=this;if(e.isStrMax)return mo.showMsg("已强化到最高等级");if(!e.isItemEnough)return mo.showMsg("材料不足");var s=gc.iface.a_user_warPrintedStrength_args,n={};n[s.warPrintedId]=e.medalId,mo.requestWaiting4Server(gc.iface.a_user_warPrintedStrength,n,function(e){var s=e[gc.dsConsts.ExWarPrintedData.medalData],n=e[gc.dsConsts.ExWarPrintedData.delBagItems];if(Object.keys(n).length>0){var o=t.userUtils.getNewBag(n,{});t.userCtrl.set(gc.dsConsts.UserEntity.bag,o)}t.userCtrl.set(gc.dsConsts.UserEntity.medalData,s),t.heroCtrl.calPropAndCombat(),a.pushNotify(a.__class.ON_STR_SUCC),r&&r.call(i,s)})},a.getWarPrintData=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.medalData);return r[e]},a.transWarPrintData=function(e){var r=mo.getJSONWithFileName(gc.cfg_t_item),i=mo.getJSONWithFileName(gc.cfg_t_medalLvl),a=t.userCtrl.get(gc.dsConsts.UserEntity.medalData),s=a[e]?a[e][0]:100*e;return[parseInt(e),i[s][gc.t_medalLvl_lvl],i[s][gc.t_medalLvl_grade],r[e][gc.t_item_color]]},a.getWarPrintStrOpt=function(e){var r=this,i=r.getWarPrintData(e);if(!i)return null;var a={medalId:e,curStrId:i[0],nextStrId:null,isStrMax:!1,reqItems:[],isItemEnough:!1,medalEnough:!1},s=parseInt(a.curStrId)+1,n=mo.getJSONWithFileName(gc.cfg_t_medalLvl),o=n[s];if(a.isStrMax=null==o,!a.isStrMax){a.nextStrId=s,a.reqItems=o[gc.t_medalLvl_reqItems],a.isItemEnough=!0,a.medalEnough=!0;for(var c=0,g=a.reqItems.length;g>c;c++){var l=a.reqItems[c];if(l[1]>t.userCtrl.getItemNum(l[0])){a.isItemEnough=!1;var _=mo.getJSONWithFileNameAndID(gc.cfg_t_item,l[0])[gc.t_item_type];_==gc.c_prop.itemTypeKey.medal&&(a.medalEnough=!1)}}}return a},a.getStrId=function(t,e){return 100*parseInt(t)+parseInt(e)},a.getStrProperty=function(t,e,r){void 0===r&&(r=!0);for(var i=Object.keys(gc.c_prop.equipProp),a=[],s=mo.getJSONWithFileNameAndID(gc.cfg_t_medal,t)[gc.t_medal_propertys],n=[],o=mo.getJSONWithFileNameAndID(gc.cfg_t_medalLvl,e)[gc.t_medalLvl_strengthPro],c=0,g=s.length;g>c;c++){var l=s[c];n.push([l[0],Math.floor(l[1]*(1+o/1e4))]),r&&a.push(l[0])}if(r)for(var c=0,g=i.length;g>c;c++){var _=parseInt(i[c]);a.indexOf(_)>=0||n.push([_,0])}return n.sort(function(t,e){return parseInt(t[0])<parseInt(e[0])?-1:1}),n},a.getTotalPrintProperty=function(){var e=this,r=Object.keys(gc.c_prop.equipProp);r.sort(function(t,e){return parseInt(t)<parseInt(e)?-1:1});for(var i=[],a=0,s=r.length;s>a;a++)i.push([r[a],0]);var n,o=t.userCtrl.get(gc.dsConsts.UserEntity.medalData)||{},c=0;for(var g in o){c=o[g][0],n=e.getStrProperty(g,c);for(var l=0,_=n.length;_>l;l++){var u=n[l],d=i[l]||[u[0],0];d[1]+=u[1],i[l]=d}}return i},a.isMedalRed=function(){var e=this;if(e.isNewPrintActived)return!0;var r,i=t.userCtrl.get(gc.dsConsts.UserEntity.medalData)||{};for(var a in i)if(r=e.getWarPrintStrOpt(a),!r.isStrMax&&r.isItemEnough)return!0;return!1},a.sortList=function(t){var e=[2,3,0],r=[-1,-1,1];return t.sort(function(t,i){for(var a=0;3>a;a++){var s=r[a];if(t[e[a]]>i[e[a]])return 0>=s?-1:1;if(t[e[a]]<i[e[a]])return 0>=s?1:-1}return 0}),t},a.getAchievmentMedal=function(){var t=mo.getJSONWithFileName(gc.cfg_t_medal),e=Object.keys(t);e.sort();for(var r=[],i=0,a=e.length;a>i;i++){var s=t[e[i]];s[gc.t_medal_isAchivement]&&r.push(s)}return r},r.ON_STR_SUCC="ON_STR_SUCC",r.ON_ACTVATE_SUCC="ON_ACTIVATE_SUCC",r}(mo.DataController);t.MedalCtrl=e,egret.registerClass(e,"gd.MedalCtrl"),t.medalCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.initData=function(e){pomelo.removeAllListeners(gc.c_prop.receiverKey.chat),pomelo.removeAllListeners(gc.c_prop.receiverKey.point),pomelo.removeAllListeners(gc.c_prop.receiverKey.task),pomelo.removeAllListeners(gc.c_prop.receiverKey.pkDeal),pomelo.on(gc.c_prop.receiverKey.chat,function(e){var i=e[r.ON_VALUE_KEY];t.chatCtrl.updateNewMsg(i)}),pomelo.on(gc.c_prop.receiverKey.point,function(t){}),pomelo.on(gc.c_prop.receiverKey.task,function(e){var i=e[r.ON_VALUE_KEY];i&&t.taskCtrl.updateEntity(i)}),pomelo.on(gc.c_prop.receiverKey.pkDeal,function(e){t.pkOutCtrl.dealRecord()})},r.ON_VALUE_KEY="v",r}(mo.DataController);t.MsgReceiverCtrl=e,egret.registerClass(e,"gd.MsgReceiverCtrl"),t.msgReceiverCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},r.getTpyeNotice=function(t){for(var e=[],i=r._noticeList,a=0;a<i.length;a++)i[a][gc.dsConsts.NoticeEntity.iconType]==t&&e.push(i[a]);return e},r.getList=function(t,e){mo.requestWaiting4Server(gc.iface.h_notice_getList,{},function(i){r.getNewOne(function(a){a[gc.dsConsts.NoticeEntity.iconType]=gc.c_prop.noticeIconTypeKey.logon,i.unshift(a),r._noticeList=i,t&&t.call(e,i)},this)})},r.getNewOne=function(e,r){var i=new egret.HttpRequest;i.responseType=egret.HttpResponseType.TEXT,i.addEventListener(egret.Event.COMPLETE,function(i){var a=i.currentTarget,s=a.response,n=JSON.parse(s);n&&n.m&&t.chatCtrl.newChannelNotice(n.m),e&&e.call(r,n.v)},this);var a;a=null==t.userCtrl?t.serverInfoCtrl.getSelectIndex():t.userCtrl.get(gc.dsConsts.UserEntity.serverIndexId);var s=t.accountCtrl.get(gc.dsConsts.AccountEntity.sdkData).open_id;i.open("http://gc.hgame.com/public/getnotice/gameid/100220/groupid/"+a+"/openid/"+s,egret.HttpMethod.GET),i.send()},r._noticeList=[],r}(mo.DataController);t.NoticeCtrl=e,egret.registerClass(e,"gd.NoticeCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._rank=0,this._curEnemyID=-1,this._curFightType=1,this._curIsRevenge=0,this._hasNewDeal=!1,this._hasNewRankPkDeal=!1,this._bePkKill=!1,this.autoPkOut=!0}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.PkOutEntity,this._pkRecordList=[]},a.initData=function(t){if(t){var e=this;e.init(t),e.getPkRecordList(function(){},e),e.dealRecord(),e.getRankPkRecordList(function(){},e),e.dealRankPkRecord(),e._dataRefreshTime=Date.newDate()}},a.checkOpen=function(e,r){var i=this;if(i._data)return e.call(r,!0);var a=mo.getJSONWithFileName(gc.cfg_c_open),s=a[gc.id_c_open.pkOut][gc.c_open_lvlRequired];return t.userCtrl.getLvl()<s?e.call(r,!1):void i.open(function(){e.call(r,!0)},i)},a.getKillValue=function(){var t=this;return t._data?(t._dataRefreshTime&&!Date.newDate().equalsDay(t._dataRefreshTime)&&t.open(function(){t._dataRefreshTime=Date.newDate()},t),this.get(gc.dsConsts.PkOutEntity.killValue)):0},a.getPkValue=function(){var t=this;return t._data?t.get(gc.dsConsts.PkOutEntity.pkValue):0},a.getAccWinCount=function(){var t=this;return t._data?t.get(gc.dsConsts.PkOutEntity.accWinCount):0},a.calPkValue=function(){var t=this;if(t._data){var e=mo.getJSONWithFileName(gc.cfg_c_game),r=t.get(gc.dsConsts.PkOutEntity.pkValue),i=t.get(gc.dsConsts.PkOutEntity.pkValueTime);i=new Date(i);var a=i.getMinutesBetween(Date.newDate());a/=20;var s=parseInt(a.toString());s>0&&(r-=e[gc.id_c_game.pkOutCfg][0]*s,i.addMinutes(20*s)),r=0>r?0:r,t.set(gc.dsConsts.PkOutEntity.pkValue,r),t.set(gc.dsConsts.PkOutEntity.pkValueTime,i)}},a.getMyRank=function(e,r){var i=this;i.getRankList(function(a){for(var s=0,n=0;n<a.length;n++){var o=a[n];o[gc.dsConsts.Rank.userId]==t.userCtrl.getId()&&(s=n+1)}return s>0?e(s):void i._initRank(e,r)},i)},a.getRankAward=function(t){for(var e=mo.getJSONWithFileName(gc.cfg_c_pvpRankReward),r=0,i=0,a=0,s=null,n=1;100>n;n++){var o=e[n];if(!o)break;if(s=o,t<=o[gc.c_pvpRankReward_range])break}return s&&(r=s[gc.c_pvpRankReward_starStone],i=s[gc.c_pvpRankReward_gold],a=s[gc.c_pvpRankReward_diamond]),[r,i,a]},a._initRank=function(t,e){var r=this;mo.request4Server(gc.iface.a_pkOut_getMyRank,{},function(i){r._rank=i,t&&t.call(e,i)})},a.open=function(t,e){var r=this;mo.request4Server(gc.iface.a_pkOut_open,{},function(i){r.init(i),t&&t.call(e,i)})},a.getReRefreshSeconds=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_game),r=e[gc.id_c_game.pkOutCfg][4],i=t.get(gc.dsConsts.PkOutEntity.enemyIds),a=t.get(gc.dsConsts.PkOutEntity.freshTime);if(a=new Date(a),i.length>=3)return 0;var s=Date.newDate().getSecondsBetween(a.clone().addSeconds(r));return s},a.getEnemyList=function(t,e){var r=this;mo.request4Server(gc.iface.a_pkOut_getEnemyList,{},function(i){var a=i[gc.dsConsts.ExPkOut.pkOutData];delete a[gc.dsConsts.PkOutEntity.pkValue],r.updateEntity(a);var s=i[gc.dsConsts.ExPkOut.enemyList];t&&t.call(e,s)})},a._calRefreshNum=function(){var t=this,e=t.get(gc.dsConsts.PkOutEntity.todayRefreshTime),r=t.get(gc.dsConsts.PkOutEntity.todayRefreshNum);e||(r=0,e=Date.newDate()),e=Date.newDate(e),e.equalsDay(new Date)||(r=0,e=Date.newDate()),t.set(gc.dsConsts.PkOutEntity.todayRefreshTime,e),t.set(gc.dsConsts.PkOutEntity.todayRefreshNum,r)},a.refreshEnemy=function(e,r,i){var a=this;a._calRefreshNum();var s=mo.getJSONWithFileName(gc.cfg_c_game),n=a.get(gc.dsConsts.PkOutEntity.todayRefreshNum),o=gc.calRefreshPKCost(n),c=e?mo.requestWaiting4Server:mo.request4Server,g=function(){c(gc.iface.a_pkOut_refreshEnemy,{},function(e){var s=e[gc.dsConsts.ExPkOut.userData];s&&t.userCtrl.updateEntity(s);var n=e[gc.dsConsts.ExPkOut.pkOutData];n&&a.updateEntity(n),a.getEnemyList(r,i)})},l=s[gc.id_c_game.pkCfg1][0];n>l?mo.showMsg(gc.id_c_msgCode.findRival100,o,n,l,g):mo.showMsg(gc.id_c_msgCode.findRival,o,n,g)},a.getClearReSeconds=function(){var t=Date.newDate().clearTime().addHours(24),e=Date.newDate().getSecondsBetween(t);return e=0>e?0:e},a.clearPkValue=function(e,r){var i=this,a=i.getPkValue();if(0>=a)return mo.showMsg(gc.id_c_msgCode.noPKPoint);var s=gc.calClearPkCost(a);mo.showMsg(gc.id_c_msgCode.ifClearPKPoint,s,function(){mo.request4Server(gc.iface.a_pkOut_clearPkValue,{},function(a){var s=a[gc.dsConsts.ExPkOut.userData];s&&t.userCtrl.updateEntity(s);var n=a[gc.dsConsts.ExPkOut.pkOutData];n&&i.updateEntity(n),e&&e.call(r)})})},a.isTodayRankWin=function(t){var e=this._getRankPkTime(),r=e[1]||[];return r.indexOf(t)>-1?!0:!1},a._getRankPkTime=function(){var e=t.userCtrl.get(gc.dsConsts.UserEntity.exData),r=e[gc.c_prop.userExDataKey.todayRankWin]||[],i=r[0];i||(i=Date.newDate());var a=Date.newDate(i),s=r[1]||[];return Date.newDate().equalsDay(a)||(i=Date.newDate(),s=[]),r=[i,s]},a.start=function(e,r,i,a,s){var n=this,o=mo.getJSONWithFileName(gc.cfg_c_open),c=o[gc.id_c_open.pkOut][gc.c_open_lvlRequired];if(!n._data)return mo.showMsg(gc.id_c_msgCode.pkNoOpen,c,function(){},n);if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(t.fightCtrl.isDie)return mo.showMsg("复活中，请稍后");n._curEnemyID=e,n._curFightType=r,n._curIsRevenge=i||0;var g={},l=gc.iface.a_pkOut_start_args;g[l.enemyId]=e,g[l.fightType]=r,g[l.isRevenge]=n._curIsRevenge,mo.requestWaiting4Server(gc.iface.a_pkOut_start,g,function(e){var r=e[gc.dsConsts.ExPkOut.pkOutData];n.updateEntity(r);for(var i=e[gc.dsConsts.ExPkOut.heroList],o=e[gc.dsConsts.ExPkOut.otherDataList],c=e[gc.dsConsts.ExPkOut.fightData],g=[],l=0;l<i.length;l++){var _=i[l],u=t.HeroEntityCtrl.createNewEnemy(_,c,o[l]);g.push(u)}g.sort(t.heroCtrl._sortHeroList),t.fightCtrl.isSpFighting=!0;var d=e[gc.dsConsts.ExPkOut.guildData];d&&t.guildCtrl.updateData(d);var p=e[gc.dsConsts.ExPkOut.guildPersonalData];p&&t.guildPersonalCtrl.updateData(p),a&&a.call(s,g)})},a.end=function(e,r,i,a){if(-1!=this._curEnemyID){var s=this,n={},o=this._curEnemyID,c=gc.iface.a_pkOut_end_args;n[c.enemyId]=o,n[c.fightData]=r,n[c.isWin]=e,n[c.fightType]=s._curFightType,n[c.isRevenge]=s._curIsRevenge,this._curEnemyID=-1,mo.requestWaiting4Server(gc.iface.a_pkOut_end,n,function(r){var n=r[gc.dsConsts.FightResult.updateUser]||{},o=r[gc.dsConsts.FightResult.bagItems],c=r[gc.dsConsts.FightResult.equipBagItems],g=t.userUtils.getNewBag({},o);n[gc.dsConsts.UserEntity.bag]=g;var l=t.userUtils.getNewEquipBag({},c);n[gc.dsConsts.UserEntity.equipBag]=l,n&&t.userCtrl.updateEntity(n);var _=r[gc.dsConsts.FightResult.updatePkOut];if(_&&s.updateEntity(_),s._initRank(),!e){var u=0;r[gc.dsConsts.FightResult.killValue]=u}i&&i.call(a,r)})}},a.getRankList=function(t,e){mo.request4Server(gc.iface.a_pkOut_getRankList,{},function(r){t&&t.call(e,r)})},a.getPkRecordList=function(e,r){var i=this;mo.getJSONWithFileName(gc.cfg_c_game);mo.request4Server(gc.iface.a_pkOut_getPkRecordList,{},function(a){i._calRecord(a),i._pkRecordList=a,t.pointCtrl.cal(gc.c_prop.pointRedKey.pkout1),e&&e.call(r,a)})},a.setReadRecord=function(){mo.request4Server(gc.iface.a_pkOut_setPkRecordRead,{},function(t){})},a.hasNewDeal=function(){var t=this;return t._hasNewDeal},a.setNewDeal=function(e){this._hasNewDeal=e,t.pointCtrl.cal(gc.c_prop.pointRedKey.pkout1)},a.dealRecord=function(t,e){var r=this;r._dealRecord(gc.c_prop.fightTypeKey.pk,function(t){t&&r.setNewDeal(t)},r)},a._calRecord=function(t){for(var e=mo.getJSONWithFileName(gc.cfg_c_game),r=0;r<t.length;r++){var i=t[r],a=i[gc.dsConsts.ArenaRecordEntity.isWin],s=i[gc.dsConsts.ArenaRecordEntity.userId],n=i[gc.dsConsts.ArenaRecordEntity.enemyId],o=i[gc.dsConsts.ArenaRecordEntity.fightData].items||{};for(var c in o){var g=o[c];0==g&&delete o[c]}if(s==n){var l=0,_=0,u=0,d=0;if(a)l=i[gc.dsConsts.ArenaRecordEntity.fightData].killValue||0,l=Math.floor(l/2);else{d=e[gc.id_c_game.pkOutCfg][11]||0,d*=-1;var p=i[gc.dsConsts.ArenaRecordEntity.fightData].ePkColor;p==gc.c_prop.pkNameColorKey.red&&(_=i[gc.dsConsts.ArenaRecordEntity.fightData].gold||0,_*=-1);var m=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.pkLoot)[0];m=m.split(","),delete o[Math.floor(m[0])]}i[gc.dsConsts.ArenaRecordEntity.fightData].killValue=l,i[gc.dsConsts.ArenaRecordEntity.fightData].gold=_,i[gc.dsConsts.ArenaRecordEntity.fightData].expc=u,i[gc.dsConsts.ArenaRecordEntity.fightData].pkValue=d}else if(!a){var l=0;i[gc.dsConsts.ArenaRecordEntity.fightData].killValue=l}i[gc.dsConsts.ArenaRecordEntity.fightData].items=o}},a._dealRecord=function(e,r,i){var a=this,s={},n=gc.iface.a_pkOut_dealRecord_args;s[n.fightType]=e,mo.request4Server(gc.iface.a_pkOut_dealRecord,s,function(e){var s=e[gc.dsConsts.ExPkOut.userData];t.userCtrl.updateEntity(s);var n=e[gc.dsConsts.ExPkOut.pkOutData];a.updateEntity(n);var o=e[gc.dsConsts.ExPkOut.hasNewDeal];r.call(i,o)})},a.getRankPkRecordList=function(e,r){var i=this;mo.request4Server(gc.iface.a_pkOut_getRankPkRecordList,{},function(a){i._calRecord(a),t.pointCtrl.cal(gc.c_prop.pointRedKey.rankPk),e&&e.call(r,a)})},a.hasRankPkNewDeal=function(){var t=this;return t._hasNewRankPkDeal},a.setRankPkNewDeal=function(e){this._hasNewRankPkDeal=e,t.pointCtrl.cal(gc.c_prop.pointRedKey.rankPk)},a.dealRankPkRecord=function(t,e){var r=this;r._dealRecord(gc.c_prop.fightTypeKey.rankPk,function(t){t&&r.setRankPkNewDeal(t)},r)},a.getRevengeList=function(t,e){var r=this;r.getPkRecordList(function(t){for(var e=0;e<t.length;e++){t[e]}},r)},a.getRevengeEnemyList=function(t,e){mo.request4Server(gc.iface.a_pkOut_getRevengeEnemyList,{},function(r){t&&t.call(e,r)})},a.isBePkKill=function(){var t=this;return t._bePkKill},a.resetBePkKill=function(){var t=this;mo.request4Server(gc.iface.a_pkOut_resetBePkKill,{},function(e){t.setBePkKill(!1)})},a.setBePkKill=function(e){var r=this;r._bePkKill=e,t.pointCtrl.cal(gc.c_prop.pointRedKey.bePkKill)},a.treasureBiz=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_treasure_spies,{},function(a){var s=a[gc.dsConsts.ExPkOut.userData];s&&t.userCtrl.updateEntity(s);var n=a[gc.dsConsts.ExPkOut.pkOutData];n&&i.updateEntity(n),i.getEnemyList(e,r)})},a.incognito=function(e,r){mo.requestWaiting4Server(gc.iface.a_pkOut_incognito,{},function(i){var a=i[gc.dsConsts.Incognito.userData];a&&t.userCtrl.updateEntity(a);i[gc.dsConsts.Incognito.openTime];e&&e.call(r,i)})},a.getExPkOutInfo=function(t,e){mo.request4Server(gc.iface.a_treasure_getExPkOutInfo,{},function(r){t&&t.call(e,r)})},a.openTreasure=function(t,e,r){var i={},a=gc.iface.a_treasure_open_args;i[a.id]=t,mo.requestWaiting4Server(gc.iface.a_treasure_open,i,function(t){e&&e.call(r,t)})},a.getTreasurePkRecordList=function(t,e){mo.request4Server(gc.iface.a_pkOut_getTreasurePkRecordList,{},function(r){t&&t.call(e,r)})},a.compose=function(e,r,i){var a={},s=gc.iface.a_treasure_compose_args;a[s.itemId]=e,mo.requestWaiting4Server(gc.iface.a_treasure_compose,a,function(e){var a={},s=e[gc.dsConsts.ComposeInfo.delBagItem],n=t.userUtils.getNewBag(s,{});a[gc.dsConsts.UserEntity.bag]=n,t.userCtrl.updateEntity(a),r&&r.call(i,e)})},r}(mo.DataController);t.PkOutCtrl=e,egret.registerClass(e,"gd.PkOutCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.isShow=function(t){var e=this,r=!1,i=gc.c_prop.pointRedKey;switch(t){case i.home_main:r=e._isShow(i.arena1)||e._isShow(i.copy_boss)||e._isShow(gc.c_prop.pointEffectKey.mail)||e._isShow(gc.c_prop.pointEffectKey.chuanChen)||e._isShow(gc.c_prop.pointEffectKey.custom)||e._isShow(gc.c_prop.pointEffectKey.medal);break;case i.role_main:r=e.isShow(i.role1_main)||e.isShow(i.role2_main)||e.isShow(i.role3_main)||e.isShow(i.role4_main);break;case i.make_main:r=e.isShow(i.role1_dazao)||e.isShow(i.role2_dazao)||e.isShow(i.role3_dazao);break;case i.role1_main:r=e._isShowByKeys([gc.c_prop.pointRedKey.role1_equip,gc.c_prop.pointRedKey.role1_tring,i.role1_wing,i.role1_skill,i.role1_realm]);break;case i.role2_main:r=e._isShowByKeys([gc.c_prop.pointRedKey.role2_equip,gc.c_prop.pointRedKey.role2_tring,i.role2_wing,i.role2_skill,i.role2_realm]);break;case i.role3_main:r=e._isShowByKeys([gc.c_prop.pointRedKey.role3_equip,gc.c_prop.pointRedKey.role3_tring,i.role3_wing,i.role3_skill,i.role3_realm]);break;case i.role4_main:r=e._isShowByKeys([gc.c_prop.pointRedKey.role4_equip,i.role4_skill]);break;case i.role1_dazao:r=e._isShowByKeys([i.role1_intensify,i.role1_star,i.role1_gem]);break;case i.role2_dazao:r=e._isShowByKeys([i.role2_intensify,i.role2_star,i.role2_gem]);break;case i.role3_dazao:r=e._isShowByKeys([i.role3_intensify,i.role3_star,i.role3_gem]);break;case i.demonLotus_main:r=e._isShowByKeys([i.demonLotus_1,i.demonLotus_2]);break;default:r=e._isShow(t)}return r},a._isShow=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.redPointData);return r[e]?!0:!1},a._isShowByKeys=function(t){for(var e=0;e<t.length;e++){var r=t[e];if(this._isShow(r))return!0}return!1},a.getShowData=function(t){return[]},a.cal=function(e){var r=this,i=function(r){var i=t.userCtrl.get(gc.dsConsts.UserEntity.redPointData);i[e]=r,t.userCtrl.set(gc.dsConsts.UserEntity.redPointData,i),mo.emitter.emit("onRed")};switch(e){case gc.c_prop.pointEffectKey.activity:var a=t.activityCtrl.isPointEffect();i(a);break;case gc.c_prop.pointEffectKey.task:var a=t.taskCtrl.isTaskReddot()[0]||t.taskCtrl.isTaskReddot()[1];i(a);break;case gc.c_prop.pointEffectKey.sign:var a=!t.signCtrl.isTodaySigned();i(a);break;case gc.c_prop.pointEffectKey.bag:var a=t.userCtrl.isSmeltReddot();i(a);break;case gc.c_prop.pointEffectKey.mail:t.mailCtrl.isNeedOperate(i,r);break;case gc.c_prop.pointEffectKey.recharge:var a=t.activityCtrl.hasRecharged()&&!t.activityCtrl.hasReceiveFirstRecharge();i(a);break;case gc.c_prop.pointEffectKey.chuanChen:var a=t.equipCtrl.getSpecialEquipDot().indexOf(1)>=0;i(a);break;case gc.c_prop.pointEffectKey.custom:var a=t.customCtrl.isCustomRed();i(a);break;case gc.c_prop.pointEffectKey.medal:var a=t.medalCtrl.isMedalRed();i(a);break;case gc.c_prop.pointRedKey.pkout1:var a=t.pkOutCtrl.hasNewDeal();i(a);break;case gc.c_prop.pointRedKey.arena1:var a=t.arenaCtrl.getData()&&t.arenaCtrl.getRePKNum()>0;i(a);break;case gc.c_prop.pointRedKey.role1_wing:var s=t.heroCtrl.getHeroByIndex(0);if(s){var a=s.isWingOpen()&&!s.isWingActived()||s.isWingActived()&&t.userCtrl.getItemNum(gc.c_prop.spItemIdKey.plumage)>0&&!s.isWingLimit();i(a)}break;case gc.c_prop.pointRedKey.role1_equip:var s=t.heroCtrl.getHeroByIndex(0);if(s){var a=s.isEquipReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role1_tring:var s=t.heroCtrl.getHeroByIndex(0);if(s){var a=s.isTringReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role2_tring:var s=t.heroCtrl.getHeroByIndex(1);if(s){var a=s.isTringReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role3_tring:var s=t.heroCtrl.getHeroByIndex(2);if(s){var a=s.isTringReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role1_skill:break;case gc.c_prop.pointRedKey.role1_realm:var s=t.heroCtrl.getHeroByIndex(0);if(s){var a=1==s.getHeroRealmList()[3]||s.getHeroRealmList()[2].length>0;i(a)}break;case gc.c_prop.pointRedKey.role1_intensify:var s=t.heroCtrl.getHeroByIndex(0);if(s){var a=s.isStrengthReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role1_star:var s=t.heroCtrl.getHeroByIndex(0);if(s){var a=s.isUpStarReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role1_gem:var s=t.heroCtrl.getHeroByIndex(0);if(s){var a=s.isUpGemReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role2_wing:var s=t.heroCtrl.getHeroByIndex(1);if(s){var a=s.isWingOpen()&&!s.isWingActived()||s.isWingActived()&&t.userCtrl.getItemNum(gc.c_prop.spItemIdKey.plumage)>0&&!s.isWingLimit();i(a)}break;case gc.c_prop.pointRedKey.role2_equip:var s=t.heroCtrl.getHeroByIndex(1);if(s){var a=s.isEquipReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role2_skill:break;case gc.c_prop.pointRedKey.role2_realm:var s=t.heroCtrl.getHeroByIndex(1);if(s){var a=1==s.getHeroRealmList()[3]||s.getHeroRealmList()[2].length>0;i(a)}break;case gc.c_prop.pointRedKey.role2_intensify:var s=t.heroCtrl.getHeroByIndex(1);if(s){var a=s.isStrengthReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role2_star:var s=t.heroCtrl.getHeroByIndex(1);if(s){var a=s.isUpStarReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role2_gem:var s=t.heroCtrl.getHeroByIndex(1);if(s){var a=s.isUpGemReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role3_wing:var s=t.heroCtrl.getHeroByIndex(2);if(s){var a=s.isWingOpen()&&!s.isWingActived()||s.isWingActived()&&t.userCtrl.getItemNum(gc.c_prop.spItemIdKey.plumage)>0&&!s.isWingLimit();
i(a)}break;case gc.c_prop.pointRedKey.role3_equip:var s=t.heroCtrl.getHeroByIndex(2);if(s){var a=s.isEquipReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role3_skill:break;case gc.c_prop.pointRedKey.role3_realm:var s=t.heroCtrl.getHeroByIndex(2);if(s){var a=1==s.getHeroRealmList()[3]||s.getHeroRealmList()[2].length>0;i(a)}break;case gc.c_prop.pointRedKey.role3_intensify:var s=t.heroCtrl.getHeroByIndex(2);if(s){var a=s.isStrengthReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role3_star:var s=t.heroCtrl.getHeroByIndex(2);if(s){var a=s.isUpStarReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role3_gem:var s=t.heroCtrl.getHeroByIndex(2);if(s){var a=s.isUpGemReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role4_equip:var s=t.heroCtrl.getHeroByIndex(3);if(s){var a=s.isEquipReddot().length>0;i(a)}break;case gc.c_prop.pointRedKey.role4_skill:break;case gc.c_prop.pointRedKey.copy_boss:t.copyCtrl.isCanStartHell(i,r);break;case gc.c_prop.pointRedKey.rankPk:var a=t.pkOutCtrl.hasRankPkNewDeal();i(a);break;case gc.c_prop.pointRedKey.bePkKill:var a=t.pkOutCtrl.isBePkKill();i(a);break;case gc.c_prop.pointRedKey.shopMain:var n=t.shopCtrl.isShopEquipReddot(),a=n.length>0;i(a);break;case gc.c_prop.pointRedKey.fuli:var a=t.activityCtrl.isFuliPointEffect();i(a);break;case gc.c_prop.pointGreenKey.copy_equip:t.copyCtrl.hasNotReadEquip(gc.c_prop.copyTypeKey.equip,i,r);break;case gc.c_prop.pointGreenKey.copy_realm:t.copyCtrl.hasNotReadEquip(gc.c_prop.copyTypeKey.state,i,r);break;case gc.c_prop.pointGreenKey.copy_boss:t.copyCtrl.hasNotReadEquip(gc.c_prop.copyTypeKey.hell,i,r);break;case gc.c_prop.pointGreenKey.role1_skill:break;case gc.c_prop.pointGreenKey.role1_realm:break;case gc.c_prop.pointGreenKey.role2_skill:break;case gc.c_prop.pointGreenKey.role2_realm:break;case gc.c_prop.pointGreenKey.role3_skill:break;case gc.c_prop.pointGreenKey.role3_realm:break;case gc.c_prop.pointRedKey.demonLotus_1:if(t.demonLotusCtrl.getData()){var a=t.demonLotusCtrl.isMaxExpc();i(a)}break;case gc.c_prop.pointRedKey.demonLotus_2:if(t.demonLotusCtrl.getData()){var a=t.demonLotusCtrl.isCanTrain();i(a)}}},a.calAll=function(){var t=this;for(var e in gc.c_prop.pointEffectKey){var r=gc.c_prop.pointEffectKey[e];t.cal(r)}for(var e in gc.c_prop.pointRedKey){var r=gc.c_prop.pointRedKey[e];t.cal(r)}for(var e in gc.c_prop.pointGreenKey){var r=gc.c_prop.pointGreenKey[e];t.cal(r)}},r}(mo.DataController);t.PointCtrl=e,egret.registerClass(e,"gd.PointCtrl"),t.pointCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.ProtocolContentEntity},i.initData=function(t){if(t){var e=this;e.init(t)}},i.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},i.getInfo=function(t,e){mo.request4Server(gc.iface.h_protocolContent_getInfo,{},function(r){t.call(e,r)})},e}(mo.DataController);t.ProtocolContentCtrl=e,egret.registerClass(e,"gd.ProtocolContentCtrl"),t.protocolContentCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){function e(t){var e=[1,2,0],r=[1,-1,1];return t.sort(function(t,i){for(var a=0;3>a;a++){var s=r[a];if(t[e[a]]>i[e[a]])return 0>=s?-1:1;if(t[e[a]]<i[e[a]])return 0>=s?1:-1}return 0}),t}var r=function(r){function i(){r.apply(this,arguments)}__extends(i,r);var a=(__define,i),s=a.prototype;return s._initProp=function(){r.prototype._initProp.call(this);var t=this,e=gc.c_prop.equipTypeKey,i=gc.c_prop.heroEquipIndexKey;t._partTypeMap={},t._partTypeMap[i.weapon]=e.weapon,t._partTypeMap[i.clothes]=e.clothes,t._partTypeMap[i.bracelet1]=e.bracelet,t._partTypeMap[i.ring1]=e.ring,t._partTypeMap[i.paralysisRing]=e.ring,t._partTypeMap[i.reviveRing]=e.ring,t._partTypeMap[i.protectRing]=e.ring,t._partTypeMap[i.harmRing]=e.ring,t._partTypeMap[i.ring2]=e.ring,t._partTypeMap[i.bracelet2]=e.bracelet,t._partTypeMap[i.helmet]=e.helmet,t._partTypeMap[i.necklace]=e.necklace},s.getSmeltArr=function(r,i){var a=this,s=[],n=[],o={},c=mo.getJSONWithFileName(gc.cfg_t_item),g=mo.getJSONWithFileName(gc.cfg_t_itemEquip),l=t.userCtrl.getLvl(),_=t.userCtrl.getEquipBag();for(p in _)o[p]=_[p];var u=t.heroCtrl.getHeroMap(),d=[];for(var p in u)d.push(u[p].get(gc.dsConsts.HeroEntity.tempId));var m=[[],[],[],[],[],[]];for(var p in o){var f=g[o[p][0]][gc.t_itemEquip_type],h=g[o[p][0]][gc.t_itemEquip_job];switch(f){case gc.c_prop.equipTypeKey.weapon:this._equipProfession(h,m[0],p,r,d,o,c,l,f);break;case gc.c_prop.equipTypeKey.clothes:this._equipProfession(h,m[1],p,r,d,o,c,l,f);break;case gc.c_prop.equipTypeKey.bracelet:this._equipProfession(h,m[2],p,r,d,o,c,l,f);break;case gc.c_prop.equipTypeKey.ring:this._equipProfession(h,m[3],p,r,d,o,c,l,f);break;case gc.c_prop.equipTypeKey.helmet:this._equipProfession(h,m[4],p,r,d,o,c,l,f);break;case gc.c_prop.equipTypeKey.necklace:this._equipProfession(h,m[5],p,r,d,o,c,l,f)}}for(var y=0;y<m.length;y++)for(var C=0;C<m[y].length;C++)if(null!=m[y][C]){m[y][C][0][1]&&delete o[m[y][C][0][1]],m[y][C][0][3]&&delete o[m[y][C][0][3][1]];for(var v=0;v<m[y][C][1].length;v++)m[y][C][1][v]&&m[y][C][1][v][1]&&delete o[m[y][C][1][v][1]],m[y][C][1][v]&&m[y][C][1][v][3]&&delete o[m[y][C][1][v][3][1]]}for(var p in u){var I=u[p].get(gc.dsConsts.HeroEntity.equipData);for(var E in I)delete o[I[E]]}for(var p in o)if(!o[p][3]&&1!=g[o[p][0]][gc.t_itemEquip_isUp]&&o[p][0]<900001){var D=o[p][6],b=o[p][0];a._isLocked(D,g[b])||n.push([p,c[b][gc.t_item_color],c[b][gc.t_item_level],0])}if(i){for(var y=0;y<n.length;y++)n[y][1]==i&&s.push(n[y][0]);return s}n=e(n);for(var S=n.length<9?n.length:9,y=0;S>y;y++)s.push(n[y][0]);return s},s._isLocked=function(t,e){var r=0;return void 0==t?e&&e[gc.t_itemEquip_isLocked]&&(r=e[gc.t_itemEquip_isLocked]):r=t,r},s._equipProfession=function(t,e,r,i,a,s,n,o,c){r=parseInt(r);var g=parseInt(s[r][2]),l=parseInt(s[r][3]),_=parseInt(n[s[r][0]][gc.t_item_level]),u=1==_?0:parseInt(_.toString().substring(0,_.toString().length-1));1==i?(t==gc.c_prop.heroJobKey.zs&&this._equipScreen(0,e,_,o,c,g,r,l,u,s),t==gc.c_prop.heroJobKey.fs&&this._equipScreen(1,e,_,o,c,g,r,l,u,s),t==gc.c_prop.heroJobKey.ds&&this._equipScreen(2,e,_,o,c,g,r,l,u,s),t==gc.c_prop.heroJobKey.ys&&this._equipScreen(3,e,_,o,c,g,r,l,u,s)):(t==gc.c_prop.heroJobKey.zs&&-1!=a.indexOf(t)&&this._equipScreen(0,e,_,o,c,g,r,l,u,s),t==gc.c_prop.heroJobKey.fs&&-1!=a.indexOf(t)&&this._equipScreen(1,e,_,o,c,g,r,l,u,s),t==gc.c_prop.heroJobKey.ds&&-1!=a.indexOf(t)&&this._equipScreen(2,e,_,o,c,g,r,l,u,s),t==gc.c_prop.heroJobKey.ys&&-1!=a.indexOf(t)&&this._equipScreen(3,e,_,o,c,g,r,l,u,s))},s._equipScreen=function(t,e,r,i,a,s,n,o,c,g){e[t]||(e[t]=[[],[]]),i>=r?a==gc.c_prop.equipTypeKey.bracelet||a==gc.c_prop.equipTypeKey.ring?e[t][0][1]?e[t][0][1]&&!e[t][0][3]?e[t][0][3]=[s,n,o]:e[t][0][0]<=s?e[t][0][3][0]<=s?e[t][0][3][0]>e[t][0][0]?e[t][0][0]==s?1!=e[t][0][2]&&(e[t][0]=[s,n,o,e[t][0][3]]):e[t][0]=[s,n,o,e[t][0][3]]:e[t][0][3][0]==s?1!=e[t][0][3][2]&&(e[t][0][3]=[s,n,o]):e[t][0][3]=[s,n,o]:e[t][0][0]==s?1!=e[t][0][2]&&(e[t][0]=[s,n,o,e[t][0][3]]):e[t][0]=[s,n,o,e[t][0][3]]:e[t][0][3][0]<=s&&(e[t][0][3][0]==s?1!=e[t][0][3][2]&&(e[t][0][3]=[s,n,o]):e[t][0][3]=[s,n,o]):e[t][0]=[s,n,o]:(e[t][0][1]||(e[t][0]=[s,n,o]),e[t][0][0]<s&&(e[t][0]=[s,n,o]),e[t][0][0]==s&&1!=e[t][0][2]&&(e[t][0]=[s,n,o])):e[t][1][c]&&e[t][1][c][1]?a==gc.c_prop.equipTypeKey.bracelet||a==gc.c_prop.equipTypeKey.ring?e[t][1][c]&&!e[t][1][c][3]?e[t][1][c][3]=[g[n][2],n,o]:e[t][1][c][0]<=g[n][2]?e[t][1][c][3][0]<=g[n][2]?e[t][1][c][0]<=e[t][1][c][3][0]?e[t][1][c]=[g[n][2],n,o,e[t][1][c][3]]:e[t][1][c][3]=[g[n][2],n,o]:e[t][1][c]=[g[n][2],n,o,e[t][1][c][3]]:e[t][1][c][3]&&e[t][1][c][3][0]<=g[n][2]&&(e[t][1][c][3]=[g[n][2],n,o]):e[t][1][c][0]<=g[n][2]&&(e[t][1][c]=[g[n][2],n,o,e[t][1][c][3]]):e[t][1][c]=[g[n][2],n,o]},s.getColorCount=function(e){var r=this,i=mo.getJSONWithFileName(gc.cfg_t_item),a=mo.getJSONWithFileName(gc.cfg_t_itemEquip),s=0,n=t.userCtrl.getEquipBag();for(var o in n)if(!n[o][3]){var c=n[o][0],g=i[c][gc.t_item_color];if(e==g){var l=n[o][6];r._isLocked(l,a[c])||s++}}return s},s.smelt=function(e,r,i,a){var s=this;if(e.length<=0)return i.call(a,[]);var n=gc.iface.a_smelt_smelt_args,o={};o[n.equipArr]=e,o[n.choColor]=r,mo.requestWaiting4Server(gc.iface.a_smelt_smelt,o,function(e){var n=e[gc.dsConsts.ExUserData.userData]||{},o=e[gc.dsConsts.ExUserData.gainArr]||[],c=e[gc.dsConsts.ExUserData.bagItems]||{},g=e[gc.dsConsts.ExUserData.equipBagItems]||{},l=e[gc.dsConsts.ExUserData.delEquipBagArr]||[],_=t.userUtils.getNewBag({},c);n[gc.dsConsts.UserEntity.bag]=_;var u=t.userUtils.getNewEquipBag(l,g);n[gc.dsConsts.UserEntity.equipBag]=u,t.userCtrl.updateEntity(n),r?s.pushNotify(s.__class.ON_BATCH_SMELT):s.pushNotify(s.__class.ON_SMELT),t.pointCtrl.cal(gc.c_prop.pointEffectKey.bag),i.call(a,o),g_cache.recordGuideDone(g_consts.GUIDE_LCK.hasSmelting)})},s.compound=function(e,r,i){var a=this,s=gc.iface.a_smelt_compound_args,n={};n[s.compoundId]=e,mo.requestWaiting4Server(gc.iface.a_smelt_compound,n,function(s){var n={},o=s[gc.dsConsts.ExUserData.bagItems]||{},c=s[gc.dsConsts.ExUserData.delBagItems]||{},g=t.userUtils.getNewBag(c,o);n[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(n),r.call(i,s),a.pushNotify(a.__class.ON_BREAK_MERGED,e)})},s.wearParRing=function(e,r,i,a){var s=this,n=parseInt(r),o=t.userCtrl.get(gc.dsConsts.UserEntity.bag);if(!o[n]||0==o[n])return mo.showMsg("还未拥有该特戒");var c=t.heroCtrl.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),g=gc.iface.a_smelt_wearParRing_args,l={};l[g.tempId]=c,l[g.breakId]=n,mo.requestWaiting4Server(gc.iface.a_smelt_wearParRing,l,function(r){var n={},o=r[gc.dsConsts.ExUserData.heroData]||{},c=r[gc.dsConsts.ExUserData.delBagItems]||{},g=t.userUtils.getNewBag(c,{});n[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(n),t.heroCtrl.updateHeroEntityCtrl(e,o),i.call(a,r),s.pushNotify(s.__class.ON_WEAR_PAR_RING)})},s.ringBreak=function(e,r,i,a){var s=this,n=parseInt(r),o=mo.getJSONWithFileName(gc.cfg_c_compound),c=mo.getJSONWithFileName(gc.cfg_t_itemBreak),g=t.heroCtrl.getEquipData(e),l=t.userCtrl.get(gc.dsConsts.UserEntity.bag),_=t.userCtrl.getLvl(),u=c[n][gc.t_itemBreak_position];if(!g[u]||g[u]!=n)return mo.showMsg("还未拥有用于突破的特戒");if(!o[n+1])return mo.showMsg("特戒已经突破到最高");var d=o[n+1][gc.c_compound_needLvl];if(d>_)return mo.showMsg("等级不足");var p=o[n+1][gc.c_compound_reqItems1],m=o[n+1][gc.c_compound_reqCount1],f=l[p]||0;if(m>f)return mo.showMsg("碎片不足");var h=t.heroCtrl.getHeroEntityCtrl(e).get(gc.dsConsts.HeroEntity.tempId),y=gc.iface.a_smelt_ringBreak_args,C={};C[y.tempId]=h,C[y.breakId]=n,mo.requestWaiting4Server(gc.iface.a_smelt_ringBreak,C,function(r){var n={},o=r[gc.dsConsts.ExUserData.heroData]||{},c=r[gc.dsConsts.ExUserData.delBagItems]||{},g=t.userUtils.getNewBag(c,{});n[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(n),t.heroCtrl.updateHeroEntityCtrl(e,o),i.call(a,r),s.pushNotify(s.__class.ON_BREAK_PAR_RING)})},s.getTempIdByEquipId=function(e,r){var i=null==r?t.userCtrl.getEquipBag():r;return i[e][0]},s.getEquipEvaluate=function(e){var r=t.userCtrl.getEquipBag();return r[e][2]},s.getEquipItemLvl=function(t){var e=this,r=e.getTempIdByEquipId(t),i=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r);return i[gc.t_item_itemLvl]},s.getSpecialEquipEvaluate=function(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,e);return t.userUtils.getEquipGrade(e,r[gc.t_itemEquip_fixProp])},s.getBaseEvaluate=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return e[gc.t_itemEquip_gradeBase]},s.getSpecialEquipExtra=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return e[gc.t_itemEquip_fixProp]},s.getEquipExtra=function(e,r){var i=this,a=null==r?t.userCtrl.getEquipBag():r,s=i.getTempIdByEquipId(e,r);return i.isSpecialEquip(s)||i.isRareEquip(s)?i.getSpecialEquipExtra(s):a[e][1]},s.getBasePropArr=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return e[gc.t_itemEquip_propertys]},s.getEquipName=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_item,t);return e[gc.t_item_name]},s.getEquipExtraObj=function(t,e){var r=this,i=r.getEquipExtra(t,e);return utils.kvArr2KvObj(i)},s.getStrLvlInfo=function(t,e){var r=mo.getJSONWithFileName(gc.cfg_t_itemEquip)[t],i=r[gc.t_itemEquip_slotStrengthProperty],a=r[gc.t_itemEquip_propValue]*e;return[e,i,a]},s.getIntensifyArr=function(e){var r=t.heroCtrl.getHeroEntityCtrl(e);return r.get(gc.dsConsts.HeroEntity.intensifyArr)},s.getStarArr=function(e){var r=t.heroCtrl.getHeroEntityCtrl(e);return r.get(gc.dsConsts.HeroEntity.starArr)},s.getGemArr=function(e,r){var i=[],a=0,s=mo.getJSONWithFileName(gc.cfg_c_gem),n=mo.getJSONWithFileName(gc.cfg_c_game);4>r&&(a=n[gc.id_c_game.gemInitial][r]),r>7&&(a=n[gc.id_c_game.gemInitial][r-4]);var o=t.heroCtrl.getHeroEntityCtrl(e),c=o.get(gc.dsConsts.HeroEntity.gemArr)||[],g=c[r]||a;return i[0]=[s[g][gc.c_gem_items1],s[g][gc.c_gem_effectPro1]],i[1]=[s[g][gc.c_gem_items2],s[g][gc.c_gem_effectPro2]],i[2]=[s[g][gc.c_gem_items3],s[g][gc.c_gem_effectPro3]],i[3]=[s[g][gc.c_gem_items4],s[g][gc.c_gem_effectPro4]],i},s.getWingArr=function(e){var r=t.heroCtrl.getHeroEntityCtrl(e);return r.get(gc.dsConsts.HeroEntity.wingArr)},s.getEquipListByType=function(e){var r=[],i=t.userCtrl.getEquipBag();for(var a in i){var s=i[a],n=s[0];this.getEquipType(n)!=e||this.isEquiped(a)||r.push(s)}return r},s.getEquipList=function(e,r){var i,a,s=t.userCtrl.getEquipBag(),n=[],o=mo.getJSONWithFileName(gc.cfg_t_itemEquip);for(var c in s){i=s[c];var g=i[3]>0;if(!g){a=i[0];var l=o[a];null==e&&null==r?n.push(c):null!=e&&null!=r?e==l[gc.t_itemEquip_job]&&r==l[gc.t_itemEquip_type]&&n.push(c):(e==l[gc.t_itemEquip_job]||r==l[gc.t_itemEquip_type])&&n.push(c)}}return n=n.sort(function(t,e){return s[t][2]>s[e][2]?-1:1})},s.getBagSpecialEquipList=function(){var t=this,e=t.getEquipList();return e.filter(function(e){return t.isSpecialEquip(t.getTempIdByEquipId(e))&&!t.isEquiped(e)})},s.getBagAllCanInherEquip=function(){var e=this,r=e.getBagSpecialEquipList();return r.filter(function(e){return t.equipCtrl.getInheritedEquipOpt(e).nextEquipNeedLvlEnough})},s.getEquipType=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return e[gc.t_itemEquip_type]},s.getEquipTypeName=function(t){return gc.c_prop.equipType[this.getEquipType(t)]},s.getEquipJob=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_item,t);if(e[gc.t_item_type]==gc.c_prop.itemTypeKey.equip){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return r[gc.t_itemEquip_job]}if(e[gc.t_item_type]==gc.c_prop.itemTypeKey.gift){var i=mo.getJSONWithFileNameAndID(gc.cfg_t_talisman,t);return i[gc.t_talisman_job]}},s.isSpecialEquip=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return(e[gc.t_itemEquip_isUp]||0)>0},s.isRareEquip=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return(e[gc.t_itemEquip_isRare]||0)>0},s.isSuperEquip=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return 1==(e[gc.t_itemEquip_isSuper]||0)},s.isJingEquip=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,t);return 2==(e[gc.t_itemEquip_isSuper]||0)},s.getEquipWearLvl=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_item,t);return e[gc.t_item_level]},s.getEquipTypeByPart=function(t){return this._partTypeMap[t]},s.isEquiped=function(e){var r=t.userCtrl.getEquipBag(),i=r[e];return i[3]>0},s.queryStrLvlInfo=function(t,e){var r=mo.getJSONWithFileName(gc.cfg_t_itemEquip)[t],i=r[gc.t_itemEquip_slotStrengthProperty],a=r[gc.t_itemEquip_propValue]*e;return[e,i,a]},s.queryRefineLvlInfo=function(t,e){var r=mo.getJSONWithFileName(gc.cfg_t_itemEquip)[t],i=r[gc.t_itemEquip_slotStrengthProperty],a=mo.getJSONWithFileName(gc.cfg_t_strengthRefine),s=a[e][gc.t_strengthRefine_strAddition]/1e4;return[e,i,s]},s.queryStarInfo=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,t);return[t,e[gc.c_lvl_upStarPropAdd]/100]},s.isBreakRing=function(t){var e=parseInt(t);return e>=gc.c_prop.heroEquipIndexKey.paralysisRing&&e<=gc.c_prop.heroEquipIndexKey.harmRing},s.getBreakRingBy=function(e){var r=t.userCtrl.getItemByType(gc.c_prop.itemTypeKey["break"]),i=mo.getJSONWithFileName(gc.cfg_t_itemBreak);for(var a in r){var s=i[a];if(e==s[gc.t_itemBreak_position])return a}return null},s.getInitBreakRing=function(t){var e=parseInt(t),r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.parRingCfg];return i[e-gc.c_prop.heroEquipIndexKey.paralysisRing]},s.inheritedEquip=function(e,r,i){var a=this;if(e.isMaxLvl)return mo.showMsg("满级了,不能再传承");if(!e.nextEquipNeedLvlEnough)return mo.showMsg("角色等级不足");if(!e.isItemEnough)return mo.showMsg("物品不够");var s=e.equipId,n=e.heroJobId,o=gc.iface.a_equip_inheritedEquip_args,c={};c[o.equipId]=s,c[o.tempId]=n,mo.requestWaiting4Server(gc.iface.a_equip_inheritedEquip,c,function(o){var c=o[gc.dsConsts.ExUserData.userData]||{},g=o[gc.dsConsts.ExUserData.heroData]||{},l=o[gc.dsConsts.ExUserData.equipBagItems]||{},_=o[gc.dsConsts.ExUserData.bagItems],u=t.userUtils.getNewEquipBag({},l);c[gc.dsConsts.UserEntity.equipBag]=u;var d=t.userUtils.getNewBag(_,{});if(c[gc.dsConsts.UserEntity.bag]=d,t.userCtrl.updateEntityNotShow(c),n){var p=t.heroCtrl.getHeroByJob(n),m=p.getPartByEquipId(s);t.heroCtrl.getHeroByJob(n).updateEntity(g),p.pushNotify(p.__class.ON_EQUIP_CHANGED,e.inheritedInfo[gc.t_inheritedEquip_nextId],m,s)}t.pointCtrl.cal(gc.c_prop.pointEffectKey.chuanChen),r.call(i,o),a.pushNotify(a.__class.ON_INHERITED)})},s.getInheritedEquipOpt=function(e){var r=this,i={equipId:e,heroJobId:0,inheritedInfo:null,nextEquipNeedLvl:0,nextEquipNeedLvlEnough:!1,isMaxLvl:!1,itemId:null,isItemEnough:!1},a=r.getTempIdByEquipId(e),s=mo.getJSONWithFileName(gc.cfg_t_itemEquip)[a],n=r.isEquiped(e);n&&(i.heroJobId=s[gc.t_itemEquip_job]),i.itemId=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.inheritedEquip)[0],i.inheritedInfo=r.getInheritedInfo(a);var o=i.inheritedInfo[gc.t_inheritedEquip_nextId];return o?(i.nextEquipNeedLvl=mo.getJSONWithFileName(gc.cfg_t_item)[o][gc.t_item_level],i.nextEquipNeedLvlEnough=t.userCtrl.getLvl()>=i.nextEquipNeedLvl,i.isItemEnough=t.userCtrl.getItemNum(i.itemId)>=i.inheritedInfo[gc.t_inheritedEquip_num]):i.isMaxLvl=!0,i},s.getInheritedInfo=function(t){var e=this;return e.isSpecialEquip(t)?mo.getJSONWithFileName(gc.cfg_t_inheritedEquip)[t]:null},s.getSpecialEquipDot=function(){var e=this,r=[],i=gc.c_prop.heroJob;for(var a in i){var s=parseInt(a),n=t.heroCtrl.getHeroByJob(s);n&&(n.getAllCanInherEquip().length>0?r.push(1):r.push(0))}return e.getBagAllCanInherEquip().length>0?r.push(1):r.push(0),r},s.isCustomEquipByTempId=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.customizationCfg),r=parseInt(t),i=e[14].split(",");return r>=parseInt(i[0])&&r<=parseInt(i[1])},s.isCustomEquip=function(e){var r=e;return e instanceof Array||(r=t.userCtrl.getEquipBag()[e]),r&&r[4]&&""!=r[4]?!0:!1},s.getCustomInfo=function(e){var r=this,i=e;if(e instanceof Array||(i=t.userCtrl.getEquipBag()[e]),i&&r.isCustomEquip(e)){var a=[];a.push(i[4],i[5]);var s=a.pop();s.sort();for(var n=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,i[0]),o=n[gc.t_itemEquip_propertys],c=[],g=0,l=s.length;l>g;g++)c.push(o[s[g]]);return a.push(c),a}return null},s.equipTrans=function(e){var r=this,i=e;e instanceof Array||(i=t.userCtrl.getEquipBag()[e]);var a=r.isCustomEquip(i),s=r.getCustomInfo(i),n=i[0],o=i[1];(t.equipCtrl.isSpecialEquip(n)||t.equipCtrl.isRareEquip(n))&&(o=t.equipCtrl.getSpecialEquipExtra(n));var c={isCustomEquip:a,tempId:n,extraPropArr:o,isEquiped:i[3],name:a?s[0]:r.getEquipName(i[0]),basePropArr:a?s[1]:r.getBasePropArr(i[0]),score:a?t.userUtils.getEquipGrade(n,o,i[5]):t.userUtils.getEquipGrade(n,o)};return c},s.updateEquipItemLockStatus=function(e,r,i,a){var s=gc.iface.a_equip_updateEquipItemLockStatus_args,n={};n[s.equipId]=e,n[s.isLocked]=r,mo.requestWaiting4Server(gc.iface.a_equip_updateEquipItemLockStatus,n,function(e){var r=e[gc.dsConsts.ExUserData.userData]||{},s=e[gc.dsConsts.ExUserData.equipBagItems]||{},n=t.userUtils.getNewEquipBag({},s);r[gc.dsConsts.UserEntity.equipBag]=n,t.userCtrl.updateEntity(r),i&&i.call(a,e)})},s.sellEquipItem=function(e,r,i){var a=this,s=gc.iface.a_equip_sellEquipItems_args,n={};n[s.equipIdArr]=e,mo.requestWaiting4Server(gc.iface.a_equip_sellEquipItems,n,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.bagItems]||{},o=t.userUtils.getNewBag({},n);s[gc.dsConsts.UserEntity.bag]=o;var c=e[gc.dsConsts.ExUserData.delEquipBagArr]||[],g=t.userUtils.getNewEquipBag(c,{});s[gc.dsConsts.UserEntity.equipBag]=g,t.userCtrl.updateEntity(s),a.pushNotify(a.__class.ON_SMELT),r&&r.call(i,e)})},i.ON_WEAR_PAR_RING="ON_WEAR_PAR_RING",i.ON_BREAK_PAR_RING="ON_BREAK_PAR_RING",i.ON_BREAK_MERGED="ON_BREAK_MERGED",i.ON_SMELT="ON_SMELT",i.ON_BATCH_SMELT="ON_BATCH_SMELT",i.ON_INHERITED="ON_INHERITED",i}(mo.DataController);t.EquipCtrl=r,egret.registerClass(r,"gd.EquipCtrl"),t.sortEquipList=e}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this._shopMap={}},a.getList=function(e,r,i){var a=this,s=mo.getJSONWithFileName(gc.cfg_c_shop);a._getShopData(e,function(n){for(var o=[],c=n[gc.dsConsts.ShopEntity.items],g=0;g<c.length;g++){var l=c[g],_=l[0],u=l[1],d=s[_],p=d[gc.c_shop_discount],m=[];m[0]=d[gc.c_shop_itemId],m[1]=0,m[2]=d[gc.c_shop_currencyType],m[3]=d[gc.c_shop_price],m[4]=u,m[5]=m[3],m[6]=e,m[7]=d[gc.c_shop_discount],e==gc.c_prop.shopTypeKey.equip&&(m[8]=l[2],m[9]=l[3],utils.getCurrencyTypeItemId(m[2])==gc.c_prop.spItemIdKey.gold&&a._recoderMinGoldCostItem(m[3],g)),p&&(m[5]=Math.floor(10*m[5]/p)),o.push(m)}t.pointCtrl.cal(gc.c_prop.pointRedKey.shopMain),r.call(i,o)},a)},a._recoderMinGoldCostItem=function(t,e){var r=this;r.canGoldBuyEquipGold=null==r.canGoldBuyEquipGold?t:r.canGoldBuyEquipGold,r.canGoldBuyEquipIdx=null==r.canGoldBuyEquipIdx?e:r.canGoldBuyEquipIdx,t<=r.canGoldBuyEquipGold&&(r.canGoldBuyEquipGold=t,r.canGoldBuyEquipIdx=e)},a.buy=function(e,r,i,a,s){var n={},o=this,c=gc.iface.a_shop_buy_args;n[c.index]=r,n[c.type]=e,n[c.num]=i;var g=mo.getJSONWithFileName(gc.cfg_c_shop),l=(mo.getJSONWithFileName(gc.cfg_t_item),o._shopMap[e]),_=l[gc.dsConsts.ShopEntity.items],u=parseInt(g[_[r][0]][gc.c_shop_price])*parseInt(i),d=g[_[r][0]][gc.c_shop_currencyType];return d==gc.c_prop.currencyTypeKey.diamond&&t.userCtrl.getDiamond()<u?mo.showMsg(gc.id_c_msgCode.noDiamond):d==gc.c_prop.currencyTypeKey.gold&&t.userCtrl.getGold()<u?void t.userCtrl.noGolds(function(){o.buy(e,r,i,a,s)},o):void mo.requestWaiting4Server(gc.iface.a_shop_buy,n,function(r){var i=r[gc.dsConsts.ExUserData.isMail];i&&mo.showMsg(gc.id_c_msgCode.bagMaxMail);var n=r[gc.dsConsts.ExUserData.userData]||{},c=r[gc.dsConsts.ExUserData.bagItems],g=r[gc.dsConsts.ExUserData.equipBagItems],_=t.userUtils.getNewBag({},c);n[gc.dsConsts.UserEntity.bag]=_;var u=t.userUtils.getNewEquipBag({},g);n[gc.dsConsts.UserEntity.equipBag]=u,t.userCtrl.updateEntity(n);var d=r[gc.dsConsts.ExUserData.shopData];l[gc.dsConsts.ShopEntity.items]=d[gc.dsConsts.ShopEntity.items],o.pushNotify(o.__class.ON_BUY_SUCC,e),a&&a.call(s,r),e==gc.c_prop.shopTypeKey.equip&&g_cache.recordGuideDone(g_consts.GUIDE_LCK.buyEquip),t.pointCtrl.cal(gc.c_prop.pointRedKey.shopMain)})},a.buyAll=function(e,r,i){var a=this;mo.showMsg(gc.id_c_msgCode.ifBuyAll,function(){var s={},n=gc.iface.a_shop_buyAll_args;s[n.type]=e,mo.requestWaiting4Server(gc.iface.a_shop_buyAll,s,function(s){var n=s[gc.dsConsts.ExUserData.isMail];n&&mo.showMsg(gc.id_c_msgCode.bagMaxMail);var o=s[gc.dsConsts.ExUserData.showMsgArr];o[1]&&o[0]?mo.showMsg(gc.id_c_msgCode.noDiamond):o[1]?mo.showMsg(gc.id_c_msgCode.noDiamond):o[0]&&t.userCtrl.noGolds(function(){},a);var c=mo.getJSONWithFileName(gc.cfg_c_shop),g=(mo.getJSONWithFileName(gc.cfg_t_item),s[gc.dsConsts.ExUserData.shopIdObj]);for(var l in g)var _=parseInt(c[l][gc.c_shop_price])*parseInt(g[l]);var u=s[gc.dsConsts.ExUserData.userData]||{},d=s[gc.dsConsts.ExUserData.bagItems],p=s[gc.dsConsts.ExUserData.equipBagItems],m=t.userUtils.getNewBag({},d);u[gc.dsConsts.UserEntity.bag]=m;var f=t.userUtils.getNewEquipBag({},p);u[gc.dsConsts.UserEntity.equipBag]=f,t.userCtrl.updateEntity(u);var h=s[gc.dsConsts.ExUserData.shopData],y=a._shopMap[e];y[gc.dsConsts.ShopEntity.items]=h[gc.dsConsts.ShopEntity.items],t.pointCtrl.cal(gc.c_prop.pointRedKey.shopMain),r&&r.call(i,s)})})},a.getNextRefreshHour=function(t){var e=0;switch(t){case gc.c_prop.shopTypeKey.normal:var r=mo.getJSONWithFileName(gc.cfg_c_game);e=r[gc.id_c_game.refreshTime][0];break;case gc.c_prop.shopTypeKey.arena:var i=Date.newDate().getHours(),a="";a=a.split(",");for(var s=0;s<a.length;s++){var n=a[s];if(n=parseInt(n),n>i){e=n;break}}0==e&&(e=a[0]);break;case gc.c_prop.shopTypeKey.equip:var r=mo.getJSONWithFileName(gc.cfg_c_game);e=r[gc.id_c_game.refreshTime][0];break;case gc.c_prop.shopTypeKey.gem:var r=mo.getJSONWithFileName(gc.cfg_c_game);e=r[gc.id_c_game.refreshTime][0]}return e},a.refresh=function(e,r,i,a){if(e==gc.c_prop.shopTypeKey.equip){var s=this,n={},o=gc.iface.a_shop_refreshExShop_args;n[o.type]=e,n[o.lvlRefresh]=r;var c=gc.callRefreshShop(s.getRefreshCount(e));return r&&(c=0),c>t.userCtrl.getGold()?void t.userCtrl.noGolds(function(){s.refresh(e,r,i,a)},s):void s._getShopData(e,function(){mo.requestWaiting4Server(gc.iface.a_shop_refreshExShop,n,function(r){var n=s._shopMap[e],o=r[gc.dsConsts.ExUserData.userData]||{};t.userCtrl.updateEntity(o);var c=r[gc.dsConsts.ExUserData.shopData];n[gc.dsConsts.ShopEntity.items]=c[gc.dsConsts.ShopEntity.items],n[gc.dsConsts.ShopEntity.refreshCount]=c[gc.dsConsts.ShopEntity.refreshCount],n[gc.dsConsts.ShopEntity.refreshCountResetTime]=c[gc.dsConsts.ShopEntity.refreshCountResetTime],t.pointCtrl.cal(gc.c_prop.pointRedKey.shopMain),i&&i.call(a,r)})},s)}},a.getRefreshCount=function(t){var e=this,r=e._shopMap[t];if(!r)return 0;var i=0,a=Date.newDate(r[gc.dsConsts.ShopEntity.refreshCountResetTime]);a&&a.equalsDay(Date.newDate())&&(i=r[gc.dsConsts.ShopEntity.refreshCount]||0);var s=gc.callRefreshShop(i);return s},a.getReRefreshSeconds=function(e){var r=this,i=1e5,a=r._shopMap[e];switch(e){case gc.c_prop.shopTypeKey.normal:break;case gc.c_prop.shopTypeKey.arena:var s=a[gc.dsConsts.ShopEntity.refreshCountResetTime];s=new Date(s),i=Date.newDate().getSecondsBetween(s.clone());break;case gc.c_prop.shopTypeKey.equip:var n=a[gc.dsConsts.ShopEntity.lastTime];n=new Date(n);var o=t.commonUtils.getCurLastRefreshTime();i=o.equals(n)?Date.newDate().getSecondsBetween(o.addDays(1)):0;break;case gc.c_prop.shopTypeKey.gem:}return i},a.isShopEquipReddot=function(){var e=this,r=[],i=[],a=[],s=mo.getJSONWithFileName(gc.cfg_c_shop),n=mo.getJSONWithFileName(gc.cfg_t_item),o=mo.getJSONWithFileName(gc.cfg_t_itemEquip),c=t.userCtrl.getLvl(),g=t.heroCtrl.getHeroMap(),l=t.userCtrl.getEquipBag()||{};for(var _ in g)i.push(g[_].get(gc.dsConsts.HeroEntity.tempId)),a[g[_].get(gc.dsConsts.HeroEntity.tempId)]=g[_].get(gc.dsConsts.HeroEntity.equipData);var u=e._shopMap[gc.c_prop.shopTypeKey.equip];if(!u)return r;for(var d=u[gc.dsConsts.ShopEntity.items],p=0;p<d.length;p++){var m=d[p][3],f=s[d[p][0]][gc.c_shop_itemId],h=o[f][gc.t_itemEquip_job];if(!(i.indexOf(h)<0)){var y=n[f][gc.t_item_level];if(!(y>c)){var C=o[f][gc.t_itemEquip_type],v=[];switch(C){case gc.c_prop.equipTypeKey.weapon:v=[gc.c_prop.heroEquipIndexKey.weapon];break;case gc.c_prop.equipTypeKey.clothes:v=[gc.c_prop.heroEquipIndexKey.clothes];break;case gc.c_prop.equipTypeKey.helmet:v=[gc.c_prop.heroEquipIndexKey.helmet];break;case gc.c_prop.equipTypeKey.necklace:v=[gc.c_prop.heroEquipIndexKey.necklace];break;case gc.c_prop.equipTypeKey.ring:v=[gc.c_prop.heroEquipIndexKey.ring1,gc.c_prop.heroEquipIndexKey.ring2];break;case gc.c_prop.equipTypeKey.bracelet:v=[gc.c_prop.heroEquipIndexKey.bracelet1,gc.c_prop.heroEquipIndexKey.bracelet2]}for(var I=a[h],E=0;E<v.length;E++){var D=0;I[v[E]]&&(D=l[I[v[E]]][2]),m>D&&-1==r.indexOf(p)&&r.push(p)}}}}return r},a._getShopData=function(t,e,r){var i=this,a=this._shopMap[t];if(a){var s=i.getReRefreshSeconds(t);if(s>0)return e.call(r,a)}var n={},i=this,o=gc.iface.a_shop_getInfo_args;n[o.type]=t,mo.requestWaiting4Server(gc.iface.a_shop_getInfo,n,function(a){i._shopMap[t]=a,e&&e.call(r,a)})},a.requestShopData=function(e,r,i){var a={},s=this,n=gc.iface.a_shop_getInfo_args;a[n.type]=e,mo.request4Server(gc.iface.a_shop_getInfo,a,function(a){s._shopMap[e]=a,t.pointCtrl.cal(gc.c_prop.pointRedKey.shopMain),r&&r.call(i,a)})},r.ON_BUY_SUCC="on_buy_succ",r}(mo.DataController);t.ShopCtrl=e,egret.registerClass(e,"gd.ShopCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._signItems={};var r=mo.getJSONWithFileName(gc.cfg_c_game);t._refreshTime=r[gc.id_c_game.refreshTime][1]},a.initData=function(t){},a.sign=function(e,r){var i=this;if(i.isTodaySigned())return mo.showMsg("今日已经签到");var a=t.activityCtrl.getSignActivity(),s=t.activityCtrl.getActivityValue(a,gc.dsConsts.ActivityEntity.id);t.activityCtrl.receive(s,0,function(i){t.pointCtrl.cal(gc.c_prop.pointEffectKey.sign),e&&e.call(r,i)})},a.patchSign=function(e,r){var i=this;if(!i.isTodaySigned())return mo.showMsg("今日还未签到,不能进行补签");var a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.patchSignCon][0],n=t.userCtrl.get(gc.dsConsts.UserEntity.diamond);return s>n?mo.showMsg(gc.id_c_msgCode.noDiamond):void mo.showMsg(gc.id_c_msgCode.ifPatch,s,function(){var i=t.activityCtrl.getSignActivity(),a=t.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),s={},n=gc.iface.a_activity_receive_args;s[n.activityId]=a,mo.requestWaiting4Server(gc.iface.a_activity_patchSign,s,function(i){var a=i[gc.dsConsts.ExUserData.userData]||{},s=i[gc.dsConsts.ExUserData.bagItems],n=i[gc.dsConsts.ExUserData.equipBagItems],o=t.userUtils.getNewBag({},s);a[gc.dsConsts.UserEntity.bag]=o;var c=t.userUtils.getNewEquipBag({},n);a[gc.dsConsts.UserEntity.equipBag]=c,t.userCtrl.updateEntity(a),t.pointCtrl.cal(gc.c_prop.pointEffectKey.sign),e&&e.call(r,i)})})},a.isTodayPatchSign=function(){var e=this,r=Date.newDate(),i=t.userCtrl.get(gc.dsConsts.UserEntity.sign),a=r.getDate();return i[0]+1>a||!e.isTodaySigned()?!1:!0},a.getSignItems=function(){for(var e=Date.newDate(),r=e.getMonth()+1,i=[],a=t.activityCtrl.getSignItems(),s=100*r+1,n=s;s+32>n;n++){var o=a[n];o&&i.push([n,o])}return this._signItems[r]=i,i},a.getState=function(t){var e=this,r=Date.newDate(),i=100*r.getMonth()+100,a=t-i,s=Date.newDate().getDate(),n=e.getSignNum(),o=0;return n>=a?o=1:s>=a?e.isTodaySigned()||a-1!=n?(o=3,a-1!=n&&(o=0)):o=2:o=0,o},a.getSignNum=function(){var e=this._getSignData(),r=e[0],i=e[1];if(i){var a=Date.newDate();a.getMonth()!=i.getMonth()&&(r=0,i=null)}else r=0;return e[0]=r,e[1]=i,t.userCtrl.set(gc.dsConsts.UserEntity.sign,e),r},a.isTodaySigned=function(){var t=this._getSignData(),e=t[1];if(!e)return!1;var r=Date.newDate();return!this._checkCanSign(r,e)},a._checkCanSign=function(t,e){var r=t.clone();return r=e.getHours()<this._refreshTime?e.clone().clearTime().addHours(this._refreshTime):e.clone().clearTime().addHours(this._refreshTime).addDays(1),t>=r?!0:!1},a._getSignData=function(){var e=t.userCtrl.get(gc.dsConsts.UserEntity.sign)||[0,null],r=e[1];return r&&"string"==typeof r&&(e[1]=Date.newDate(r)),e},r.ON_TODAY_SIGNED="on_today_signed",r}(mo.DataController);t.SignCtrl=e,egret.registerClass(e,"gd.SignCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.LotteryEntity},a.initData=function(t){if(t){var e=this;e.init(t)}},a.getTreasureValue=function(){return this.get(gc.dsConsts.LotteryEntity.treasureValue)},a.getTreasureChestCount=function(){return this.get(gc.dsConsts.LotteryEntity.treasureChestCount)
},a.getInfo=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_lottery_getInfo,{},function(i){r.init(i),t.call(e,i)})},a.lottery=function(e,r,i,a){for(var s=this,n=mo.getJSONWithFileName(gc.cfg_c_game),o=t.userCtrl.get(gc.dsConsts.UserEntity.bag),c=t.userCtrl.get(gc.dsConsts.UserEntity.diamond),g=0,l=0,_=0;r>_;_++)switch(e){case gc.c_prop.lotteryTypeKey.common:var u=o[gc.c_prop.spItemIdKey.goldenKey]||0;l>=u?g+=n[gc.id_c_game.lotteryCostCfg][0]:l+=1;break;case gc.c_prop.lotteryTypeKey.advanced:g+=n[gc.id_c_game.lotteryCostCfg][1];break;case gc.c_prop.lotteryTypeKey.supremacy:g+=n[gc.id_c_game.lotteryCostCfg][2]}if(g>c)return mo.showMsg(gc.id_c_msgCode.noDiamond);var d=gc.iface.a_lottery_lottery_args,p={};p[d.type]=e,p[d.count]=r,mo.requestWaiting4Server(gc.iface.a_lottery_lottery,p,function(e){var r=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.lotteryData]||{},o=e[gc.dsConsts.ExUserData.items]||{},c=e[gc.dsConsts.ExUserData.treasureValue]||0,g=e[gc.dsConsts.ExUserData.bagItems]||{},l=e[gc.dsConsts.ExUserData.delBagItems]||{},_=e[gc.dsConsts.ExUserData.equipBagItems]||{},u=t.userUtils.getNewBag(l,g);r[gc.dsConsts.UserEntity.bag]=u;var d=t.userUtils.getNewEquipBag({},_);r[gc.dsConsts.UserEntity.equipBag]=d,s.updateEntity(n),t.userCtrl.updateEntity(r),i.call(a,[o,c])})},a.getTreasureChest=function(e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_c_game),s=i.get(gc.dsConsts.LotteryEntity.treasureValue),n=a[gc.id_c_game.lotteryCostCfg][6];return n>s?mo.showMsg("探宝值不足"):void mo.requestWaiting4Server(gc.iface.a_lottery_getTreasureChest,{},function(a){var s=a[gc.dsConsts.ExUserData.userData]||{},n=a[gc.dsConsts.ExUserData.lotteryData]||{},o=a[gc.dsConsts.ExUserData.items]||{},c=a[gc.dsConsts.ExUserData.cosTreValue]||0,g=a[gc.dsConsts.ExUserData.bagItems]||{},l=a[gc.dsConsts.ExUserData.equipBagItems]||{},_=t.userUtils.getNewBag({},g);s[gc.dsConsts.UserEntity.bag]=_;var u=t.userUtils.getNewEquipBag({},l);s[gc.dsConsts.UserEntity.equipBag]=u,i.updateEntity(n),t.userCtrl.updateEntity(s),e.call(r,[o,c])})},r}(mo.DataController);t.LotteryCtrl=e,egret.registerClass(e,"gd.LotteryCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._cacheMinute=5}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._rankDataDic={},t._myRankDataDic={},t._allRankDataDic={}},a.getGuildRank=function(t,e,r){var i=this,a=i._allRankDataDic[t];if(a){var s=a[0],n=a[1];if(s.clone().addMinutes(i._cacheMinute).isAfter(Date.newDate()))return e.call(r,n)}var o=gc.iface.a_rank_getGuildRank_args,c={};c[o.rankType]=t,mo.requestWaiting4Server(gc.iface.a_rank_getGuildRank,c,function(a){var s=[];if(s[0]=a[gc.dsConsts.ExUserRankData.userRankList],s[1]=a[gc.dsConsts.ExUserRankData.guildName],!a[gc.dsConsts.ExUserRankData.userRankList][0])return mo.showMsg("该排行榜暂时没有数据");var n=Date.newDate();i._allRankDataDic[t]=[n,s],e&&e.call(r,s)})},a.getAllRankArr=function(e,r,i){var a=this,s=a._allRankDataDic[e];if(s){var n=s[0],o=s[1];if(n.clone().addMinutes(a._cacheMinute).isAfter(Date.newDate()))return r.call(i,o)}var c=gc.iface.a_rank_allRankArr_args,g={};g[c.rankType]=e,mo.requestWaiting4Server(gc.iface.a_rank_allRankArr,g,function(s){var n=[];if(n[0]=s[gc.dsConsts.ExUserRankData.userRank],n[1]=s[gc.dsConsts.ExUserRankData.userRankData],n[2]=s[gc.dsConsts.ExUserRankData.userRankList],n[3]=[],n[4]=s[gc.dsConsts.ExUserRankData.guildName],!s[gc.dsConsts.ExUserRankData.userRankList][0])return mo.showMsg("该排行榜暂时没有数据"),r.call(i);if(e==gc.c_prop.rankTypeKey.guildRank||e==gc.c_prop.rankTypeKey.guildCombatRank||e==gc.c_prop.rankTypeKey.chairmanCombatRank)return r.call(i,n);var o=s[gc.dsConsts.ExUserRankData.userRankList][0][gc.dsConsts.UserRankEntity.userId],c=0;e==gc.c_prop.rankTypeKey.zsRank?c=1:e==gc.c_prop.rankTypeKey.fsRank?c=2:e==gc.c_prop.rankTypeKey.dsRank&&(c=3),t.heroCtrl.getHeroDisplayByTempId(o,c,function(t){n[3]=t;var s=Date.newDate();a._allRankDataDic[e]=[s,n],r&&r.call(i,n)},a)})},a.getRankList=function(t,e,r){var i=this,a=i._rankDataDic[t];if(a){var s=a[0],n=a[1];if(s.clone().addMinutes(i._cacheMinute).isAfter(Date.newDate()))return e.call(r,n)}var o=gc.iface.a_rank_getRankList_args,c={};c[o.rankType]=t,mo.requestWaiting4Server(gc.iface.a_rank_getRankList,c,function(a){var s=Date.newDate(),n=a;i._rankDataDic[t]=[s,n],e&&e.call(r,a)})},a.getUserRank=function(t,e,r){var i=this,a=i._myRankDataDic[t];if(a){var s=a[0],n=a[1];if(s.clone().addMinutes(i._cacheMinute).isAfter(Date.newDate()))return e.call(r,n)}var o=gc.iface.a_rank_getUserRank_args,c={};c[o.rankType]=t,mo.requestWaiting4Server(gc.iface.a_rank_getUserRank,c,function(a){var s=[];s[0]=a[gc.dsConsts.ExUserRankData.userRank],s[1]=a[gc.dsConsts.ExUserRankData.userRankData];var n=Date.newDate();i._myRankDataDic[t]=[n,a],e&&e.call(r,s)})},r}(mo.DataController);t.RankCtrl=e,egret.registerClass(e,"gd.RankCtrl")}(gd||(gd={}));var gd;!function(t){function e(t){var e=[1,0],r=[-1,1];return t.sort(function(t,i){for(var a=0;2>a;a++){var s=r[a];if(t[e[a]]>i[e[a]])return 0>=s?-1:1;if(t[e[a]]<i[e[a]])return 0>=s?1:-1}return 0}),t}var r=function(r){function i(){r.apply(this,arguments),this._taskUpdateId=0}__extends(i,r);var a=(__define,i),s=a.prototype;return s._initProp=function(){r.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.TaskEntity},s.initData=function(t){if(t){var e=this;e.init(t)}},s.updateEntity=function(e){r.prototype.updateEntity.call(this,e),t.pointCtrl.cal(gc.c_prop.pointEffectKey.task)},s.getUpdateId=function(){return this._taskUpdateId},s.syncData=function(){var e=this,r={};mo.request4Server(gc.iface.a_task_getInfo,r,function(r){e.init(r[gc.dsConsts.ExTask.taskData]),e._taskUpdateId=r[gc.dsConsts.ExTask.updateId],t.pointCtrl.cal(gc.c_prop.pointEffectKey.task)})},s.getInfo=function(e,r){var i=this,a={};mo.requestWaiting4Server(gc.iface.a_task_getInfo,a,function(a){i.init(a[gc.dsConsts.ExTask.taskData]),i._taskUpdateId=a[gc.dsConsts.ExTask.updateId],t.pointCtrl.cal(gc.c_prop.pointEffectKey.task),e.call(r,a)})},s.getVitality=function(){var t=this,e=0,r=[0,0,0],i=t.get(gc.dsConsts.TaskEntity.refreshTime);return i&&Date.newDate(i).equalsDay(Date.newDate())&&(e=t.get(gc.dsConsts.TaskEntity.vitality),r=t.get(gc.dsConsts.TaskEntity.vitalityChests)),[e,r]},s.getVitalityBoxState=function(t){var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.vitalityCfg),i=[!1,!0],a=e.getVitality(),s=a[0],n=a[1],o=r[t];return s>=o&&(i[0]=!0),0==n[t]&&(i[1]=!1),i},s.getVitalityProgress=function(){var t=this,e={cur:0,max:0,per:0},r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.vitalityCfg),i=t.getVitality();return e.cur=parseInt(i[0].toString()),e.max=r[2],e.per=e.cur/e.max*100,e},s.getDailyTaskList=function(){var t=this,r=mo.getJSONWithFileName(gc.cfg_c_task);if(!t._dailyTaskList){for(var i=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.dailyTasksCfg),a=i[0],s=i[1],n=[],o=a;s>=o;o++)2100012!=o&&n.push(r[o]);t._dailyTaskList=n}for(var c=[],g=0;g<t._dailyTaskList.length;g++){var o=t._dailyTaskList[g][gc.c_task_id];c.push([o,t.getTaskOpt(o).isComplete?t.getTaskOpt(o).isReceive?1:3:2])}var l=[];c=e(c);for(var g=0;g<c.length;g++)l.push(r[c[g][0]]);return l},s.getTasksList=function(){for(var t=this,r=[],i=mo.getJSONWithFileName(gc.cfg_c_task),a=t.get(gc.dsConsts.TaskEntity.tasks),s=[],n=0;13>=n;n++){var o=a[n];s.push([o,t.getTaskOpt(o).isComplete?t.getTaskOpt(o).isReceive?1:3:2])}s=e(s);for(var n=0;n<s.length;n++)r.push(i[s[n][0]]);return r},s.getTaskReward=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_task,t),r=mo.getJSONWithFileNameAndID(gc.cfg_c_reward,e[gc.c_task_rewardId]),i={};r[gc.c_reward_gold]&&(i[gc.c_prop.spItemIdKey.gold]=r[gc.c_reward_gold]),r[gc.c_reward_diamond]&&(i[gc.c_prop.spItemIdKey.diamond]=r[gc.c_reward_diamond]),r[gc.c_reward_activity]&&(i[gc.c_prop.spItemIdKey.vitality]=r[gc.c_reward_activity]);var a=r[gc.c_reward_rewardItems];for(var s in a)i[s]=a[s];return i},s.getEquipSmelt=function(){var t=this,e=t.get(gc.dsConsts.TaskEntity.tasksValue);return e[gc.c_prop.cTaskTypeKey.equipSmelt]},s.getEncounter=function(){var t=this,e=t.get(gc.dsConsts.TaskEntity.tasksValue);return e[gc.c_prop.cTaskTypeKey.encounter]},s.getDailyTasks=function(){var t=this,e={},r=mo.getJSONWithFileName(gc.cfg_c_game),i=t.get(gc.dsConsts.TaskEntity.refreshTime);if(i&&Date.newDate(i).equalsDay(Date.newDate()))e=t.get(gc.dsConsts.TaskEntity.dailyTasks);else for(var a=r[gc.id_c_game.dailyTasksCfg][0],s=r[gc.id_c_game.dailyTasksCfg][1],n=a;s>=n;n++)e[n]=[0,0];return e},s.getTaskOpt=function(t){var e=this,r={taskId:t,value:0,targetValue:1,isComplete:!0,isReceive:!0,type:0,subType:0},i=mo.getJSONWithFileName(gc.cfg_c_task),a=mo.getJSONWithFileName(gc.cfg_c_game),s=i[t],n=a[gc.id_c_game.dailyTasksCfg][0],o=a[gc.id_c_game.dailyTasksCfg][1],c=e.getDailyTasks(),g=s[gc.c_task_targetValue],l=e.get(gc.dsConsts.TaskEntity.doneTasks)||[],_=e.get(gc.dsConsts.TaskEntity.tasksValue),u=s[gc.c_task_cTaskType];if(r.type=s[gc.c_task_taskType],r.subType=s[gc.c_task_cTaskType],t>=n&&o>=t)c[t]||(c[t]=[0,0]),c[t][0]<g&&(r.isComplete=!1),0==c[t][1]&&(r.isReceive=!1),r.value=c[t][0];else{_[u]<g&&(r.isComplete=!1),-1==l.indexOf(t)&&(r.isReceive=!1);var _=e.get(gc.dsConsts.TaskEntity.tasksValue);r.value=_[u]}var d=s[gc.c_task_targetValue];return r.targetValue=d,r},s.taskAward=function(e,r,i){var a=this,s=e.taskId;if(!e.isComplete)return mo.showMsg("未达成完成条件");if(e.isReceive)return mo.showMsg("已领取");var n=gc.iface.a_task_taskAward_args,o={};o[n.taskId]=s,mo.requestWaiting4Server(gc.iface.a_task_taskAward,o,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.bagItems]||{},o=e[gc.dsConsts.ExUserData.equipBagItems]||{},c=t.userUtils.getNewBag({},n);s[gc.dsConsts.UserEntity.bag]=c;var g=t.userUtils.getNewEquipBag({},o);s[gc.dsConsts.UserEntity.equipBag]=g;var l=e[gc.dsConsts.ExUserData.taskData]||{},_=e[gc.dsConsts.ExUserData.items]||{},u=e[gc.dsConsts.ExUserData.vitality]||0;a.updateEntity(l),t.userCtrl.updateEntity(s),r.call(i,[_,u])})},s.getVitalityChest=function(e,r,i){var a=this,s=mo.getJSONWithFileName(gc.cfg_c_game),n=a.get(gc.dsConsts.TaskEntity.refreshTime),o=a.get(gc.dsConsts.TaskEntity.vitality),c=s[gc.id_c_game.vitalityCfg]||[],g=a.get(gc.dsConsts.TaskEntity.vitalityChests)||[0,0,0];if(!n)return mo.showMsg("探宝值不足");if(!Date.newDate(n).equalsDay(Date.newDate()))return mo.showMsg("探宝值不足");if(o<c[e])return mo.showMsg("探宝值不足");if(1==g[e])return mo.showMsg("已领取");var l=gc.iface.a_task_getVitalityChest_args,_={};_[l.index]=e,mo.requestWaiting4Server(gc.iface.a_task_getVitalityChest,_,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.bagItems]||{},o=e[gc.dsConsts.ExUserData.equipBagItems]||{},c=t.userUtils.getNewBag({},n);s[gc.dsConsts.UserEntity.bag]=c;var g=t.userUtils.getNewEquipBag({},o);s[gc.dsConsts.UserEntity.equipBag]=g;var l=e[gc.dsConsts.ExUserData.taskData]||{},_=e[gc.dsConsts.ExUserData.items]||{};a.updateEntity(l),t.userCtrl.updateEntity(s),r.call(i,_),a.pushNotify(a.__class.ON_RECIVED_BOX)})},s._isResId=function(t){return t==gc.c_prop.spItemIdKey.gold||t==gc.c_prop.spItemIdKey.diamond},s.queryVitalityBoxReward=function(t){for(var e=this,r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.vitalityCfg]||[],a=i[t+3],s=mo.getJSONWithFileNameAndID(gc.cfg_t_itemLogic,a),n=s[gc.t_itemLogic_create],o={},c={},g=0,l=n.length;l>g;g++){var _=n[g],u=_[0],d=_[1];e._isResId(u)?o[u]=d:c[u]=d}return[o,c]},s.isTaskReddot=function(){var t=this,e=[!1,!1];!t._data;for(var r=t.getDailyTasks(),i=mo.getJSONWithFileName(gc.cfg_c_task),a=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.dailyTasksCfg),s=a[0],n=a[1],o=s;n>=o;o++){var c=i[o],g=c[gc.c_task_targetValue];if(r[o]||(r[o]=[0,0]),!(r[o][0]<g)&&0==r[o][1]){e[0]=!0;break}}var l=t.get(gc.dsConsts.TaskEntity.tasks),_=t.get(gc.dsConsts.TaskEntity.tasksValue),u=t.get(gc.dsConsts.TaskEntity.doneTasks)||[];for(var d in l){var g=i[l[d]][gc.c_task_targetValue];if(!(_[d]<g)&&-1==u.indexOf(l[d])){e[1]=!0;break}}return e},i.ON_RECIVED_BOX="on_recevied_box",i}(mo.DataController);t.TaskCtrl=r,egret.registerClass(r,"gd.TaskCtrl"),t.sortList=e}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._addTime=0,this._timeErrorNum=0,this._addTime2=0}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.initData=function(t){var e=this;e._lastTime=new Date,e._clearUpdateIntervalId(),e._syncIntervalId1=mo.setInterval(e._update1,e,12e4),e._syncIntervalId2=mo.setInterval(e._update2,e,5e3),e._syncIntervalId3=mo.setInterval(e._update3,e,3e3),mo.tick(e._tick,e)},a.clearAll=function(){var t=this;t._clearUpdateIntervalId()},a._tick=function(t){this._addTime+=t,this._addTime2+=t},a._update1=function(){var e=this;t.userCtrl.syncData2(function(t){},e)},a._update2=function(){var e=this,r=[];r[0]=t.chatCtrl.getLastId(),r[1]=t.taskCtrl.getUpdateId(),r[2]=t.hoodinnCtlr.getLastBugChatId(),r[3]=t.hoodinnCtlr.getLastSysMsgId(),r[4]=t.bossFightCtrl.getEntity(1).getInspireNum(),r[5]=t.redEnvelopeCtrl.getLastId(),r[6]=t.chatCtrl.getGuildLastId(),r[7]=t.guildPersonalCtrl.getData()?t.guildPersonalCtrl.getGuildId():0,t.userCtrl.syncData(r,function(e){var r=e[gc.dsConsts.AsyncData.chat],i=e[gc.dsConsts.AsyncData.guildChat];(r||i)&&t.chatCtrl.syncData();var a=e[gc.dsConsts.AsyncData.redEnvelope],s=t.redEnvelopeCtrl._allList||[];(a||s.length>0)&&t.redEnvelopeCtrl.syncData();var n=e[gc.dsConsts.AsyncData.task];n&&t.taskCtrl.syncData();var o=e[gc.dsConsts.AsyncData.pkDeal];o&&t.pkOutCtrl.dealRecord();var c=e[gc.dsConsts.AsyncData.bePkKill];c&&t.pkOutCtrl.setBePkKill(c);var g=e[gc.dsConsts.AsyncData.kefu];g&&t.hoodinnCtlr.syncBugChatData();var l=e[gc.dsConsts.AsyncData.sysMsg];l&&t.hoodinnCtlr.syncSysMsgData();var _=e[gc.dsConsts.AsyncData.rankPkDeal];_&&t.pkOutCtrl.dealRankPkRecord();var u=(e[gc.dsConsts.AsyncData.inspire],e[gc.dsConsts.AsyncData.isBossOpen]);t.bossFightCtrl.setOpenIds(u);var d=e[gc.dsConsts.AsyncData.buffArr];t.fightCtrl.setBuffArr(d);var p=e[gc.dsConsts.AsyncData.isGuildChange];p&&t.guildCtrl.getInfo(function(){},this);var m=e[gc.dsConsts.AsyncData.guildWarIsOpen];t.guildWarCtrl.setIsOpen(m)},e),t.pkOutCtrl.calPkValue()},a._update3=function(){t.guildWarCtrl.syncData()},a._clearUpdateIntervalId=function(){var t=this;t._syncIntervalId1&&(mo.clearInterval(t._syncIntervalId1),t._syncIntervalId1=null),t._syncIntervalId2&&(mo.clearInterval(t._syncIntervalId2),t._syncIntervalId2=null),t._syncIntervalId3&&(mo.clearInterval(t._syncIntervalId3),t._syncIntervalId3=null)},r}(mo.DataController);t.TimeCtrl=e,egret.registerClass(e,"gd.TimeCtrl"),t.timeCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this._equipBk={},this.DATA_KEY=gc.dsConsts.UserEntity},a.initData=function(e){var r=this;t.signCtrl=t.SignCtrl.getInstance(),t.heroCtrl=t.HeroCtrl.getInstance(),t.heroCtrl.initData(e[gc.dsConsts.LoginData.heroList]),t.arenaCtrl.initData(e[gc.dsConsts.LoginData.arenaData]),t.copyCtrl=t.CopyCtrl.getInstance(),t.copyCtrl.initData(e[gc.dsConsts.LoginData.copyProgressList]),t.pkOutCtrl=t.PkOutCtrl.getInstance(),t.pkOutCtrl.initData(e[gc.dsConsts.LoginData.pkOut]),t.lotteryCtrl=t.LotteryCtrl.getInstance(),t.lotteryCtrl.initData(e[gc.dsConsts.LoginData.lottery]),t.taskCtrl=t.TaskCtrl.getInstance(),t.taskCtrl.initData(e[gc.dsConsts.LoginData.task]),t.shopCtrl=t.ShopCtrl.getInstance(),t.equipCtrl=t.EquipCtrl.getInstance(),t.rankCtrl=t.RankCtrl.getInstance(),t.kingCtrl=t.KingCtrl.getInstance(),t.rechargeCtrl.initData(e[gc.dsConsts.LoginData.rechargeData]),t.mailCtrl.initData(),t.signCtrl.initData(),t.timeCtrl.initData(),t.msgReceiverCtrl.initData(),t.demonLotusCtrl.initData(),r.offLineData=e[gc.dsConsts.LoginData.offLineData],r._lootTypeArr=e[gc.dsConsts.LoginData.lootTypeArr];var i=mo.getJSONWithFileName(gc.cfg_c_game);r.strengthReplayInterval=60*i[gc.id_c_game.strengthCfg][2]*1e3,mo.setTimeout(t.pointCtrl.calAll,t.pointCtrl,4e3),mo.setTimeout(function(){t.guildCtrl.getData()||t.guildCtrl.getInfo(function(){t.chatCtrl.initData()},r)},r,1e3),mo.setTimeout(function(){t.shopCtrl.requestShopData(gc.c_prop.shopTypeKey.equip,function(){},r),t.redEnvelopeCtrl.syncRedEnvelope(function(){},r),r.checkBindPhoneReward()},r,5e3)},a.getLootTypeArr=function(){return this._lootTypeArr},a.syncData=function(t,e,r){var i={},a=gc.iface.a_user_syncData_args,i={};i[a.sendData]=t,mo.request4Server(gc.iface.a_user_syncData,i,function(t){e&&e.call(r,t)})},a.syncData2=function(t,e){var r=this;mo.request4Server(gc.iface.a_user_syncData2,{},function(i){var a=i[gc.dsConsts.AsyncData2.lastUpdateTime],s=i[gc.dsConsts.AsyncData2.lootTypeArr];a=Date.newDate(a),r.set(gc.dsConsts.UserEntity.lastUpdateTime,a),Date.setStandard(a.getTime()),r._lootTypeArr=s,t&&t.call(e,a)})},a.updateGuide=function(t,e,r){var i=this,a=gc.iface.a_user_updateGuide_args,s={};s[a.guideId]=t,mo.request4Server(gc.iface.a_user_updateGuide,s,function(t){t&&i.updateEntity(t),e&&e.call(r)})},a.getGuide=function(){var t=this,e=t.get(gc.dsConsts.UserEntity.exData);return e[gc.c_prop.userExDataKey.guide]||0},a.setAutoFight=function(t){var e=this,r=e.get(gc.dsConsts.UserEntity.exData);r[gc.c_prop.userExDataKey.autoFight]=t,e.set(gc.dsConsts.UserEntity.exData,r);var i=gc.iface.a_user_setAutoFight_args,a={};a[i.isAuto]=t,mo.request4Server(gc.iface.a_user_setAutoFight,a,function(t){}),t?mo.showMsg(gc.id_c_msgCode.autoOpen):mo.showMsg(gc.id_c_msgCode.autoClose)},a.updateSetting=function(t,e,r,i){var a=this,s=a.get(gc.dsConsts.UserEntity.exData);s[gc.c_prop.userExDataKey.catNoVipChat]=t,s[gc.c_prop.userExDataKey.autoBuyLittleHorn]=e,a.set(gc.dsConsts.UserEntity.exData,s);var n=gc.iface.a_user_updateSetting_args,o={};o[n.catNoVipChat]=t,o[n.autoBuyLittleHorn]=e,mo.request4Server(gc.iface.a_user_updateSetting,o,function(t){r&&r.call(i)})},a.isAutoFight=function(){var t=this,e=t.get(gc.dsConsts.UserEntity.exData);return e[gc.c_prop.userExDataKey.autoFight]||0},a.setTimeError=function(){var t=this,e=t.getTimeError();e++;var r=t.get(gc.dsConsts.UserEntity.exData);r[gc.c_prop.userExDataKey.timeError]=e;var i=gc.iface.a_user_setTimeError_args,a={};a[i.errorNum]=e,mo.request4Server(gc.iface.a_user_setTimeError,a,function(t){})},a.getTimeError=function(){var t=this,e=t.get(gc.dsConsts.UserEntity.exData);return e[gc.c_prop.userExDataKey.timeError]||0},a.changeName=function(e,r,i,a){var s=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.fuckWord)[0].split(",");if(null==e||""==e)return mo.showMsg(gc.id_c_msgCode.inputRoleName);if(mo.STR.getStringLength(e)>14)return mo.showMsg(gc.id_c_msgCode.roleNameOutLenght);if(mo.STR.checkSensitiveWord(e,s))return mo.showMsg(gc.id_c_msgCode.sensitiveInRoleName);var n=this,o=gc.iface.a_user_changeName_args,c={};c[o.name]=e,c[o.heroTempId]=r,mo.requestWaiting4Server(gc.iface.a_user_changeName,c,function(e){var r=e[gc.dsConsts.ExUserData.userData];n.updateEntity(r);var s=e[gc.dsConsts.ExUserData.heroData];t.heroCtrl.updateHeroEntityCtrl(s[gc.dsConsts.HeroEntity.id],s),i&&i.call(a)})},a.addBag=function(t,e){var r=this,i=r.get(gc.dsConsts.UserEntity.bag)||{};if("object"==typeof t)for(var a in t)r._addBag(i,a,t[a]);else r._addBag(i,t,e);r.set(gc.dsConsts.UserEntity.bag,i)},a._addBag=function(t,e,r){var i=t[e]||0;return i+=r,t[e]=i,t},a.delBag=function(t,e){var r=this,i=r.get(gc.dsConsts.UserEntity.bag)||{};if("object"==typeof t)for(var a in t)r._delBag(i,a,t[a]);else r._delBag(i,t,e);r.set(gc.dsConsts.UserEntity.bag,i)},a.getItemNum=function(t){var e=this,r=mo.getJSONWithFileName(gc.cfg_t_item),i=r[t];if(!i)return 0;var a=0;switch(t){case gc.c_prop.spItemIdKey.diamond:a=e.getDiamond();break;case gc.c_prop.spItemIdKey.gold:a=e.getGold();break;default:var s=e.get(gc.dsConsts.UserEntity.bag)||{};a=s[t]||0}return a},a.getItemByType=function(t){var e=this,r={},i=e.get(gc.dsConsts.UserEntity.bag),a=mo.getJSONWithFileName(gc.cfg_t_item);for(var s in i){var n=a[s];n[gc.t_item_type]==t&&(r[s]=i[s])}return r},a._delBag=function(t,e,r){var i=t[e]||0,a=i-r;return t[e]=a,0>=a&&delete t[e],t},a.getStrength=function(){var t=this,e=t.getMaxStrength(),r=t.strengthReplayInterval,i=t._data[gc.dsConsts.UserEntity.strength];if(i>=e)return i;var a=t._data[gc.dsConsts.UserEntity.strengthReTime];if(!a)return i;var s=Date.newDate().getTime(),n=a.getTime();if(s>=n)return e;var o=e-Math.ceil((n-s)/r);return 0>o?i:Math.min(e,o)},a.getMaxStrength=function(){var t=this,e=gc.dsConsts.UserEntity,r=t.get(e.lvl),i=mo.getJSONWithFileName(gc.cfg_c_game),a=i[gc.id_c_game.strengthCfg][0],s=i[gc.id_c_game.strengthCfg][1];return a+(r-1)*s},a.updateEntityNotShow=function(t){var r=this,i=JSON.parse(JSON.stringify(r.getData()));r.__adjust_equpBag_final(t),e.prototype.updateEntity.call(this,t),r._calPoint(i,t)},a.__adjust_equpBag_final=function(e){var r=this._equipBk,i=e[gc.dsConsts.UserEntity.equipBag];if(i){var a;for(var s in i){var n=i[s][0];r[s]&&r[s][0]==n?i[s][2]=r[s][1]:(a=i[s][1],(t.equipCtrl.isSpecialEquip(n)||t.equipCtrl.isRareEquip(n))&&(a=t.equipCtrl.getSpecialEquipExtra(n)),i[s][5]?i[s][2]=t.userUtils.getEquipGrade(n,a,i[s][5]):i[s][2]=t.userUtils.getEquipGrade(n,a),r[s]=[n,i[s][2]])}}},a.updateEntity=function(t){var r=this,i=JSON.parse(JSON.stringify(r.getData()));r.calProChanged(t,i),r.__adjust_equpBag_final(t),e.prototype.updateEntity.call(this,t),r._calPoint(i,t)},a._calPoint=function(e,r){var i=this;if(r[gc.dsConsts.UserEntity.lvl]){var a=e[gc.dsConsts.UserEntity.lvl],s=r[gc.dsConsts.UserEntity.lvl];if(a!=s){var n=mo.getJSONWithFileName(gc.cfg_c_genuineQi),o=i.get(gc.dsConsts.UserEntity.exData);if(o&&o[gc.c_prop.userExDataKey.genuineQi]||!n[s]||(t.demonLotusCtrl.initData(),i.getGenuineQi(function(){},this)),t.pointCtrl.cal(gc.c_prop.pointGreenKey.copy_boss),t.heroCtrl.calPropAndCombat(),s>=10){var c=s.toString().split("");0==c[c.length-1]&&t.shopCtrl.refresh(gc.c_prop.shopTypeKey.equip,!0,function(t){i.pushNotify(i.__class.ON_TEN_LVL,gc.c_prop.shopTypeKey.equip)},this)}mo_channel.getCurChannel().footmark("levelUpgrade",{level:s})}}r[gc.dsConsts.UserEntity.bag]&&(t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_wing),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_wing),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_wing),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_realm),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_realm),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_realm),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_intensify),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_intensify),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_intensify),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_star),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_star),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_star),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_gem),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_gem),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_gem),t.pointCtrl.cal(gc.c_prop.pointEffectKey.medal),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_tring),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_tring),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_tring),t.pointCtrl.cal(gc.c_prop.pointRedKey.demonLotus_1),t.pointCtrl.cal(gc.c_prop.pointRedKey.demonLotus_2),t.pointCtrl.cal(gc.c_prop.pointRedKey.demonLotus_main)),r[gc.dsConsts.UserEntity.equipBag]&&(t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_equip),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_equip),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_equip),t.pointCtrl.cal(gc.c_prop.pointRedKey.role4_equip),t.pointCtrl.cal(gc.c_prop.pointEffectKey.bag),t.pointCtrl.cal(gc.c_prop.pointEffectKey.chuanChen),t.pointCtrl.cal(gc.c_prop.pointEffectKey.custom)),r[gc.dsConsts.UserEntity.gold]&&(t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_wing),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_wing),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_wing),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_realm),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_realm),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_realm),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_intensify),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_intensify),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_intensify),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_star),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_star),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_star),t.pointCtrl.cal(gc.c_prop.pointRedKey.role1_gem),t.pointCtrl.cal(gc.c_prop.pointRedKey.role2_gem),t.pointCtrl.cal(gc.c_prop.pointRedKey.role3_gem))},a.calProChanged=function(e,r){var i=gc.dsConsts.UserEntity,a={},s=[];for(var n in i){var o=i[n];if(e[o]&&r[o]&&e[o]!=r[o])if(i.bag==o){var c=r[o],g=e[o];for(var n in g){var l=g[n]||0,_=c[n]||0;if(l!=_){var u=l-_;u>0&&(a[n]=u)}}}else if(i.equipBag==o){var c=r[o],g=e[o];for(var d in g)(null==c[d]||null!=c[d]&&g[d][0]!=c[d][0])&&s.push(g[d][0])}else if(i.combat==o){var p=r[o],m=e[o];p>0&&g_msg.UIMsgCombatCtrl.push({oldCombat:p,newCombat:m})}else if(i.gold==o){var _=r[o],l=e[o],u=l-_;u>0&&(a[gc.c_prop.spItemIdKey.gold]=u)}else if(i.diamond==o){var _=r[o],l=e[o],u=l-_;u>0&&(a[gc.c_prop.spItemIdKey.diamond]=u)}else if(i.medalData==o){var f=r[o],h=e[o];JSON.stringify(f)!=JSON.stringify(h)&&t.heroCtrl.calPropAndCombat()}}(Object.keys(a).length>0||s.length>0)&&g_msg.GetItemTips.create().setData({items:a,equips:s}).show()},a._appendValue=function(t,e){var r=this._data[t]||0;this.set(t,r+e)},a.getName=function(){return this.get(gc.dsConsts.UserEntity.nickName)},a.getId=function(){return this.get(gc.dsConsts.UserEntity.id)},a.getGold=function(){return this.get(gc.dsConsts.UserEntity.gold)},a.getPrestige=function(){return this.get(gc.dsConsts.UserEntity.prestige)},a.getBuyGoldCount=function(){return this.getTodayCount(gc.c_prop.userRefreshCountKey.buyGold)},a.getBuyLingyunCount=function(){return this.getTodayCount(gc.c_prop.userRefreshCountKey.buyLingyun)},a.getDiamond=function(){return this.get(gc.dsConsts.UserEntity.diamond)},a.getCombat=function(){return this.get(gc.dsConsts.UserEntity.combat)},a.getActivity=function(){return this.get(gc.dsConsts.UserEntity.activity)},a.getExData=function(){return this.get(gc.dsConsts.UserEntity.exData)},a.getIsKing=function(){return this.get(gc.dsConsts.UserEntity.isKing)},a.setIsKing=function(t){return this.set(gc.dsConsts.UserEntity.isKing,t)},a.updateCombat=function(){var e=this,r=t.heroCtrl.getTotalCombat(),i={};i[gc.dsConsts.UserEntity.combat]=r,e.updateEntity(i),mo.request4Server(gc.iface.a_user_updateCombat,{},function(){},e)},a.getVip=function(){return this.get(gc.dsConsts.UserEntity.vip)},a.getVipScore=function(){return this.get(gc.dsConsts.UserEntity.vipScore)},a.getNextVipScore=function(){var t=this.getVip(),e=mo.getJSONWithFileNameAndID(gc.cfg_c_vip,t);return e[gc.c_vip_score]},a.getLvl=function(){return this.get(gc.dsConsts.UserEntity.lvl)},a.getRebirthLvl=function(){return this.get(gc.dsConsts.UserEntity.rebirthLvl)},a.getInfuseExpc=function(){return this.get(gc.dsConsts.UserEntity.infuseExpc)},a.getExp=function(){return this.get(gc.dsConsts.UserEntity.expc)},a.getIconId=function(){return this.get(gc.dsConsts.UserEntity.iconId)},a.getEquipBag=function(){return this.get(gc.dsConsts.UserEntity.equipBag)},a.isOpenInfuseExpc=function(){var t=this.get(gc.dsConsts.UserEntity.isOpenIn);return t&&1==t?!0:!1},a.getEquipBagNum=function(){var t=this.getEquipBag(),e=0;for(var r in t){var i=t[r];0==i[3]&&e++}return e},a.getBag=function(){return this.get(gc.dsConsts.UserEntity.bag)},a.getEquipBagGrid=function(){var t=this,e=mo.getJSONWithFileName(gc.cfg_c_vip),r=mo.getJSONWithFileName(gc.cfg_c_game),i=this.get(gc.dsConsts.UserEntity.equipBagBuyCount),a=parseInt(r[gc.id_c_game.equipBagCfg][0]),s=parseInt(r[gc.id_c_game.equipBagCfg][1]),n=parseInt(e[t.getVip()][gc.c_vip_addEquipBag]),o=a+i*s+n;return o},a.increaseGold=function(t){this._appendValue(gc.dsConsts.UserEntity.gold,t)},a.reduceDiamond=function(t){this._appendValue(gc.dsConsts.UserEntity.diamond,-t)},a.getTodayCount=function(t){var e=this,r=e.get(gc.dsConsts.UserEntity.counts),i=e.get(gc.dsConsts.UserEntity.countsRefreshTime),a=r[t]||0,s=Date.newDate(i[t]);return s&&(s=Date.newDate(s),s.equalsDay(Date.newDate())||(s=Date.newDate(),a=0)),r[t]=a,i[t]=s,e.set(gc.dsConsts.UserEntity.counts,r),e.set(gc.dsConsts.UserEntity.countsRefreshTime,i),a},a.getLastTime=function(t){var e=this,r=e.get(gc.dsConsts.UserEntity.countsRefreshTime);return r[t]},a.getBuyGoldData=function(){var t=this,e=t.get(gc.dsConsts.UserEntity.lvl),r=mo.getJSONWithFileName(gc.cfg_c_game),i=mo.getJSONWithFileName(gc.cfg_c_lvl),a=t.getBuyGoldCount(),s=r[gc.id_c_game.goldBuySet][0],n=i[e][gc.c_lvl_buyGoldMult],o=gc.calBuyGold(a+1,s,n),c=gc.calBuyGoldDiamond(a+1);return[o,c]},a.buyGold=function(t,e){var r=this,i=r.getBuyGoldData(),a=i[0],s=i[1];mo.showMsg(gc.id_c_msgCode.buyGolds,s,a,function(){if(r.getDiamond()<s)return mo.showMsg(gc.id_c_msgCode.noDiamond);var i={};mo.requestWaiting4Server(gc.iface.a_user_buyGold,i,function(i){var a=i[gc.dsConsts.ExUserData.userData];r.updateEntity(a),t&&t.call(e,i)})})},a.noGolds=function(t,e){var r=this,i=r.getBuyGoldData(),a=i[0],s=i[1];mo.showMsg(gc.id_c_msgCode.noGolds,s,a,function(){if(r.getDiamond()<s)return mo.showMsg(gc.id_c_msgCode.noDiamond);var i={};mo.requestWaiting4Server(gc.iface.a_user_buyGold,i,function(i){var a=i[gc.dsConsts.ExUserData.userData];r.updateEntity(a),t&&t.call(e,i)})})},a.getBuyLingyunCos=function(){var t=this,e=999999,r=mo.getJSONWithFileName(gc.cfg_c_game),i=t.getBuyLingyunCount(),a=r[gc.id_c_game.buyLingyunCfg][0]||0,s=r[gc.id_c_game.buyLingyunCfg][1].split(";")||[],n=s[s.length-1].split(",")||[];if(i+1>=n[0])e=parseInt(n[1])/10*a;else for(var o=0;o<s.length;o++){var c=s[o].split(",")||[];if(c[0]&&c[1]&&i+1<=c[0]){e=parseInt(c[1])/10*a;break}}return e},a.buyLingyun=function(e,r){var i=this,a=i.getVip(),s=mo.getJSONWithFileName(gc.cfg_c_vip),n=i.getBuyLingyunCount(),o=i.getBuyLingyunCos(),c=s[a][gc.c_vip_buyLingyunCount];if(n>=c)return mo.showMsg(gc.id_c_msgCode.cantBusMax);if(i.getDiamond()<o)return mo.showMsg(gc.id_c_msgCode.noDiamond);var g={};mo.requestWaiting4Server(gc.iface.a_user_buyLingyun,g,function(a){var s=a[gc.dsConsts.ExUserData.userData],n=a[gc.dsConsts.ExUserData.bagItems]||{},o=t.userUtils.getNewBag({},n);s[gc.dsConsts.UserEntity.bag]=o,i.updateEntity(s),e&&e.call(r,a)})},a.getEquipAttribute=function(e){var r=t.userCtrl.get(gc.dsConsts.UserEntity.equipBag);r[e][0],r[e][1]},r.createUser=function(e,r,i,a,s){var n=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.fuckWord)[0].split(",");if(null==e||""==e)return mo.showMsg(gc.id_c_msgCode.inputRoleName);if(mo.STR.getStringLength(e)>12)return mo.showMsg(gc.id_c_msgCode.roleNameOutLenght);if(mo.STR.checkSensitiveWord(e,n))return mo.showMsg(gc.id_c_msgCode.sensitiveInRoleName);if(e.indexOf("'")>-1)return mo.showMsg("不能包含单引号");if(e.indexOf('"')>-1)return mo.showMsg("不能包含双引号");if(e.indexOf("\\")>-1)return mo.showMsg("不能包含斜杠");var o=t.serverInfoCtrl.getSelectIndex();if(!o)return mo.showMsg("请先选择服务器！");var c=this,g=gc.iface.c_account_createUser_args,l={};l[g.name]=e,l[g.heroTempId]=r,l[g.sex]=i,l[g.serverIndexId]=o;var _=t.HoodinnCtlr.SharedUserKey();_&&(l[g.shareKey]=_),mo.requestWaiting4Server(gc.iface.c_account_createUser,l,function(t){a&&a.call(s),c.CREATEDUSER=!0})},a.getGenuineQi=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_user_getGenuineQi,{},function(a){var s=a[gc.dsConsts.UserEntity.genuineQi]||0;parseInt(s)>0&&(t.demonLotusCtrl._genuineQi=parseInt(s),t.demonLotusCtrl._lastUpTime=Date.newDate().toString()),i.updateEntity(a),e&&e.call(r)})},a.buyBagGrid=function(t,e){var r=this,i=r.getDiamond(),a=this.get(gc.dsConsts.UserEntity.equipBagBuyCount),s=gc.callBuyEquipBag(a),n=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.equipBagCfg);mo.showMsg(gc.id_c_msgCode.ifBuyBag,s,n[1],function(){return s>i?mo.showMsg(gc.id_c_msgCode.noDiamond):void mo.requestWaiting4Server(gc.iface.a_user_buyBagGrid,{},function(i){r.updateEntity(i),t.call(e,i)
})})},a.getNeedItems=function(t){var e=[0],r=mo.getJSONWithFileName(gc.cfg_t_itemLogic);if(r[t][gc.t_itemLogic_needItems]){var i=r[t][gc.t_itemLogic_needItems];e[1]=i[0],e[0]=i[1]}return e},a.getBagChest=function(e,r,i,a){var s=this;if(s.getItemNum(e)<=0)return mo.showMsg("不存在该宝箱");var n=s.getBag(),o=s.getNeedItems(e);if(0!=o[0]){var c=o[1],g=o[0];!n[c]||n[c]<g}var l=gc.iface.a_user_getBagChest_args,_={};_[l.chestId]=e,_[l.count]=r,mo.requestWaiting4Server(gc.iface.a_user_getBagChest,_,function(e){var r=e[gc.dsConsts.ExUserData.wingExp];t.demonLotusCtrl._genuineQi=parseInt(r),t.demonLotusCtrl._lastUpTime=Date.newDate().toString();var n=e[gc.dsConsts.ExUserData.expc];n>0&&g_msg.UIMsgTextCtrl.push("获得经验："+n);var o=e[gc.dsConsts.ExUserData.rebirthExp];o>0&&g_msg.UIMsgTextCtrl.push("获得飞升经验："+o);var c=e[gc.dsConsts.ExUserData.genuineQi];c>0&&g_msg.UIMsgTextCtrl.push("获得真气："+c);var g=e[gc.dsConsts.ExUserData.userData]||{},l=e[gc.dsConsts.ExUserData.isMail];l&&mo.showMsg(gc.id_c_msgCode.bagMaxMail);var _=e[gc.dsConsts.ExUserData.bagItems]||{},u=e[gc.dsConsts.ExUserData.delBagItems]||{},d=e[gc.dsConsts.ExUserData.equipBagItems]||{},p=t.userUtils.getNewBag(u,_);g[gc.dsConsts.UserEntity.bag]=p;var m=t.userUtils.getNewEquipBag({},d);g[gc.dsConsts.UserEntity.equipBag]=m,s.updateEntity(g),i&&i.call(a,l)})},a.isEquipBagReddot=function(){var t=this,e=t.getEquipBagGrid(),r=this.getEquipBag()||{},i=0;for(var a in r)1==r[a][3]&&(i+=1);var s=Object.keys(r).length,n=e-s+i;return 0>=n?!0:!1},a.isSmeltReddot=function(){var e=this,r=mo.getJSONWithFileName(gc.cfg_c_game),i=r[gc.id_c_game.equipBagCfg][2],a=e.getEquipBagGrid(),s=this.getEquipBag()||{},n=0;for(var o in s)1==s[o][3]&&(n+=1);var c=Object.keys(s).length,g=parseInt(((c-n)/a*100).toString()),l=t.equipCtrl.getSmeltArr(1);return g>=i&&l.length>0?!0:!1},a.isGetDeskReward=function(){var t=this,e=t.get(gc.dsConsts.UserEntity.record),r=e[gc.c_prop.userRecordTypeKey.saveDesk]||0;return r},a.getAddDeskReward=function(t,e){var r=this,i=gc.iface.a_user_saveDeskSuccess_args,a={};a[i.type]=gc.c_prop.userRecordTypeKey.saveDesk,mo.requestWaiting4Server(gc.iface.a_user_saveDeskSuccess,a,function(i){i&&r.updateEntity(i),mo.showMsg(gc.id_c_msgCode.rewardMail),t&&t.call(e,i)})},a.getBindPhoneReward=function(t,e){var r=this,i=gc.iface.a_user_saveDeskSuccess_args,a={};a[i.type]=gc.c_prop.userRecordTypeKey.bindPhone,mo.requestWaiting4Server(gc.iface.a_user_saveDeskSuccess,a,function(i){i&&r.updateEntity(i),t&&t.call(e,i),r.pushNotify(r.__class.ON_GET_BINDPHONE_REWARD)})},a.isGetBindPhoneReward=function(){var t=this,e=t.get(gc.dsConsts.UserEntity.record),r=e[gc.c_prop.userRecordTypeKey.bindPhone]||0;return r>0},a.checkBindPhoneReward=function(){var t=this;if(!(t.getLvl()<30)){var e=mo_channel.getCurChannel();e.isBindMobile(function(e,r){e&&r&&!t.isGetBindPhoneReward()&&t.getBindPhoneReward(function(){console.log("-->自动领奖")},t)},t)}},a.getBindPhoneUrl=function(t,e){mo.requestWaiting4Server(gc.iface.a_user_getBindPhoneUrl,{},function(r){t&&t.call(e,r)})},a.addDesktopReward=function(t,e,r){var i=this,a=gc.iface.a_user_saveDeskSuccess_args,s={};s[a.type]=t,mo.requestWaiting4Server(gc.iface.a_user_saveDeskSuccess,s,function(t){t&&i.updateEntity(t),mo.showMsg(gc.id_c_msgCode.rewardMail),e&&e.call(r,t)})},a.getWanbaGift=function(e,r,i,a){var s=this,n=gc.iface.a_user_getWanbagift_args,o={};o[n.os]=e,o[n.giftId]=r,mo.requestWaiting4Server(gc.iface.a_user_getWanbagift,o,function(e){var r=e[gc.dsConsts.WanbaGift.code];if(0==r){var n=e[gc.dsConsts.WanbaGift.userData],o=e[gc.dsConsts.WanbaGift.bagItems]||{},c=e[gc.dsConsts.WanbaGift.equipBagItems]||{},g=t.userUtils.getNewBag({},o);n[gc.dsConsts.UserEntity.bag]=g;var l=t.userUtils.getNewEquipBag({},c);n[gc.dsConsts.UserEntity.equipBag]=l,s.updateEntity(n)}i&&i.call(a,e)})},a.sellItems=function(e,r,i,a){var s=this,n=gc.iface.a_item_sellItems_args,o={};o[n.itemId]=e,o[n.itemNum]=r,mo.requestWaiting4Server(gc.iface.a_item_sellItems,o,function(e){var r=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.bagItems]||{},o=e[gc.dsConsts.ExUserData.delBagItems]||{},c=t.userUtils.getNewBag(o,n);r[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntity(r),s.pushNotify(s.__class.ON_ITEM_CHANGE),i&&i.call(a,e)})},a.deleteItem=function(e,r){var i=this;if(e){var a={};a[e]=r;var s=t.userUtils.getNewBag(a,{}),n={};n[gc.dsConsts.UserEntity.bag]=s,t.userCtrl.updateEntity(n),i.pushNotify(i.__class.ON_ITEM_CHANGE)}},a.updateBagItems=function(e,r,i){var a=gc.iface.a_user_updateItems4Bag_args,s={};s[a.itemId]=e,mo.requestWaiting4Server(gc.iface.a_user_updateItems4Bag,s,function(e){var a=t.userUtils.getNewBag4update(e),s={};s[gc.dsConsts.UserEntity.bag]=a,t.userCtrl.updateEntity(s),r&&r.call(i,e)})},a.isMaxLvl=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.initCfg);return t.getLvl()>=e[0]},a.getMedalDataNum=function(t){var e=this,r=e.get(gc.dsConsts.UserEntity.medalData),i=r[t]?1:0;return i+=e.getItemNum(t)},r.ON_TEN_LVL="on_ten_lvl",r.ON_GET_BINDPHONE_REWARD="on_getBindPhone",r.ON_ITEM_CHANGE="on_itemChange",r.enterGame=function(e,r){var i=this,a=t.serverInfoCtrl.getSelectIndex();if(!a)return mo.showMsg("请先选择服务器！");var s=t.serverInfoCtrl.getSelectServer(),n=s[gc.dsConsts.ServerInfoEntity.isClose];if(n)return mo.showMsg("服务器维护中！");var o=gc.iface.c_account_enterGame_args,c={};c[o.accountId]=t.accountCtrl.getId(),c[o.loginKey]=t.accountCtrl.getLoginKey(),c[o.serverIndexId]=a,mo.requestWaiting4Server(gc.iface.c_account_enterGame,c,function(a){if(gc.net.httpRetryMaxTimes=5,a){var s=a[gc.dsConsts.LoginData.user];t.userCtrl=t.UserCtrl.getInstance(s),t.userCtrl.initData(a),e&&e.call(r,a),mo_channel.getCurChannel().footmark("enterGame",{level:i.getInstance().getLvl(),vipLevel:i.getInstance().getVip(),score:i.getInstance().getCombat(),isNew:i.CREATEDUSER}),i.CREATEDUSER=!1}else e&&e.call(r,a)})},r}(mo.DataController);t.UserCtrl=e,egret.registerClass(e,"gd.UserCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.initData=function(t){this._rechargeData=t},a.getList=function(){var t=egret.Capabilities.os,e=mo_channel.getCurChannel().channel(),r=[],i=mo.getJSONWithFileName(gc.cfg_c_recharge);for(var a in i){var s=i[a];if(s[gc.c_recharge_visible]){if("iOS"==t&&"qqbrowser"==e){var n=s[gc.c_recharge_cost];if(n>=388)continue}r.push(s)}}return r.sort(function(t,e){return t[gc.c_recharge_index]-e[gc.c_recharge_index]}),r},a.getInfo=function(t,e){var r=this;mo.request4Server(gc.iface.a_recharge_getInfo,{},function(i){r.initData(i),t&&t.call(e,i)})},a.recharge=function(e,r,i,a){var s=this,n=gc.iface.a_recharge_recharge_args,o={};o[n.rechargeId]=e,o[n.channelId]=r,mo.request4Server(gc.iface.a_recharge_recharge,o,function(e){s.getInfo(function(){t.userCtrl.updateEntity(e),i&&i.call(a,e)},s)})},a.getAllCostRMB=function(){var t=mo.getJSONWithFileName(gc.cfg_c_recharge),e=this._rechargeData[gc.dsConsts.RechargeData.countMap],r=0;for(var i in e){var a=parseInt(i),s=t[a],n=e[i]||0;r+=(s[gc.c_recharge_cost]||0)*n}return r},a.getMaxVip=function(){var t=mo.getJSONWithFileName(gc.cfg_c_vip),e=-1;for(var r in t)t[r][gc.c_vip_id]>e&&(e=t[r][gc.c_vip_id]);return e},a.getVipCost=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_vip,t-1);return e[gc.c_vip_score]},a.hasBuy=function(t){var e=this._rechargeData[gc.dsConsts.RechargeData.countMap],r=e[t]||0;return r>0},a.getRequest=function(t,e,r,i){var a=gc.iface.a_recharge_getRequest_args,s={};s[a.rechargeId]=t,s[a.goodsId]=e,mo.request4Server(gc.iface.a_recharge_getRequest,s,function(t){r&&r.call(i,t)})},a.handleRequest=function(e,i){var a=this;mo.request4Server(gc.iface.a_recharge_handleRequest,{},function(s){var n=s[gc.dsConsts.HandleRecharge.userData],o=s[gc.dsConsts.HandleRecharge.addDiamond],c=s[gc.dsConsts.HandleRecharge.isFinish],g=s[gc.dsConsts.HandleRecharge.rechargeId];if(n&&t.userCtrl.updateEntity(n),a.getInfo(function(){},a),o){var l=g_cache.getLocalStorageItem(g_consts.GUIDE_LCK.popBindPhoneAfterPay);l||(mo.moduleMgr.runModule(g_consts.moduleId.bindPhone),g_cache.recordGuideDone(g_consts.GUIDE_LCK.popBindPhoneAfterPay))}e&&e.call(i,[c,g]),a.pushNotify(r.ON_RECHARGE_SUCC)})},r.ON_RECHARGE_SUCC="onRechargeSucc",r}(mo.DataController);t.RechargeCtrl=e,egret.registerClass(e,"gd.RechargeCtrl"),t.rechargeCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._serverList=[],t._myServerList=[],t._channelServerList=[]},a.setSelectIndex=function(t){this._selectIndex=t},a.getSelectIndex=function(){return this._selectIndex},a.setSelectServer=function(t){this._selectServer=t},a.getSelectServer=function(){return this._selectServer},a.getInfo=function(e,r){var i=this,a={},s=gc.iface.h_serverInfo_getServerList_args,n=t.accountCtrl.getStatus(),o=0;3==n&&(o=1),a[s.isTest]=o;var c=t.accountCtrl.getId();mo.request4Http(gc.iface.h_serverInfo_getServerList,a,function(t){i._serverList=t,i._channelServerList=i._calChannel(t);var a=gc.iface.h_serverInfo_getUserServers_args,s={};s[a.accountId]=c,mo.request4Http(gc.iface.h_serverInfo_getUserServers,s,function(t){i._myServerList=t,e.call(r)})})},a._calChannel=function(t){for(var e=[],r=[],i=mo_channel.getCurChannel().channel(),a=0;a<t.length;a++){var s=t[a],n=s[gc.dsConsts.ServerInfoEntity.appId];n||r.push(s),n&&i==n&&e.push(s)}return e.length>0?e:r},a.getTitleList=function(){for(var t=this,e=[],r=0;100>r;r++){var i=t._getRang(r),a=i[0],s=i[1],n=a+"-"+s+"服";if(e.push(n),s>=t._channelServerList.length)break}return e.push("登录过的"),e},a.getServerList=function(t){var e=this;if(0==t)return e._myServerList.reverse();for(var r=e._getRang(t-1),i=r[0],a=r[1],s=[],n=i-1;a>n;n++){var o=e._channelServerList[n];if(!o)break;s.push(o)}return s},a.getNewServer=function(){return this._channelServerList[this._channelServerList.length-1]},a.getNewGoodServerIndex=function(){for(var t=this,e=t.getNewServers(),r=e.length-1;r>=0;r--){var i=e[r];if(!i[gc.dsConsts.ServerInfoEntity.isClose])return[r,t._channelServerList.indexOf(i)]}return[-1,-1]},a.getNewServers=function(){var t=this;if(!t._channelServerList)return[];var e=6;return t._channelServerList.length<e?t._channelServerList.slice(-t._channelServerList.length):t._channelServerList.slice(-e)},a.getServerInfoById=function(t){for(var e=this,r=0;r<e._serverList.length;r++){var i=e._serverList[r];if(i[gc.dsConsts.ServerInfoEntity.id]==t)return i}return e._channelServerList[0]},a.getServerByIndex=function(t){var e=this;return t>=0&&t<e._channelServerList.length?e._channelServerList[t]:null},a._getRang=function(t){var e=20*t+1,r=20*t+20;return[e,r]},r.__className="ServerDataCtrl",r}(mo.DataController);t.ServerInfoCtrl=e,egret.registerClass(e,"gd.ServerInfoCtrl"),t.serverInfoCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.getBuffArr=function(){return this._buffArr},this.setBuffArr=function(t){var e=this;e._buffArr=t,e._checkKingBuff()},this._checkKingBuff=function(){var e=this,r=!1;return e._buffArr.indexOf(gc.c_prop.otherBuffIdKey.king)>-1&&(r=!0),t.kingCtrl.setIsOpenBuff(r)},this.getExpcRate=function(){for(var t=this,e=1,r=mo.getJSONWithFileName(gc.cfg_t_otherBuff),i=0;i<t._buffArr.length;i++){var a=t._buffArr[i],s=r[a][gc.t_otherBuff_addHurt]/1e4;s=parseInt(s.toString()),a==gc.c_prop.otherBuffIdKey.king&&(e+=s)}return e}}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this._copyLootDic={},this.isSpFighting=!1,this._buffArr=[]},a.getNextLoot=function(t,e,r,i){var a=this;a._initNextLoot(t,e,function(){var s=a._getAllUnUseCopyLoot(t,e);r.call(i,s),a.pushNotify(a.__class.ON_NEXT_LOOT,{}),mo.emitter.emit(a.__class.ON_NEXT_LOOT)},a)},a.pickLoot=function(e,r,i,a){var s=t.copyCtrl.getNormalCurCopyId(),n={},o=gc.iface.a_fight_pickLoot_args;n[o.copyId]=s,n[o.uidArr]=e,n[o.fightData]=r;var c=t.userCtrl.getLvl();mo.request4Server(gc.iface.a_fight_pickLoot,n,function(e){var r=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.copyProgressData],o=e[gc.dsConsts.ExUserData.bagItems]||{},g=e[gc.dsConsts.ExUserData.equipBagItems]||{},l=t.userUtils.getNewBag({},o);r[gc.dsConsts.UserEntity.bag]=l;var _=t.userUtils.getNewEquipBag({},g);return r[gc.dsConsts.UserEntity.equipBag]=_,t.userCtrl.updateEntityNotShow(r),c!=t.userCtrl.getLvl()&&t.heroCtrl.calPropAndCombat(),n&&t.copyCtrl.updateCopyProgressCtrl(t.copyCtrl.getCopyType(s),n),i?i.call(a,e):void 0})},a.startPvpFight=function(e,r,i,a){void 0===a&&(a=null),mo.moduleMgr.curModule.name!=g_consts.moduleId.fight&&mo.moduleMgr.runModule(g_consts.moduleId.fight),t.fightLayer.onStartPvpFight({my:e,enemy:r,isPkOut:i,name:a})},a.enterCopy=function(e){t.copyCtrl.start(e,function(r){var i=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,e);i[gc.t_copy_type]!=gc.c_prop.copyTypeKey.normal&&mo.moduleMgr.curModule.name!=g_consts.moduleId.fight&&mo.moduleMgr.runModule(g_consts.moduleId.fight),t.fightLayer.onEnterCopy({pveType:gc.c_prop.fightTypeKey.copy,copyID:e,loots:r.concat()})},this)},a.forceNormalCopy=function(){t.fightLayer.forceNormalCopy()},a._getAndInitNextLoot=function(e,r,i,a){var s=this,n=t.userCtrl.getLvl(),o={},c=gc.iface.a_fight_getAndInitNextLoot_args;o[c.copyId]=e,o[c.isBoss]=r,o[c.lvl]=n,mo.request4Server(gc.iface.a_fight_getAndInitNextLoot,o,function(t){t||(t={});for(var n in t)s._setUnUseCopyLootByUid(e,r,n,t[n]);return i?i.call(a,t):void 0})},a._initNextLoot=function(t,e,r,i){var a=this;a._getAndInitNextLoot(t,e,r,i)},a._getUseLootDic=function(t,e){var r=this,i=r._getCopyLootDic(t),a=e?i.useBossLootDic:i.useLootDic;return a},a._getUnUseLootDic=function(t,e){var r=this,i=r._getCopyLootDic(t),a=e?i.unUseBossLootDic:i.unUseLootDic;return a},a._getCopyLootDic=function(e){var r=this,i=r._copyLootDic[e];return i||(i=new t.LootObj,i.copyId=e,r._copyLootDic[e]=i),i},a._getAllUnUseCopyLoot=function(t,e){var r=this,i=r._getUnUseLootDic(t,e),a=r._getUseLootDic(t,e),s=[];for(var n in i){var o=i[n];delete i[n],a[n]=o,s.push([n,o])}return s},a._getUnUseCopyLootByUid=function(t,e){var r=this,i=r._getUnUseLootDic(t,e),a=r._getUseLootDic(t,e),s=Object.keys(i),n=s[s.length-1],o=i[n];return o&&n?(delete i[n],a[n]=o,[n,o]):null},a._setUnUseCopyLootByUid=function(t,e,r,i){var a=this,s=a._getUnUseLootDic(t,e);s[r]=i},r.ON_START_PVP_FIGHT="ON_START_PVP_FIGHT",r.ON_NEXT_LOOT="ON_NEXT_LOOT",r.ON_ENTER_COPY="ON_ENTER_COPY",r}(mo.DataController);t.FightCtrl=e,egret.registerClass(e,"gd.FightCtrl"),t.fightCtrl=e.getInstance()}(gd||(gd={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.isLogout=!1,this.isAutoLogin=!1}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._isLoginSucc=!1},a.loginChannel=function(t){var e=this;e.loginOpt=t;var r=mo_channel.getCurChannel();e.requestTimeOut(),e.isLogout?r.login(e.responseCb,e,e.loginOpt):r.checkLogin(e.checkLoginCb,e,t)},a.changeAccount=function(){var t=this;t.isLogout=!0,t._isLoginSucc=!1;var e=mo_channel.getCurChannel();e.logout(function(){t.loginChannel(null)},t)},a.checkLoginCb=function(t){var e=this,r=mo_channel.getCurChannel();e.clearRequestTimeOut(),t?(e.onLoginSucc(),mo.stopWaiting()):r.isAutoLogin?(e.requestTimeOut(),r.login(e.responseCb,e,e.loginOpt)):(e.onLoginFail(),mo.stopWaiting())},a.requestTimeOut=function(){var t=this;mo.playWaiting(),null==t._timerId&&(t._timerId=tm.setTimeout(function(){t.clearRequestTimeOut(),t.onLoginFail(),mo.showErrMsg("请求超时了，请重新登录!",10)},8e4))},a.clearRequestTimeOut=function(){var t=this;null!=t._timerId&&(mo.stopWaiting(),tm.clearTimeout(t._timerId),t._timerId=null)},a.responseCb=function(t){var e=this;e._isLoginSucc||(e.clearRequestTimeOut(),1==t?(e._isLoginSucc=!0,e.onLoginSucc()):e.onLoginFail(),mo.stopWaiting())},a.onLoginSucc=function(){var t=this;t.emit(t.__class.ON_LOGIN_SUCC)},a.onLoginFail=function(){var t=this;t.emit(t.__class.ON_LOGIN_FAIL)},a.asyncAccount=function(t,e){var r=this;mo.playWaiting(),null==r._timerId&&(r._timerId=tm.setTimeout(function(){r.clearRequestTimeOut(),mo.showErrMsg("请求超时了，请重新登录!",10)},8e4));var i=mo_channel.getCurChannel();i.login(function(t){r._isLoginSucc||(r.clearRequestTimeOut(),r._isLoginSucc=!!t,e(t))},r,t)},a.enterGame=function(e){var r=this;g_cache.initGuideKeyCache(),gd.UserCtrl.enterGame(function(i){i?(mo.log("登陆成功！"),gd.activityCtrl.getInfo(function(){var i=mo_channel.getCurChannel();i.restorePayment(),mo.R.moduleInfoMap.mapview={},mo.moduleMgr.runModule(g_consts.moduleId.fight,null,function(){var i=mo_channel.getCurChannel().getHdpuProperty("GIFT");i&&i.length>0?gd.userCtrl.getWanbaGift(egret.Capabilities.os,i,function(a){var s=a[gc.dsConsts.WanbaGift.code];a&&0==s||a&&1==s?t.WanbaGift.create().setData({type:s,giftId:i,exData:e}).show():r.showNoticeOrFirstEnterGame(e)},r):r.showNoticeOrFirstEnterGame(e)})})):(t.CreateRole.create().setData({action:0}).show(),g_cache.clearGuideKeyCache())},r)},a.showNoticeOrFirstEnterGame=function(t){var e=this;t?(mo.showMsg(gc.id_c_msgCode.firstEnterGame,{}),mo.emitter.emit("logined")):gd.NoticeCtrl.getNewOne(function(t){mo.showMsg(gc.id_c_msgCode.sysNotice,{sysNotice:t}),mo.emitter.emit("logined")},e)},r.ON_LOGIN_SUCC="on_login_succ",r.ON_LOGIN_FAIL="on_login_fail",r}(egret.Emitter);t.LoginCtrl=e,egret.registerClass(e,"g_base.LoginCtrl"),t.loginCtrl=new e}(g_base||(g_base={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._lastBugChatId=0,this._lastSysMsgId=0,this._bugchatDatas=[],this._annouDatas=[],this._noticeDatas=[]}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.getLastBugChatId=function(){return this._lastBugChatId},a.getLastSysMsgId=function(){return this._lastSysMsgId},r.LockedServer=function(){return this.UrlField("area",null)},r.SharedUserKey=function(){return this.UrlField("shareKey",null)},r.UrlField=function(t,e,r){void 0===e&&(e=""),void 0===r&&(r=location.href);var i=r.match(new RegExp(t+"=([0-9a-z]+)","i"));return i?i[1]:e},a.openBugChatWindow=function(){this.syncBugChatData(),this.pushNotify(this.__class.ON_BUGCHAT_UPDATE,this._bugchatDatas),this._tmrBugChatUpdate=new egret.Timer(5e3,0),this._tmrBugChatUpdate.addEventListener(egret.TimerEvent.TIMER,this.syncBugChatData,this),this._tmrBugChatUpdate.start()},a.closeBugChatWindow=function(){this._tmrBugChatUpdate.stop(),this._tmrBugChatUpdate=null},a.syncBugChatData=function(){var e=this,r=gc.iface.h_kefu_getList_args,i={};i[r.lastId]=e._lastBugChatId,i[r.openId]=t.accountCtrl.get(gc.dsConsts.AccountEntity.sdkData).open_id,mo.request4Server(gc.iface.h_kefu_getList,i,function(t){e._updateBugChatData(t)})},a.syncSysMsgData=function(){var t=this,e=gc.iface.a_chat_getNewSysMsgList_args,r={};r[e.lastId]=t._lastSysMsgId,mo.request4Server(gc.iface.a_chat_getNewSysMsgList,r,function(e){t._updateSysMsgData(e)})},a.getAllBugChats=function(){return this._bugchatDatas},a.getAllAnnounces=function(){return this._annouDatas},a.delAnnounce=function(t){for(var e=this,r=0;r<e._annouDatas.length;++r){var i=e._annouDatas[r];if(i[gc.dsConsts.ChatData.uniqueId]==t){e._annouDatas.splice(r,1);break}}},a.getAllNotices=function(){return this._noticeDatas},a.delNotice=function(t){for(var e=this,r=0;r<e._noticeDatas.length;++r){var i=e._noticeDatas[r];if(i[gc.dsConsts.ChatData.uniqueId]==t){e._noticeDatas.splice(r,1);var a=i[gc.dsConsts.ChatData.sysArgs],s=a[0];if(9999==s){var n=a[a.length-2],o=a[a.length-1];if(n&&o){if(a[a.length-2]=--n,0>=n)break;egret.setTimeout(function(t){e._noticeDatas.push(t),e.pushNotify(e.__class.ON_SYSNOTICE_UPDATE,e._noticeDatas)},e,1e3*o,i);break}if(n&&(a[a.length-2]=--n,0>=n))break;e._noticeDatas.push(i)}break}}},a._updateBugChatData=function(t){for(var e=(mo.getJSONWithFileName(gc.cfg_c_chatSys),0);e<t.length;++e){var r=t[e];this._bugchatDatas.push(r);var i=r[gc.dsConsts.ChatData.uniqueId];i>this._lastBugChatId&&(this._lastBugChatId=i,this.pushNotify(this.__class.ON_NEWBUGCHAT_RECEIVED,r))}this.pushNotify(this.__class.ON_BUGCHAT_UPDATE,this._bugchatDatas)},a._updateSysMsgData=function(t){for(var e=!1,r=!1,i=0;i<t.length;++i){var a=t[i],s=a[gc.dsConsts.ChatData.subType];switch(s){case 1:this._noticeDatas.push(a),e=!0;break;case 2:this._annouDatas.push(a),r=!0}var n=a[gc.dsConsts.ChatData.uniqueId];n>this._lastSysMsgId&&(this._lastSysMsgId=n)}e&&this.pushNotify(this.__class.ON_SYSNOTICE_UPDATE,this._noticeDatas),r&&this.pushNotify(this.__class.ON_ANNOUNCE_UPDATE,this._annouDatas)},a.pushNotices=function(t){for(var e=0;e<t.length;++e){var r=t[e];r[gc.dsConsts.ChatData.uniqueId]+="::getnewlist",this._noticeDatas.push(r)}this.pushNotify(this.__class.ON_SYSNOTICE_UPDATE,this._noticeDatas)},a.getSysNoticeStr=function(t){var e=(t[gc.dsConsts.ChatData.type],""),r=t[gc.dsConsts.ChatData.sysArgs],i=mo.getJSONWithFileNameAndID(gc.cfg_c_chatSys,r[0]);return 1==r.length?e=mo.STR.format(i[gc.c_chatSys_text]):2==r.length?e=mo.STR.format(i[gc.c_chatSys_text],r[1]):3==r.length?e=mo.STR.format(i[gc.c_chatSys_text],r[1],r[2]):4==r.length?e=mo.STR.format(i[gc.c_chatSys_text],r[1],r[2],r[3]):5==r.length?e=mo.STR.format(i[gc.c_chatSys_text],r[1],r[2],r[3],r[4]):6==r.length?e=mo.STR.format(i[gc.c_chatSys_text],r[1],r[2],r[3],r[4],r[5]):7==r.length?e=mo.STR.format(i[gc.c_chatSys_text],r[1],r[2],r[3],r[4],r[5],r[6]):8==r.length&&(e=mo.STR.format(i[gc.c_chatSys_text],r[1],r[2],r[3],r[4],r[5],r[6],r[7])),e},a.getBugChatStr=function(e){var r=e[gc.dsConsts.ChatData.userArgs],i=r[0],a=r[1];return a=a.replace(/\n/g,","),r[0]==t.userCtrl.getName()?mo.STR.format("[ubb color=0xf7d26e]%s: %s[/ubb]",i,a):mo.STR.format("[ubb color=0xec964a]%s: %s[/ubb]",i,a)},a.sendBugChat=function(e,r,i){var a=this,s=mo.getJSONWithFileName(gc.cfg_c_game),n=s[gc.id_c_game.fuckWord][0].split(","),o=s[gc.id_c_game.chatCfg][1],c=s[gc.id_c_game.chatCfg][3];if(null==e||""==e)return mo.showMsg(gc.id_c_msgCode.noWord);if(mo.STR.getStringLength(e)>c)return mo.showMsg(gc.id_c_msgCode.wordTooLong);if(mo.STR.checkSensitiveWord(e,n))return mo.showMsg(gc.id_c_msgCode.wordIllegal);if(a._lastBugSendTime&&a._lastBugSendTime.getSecondsBetween(Date.newDate())<o)return mo.showMsg(gc.id_c_msgCode.wordTooFast);a._lastBugSendTime=Date.newDate();var g=gc.iface.h_kefu_sendData_args,l={};l[g.lastId]=this._lastBugChatId,l[g.content]=e,l[g.openId]=t.accountCtrl.get(gc.dsConsts.AccountEntity.sdkData).open_id,l[g.nickname]=t.userCtrl.getName(),l[g.vipLevel]=t.userCtrl.getVip(),mo.requestWaiting4Server(gc.iface.h_kefu_sendData,l,function(t){a._updateBugChatData(t),r.call(i)})},r.ON_BUGCHAT_UPDATE="ON_BUGCHAT_UPDATE",r.ON_NEWBUGCHAT_RECEIVED="ON_NEWBUGCHAT_RECEIVED",r.ON_ANNOUNCE_UPDATE="ON_ANNOUNCE_UPDATE",r.ON_SYSNOTICE_UPDATE="ON_SYSNOTICE_UPDATE",r}(mo.DataController);t.HoodinnCtlr=e,egret.registerClass(e,"gd.HoodinnCtlr"),t.hoodinnCtlr=new e}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.HeartStuntEntity},a.initData=function(t){if(t){var e=this;e.init(t)}},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.getOpenCon=function(e){var r=mo.getJSONWithFileName(gc.cfg_c_open),i=(t.userCtrl.getVip(),[]),a="heartStunt"+(parseInt(e)+1).toString(),s="vip"+a;if(0==e)return[r[gc.id_c_open.heartStunt1][gc.c_open_lvlRequired],0];if(!r[gc.id_c_open[a]]||!r[gc.id_c_open[s]])return i;var n=r[gc.id_c_open[a]][gc.c_open_lvlRequired],o=r[gc.id_c_open[s]][gc.c_open_lvlRequired];return i[0]=n,i[1]=o,i},a.getHeartStuntArr=function(t){var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_heartStunt,t),i=parseInt(r[gc.c_heartStunt_layer]),a=parseInt(r[gc.c_heartStunt_series]),s=[-1];if(!e.getData())return s;for(var n=-1,o=e.get(gc.dsConsts.HeartStuntEntity.stateArr)||[],c=e.get(gc.dsConsts.HeartStuntEntity.heartLvlArr)||[],g=0;g<o.length;g++)o[g]==t&&(n=c[g]);if(s[0]=n,0==n)return[0,1,0];if(n>0){var l=n%a;s[1]=(n-l)/a+1,s[2]=l,s[1]>i&&(s[1]=i,s[2]=a)}return s},a.getInfo=function(e,r){var i=this;if(i.getData())return e.call(r,i.getData());var a=mo.getJSONWithFileName(gc.cfg_c_open),s=t.userCtrl.getLvl(),n=a[gc.id_c_open.heartStunt1][gc.c_open_lvlRequired];return n>s?mo.showMsg(gc.id_c_msgCode.noRoleLvl,n):void mo.request4Server(gc.iface.a_heartStunt_getInfo,{},function(t){i.getData()?i.updateEntity(t):i.init(t),e.call(r,t)})},a.choMenCulMethods=function(e,r,i,a){var s=this,n=gc.iface.a_heartStunt_choMenCulMethods_args,o={};o[n.index]=e,o[n.heartStuntId]=r,mo.requestWaiting4Server(gc.iface.a_heartStunt_choMenCulMethods,o,function(e){var r=e[gc.dsConsts.ExHeartStuntData.heartStuntData],n=e[gc.dsConsts.ExHeartStuntData.userData];t.userCtrl.updateEntity(n),s.updateEntity(r),t.heroCtrl.calPropAndCombat(),t.heroCtrl.calSkill(),i.call(a,r)})},a.stuMenCulMethods=function(e,r,i){var a=this,s=gc.iface.a_heartStunt_stuMenCulMethods_args,n={};n[s.index]=e,mo.requestWaiting4Server(gc.iface.a_heartStunt_stuMenCulMethods,n,function(e){var s=e[gc.dsConsts.ExHeartStuntData.heartStuntData],n=e[gc.dsConsts.ExHeartStuntData.userData],o=e[gc.dsConsts.ExHeartStuntData.isSucceed],c=e[gc.dsConsts.ExHeartStuntData.genuineQiArr];c.length>0&&(t.demonLotusCtrl._genuineQi=parseInt(c[0]),t.demonLotusCtrl._lastUpTime=Date.newDate().toString()),t.userCtrl.updateEntity(n),a.updateEntity(s),t.heroCtrl.calPropAndCombat(),t.heroCtrl.calSkill(),r.call(i,[o,s])})},a.chaMenCulMethods=function(e,r,i,a){var s=this,n=gc.iface.a_heartStunt_chaMenCulMethods_args,o={};o[n.index]=e,o[n.heartStuntId]=r;var c=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.heartStuntCfg);mo.showMsg(gc.id_c_msgCode.changeheartStunt,c[2],function(){mo.requestWaiting4Server(gc.iface.a_heartStunt_chaMenCulMethods,o,function(e){var r=e[gc.dsConsts.ExHeartStuntData.heartStuntData],n=e[gc.dsConsts.ExHeartStuntData.userData];t.userCtrl.updateEntity(n),s.updateEntity(r),t.heroCtrl.calPropAndCombat(),t.heroCtrl.calSkill(),i.call(a,r)})})},r}(mo.DataController);t.HeartStuntCtrl=e,egret.registerClass(e,"gd.HeartStuntCtrl"),t.heartStuntCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.FiveDaysTaret},a.initData=function(t){if(t){var e=this;e.init(t)}},a.getInfo=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_fiveDaysTarget_getInfo,{},function(i){r._day=i[gc.dsConsts.FiveDaysTaret.day],r._items=i[gc.dsConsts.FiveDaysTaret.items],t.call(e,i)})},a.getItemInfoByDay=function(e){var i=this;if(e<i._items.length){var a=i._items[e],s=a[gc.dsConsts.ExFiveDaysTargetData.value],n=-1,o=t.activityCtrl.getFiveTargetActivity(),c=t.activityCtrl.getActivityValue(o,gc.dsConsts.ActivityEntity.id),g=t.userCtrl.getActivity()||{},l=g[c]||[],_=0;if(_=l[e]||-1,_>0)return[_,a[gc.dsConsts.ExFiveDaysTargetData.rank],e];var u=i.getCurActDay();if(u>=i.__class.MAX_DAY)return[-2,a[gc.dsConsts.ExFiveDaysTargetData.rank],e];var d=r.FIVE_TASK[e];if(!d)return[-1,[],e];var p=mo.getJSONWithFileNameAndID(gc.cfg_c_task,d),m=p[gc.c_task_targetValue];switch(e){case 0:t.userCtrl.getCombat()>=m&&(n=0);break;case 1:var f=t.heroCtrl.getHeroMap(),h=0;for(var y in f)h+=f[y].wingData[1];h>=m&&(n=0);break;case 2:var C=t.userCtrl.getExData(),v=C[gc.c_prop.userExDataKey.arenaCount]||0;v>=m&&(n=0);break;case 3:s>=m&&(n=0);break;case 4:return[-1,[],e]}return[n,a[gc.dsConsts.ExFiveDaysTargetData.rank],e]}return[-1,[],e]},a.getNormalTargetInfo=function(e){var r=t.fiveDaysTargetCtrl.getItemInfoByDay(e)[0],i=r>=0,a=-2==r,s=0==r,n=1==r;return[i,s,n,a]},a.getRankList=function(e){for(var r=t.fiveDaysTargetCtrl.getItemInfoByDay(e)[1],i=[],a=0,s=3;s>a;a++)i[a]=null,r[a]&&(i[a]=r[a]);return i},a.receive=function(e,r,i){var a=this,s=a.getCurActDay();if(e>s)return mo.showMsg(gc.id_c_msgCode.eventNoStart);var n=a.getNormalTargetInfo(e),o=n[0],c=n[3];if(!o)return c?mo.showMsg(gc.id_c_msgCode.activitiesEnd):mo.showMsg(gc.id_c_msgCode.goalNotGet);var g=t.activityCtrl.getFiveTargetActivity();t.activityCtrl.receive(t.activityCtrl.getActivityValue(g,gc.dsConsts.ActivityEntity.id),e,function(){a.pushNotify(a.__class.ON_RECEIVED,e),r.call(i,e)},a)},a.getActivityStartTime=function(){var e=t.activityCtrl.getFiveTargetActivity(),r=e[gc.dsConsts.ExActivity.activity];return r[gc.dsConsts.ActivityEntity.startTime]},a.getActivityEndTime=function(){var t=this,e=Date.newDate(t.getActivityStartTime());return e.addDays(t.__class.MAX_DAY),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e},a.getCurActDay=function(){var e=t.activityCtrl.getFiveTargetActivity();return e[gc.dsConsts.ExActivity.days]},a.isCertified=function(t){var e=this,r=e.getCurActDay();return r>t},a.isTodayTarget=function(t){var e=this,r=e.getCurActDay();return r==t},a.getCalTime=function(t){var e=this,r=Date.newDate(e.getActivityStartTime()),i=Date.newDate(r);return i.addDays(t+1),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i},a.getStarTime=function(t){var e=this,r=Date.newDate(e.getActivityStartTime()),r=r.addDays(t);return t>0&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0)),r},r.ON_RECEIVED="on_received",r.FIVE_TASK={0:"3100004",1:"3100002",2:"3100003",3:"3100005",4:"0"},r.MAX_DAY=4,r}(mo.DataController);t.FiveDaysTargetCtrl=e,egret.registerClass(e,"gd.FiveDaysTargetCtrl"),t.fiveDaysTargetCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.FiveDaysTaret},a.initData=function(t){if(t){var e=this;e.init(t)}},a.getInfo=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_fiveDaysTarget_getInfo1,{},function(i){r._day=i[gc.dsConsts.FiveDaysTaret.day],r._items=i[gc.dsConsts.FiveDaysTaret.items],t.call(e,i)})},a.getItemInfoByDay=function(e){var r=this;if(e<r._items.length){var i=r._items[e],a=(i[gc.dsConsts.ExFiveDaysTargetData.value],-1),s=t.activityCtrl.getNewFourActivity(),n=t.activityCtrl.getActivityValue(s,gc.dsConsts.ActivityEntity.id),o=t.userCtrl.getActivity()||{},c=o[n]||[],g=0;if(g=c[e]||-1,g>0)return[g,i[gc.dsConsts.ExFiveDaysTargetData.rank],e];var l=r.getCurActDay();if(l>=r.__class.MAX_DAY)return[-2,i[gc.dsConsts.ExFiveDaysTargetData.rank],e];var _=0,u=0,d=0,p=t.heroCtrl.getHeroMap();for(var m in p){var f=p[m];f.get(gc.dsConsts.HeroEntity.wingSumLvl)&&(_+=parseInt(f.get(gc.dsConsts.HeroEntity.wingSumLvl))),f.get(gc.dsConsts.HeroEntity.gemSumLvl)&&(u+=parseInt(f.get(gc.dsConsts.HeroEntity.gemSumLvl))),f.get(gc.dsConsts.HeroEntity.realmSumLvl)&&(d+=parseInt(f.get(gc.dsConsts.HeroEntity.realmSumLvl)))}_/=100,d/=100;var h=99999999,y=mo.getJSONWithFileName(gc.cfg_c_game),C=y[gc.id_c_game.newFourNeedValue];switch(e){case 0:h=C[0],_>=h&&(a=0);break;case 1:h=C[1],u>=h&&(a=0);break;case 2:h=C[2],d>=h&&(a=0);break;case 3:h=C[3],t.userCtrl.getCombat()>=h&&(a=0);break;case 4:return[-1,[],e]}return[a,i[gc.dsConsts.ExFiveDaysTargetData.rank],e]}return[-1,[],e]},a.getNormalTargetInfo=function(e){var r=t.newFourDaysCtrl.getItemInfoByDay(e)[0],i=r>=0,a=-2==r,s=0==r,n=1==r;return[i,s,n,a]},a.getRankList=function(e){for(var r=t.newFourDaysCtrl.getItemInfoByDay(e)[1],i=[],a=0,s=3;s>a;a++)i[a]=null,r[a]&&(i[a]=r[a]);return i},a.receive=function(e,r,i){var a=this,s=a.getCurActDay();if(e>s)return mo.showMsg(gc.id_c_msgCode.eventNoStart);var n=a.getNormalTargetInfo(e),o=n[0],c=n[3];if(!o)return c?mo.showMsg(gc.id_c_msgCode.activitiesEnd):mo.showMsg(gc.id_c_msgCode.goalNotGet);var g=t.activityCtrl.getNewFourActivity();t.activityCtrl.receive(t.activityCtrl.getActivityValue(g,gc.dsConsts.ActivityEntity.id),e,function(){a.pushNotify(a.__class.ON_RECEIVED,e),r.call(i,e)
},a)},a.getActivityStartTime=function(){var e=t.activityCtrl.getNewFourActivity(),r=e[gc.dsConsts.ExActivity.activity];return r[gc.dsConsts.ActivityEntity.startTime]},a.getActivityEndTime=function(){var t=this,e=Date.newDate(t.getActivityStartTime());return e.addDays(t.__class.MAX_DAY),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e},a.getCurActDay=function(){var e=t.activityCtrl.getNewFourActivity();return e[gc.dsConsts.ExActivity.days]},a.isCertified=function(t){var e=this,r=e.getCurActDay();return r>t},a.isTodayTarget=function(t){var e=this,r=e.getCurActDay();return r==t},a.getCalTime=function(t){var e=this,r=Date.newDate(e.getActivityStartTime()),i=Date.newDate(r);return i.addDays(t+1),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i},a.getStarTime=function(t){var e=this,r=Date.newDate(e.getActivityStartTime()),r=r.addDays(t);return t>0&&(r.setHours(0),r.setMinutes(0),r.setSeconds(0)),r},r.ON_RECEIVED="on_received",r.MAX_DAY=4,r}(mo.DataController);t.NewFourDaysCtrl=e,egret.registerClass(e,"gd.NewFourDaysCtrl"),t.newFourDaysCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._genuineQi=0,this._lastUpTime="",this._dlLastUpTime=""}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.DemonLotusEntity},a.initData=function(e){var r=mo.getJSONWithFileName(gc.cfg_c_open),i=t.userCtrl.getLvl(),a=r[gc.id_c_open.expBox][gc.c_open_lvlRequired];i>=a&&this.getInfo(function(){},this)},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.calGenuineQi=function(){var e=this,r=t.userCtrl.getData(),i=r[gc.dsConsts.UserEntity.exData]||{},a=t.demonLotusCtrl.getData(),s=mo.getJSONWithFileName(gc.cfg_c_genuineQi),n=mo.getJSONWithFileName(gc.cfg_c_demonLotus),o=mo.getJSONWithFileName(gc.cfg_t_talismanSkill),c=r[gc.dsConsts.UserEntity.lvl],g=0,l=0,_=Date.newDate(),u=e._genuineQi,d=Date.newDate(e._lastUpTime);if(!s[c]||e._lastUpTime.length<=0)return[g,l];var p=s[r[gc.dsConsts.UserEntity.lvl]][gc.c_genuineQi_recovery]||0;if(i[gc.c_prop.userExDataKey.talismanSkill]&&i[gc.c_prop.userExDataKey.talismanSkill][gc.c_prop.talismanSkillTypeKey.genuineQi])for(var m=i[gc.c_prop.userExDataKey.talismanSkill][gc.c_prop.talismanSkillTypeKey.genuineQi],f=0;f<m.length;f++){var h=m[f];o[h]&&(p+=o[h][gc.t_talismanSkill_effect][0][0])}r[gc.dsConsts.UserEntity.exData][gc.c_prop.userExDataKey.genuineQi]||(r[gc.dsConsts.UserEntity.exData][gc.c_prop.userExDataKey.genuineQi]=[]);var y=r[gc.dsConsts.UserEntity.exData][gc.c_prop.userExDataKey.genuineQi];y[0]||(r[gc.dsConsts.UserEntity.exData][gc.c_prop.userExDataKey.genuineQi][0]=Date.newDate());var C=(_.getTime()-d.getTime())/1e3;0>C&&(C=0),g=Math.ceil(C*p)+u;var v=0;a&&(v=a[gc.dsConsts.DemonLotusEntity.advanceLvl]);var I=n[v][gc.c_demonLotus_genqiAccLimit];return l=parseInt(s[c][gc.c_genuineQi_genuLimit])+I,g>l&&(g=l>u?l:u),[g,l,p]},a.isMaxExpc=function(){var t=this,e=t.calNowGet(),r=t.getExpcLimit();return e>=r},a.getExpcLimit=function(){var e=mo.getJSONWithFileName(gc.cfg_c_lvl),r=mo.getJSONWithFileName(gc.cfg_c_demonLotus),i=t.demonLotusCtrl.getData(),a=i[gc.dsConsts.DemonLotusEntity.lvl],s=i[gc.dsConsts.DemonLotusEntity.advanceLvl]||0,n=parseInt(e[a][gc.c_lvl_storeLimit]);return n+=parseInt(r[s][gc.c_demonLotus_expcAccLimit])},a.calNowGet=function(){var e=this,r=0,i=mo.getJSONWithFileName(gc.cfg_c_lvl),a=mo.getJSONWithFileName(gc.cfg_c_demonLotus),s=t.demonLotusCtrl.getData(),n=Date.newDate(),o=s[gc.dsConsts.DemonLotusEntity.lvl],c=s[gc.dsConsts.DemonLotusEntity.advanceLvl]||0,g=parseInt(s[gc.dsConsts.DemonLotusEntity.addUpExpc]),l=e._dlLastUpTime,_=parseInt(i[o][gc.c_lvl_expOutput]);_+=parseInt(a[c][gc.c_demonLotus_expOutput]);var u=parseInt(i[o][gc.c_lvl_storeLimit]);u+=parseInt(a[c][gc.c_demonLotus_expcAccLimit]);var d=0;if(u>g&&l&&n>Date.newDate(l)){var p=(n.getTime()-Date.newDate(l).getTime())/1e3;p>1&&(d=Math.round(_*p))}var m=g+d;return r=m,m>u&&(r=u),t.pointCtrl.cal(gc.c_prop.pointRedKey.demonLotus_main),r},a.getInfo=function(e,r){var i=this;if(i.getData())return e.call(r,[!1,!1,i.getData()]);var a=mo.getJSONWithFileName(gc.cfg_c_open),s=t.userCtrl.getLvl(),n=a[gc.id_c_open.expBox][gc.c_open_lvlRequired];return n>s?mo.showMsg(gc.id_c_msgCode.noRoleLvl,n):void mo.request4Server(gc.iface.a_demonLotus_getInfo,{},function(t){var a=t[gc.dsConsts.ExDemonLotusData.isWeek],s=t[gc.dsConsts.ExDemonLotusData.isMonth],n=t[gc.dsConsts.ExDemonLotusData.demonLotusData],o=t[gc.dsConsts.ExDemonLotusData.genuineQiArr];i._dlLastUpTime=Date.newDate().toString(),o.length>0&&(i._genuineQi=parseInt(o[0]),i._lastUpTime=Date.newDate().toString()),i.getData()?i.updateEntity(n):i.init(n),e.call(r,[a,s,n])})},a.upLotus=function(e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_c_lvl),s=mo.getJSONWithFileName(gc.cfg_c_game),n=i.get(gc.dsConsts.DemonLotusEntity.lvl),o=s[gc.id_c_game.demonLotusCfg][0],c=s[gc.id_c_game.demonLotusCfg][1];if(n>=c)return mo.showMsg("等级已达上限");var g=a[n+1][gc.c_lvl_upLotusNum],l=t.userCtrl.getItemNum(o);return g>l?void g_base.GainWay.create().setData({itemId:o}).show():void mo.requestWaiting4Server(gc.iface.a_demonLotus_upLotus,{},function(a){var s=a[gc.dsConsts.ExDemonLotusData.demonLotusData],n=a[gc.dsConsts.ExDemonLotusData.delBagItems],o=t.userCtrl.getData(),c=t.userUtils.getNewBag(n,{});o[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntity(o),i.updateEntity(s),i._dlLastUpTime=Date.newDate().toString(),e.call(r,s)})},a.getRevenue=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_demonLotus_getRevenue,{},function(a){var s=a[gc.dsConsts.ExDemonLotusData.expSum];s>0&&g_msg.UIMsgTextCtrl.push("获得经验："+s);var n=a[gc.dsConsts.ExDemonLotusData.demonLotusData],o=a[gc.dsConsts.ExDemonLotusData.userData];t.userCtrl.updateEntity(o),i.updateEntity(n),i._dlLastUpTime=Date.newDate().toString(),t.pointCtrl.cal(gc.c_prop.pointRedKey.demonLotus_main),e.call(r,n)})},a.getOpeningCount=function(){return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.opening)||0},a.opening=function(e,r){mo.requestWaiting4Server(gc.iface.a_demonLotus_opening,{},function(i){var a=i[gc.dsConsts.Opening.diffExp]||0;a>0&&g_msg.UIMsgTextCtrl.push("获得经验："+Math.floor(a));var s=i[gc.dsConsts.Opening.userData]||{};t.userCtrl.updateEntity(s),e.call(r,i)})},a.lotusAdvance=function(e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_c_demonLotus),s=i.get(gc.dsConsts.DemonLotusEntity.lvl),n=gc.c_prop.spItemIdKey.lotus,o=parseInt(i.get(gc.dsConsts.DemonLotusEntity.advanceLvl))||0;if(!a[o+1])return mo.showMsg("进阶等级已达上限");var c=a[o][gc.c_demonLotus_advNeedLvl];if(c>s)return mo.showMsg(c+"级可进阶");var g=a[o][gc.c_demonLotus_advCosLotus],l=t.userCtrl.getItemNum(n);return g>l?void g_base.GainWay.create().setData({itemId:n}).show():void mo.requestWaiting4Server(gc.iface.a_demonLotus_lotusAdvance,{},function(a){var s=a[gc.dsConsts.ExDemonLotusData.isSucceed],n=a[gc.dsConsts.ExDemonLotusData.demonLotusData],o=a[gc.dsConsts.ExDemonLotusData.delBagItems],c=t.userUtils.getNewBag(o,{});t.userCtrl.set(gc.dsConsts.UserEntity.bag,c),i.updateEntity(n),e.call(r,[s,n])})},a.isCanTrain=function(){var e=this,r=t.userCtrl.getLvl(),i=mo.getJSONWithFileName(gc.cfg_c_demonLotus),a=gc.c_prop.spItemIdKey.lotus,s=parseInt(e.get(gc.dsConsts.DemonLotusEntity.treasureLvl))||0;if(!i[s][gc.c_demonLotus_treaCosGenqi])return!1;var n=i[s][gc.c_demonLotus_treaNeedUserLvl];if(n>r)return!1;var o=i[s][gc.c_demonLotus_treaCosLotus],c=i[s][gc.c_demonLotus_treaCosGenqi],g=t.userCtrl.getItemNum(a);if(o>g)return!1;var l=e.calGenuineQi();return l[0]<c?!1:!0},a.treasureTrain=function(e,r){var i=this,a=mo.getJSONWithFileName(gc.cfg_c_demonLotus),s=gc.c_prop.spItemIdKey.lotus,n=t.userCtrl.getLvl(),o=(parseInt(i.get(gc.dsConsts.DemonLotusEntity.advanceLvl))||0,parseInt(i.get(gc.dsConsts.DemonLotusEntity.treasureLvl))||0);if(!a[o][gc.c_demonLotus_treaCosGenqi])return mo.showMsg("妖莲宝物等级已达上限");var c=a[o][gc.c_demonLotus_treaNeedUserLvl];if(c>n)return mo.showMsg("人物升至"+c+"级后可培养莲宝");var g=a[o][gc.c_demonLotus_treaCosLotus],l=t.userCtrl.getItemNum(s);return g>l?void g_base.GainWay.create().setData({itemId:s}).show():void mo.requestWaiting4Server(gc.iface.a_demonLotus_treasureTrain,{},function(a){var s=a[gc.dsConsts.ExDemonLotusData.isSucceed],n=a[gc.dsConsts.ExDemonLotusData.userData],o=a[gc.dsConsts.ExDemonLotusData.demonLotusData],c=a[gc.dsConsts.ExDemonLotusData.delBagItems],g=a[gc.dsConsts.ExDemonLotusData.genuineQiArr];g.length>0&&(i._genuineQi=parseInt(g[0]),i._lastUpTime=Date.newDate().toString());var l=t.userUtils.getNewBag(c,{});n[gc.dsConsts.UserEntity.bag]=l,t.userCtrl.updateEntity(n),i.updateEntity(o),t.heroCtrl.calPropAndCombat(),t.pointCtrl.cal(gc.c_prop.pointRedKey.demonLotus_main),e.call(r,[s,o])})},a._getOpenConNum=function(){var e=t.userCtrl.get(gc.dsConsts.UserEntity.record),r=e[gc.c_prop.userRecordTypeKey.demonLotusOpenNum]||0,i=e[gc.c_prop.userRecordTypeKey.demonLotusOpenDate]||Date.newDate();return i=Date.newDate(i),i.getDaysBetween(Date.newDate())>1&&(r=0),r},a._getOpenExpc=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,t.get(gc.dsConsts.DemonLotusEntity.lvl)),r=(mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.demonLotusCfg),e[gc.c_lvl_openingExp]||0),i=t._getAddMult();return r+=Math.floor(r*i/1e4)},a._getAddMult=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.demonLotusCfg),r=e[4],i=e[5],a=t._getOpenConNum(),s=r*a;return s>=i&&(s=i),s},a._getOpenCost=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.demonLotusCfg),r=e[3];r=r.split(",");var i=parseInt(r[t.getOpeningCount()]||0);return 0>=i&&(i=r[r.length-1]),i},a.getOpeningData=function(){var e=this,r={},i=t.userCtrl.getVip(),a=mo.getJSONWithFileNameAndID(gc.cfg_c_vip,i),s=a[gc.c_vip_openingCount]||0,n=s-e.getOpeningCount();n=n>=0?n:0;var o=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.demonLotusCfg),c=(mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,e.get(gc.dsConsts.DemonLotusEntity.lvl)),e._getOpenCost());return r={lotusLvl:e.get(gc.dsConsts.DemonLotusEntity.lvl)||0,vip:t.userCtrl.getVip(),openingCount:s,cost:c||0,exp:e._getOpenExpc(),leftNum:n,conDays:e._getOpenConNum(),addMult:e._getAddMult(),maxMult:o[5]}},r}(mo.DataController);t.DemonLotusCtrl=e,egret.registerClass(e,"gd.DemonLotusCtrl"),t.demonLotusCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this._lastId=0,this._allList=[],this._allCanGetList=[],this._allName={},this.DATA_KEY=gc.dsConsts.RedEnvelopeEntity},a.initData=function(t){if(t){var e=this;e.init(t)}},a.updateData=function(t){var e=this,r=t[gc.dsConsts.RedEnvelopeEntity.id],i=e._allList;for(var a in i)r==i[a][gc.dsConsts.RedEnvelopeEntity.id]&&(e._allList[a]=t)},a.getLastId=function(){return this._lastId},a.isPicked=function(e){for(var r=!1,i=t.userCtrl.getId(),a=0;a<e.length;a++)if(e[a][1]==i){r=!0;break}return r},a.getNameById=function(t){return this._allName[t]||""},a.getList=function(t,e){mo.request4Server(gc.iface.a_redEnvelope_getList,{},function(r){t.call(e,r)})},a.sendRedEnvelope=function(e,r,i,a,s,n,o){var c=this,g=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.fuckWord)[0].split(","),l=mo.getJSONWithFileName(gc.cfg_c_game),_=t.userCtrl.getDiamond(),u=l[gc.id_c_game.redEnvelopeCfg][0],d=l[gc.id_c_game.redEnvelopeCfg][1];if(i>_)return mo.showMsg(gc.id_c_msgCode.noDiamond);if(u>i)return mo.showMsg(gc.id_c_msgCode.packetMin20);if(d>a)return mo.showMsg("元宝分配份数低于最小值");if(s.replace(/[^\x00-\xFF]/g,"**").length>50)return mo.showMsg("红包祝福最多25字！");if(mo.STR.checkSensitiveWord(s,g))return mo.showMsg("输入祝福内容不合法");var p=gc.iface.a_redEnvelope_sendRedEnvelope_args,m={};m[p.type]=e,m[p.amount]=i,m[p.personNum]=a,m[p.wish]=s,m[p.spItemId]=r,mo.requestWaiting4Server(gc.iface.a_redEnvelope_sendRedEnvelope,m,function(e){var r=e[gc.dsConsts.ExRedEnvelopeData.userData]||{},i=e[gc.dsConsts.ExRedEnvelopeData.redEnvelopeData]||{},a=e[gc.dsConsts.ExRedEnvelopeData.redEnvelopePersonalData]||{};t.redEnvelopePersonalCtrl.getData()?t.redEnvelopePersonalCtrl.updateEntity(a):t.redEnvelopePersonalCtrl.init(a),t.userCtrl.updateEntity(r),c.updateData(i),n.call(o,i)})},a.receiveBonus=function(e,r,i){var a=this,s=gc.iface.a_redEnvelope_receiveBonus_args,n={};n[s.redEnvelopeId]=e,mo.requestWaiting4Server(gc.iface.a_redEnvelope_receiveBonus,n,function(e){var s=e[gc.dsConsts.ExRedEnvelopeData.isGet],n=e[gc.dsConsts.ExRedEnvelopeData.userData]||{};t.userCtrl.updateEntity(n);var o={};if(s){o=e[gc.dsConsts.ExRedEnvelopeData.redEnvelopeData]||{};var c=e[gc.dsConsts.ExRedEnvelopeData.redEnvelopePersonalData]||{};t.redEnvelopePersonalCtrl.getData()?t.redEnvelopePersonalCtrl.updateEntity(c):t.redEnvelopePersonalCtrl.init(c);for(var g=0;g<a._allList.length;++g)a._allList[g][gc.dsConsts.RedEnvelopeEntity.id]==o[gc.dsConsts.RedEnvelopeEntity.id]&&a._allList.splice(g--,1);a.onNewAll(),r.call(i,o)}else mo.showMsg("该红包已经被领光了")})},a.syncRedEnvelope=function(t,e){mo.request4Server(gc.iface.a_redEnvelope_syncRedEnvelope,{},function(r){t.call(e,r)})},a.syncData=function(){var t=this,e=gc.iface.a_redEnvelope_getNewList_args,r={};r[e.lastId]=t._lastId,mo.request4Server(gc.iface.a_redEnvelope_getNewList,r,function(e){var r=e[gc.dsConsts.ExRedEnvelopeData.redEnvelopeData]||{};t._allName=e[gc.dsConsts.ExRedEnvelopeData.nameObj]||{},t._updateData(r),t.onNewAll()})},a.getCanGetList=function(){return this._allCanGetList},a.onNewAll=function(){for(var t=this,e=!1,r=!1,i=Date.newDate(),a=0;a<this._allCanGetList.length;++a)-1==this._allList.indexOf(this._allCanGetList[a])&&(r=!0,this._allCanGetList.splice(a--,1));for(var a=0;a<this._allList.length;++a){var s=this._allList[a],n=Date.newDate(s[gc.dsConsts.RedEnvelopeEntity.addTime]);i.getTime()-n.getTime()>=15e3&&(e||(e=!0,this._allCanGetList=[]),this._allCanGetList.push(s))}this._allCanGetList.length==this._allList.length&&this.startCheckCanGet(!1),(e||r)&&t.pushNotify(t.__class.ON_REDENVELOPE_UPDATE,t.getCanGetList())},a.startCheckCanGet=function(t){egret.clearInterval(this.checkTimeId),t&&(this.checkTimeId=egret.setInterval(function(){this.onNewAll()},this,500))},a.needToDel=function(){for(var t=this,e=t._allList,r=Date.newDate(),i=0;i<e.length;++i){var a=e[i],s=a[gc.dsConsts.RedEnvelopeEntity.expireTime];s&&(Date.newDate(s).isBefore(r)||Date.newDate(s).equals(r))&&t._allList.splice(i--,1)}t.onNewAll()},a._updateData=function(t){var e=this,r={};e._allList.length=0;for(var i=0;i<t.length;i++){var a=t[i];r[0]=1,e._pushAllList(a),e._lastId=a[gc.dsConsts.RedEnvelopeEntity.id]}e.startCheckCanGet(e._allList.length>0)},a._pushAllList=function(t){var e=this;e._allList.push(t)},r.ON_REDENVELOPE_UPDATE="ON_REDENVELOPE_UPDATE",r}(mo.DataController);t.RedEnvelopeCtrl=e,egret.registerClass(e,"gd.RedEnvelopeCtrl"),t.redEnvelopeCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.RedEnvelopePersonalEntity},a.initData=function(t){if(t){var e=this;e.init(t)}},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.getGetData=function(){},a.getDayCount=function(e){var r=this,i=[],a=t.userCtrl.getVip();i[0]=a;var s=mo.getJSONWithFileName(gc.cfg_c_vip),n={},o=r.get(gc.dsConsts.RedEnvelopePersonalEntity.lastSendTime);if(o&&Date.newDate(o).equalsDay(Date.newDate())&&(n=r.get(gc.dsConsts.RedEnvelopePersonalEntity.exData)),e==gc.c_prop.redEnvelopeTypeKey.comRed){var c=s[a][gc.c_vip_worldCount];i[2]=c;var g=n[gc.c_prop.redEnvelopeTypeKey.comRed]||[0];i[1]=c-g[0]}else if(e==gc.c_prop.redEnvelopeTypeKey.guildRed){var c=s[a][gc.c_vip_guildCount];i[2]=c;var l=n[gc.c_prop.redEnvelopeTypeKey.guildRed]||[0];i[1]=c-l[0]}else i[2]=0,i[1]=0;return i},a.getDayShare=function(){var e=this,r=t.userCtrl.getVip(),i=mo.getJSONWithFileName(gc.cfg_c_vip),a=i[r][gc.c_vip_redEnvelopeCount];if(!e.getData())return a;if(-1==a)return a;var s=e.get(gc.dsConsts.RedEnvelopePersonalEntity.lastSendTime);if(!s)return a;if(s&&Date.newDate(s).equalsDay(Date.newDate())){var n=e.get(gc.dsConsts.RedEnvelopePersonalEntity.sendCount)||0;a-=n}return a},a.getInfo=function(e,r){var i=this;return t.guildPersonalCtrl.getData()&&i.getData()?e.call(r,i.getData()):void mo.requestWaiting4Server(gc.iface.a_redEnvelopePersonal_getInfo,{},function(a){var s=a[gc.dsConsts.ExRedEnvelopeData.guildPersonalData]||{},n=a[gc.dsConsts.ExRedEnvelopeData.redEnvelopePersonalData]||{};i.getData()?i.updateEntity(n):i.init(n),t.guildPersonalCtrl.getData()?t.guildPersonalCtrl.updateEntity(s):t.guildPersonalCtrl.init(s),e.call(r,n)})},r}(mo.DataController);t.RedEnvelopePersonalCtrl=e,egret.registerClass(e,"gd.RedEnvelopePersonalCtrl"),t.redEnvelopePersonalCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.King,this._isOpenBuff=!1},a.getInfo=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_king_getInfo,{},function(i){r.init(i),t&&t.call(e,i)})},a.setIsOpenBuff=function(t){var e=this;e._isOpenBuff;e._isOpenBuff!=t&&(e._isOpenBuff=t,e.pushNotify(e.__class.ON_KING_BUFF_CHANGE))},a.isOpenBuff=function(){return this._isOpenBuff},a.isKing=function(){var e=this,r=t.userCtrl.getId(),i=e.get(gc.dsConsts.King.kingId);return r==i?!0:!1},a.isKingInGuild=function(){var t=this,e=t.get(gc.dsConsts.King.kingGuildId);return e?!0:!1},a.getMyWelfare=function(){return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.getKingWelfare)},a.getMyWorshipNum=function(){return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.worShip)},a.getBuffReCd=function(){var t=this,e=t.get(gc.dsConsts.King.buffEndTime);if(!e)return 0;e=Date.newDate(e);var r=Date.newDate().getSecondsBetween(e);return 0>r&&(r=0),r},a.worship=function(e,r){var i=this;mo.requestWaiting4Server(gc.iface.a_king_worship,{},function(a){var s=a[gc.dsConsts.ExKing.king];i.updateEntity(s);var n=a[gc.dsConsts.ExKing.userData],o=a[gc.dsConsts.ExKing.bagItems],c=t.userUtils.getNewBag({},o);n[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntity(n),e&&e.call(r)})},a.receiveWelfare=function(e,r){mo.requestWaiting4Server(gc.iface.a_king_receiveWelfare,{},function(i){var a=i[gc.dsConsts.ExKing.userData],s=i[gc.dsConsts.ExKing.bagItems],n=t.userUtils.getNewBag({},s);a[gc.dsConsts.UserEntity.bag]=n,t.userCtrl.updateEntity(a),e&&e.call(r)})},a.openBuff=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_king_openBuff,{},function(i){r.updateEntity(i),t&&t.call(e)})},a.getBuffOpenNum=function(){var t=this,e=t.get(gc.dsConsts.King.buffOpenTime),r=t.get(gc.dsConsts.King.buffOpenNum);return e=Date.newDate(e),e&&!e.equalsDay(Date.newDate())&&(e=Date.newDate(),r=0),r},a.getKingData=function(){var t,e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.king);return t={kingGuildName:e.get(gc.dsConsts.King.kingGuildName),kingVip:e.get(gc.dsConsts.King.kingVip),kingLvl:e.get(gc.dsConsts.King.kingLvl),kingName:e.get(gc.dsConsts.King.kingName),beWorshipNum:e.get(gc.dsConsts.King.beWorshipNum),beWorshipCount:e.get(gc.dsConsts.King.beWorshipCount),buffOpenNum:e.getBuffOpenNum(),avatarData:e.get(gc.dsConsts.King.kingHeroDisplay),buffEndCD:e.getBuffReCd(),buffOpenNeedNum:r[1],dayBuffOpenNum:r[3]}},a.isInSameGuild=function(){var t=this;return t.isKingInGuild()?t.get(gc.dsConsts.King.kingGuildId)==t.get(gc.dsConsts.King.myGuildId):!1},a.getWelfareItemList=function(){for(var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.king),e=t[2],r=e.split(";"),i=[],a=0;a<r.length;++a){var s=r[a].split(",");i.push({itemId:s[0],count:s[1]})}return i},a.getWorshipItemList=function(){for(var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.king),e=t[0],r=e.split(";"),i=[],a=0;a<r.length;++a){var s=r[a].split(",");i.push({itemId:s[0],count:s[1]})}return i},a.getBuffData=function(){var t=this,e=t.getKingBuffId(),r=mo.getJSONWithFileNameAndID(gc.cfg_t_otherBuff,e);if(!r)return null;var i={name:r[gc.t_otherBuff_name],addHurt:r[gc.t_otherBuff_addHurt],conTime:r[gc.t_otherBuff_conTime]/60,icon:r[gc.t_otherBuff_icon],des:r[gc.t_otherBuff_des]};return i},a.getKingBuffId=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.king);return t[4]},a.getCloakProAdd=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.challengeCupCfg);return t[11]},r.ON_KING_BUFF_CHANGE="ON_KING_BUFF_CHANGE",r}(mo.DataController);t.KingCtrl=e,egret.registerClass(e,"gd.KingCtrl")}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.rebirth=function(e,r){mo.requestWaiting4Server(gc.iface.a_rebirth_rebirth,{},function(i){var a=i[gc.dsConsts.Rebirth.userData]||{},s=i[gc.dsConsts.Rebirth.heroList]||{};t.userCtrl.updateEntity(a);for(var n=0;n<s.length;n++){var o=s[n],c=o[gc.dsConsts.HeroEntity.tempId];t.heroCtrl.getHeroByJob(c);t.heroCtrl.getHeroByJob(c).updateEntity(o)}e.call(r,i)})},this.buyRebirth=function(e,r,i,a){var s=gc.iface.a_rebirth_buyRebirth_args,n={};n[s.index]=e,n[s.num]=r,mo.requestWaiting4Server(gc.iface.a_rebirth_buyRebirth,n,function(e){var r=e[gc.dsConsts.ExUserData.userData]||{},s=e[gc.dsConsts.ExUserData.bagItems]||{},n=e[gc.dsConsts.ExUserData.equipBagItems]||{},o=t.userUtils.getNewBag({},s);r[gc.dsConsts.UserEntity.bag]=o;var c=t.userUtils.getNewEquipBag({},n);r[gc.dsConsts.UserEntity.equipBag]=c,t.userCtrl.updateEntity(r),i.call(a,e)})}}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.initData=function(t){if(t){var e=this;e.init(t)}},a.getRebirthLvl=function(){return t.userCtrl.get(gc.dsConsts.UserEntity.rebirthLvl)||0},a.getRebirthExp=function(){return Math.floor(t.userCtrl.get(gc.dsConsts.UserEntity.rebirthExp))},a.getBuyRebirthCount=function(e){switch(e){case 0:return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.buyPrimaryRebirth);case 1:return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.buyMidRebirth);case 2:return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.buyAdvancedRebirth)}return-1},a.getRebirthCfg=function(t){var e=mo.getJSONWithFileName(gc.cfg_t_rebirth),r=e[t];if(!r)return null;var i={rebirthLvl:r[gc.t_rebirth_rebirthLvl],lvl:r[gc.t_rebirth_lvl],limitLvl:r[gc.t_rebirth_limitLvl],exp:r[gc.t_rebirth_exp],maxHpTemp:r[gc.t_rebirth_maxHpTemp],attackTemp:r[gc.t_rebirth_attackTemp],defenceTemp:r[gc.t_rebirth_defenceTemp],magicDefenceTemp:r[gc.t_rebirth_magicDefenceTemp],hitTemp:r[gc.t_rebirth_hitTemp],dodgeTemp:r[gc.t_rebirth_dodgeTemp],criticalTemp:r[gc.t_rebirth_criticalTemp],disCriticalTemp:r[gc.t_rebirth_disCriticalTemp]};return i},a.getItems=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.rebirth),e=t[0].split(",");return e},a.getItemBagDataCtrl=function(e){var r=t.userCtrl.getBag(),i=t.BagDataCtrl.pileItems(r);for(var a in i){var s=i[a];if(s.tempId==e)return s}return null},a.getItemShopLeftNum=function(t){var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.rebirth),i=r[2].split(","),a=i[t]-e.getBuyRebirthCount(t);return a=a>=0?a:0},a.getItemShopData=function(t){var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.rebirth),i=r[0].split(","),a=r[1].split(","),s=[];return s[0]=i[t],s[1]=0,s[2]=2,s[3]=a[t],s[4]=e.getItemShopLeftNum(t),s},r}(mo.DataController);t.ReBirthCtrl=e,egret.registerClass(e,"gd.ReBirthCtrl"),t.reBirthCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.isOpen=!1}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this.DATA_KEY=gc.dsConsts.ChallengeCupData},a.initData=function(t){if(t){var e=this;e.init(t),e._initTrigger()}},a._initTrigger=function(){var t=this,e=t.DATA_KEY,r=t._data,i=r[e.activityLeftTime]+1,a=r[e.leftTime]+1;if(t.removeTrigger(),i>1){var s=Date.newDate(Date.newDate().getTime()+1e3*i),n=t.actTrigger=new tm.Trigger(s);n.on(tm.Trigger.ON_SECOND,function(){r[e.activityLeftTime]--},t),n.on(tm.Trigger.ON_END,t._onActEnd,t),tm.timer.add(n)}if(a>1){var s=Date.newDate(Date.newDate().getTime()+1e3*a),n=t.kingTrigger=new tm.Trigger(s);n.on(tm.Trigger.ON_SECOND,function(){r[e.leftTime]--},t),n.on(tm.Trigger.ON_END,t._onActEnd,t),tm.timer.add(n)}},a._onActEnd=function(){var e=this;e.removeTrigger(),t.fightCtrl.forceNormalCopy(),e.getInfo(function(t){e.pushNotify(e.__class.ON_ACT_END,t)},e)},a.removeTrigger=function(){var t=this;t.actTrigger&&(tm.timer.remove(t.actTrigger),t.actTrigger=null),t.kingTrigger&&(tm.timer.remove(t.kingTrigger),t.kingTrigger=null)},a.getInfo=function(t,e){var r=this;r._initGuild(function(){mo.requestWaiting4Server(gc.iface.a_challengeCup_getInfo,{},function(i){r.initData(i),t.call(e,i)})},r)},a._initGuild=function(e,r){t.guildCtrl.getData()?e.call(r):t.guildCtrl.getInfo(e,r)},a.getIsOpen=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_challengeCup_getIsOpen,{},function(i){r.isOpen=i[0],r.nextOpenTime=Date.newDate(i[2]),t.call(e)})},a.startFight=function(e,r){var i=this;if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(i.getOpenLvl()>t.userCtrl.getLvl())return mo.showMsg(gc.id_c_msgCode.noRoleLvl,i.getOpenLvl());var a=i.DATA_KEY,s=i._data,n=s[a.userId],o=gc.iface.a_challengeCup_startFight_args,c={};c[o.championUserId]=n,mo.requestWaiting4Server(gc.iface.a_challengeCup_startFight,c,function(a){var s=a[gc.dsConsts.ExChallengeCupFight.errCode];if(s)return void e.call(r,s);var n=a[gc.dsConsts.ExChallengeCupFight.userData];n&&t.userCtrl.updateEntity(n);for(var o=a[gc.dsConsts.ExChallengeCupFight.heroList],c=a[gc.dsConsts.ExChallengeCupFight.otherDataList],g=a[gc.dsConsts.ExChallengeCupFight.fightData],l=[],_=0;_<o.length;_++){var u=o[_],d=t.HeroEntityCtrl.createNewEnemy(u,g,c[_]);l.push(d)}l.sort(t.heroCtrl._sortHeroList),t.fightCtrl.isSpFighting=!0;var p=t.heroCtrl.getFightList();t.fightCtrl.startPvpFight(p,l,gc.c_prop.fightTypeKey.challengeCupPk,i._data[i.DATA_KEY.nickName]),e.call(r)})},a.endFight=function(t,e,r){var i=gc.iface.a_challengeCup_endFight_args,a={};a[i.isWin]=t;mo.request4Server(gc.iface.a_challengeCup_endFight,a,function(t){e.call(r,t)})},a.op=function(e,r,i){var a=this,s=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.challengeCupCfg),n=t.userCtrl.getVip(),o=t.userCtrl.getLvl(),c=s[17];if(0>=n&&(c>o||!t.guildCtrl.getData()))return mo.showMsg(gc.id_c_msgCode.noRightarena);var g=gc.iface.a_challengeCup_op_args,l={};l[g.op]=e,mo.request4Server(gc.iface.a_challengeCup_op,l,function(e){a.updateEntity(e);var n={},o=s[16];n[o]=1;var c=t.userUtils.getNewBag({},n),g={};g[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntity(g),r.call(i,e)})},a.getPropTotal=function(){var t=this.getPropAdd()+this.getPropDel();return t},a.getPropAdd=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.challengeCupCfg),e=t[12],r=t[13],i=this.get(gc.dsConsts.ChallengeCupData.upCount),a=e*i;return a>r&&(a=r),a},a.getPropDel=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.challengeCupCfg),e=t[14],r=t[15],i=this.get(gc.dsConsts.ChallengeCupData.downCount),a=e*i;return r>a&&(a=r),a},a.clearCd=function(e,r){mo.request4Server(gc.iface.a_challengeCup_clearCd,{},function(i){t.userCtrl.updateEntity(i),e.call(r,i)})},a.toBeChampoin=function(e,r){var i=this;return i.getOpenLvl()>t.userCtrl.getLvl()?mo.showMsg(gc.id_c_msgCode.noRoleLvl,i.getOpenLvl()):void mo.request4Server(gc.iface.a_challengeCup_toBeChampion,{},function(a){a[i.DATA_KEY.userId]!=t.userCtrl.getId()&&mo.showMsg(gc.id_c_msgCode.someoneHoldArena),i.initData(a),e.call(r,a)})},a.getRward=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.challengeCupCfg);return t[4].split(",")},a.getChallegeCost=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.challengeCupCfg);return t[9]},a.getFirstReward=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.challengeCupCfg);return t[5]},a.getDefTime=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.challengeCupCfg);return t[1]},a.getRank=function(t,e){var r=this;mo.request4Server(gc.iface.a_challengeCup_getDurationTimeRankList,{},function(i){r._myRank=i.pop(),t.call(e,i)})},a.getMyRank=function(){var t=this;return t._myRank},a.getRankReward=function(t){for(var e=mo.getJSONWithFileName(gc.cfg_c_challengeCupRankReward),r=null,i=1;50>i;i++){var a=e[i];if(!a)break;if(t>=a[gc.c_challengeCupRankReward_rangeStart]&&t<=a[gc.c_challengeCupRankReward_rangeEnd]){r=a;break}}if(r){var s=[gc.c_prop.spItemIdKey.gold,r[gc.c_challengeCupRankReward_gold]],n=r[gc.c_challengeCupRankReward_reward],o=[s];o=o.concat(n)}return o},a.getOpenLvl=function(){var t=mo.getJSONWithFileName(gc.cfg_c_open),e=t[gc.id_c_open.challengeCup];return e[gc.c_open_lvlRequired]},r.ON_ACT_END="on_act_end",r}(mo.DataController);t.ChallengeCupCtrl=e,egret.registerClass(e,"gd.ChallengeCupCtrl"),t.challengeCupCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.rebirth=function(e,r){mo.requestWaiting4Server(gc.iface.a_rebirth_rebirth,{},function(i){var a=i[gc.dsConsts.Rebirth.userData]||{},s=i[gc.dsConsts.Rebirth.heroList]||{};t.userCtrl.updateEntity(a);for(var n=0;n<s.length;n++){var o=s[n],c=o[gc.dsConsts.HeroEntity.tempId];t.heroCtrl.getHeroByJob(c);t.heroCtrl.getHeroByJob(c).updateEntity(o)}e.call(r,i)})},this.buyRebirth=function(e,r,i,a){var s=gc.iface.a_rebirth_buyRebirth_args,n={};n[s.index]=e,n[s.num]=r,mo.requestWaiting4Server(gc.iface.a_rebirth_buyRebirth,n,function(e){var r=e[gc.dsConsts.ExUserData.userData]||{},s=e[gc.dsConsts.ExUserData.bagItems]||{},n=e[gc.dsConsts.ExUserData.equipBagItems]||{},o=t.userUtils.getNewBag({},s);r[gc.dsConsts.UserEntity.bag]=o;var c=t.userUtils.getNewEquipBag({},n);r[gc.dsConsts.UserEntity.equipBag]=c,t.userCtrl.updateEntity(r),i.call(a,e)})}}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.initData=function(t){if(t){var e=this;e.init(t)}},a.getRebirthLvl=function(){return t.userCtrl.get(gc.dsConsts.UserEntity.rebirthLvl)||0},a.getRebirthExp=function(){return Math.floor(t.userCtrl.get(gc.dsConsts.UserEntity.rebirthExp))},a.getBuyRebirthCount=function(e){switch(e){case 0:return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.buyPrimaryRebirth);case 1:return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.buyMidRebirth);case 2:return t.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.buyAdvancedRebirth)}return-1},a.getRebirthCfg=function(t){var e=mo.getJSONWithFileName(gc.cfg_t_rebirth),r=e[t];if(!r)return null;var i={rebirthLvl:r[gc.t_rebirth_rebirthLvl],lvl:r[gc.t_rebirth_lvl],limitLvl:r[gc.t_rebirth_limitLvl],exp:r[gc.t_rebirth_exp],maxHpTemp:r[gc.t_rebirth_maxHpTemp],attackTemp:r[gc.t_rebirth_attackTemp],defenceTemp:r[gc.t_rebirth_defenceTemp],magicDefenceTemp:r[gc.t_rebirth_magicDefenceTemp],hitTemp:r[gc.t_rebirth_hitTemp],dodgeTemp:r[gc.t_rebirth_dodgeTemp],criticalTemp:r[gc.t_rebirth_criticalTemp],disCriticalTemp:r[gc.t_rebirth_disCriticalTemp]};return i},a.getItems=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.rebirth),e=t[0].split(",");return e},a.getItemBagDataCtrl=function(e){var r=t.userCtrl.getBag(),i=t.BagDataCtrl.pileItems(r);for(var a in i){var s=i[a];if(s.tempId==e)return s}return null},a.getItemShopLeftNum=function(t){var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.rebirth),i=r[2].split(","),a=i[t]-e.getBuyRebirthCount(t);return a=a>=0?a:0},a.getItemShopData=function(t){var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.rebirth),i=r[0].split(","),a=r[1].split(","),s=[];return s[0]=i[t],s[1]=0,s[2]=2,s[3]=a[t],s[4]=e.getItemShopLeftNum(t),s
},r}(mo.DataController);t.ReBirthCtrl=e,egret.registerClass(e,"gd.ReBirthCtrl"),t.reBirthCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.custing=!1}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.getCustomTicket=function(e){var r=[],i=mo.getJSONWithFileName(gc.cfg_c_customParameter),a=0;for(var s in i)if(a=t.userCtrl.getBag()[s]){if(null!=e&&i[s][gc.c_customParameter_color]!=e)continue;for(var n=0;a>n;n++)r.push(s)}return r},a.getCustomEquips=function(){var e=t.userCtrl.getEquipBag(),r=[];for(var i in e)t.equipCtrl.isCustomEquip(i)&&r.push(i);return r},a.canCustomTicket=function(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_c_customParameter,e);return r[gc.c_customParameter_gainType]>1?!0:t.userCtrl.getVip()>=r[gc.c_customParameter_vip]},a.isCustomRed=function(){var t=this,e=t.getCustomTicket();if(e.length>0)for(var r=0,i=e.length;i>r;r++)if(t.canCustomTicket(e[r]))return!0;for(var a=t.getCustomEquips(),r=0,i=a.length;i>r;r++){var s=t.getInheritedEquipOpt(a[r]);if(s.nextEquipNeedLvlEnough&&s.isItemEnough)return!0}return!1},a.getCustomListInfo=function(){var e=this,r=[],i=e.getCustomTicket();i.sort(function(t,r){var i=e.canCustomTicket(t)?0:-1,a=e.canCustomTicket(r)?0:-1;return i>a?-1:1});for(var a=0,s=i.length;s>a;a++)r.push({itemId:i[a]});var n=e.getCustomEquips();n.sort(function(r,i){var a=e.getInheritedEquipOpt(r).nextEquipNeedLvlEnough?1:-1,s=e.getInheritedEquipOpt(i).nextEquipNeedLvlEnough?1:-1;return a==s&&(t.equipCtrl.getEquipItemLvl(r)>=t.equipCtrl.getEquipItemLvl(i)?a-=1:s-=1),a>s?-1:1});for(var a=0,s=n.length;s>a;a++)r.push({equipId:n[a]});return r},a.getCustomLvlLimt=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_c_customParameter,t);return e[gc.c_customParameter_equip_lvl_range]},a.getTicketInfo=function(t,e,r){var i=this,a={};return a[gc.c_prop.heroJobKey.zs]=i.getCustomizationId(t,gc.c_prop.heroJobKey.zs,e,r),a[gc.c_prop.heroJobKey.fs]=i.getCustomizationId(t,gc.c_prop.heroJobKey.fs,e,r),a[gc.c_prop.heroJobKey.ds]=i.getCustomizationId(t,gc.c_prop.heroJobKey.ds,e,r),a},a.getExtrPropAddRatio=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.customizationCfg);return t[1]},a.getMaxCustomPropNum=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.customizationCfg);return t[12]},a.getCustomizationId=function(t,e,r,i){var a=e.toString(),s=mo.getJSONWithFileName(gc.cfg_c_customParameter),n=parseInt(s[t][gc.c_customParameter_color]);6==n&&(a=(parseInt(e)+3).toString());var o="9"+a+i.toString()+(10*Math.ceil(r/10)).toString();return parseInt(o)},a.customization=function(e,r,i,a,s,n,o,c){var g=this;if(1!=g.custing){var l=t.userCtrl.getBag(),_=mo.getJSONWithFileName(gc.cfg_c_game),u=mo.getJSONWithFileName(gc.cfg_t_itemEquip),d=_[gc.id_c_game.fuckWord][0].split(",");if(i.indexOf(" ")>=0)return mo.showMsg("名称不能包含空格");if(null==i||""==i)return mo.showMsg(gc.id_c_msgCode.noItemName);if(mo.STR.getStringLength(i)>12)return mo.showMsg(gc.id_c_msgCode.nameToolong);if(mo.STR.checkSensitiveWord(i,d))return mo.showMsg(gc.id_c_msgCode.fuckword);if(-1==_[gc.id_c_game.customizationCfg][3].indexOf(e.toString()))return mo.showMsg("定制凭证错误");var p=g.getCustomizationId(e,r,a,n);if(!u[p])return mo.showMsg("没有该定制装备");if(s.length-1!=g.getMaxCustomPropNum())return mo.showMsg(gc.id_c_msgCode.choseProperty,g.getMaxCustomPropNum());for(var m=u[p],f=m[gc.t_itemEquip_propertys],h=0;h<s.length;h++)if(!f[s[h]])return mo.showMsg("属性勾选出错");return l[e]&&0!=l[e]?void mo.showMsg(gc.id_c_msgCode.makeItem,function(){var l=mo.getJSONWithFileNameAndID(gc.cfg_t_item,p)[gc.t_item_level];t.userCtrl.getLvl()<l?mo.showMsg(gc.id_c_msgCode.makeLvlBigger,function(){g._doCustomization(e,r,i,a,s,n,o,c)}):g._doCustomization(e,r,i,a,s,n,o,c)}):mo.showMsg("缺少定制凭证")}},a._doCustomization=function(e,r,i,a,s,n,o,c){var g=this,l=gc.iface.a_equip_customization_args,_={};_[l.certificate]=e,_[l.job]=r,_[l.name]=i,_[l.lvl]=a,_[l.abilityIndex]=s,_[l.equipType]=n,g.custing=!0,mo.requestWaiting4Server(gc.iface.a_equip_customization,_,function(e){g.custing=!1;var r=e[gc.dsConsts.ExUserData.isMail];r&&mo.showMsg(gc.id_c_msgCode.bagMaxMail);var i={},a=e[gc.dsConsts.ExUserData.equipBagItems]||{},s=e[gc.dsConsts.ExUserData.delBagItems]||{},n=t.userUtils.getNewBag(s,{}),l=t.userUtils.getNewEquipBag({},a);i[gc.dsConsts.UserEntity.bag]=n,i[gc.dsConsts.UserEntity.equipBag]=l,t.userCtrl.updateEntity(i),o.call(c,e),g.pushNotify(g.__class.ON_CUSTOM),t.pointCtrl.cal(gc.c_prop.pointEffectKey.custom)})},a.upCustomization=function(e,r,i){var a=this,s=e.equipId,n=t.userCtrl.getEquipBag();if(!n[s])return mo.showMsg("背包没有该装备");if(e.isMaxLvl)return mo.showMsg("定制武器已升到最高级");if(!e.isItemEnough)return mo.showMsg("材料不足");var o=gc.iface.a_equip_upCustomization_args,c={};c[o.equipId]=s,mo.requestWaiting4Server(gc.iface.a_equip_upCustomization,c,function(e){var s={},n=e[gc.dsConsts.ExUserData.equipBagItems]||{},o=e[gc.dsConsts.ExUserData.delBagItems]||{},c=t.userUtils.getNewBag(o,{}),g=t.userUtils.getNewEquipBag({},n);s[gc.dsConsts.UserEntity.bag]=c,s[gc.dsConsts.UserEntity.equipBag]=g,t.userCtrl.updateEntity(s),r.call(i,e),a.pushNotify(a.__class.ON_INHERITED),t.heroCtrl.calPropAndCombat(),t.pointCtrl.cal(gc.c_prop.pointEffectKey.custom)})},a.getInheritedEquipOpt=function(e){var r={equipId:e,nextEquipInfo:null,nextEquipNeedLvl:0,nextEquipNeedLvlEnough:!1,isMaxLvl:!1,costItemId:null,costCount:null,isItemEnough:!1},i=t.equipCtrl.equipTrans(e),a=i.tempId,s=parseInt(a)+10,n=t.userCtrl.getEquipBag()[e][5],o=mo.getJSONWithFileNameAndID(gc.cfg_t_itemEquip,s);if(o){for(var c=o[gc.t_itemEquip_propertys],g=[],l=0,_=n.length;_>l;l++)g.push(c[n[l]]);var u={tempId:s,name:i.name,basePropArr:g,extraPropArr:i.extraPropArr,scrore:t.userUtils.getEquipGrade(s,i.extraPropArr,n)};r.nextEquipInfo=u;var d=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.customizationCfg),p=d[4].split(",");r.costItemId=d[2];var m=999999,f=mo.getJSONWithFileNameAndID(gc.cfg_t_item,a);switch(parseInt(f[gc.t_item_itemLvl])){case 120:m=parseInt(p[0]);break;case 130:m=parseInt(p[1]);break;case 140:m=parseInt(p[2]);break;case 150:m=parseInt(p[3]);break;case 160:m=parseInt(p[4]);break;case 170:m=parseInt(p[5]);break;case 180:m=parseInt(p[6]);break;case 190:m=parseInt(p[7])}r.costCount=m,r.nextEquipNeedLvl=mo.getJSONWithFileNameAndID(gc.cfg_t_item,s)[gc.t_item_level],r.nextEquipNeedLvlEnough=t.userCtrl.getLvl()>=r.nextEquipNeedLvl,r.isItemEnough=t.userCtrl.getItemNum(r.costItemId)>=r.costCount}else r.isMaxLvl=!0;return r},r.ON_INHERITED="ON_INHERITED",r.ON_CUSTOM="ON_CUSTOM",r}(mo.DataController);t.CustomCtrl=e,egret.registerClass(e,"gd.CustomCtrl"),t.customCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),this._guildCopyArr=[-1]},a.initData=function(t){if(t){var e=this;e.init(t)}},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.getGuildSection=function(){for(var t=mo.getJSONWithFileName(gc.cfg_t_guildCopy),e=[],r=1,i=Object.keys(t).length;i>=r;++r)e.push(t[r]);return e},a.getSectionInfo=function(t){return mo.getJSONWithFileNameAndID(gc.cfg_t_guildCopy,t)},a.getGuildBossList=function(t){for(var e=this,r=e.getSectionInfo(t),i=r[gc.t_guildCopy_section],a=[],s=parseInt(i[0]),n=parseInt(i[1]);n>=s;++s)a.push(s);return a},a.getGuildBossListLength=function(t){var e=this,r=e.getSectionInfo(t),i=r[gc.t_guildCopy_section];return parseInt(i[1])-parseInt(i[0])+1},a.getGuildProgress=function(e){var r=0,i=t.guildCtrl.get(gc.dsConsts.GuildEntity.guildCopyData);return i[e]?(i[e][0]&&(r=i[e][0]),r):0},a.getNewGuildBossId=function(){var e={};if(!t.guildCtrl.getData())return e;var r=t.guildCtrl.get(gc.dsConsts.GuildEntity.guildCopyData),i=mo.getJSONWithFileName(gc.cfg_t_guildCopy),a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.guildCopyCfg][2];for(var n in i){for(var o=i[n][gc.t_guildCopy_section],c=o[0],g=o[1],l=!0,_=c;g>=_;_++)if(!r[_]||!r[_][0]||r[_][0]<s){e[n]=_,l=!1;break}l&&(e[n]=-1)}return e},a.getCurBossId=function(t){var e=this,r=e.getNewGuildBossId()[t];if(0>r){var i=e.getSectionInfo(t);r=parseInt(i[gc.t_guildCopy_section][1])}return r},a.isBossKilled=function(t,e){var r=this,i=r.getNewGuildBossId()[t];return i>0?parseInt(i)>parseInt(e):!0},a.getGuildCopyCdState=function(){var t=this,e={threshold:mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.guildCopyCfg)[3],needBuy:!1};return e.needBuy=t.isNeedClearFightCD(),e},a.isNeedClearFightCD=function(){var e=!1,r=t.copyCtrl.getCopyProgressCtrl(gc.c_prop.copyTypeKey.guild),i=r.get(gc.dsConsts.CopyProgressEntity.refreshTime);if(i){var a=mo.getJSONWithFileName(gc.cfg_c_game),s=a[gc.id_c_game.guildCopyCfg][3],n=r.get(gc.dsConsts.CopyProgressEntity.pCopyId)||0,o=(Date.newDate().getTime()-Date.newDate(i).getTime())/1e3;n>=s&&n>o&&(e=!0)}return e},a.getGuildCopyCd=function(){var e=t.copyCtrl.getCopyProgressCtrl(gc.c_prop.copyTypeKey.guild),r=e.get(gc.dsConsts.CopyProgressEntity.pCopyId)||0,i=e.get(gc.dsConsts.CopyProgressEntity.refreshTime);if(i){var a=(Date.newDate().getTime()-Date.newDate(i).getTime())/1e3;r-=a}return 0>r&&(r=0),r},a.getResetCd=function(){var e=mo.getJSONWithFileName(gc.cfg_c_game),r=e[gc.id_c_game.guildCopyCfg][1],i=0,a=t.guildCtrl.get(gc.dsConsts.GuildEntity.resetTime);if(!a)return i;var s=Date.newDate(a).addDays(r);return Date.newDate()>=s?i:i=(s.getTime()-Date.newDate().getTime())/1e3},a.getCompletedNum=function(t){var e=this,r=parseInt(e.getNewGuildBossId()[t]);if(r>0){var i=e.getSectionInfo(t);return r-parseInt(i[gc.t_guildCopy_section][0])}return e.getGuildBossListLength(t)},a.guildStart=function(e,r,i,a){var s=this;if(t.fightCtrl.isSpFighting)return mo.showMsg("还在挑战中，请稍后");if(t.fightCtrl.isDie)return mo.showMsg("复活中，请稍后");var n=s.getGuildCopyCd(),o=s.getGuildCopyCdState().needBuy;if(n&&o){var c=gc.calGuildCopyCd(t.guildCopyCtrl.getGuildCopyCd());return void mo.showMsg(gc.id_c_msgCode.buyTime,c,function(){t.userCtrl.getGold()<c?t.userCtrl.noGolds(function(){s.clearGuildCopy(r,function(){},s)},s):s.clearGuildCopy(r,function(){},s)})}var g=mo.getJSONWithFileName(gc.cfg_t_guildCopy);if(!g[e])return mo.showMsg("数据异常");var l=g[e][gc.t_guildCopy_section];if(r<l[0]||r>l[1])return mo.showMsg("数据异常");var _=g[e][gc.t_guildCopy_openLvl];if(!t.guildCtrl.getData())return mo.showMsg("数据异常");var u=t.guildCtrl.get(gc.dsConsts.GuildEntity.lvl);if(_>u)return mo.showMsg("行会等级不足");this._guildCopyArr[0]=e,this._guildCopyArr[1]=r;var d=gc.iface.a_copy_guildStart_args,p={};p[d.copyId]=e,p[d.bossId]=r,s.curFightGuildBossId=r,mo.requestWaiting4Server(gc.iface.a_copy_guildStart,p,function(e){t.fightCtrl.isSpFighting=!0;var s=mo.getJSONWithFileNameAndID(gc.cfg_t_guildCopyBoss,r),n=s[gc.t_guildCopyBoss_copyId];mo.moduleMgr.curModule.name!=g_consts.moduleId.fight&&mo.moduleMgr.runModule(g_consts.moduleId.fight),t.fightLayer.onEnterCopy({pveType:gc.c_prop.fightTypeKey.guildCopy,copyID:n,bossId:r}),i.call(a,e)})},a.guildEnd=function(e,r,i){if(-1!=this._guildCopyArr[0]){var a=this,s=this._guildCopyArr[0],n=this._guildCopyArr[1],o=gc.iface.a_copy_guildEnd_args,c={};c[o.copyId]=s,c[o.bossId]=n,c[o.isWin]=e,a._guildCopyArr[0]=-1,mo.requestWaiting4Server(gc.iface.a_copy_guildEnd,c,function(e){var a=e[gc.dsConsts.ExCopyProgress.msg]||"";if(a.length>0)return mo.showMsg(a),r.call(i,[0,0,{}]);var s=e[gc.dsConsts.ExCopyProgress.userData]||{},n=e[gc.dsConsts.ExCopyProgress.copyProgress]||{},o=e[gc.dsConsts.ExCopyProgress.bagItems]||{},c=e[gc.dsConsts.ExCopyProgress.equipBagItems]||{},g=e[gc.dsConsts.ExCopyProgress.isWin],l=e[gc.dsConsts.ExCopyProgress.progress]||0,_=e[gc.dsConsts.ExCopyProgress.items]||{},u=t.userUtils.getNewBag({},o);s[gc.dsConsts.UserEntity.bag]=u;var d=t.userUtils.getNewEquipBag({},c);s[gc.dsConsts.UserEntity.equipBag]=d,s&&t.userCtrl.updateEntity(s),n&&t.copyCtrl.updateCopyProgressCtrl(gc.c_prop.copyTypeKey.guild,n);var p=e[gc.dsConsts.ExCopyProgress.guildData];p&&t.guildCtrl.updateData(p),r.call(i,[g,l,_])})}},a.guildCopyReset=function(e,r){mo.showMsg(gc.id_c_msgCode.resetCopy,function(){mo.requestWaiting4Server(gc.iface.a_copy_guildCopyReset,{},function(i){i&&(t.guildCtrl.getData()?t.guildCtrl.updateEntity(i):t.guildCtrl.initData(i)),e.call(r,i)})})},a.clearGuildCopy=function(e,r,i){var a=this,s=gc.iface.a_copy_clearGuildCopy_args,n={};n[s.bossId]=e,mo.requestWaiting4Server(gc.iface.a_copy_clearGuildCopy,n,function(e){var s=e[gc.dsConsts.ExUserData.userData]||{},n=e[gc.dsConsts.ExUserData.copyProgressData]||{};t.userCtrl.updateEntity(s),t.copyCtrl.updateCopyProgressCtrl(gc.c_prop.copyTypeKey.guild,n),a.pushNotify(a.__class.ON_GUILD_COPY_CD_CLEAR),r.call(i,e)})},a.getBuyCopyCount=function(){var e=gc.c_prop.copyTypeKey.guild,r=t.copyCtrl.getCopyProgressCtrl(e),i=1,a=r.get(gc.dsConsts.CopyProgressEntity.resetTime),s=r.get(gc.dsConsts.CopyProgressEntity.resetCounts);return a?(a&&Date.newDate(a).equalsDay(Date.newDate())||(s={}),a&&Date.newDate(a).equalsDay(Date.newDate())&&s.hasOwnProperty(e)?s[e]+1:i):i},a.getCopyCount=function(e){var r=mo.getJSONWithFileName(gc.cfg_c_vip),i=t.copyCtrl.getCopyProgressCtrl(gc.c_prop.copyTypeKey.guild),a=t.userCtrl.getVip()||0,s=r[a][gc.c_vip_guildFbCount],n=s-r[0][gc.c_vip_guildFbCount];if(!i.get(gc.dsConsts.CopyProgressEntity.refreshTime))return s;var o=Date.newDate(i.get(gc.dsConsts.CopyProgressEntity.refreshTime)),c=i.get(gc.dsConsts.CopyProgressEntity.timesPerDay);return o&&o.equalsDay(Date.newDate())&&c.hasOwnProperty(e)?parseInt(c[e])+n:s},a.getMaxCopyCount=function(){return mo.getJSONWithFileNameAndID(gc.cfg_c_vip,t.userCtrl.getVip())[gc.c_vip_guildFbCount]},a.guildCopyAward=function(e,r,i,a){var s=gc.iface.a_copy_guildCopyAward_args,n={};n[s.type]=e,n[s.typeId]=r,mo.requestWaiting4Server(gc.iface.a_copy_guildCopyAward,n,function(e){var r=e[gc.dsConsts.ExCopyProgress.userData]||{},s=e[gc.dsConsts.ExCopyProgress.copyProgress]||{},n=e[gc.dsConsts.ExCopyProgress.bagItems]||{},o=e[gc.dsConsts.ExCopyProgress.equipBagItems]||{},c=t.userUtils.getNewBag({},n);r[gc.dsConsts.UserEntity.bag]=c;var g=t.userUtils.getNewEquipBag({},o);r[gc.dsConsts.UserEntity.equipBag]=g,r&&t.userCtrl.updateEntity(r),s&&t.copyCtrl.updateCopyProgressCtrl(gc.c_prop.copyTypeKey.guild,s),i.call(a,s)})},a._calProgress=function(t){var e=mo.getJSONWithFileName(gc.cfg_c_game),r=e[gc.id_c_game.guildCopyCfg][2];return t=Math.floor(t/r*1e4)/100,t>100&&(t=100),t},a.getSectionIdByBossId=function(t){var e=mo.getJSONWithFileName(gc.cfg_t_guildCopy);for(var r in e){var i=e[r][gc.t_guildCopy_section];if(parseInt(t)>=parseInt(i[0])&&parseInt(t)<=parseInt(i[1]))return parseInt(r)}return-1},a.getMaxKillTimes=function(){return mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.guildCopyCfg)[2]},r.ON_GUILD_COPY_CD_CLEAR="on_guild_copy_cd_clear",r}(mo.DataController);t.GuildCopyCtrl=e,egret.registerClass(e,"gd.GuildCopyCtrl"),t.guildCopyCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this)},a.initData=function(t){if(t){var e=this;e.init(t)}},a.updateData=function(t){var e=this;e._data&&e.updateEntity(t)},a.getGiftById=function(e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_talisman,e);if(!r)return null;var i=r[gc.t_talisman_job],a=t.heroCtrl.hasHeroJobData(i);if(!a)return null;var s=a.get(gc.dsConsts.HeroEntity.talismanData)||{};return s[e]?s[e]:null},a.getTalismanAdorn=function(e){var r=t.heroCtrl.getHeroEntityCtrl(e);if(!r)return 0;var i=r.get(gc.dsConsts.HeroEntity.talismanAdorn)||0;return i},a.getHaveTrump=function(e){var r=t.heroCtrl.getHeroEntityCtrl(e);if(!r)return{};var i=r.get(gc.dsConsts.HeroEntity.talismanData)||{};return i},a.isHaveTrupId=function(e){var r=!1,i=t.userCtrl.getBag()||{};return i[e]&&i[e]>=1&&(r=!0),r},a.getTalismanFg=function(e){var r=t.heroCtrl.getHeroEntityCtrl(e);if(!r)return{};var i=r.get(gc.dsConsts.HeroEntity.talismanFg)||{};return i},a.calTaliCombat=function(e){var r=this,i=t.heroCtrl.getHeroEntityCtrl(e);if(!i)return[0,{},0,0,0];var a=i.get(gc.dsConsts.HeroEntity.talismanData)||{},s=i.get(gc.dsConsts.HeroEntity.talismanFg)||{};if(Object.keys(a).length<=0)return[0,{},0,0,0];var n=0,o={33:0,34:0,35:0,36:0,37:0,38:0,39:0,40:0},c={},g=mo.getJSONWithFileName(gc.cfg_c_game),l=mo.getJSONWithFileName(gc.cfg_t_talismanRes),_=mo.getJSONWithFileName(gc.cfg_t_talismanSkill),u=g[gc.id_c_game.combatMult],d=u[0]/1e4,p=u[1]/1e4,m=u[2]/1e4,f=u[3]/1e4,h=u[4]/1e4,y=u[5]/1e4,C=u[6]/1e4,v=u[7]/1e4,I=u[8],E=0,D=0;for(var b in a){E+=1;var S=0,N=a[b],T=N[4],k=parseInt(b)+parseInt(N[0]);S=parseInt(N[1])/1e3,o[33]+=r._getPropByIndex(33,k)*(1+S),o[34]+=r._getPropByIndex(34,k)*(1+S),o[35]+=r._getPropByIndex(35,k)*(1+S),o[36]+=r._getPropByIndex(36,k)*(1+S),o[37]+=r._getPropByIndex(37,k)*(1+S),o[38]+=r._getPropByIndex(38,k)*(1+S),o[39]+=r._getPropByIndex(39,k)*(1+S),o[40]+=r._getPropByIndex(40,k)*(1+S);for(var x in T){D+=1;var R=_[T[x]][gc.t_talismanSkill_type];if(1==R)for(var w=_[T[x]][gc.t_talismanSkill_effect],A=0;A<w.length;A++){var L=0;c[w[A][0]]&&(L=parseInt(c[w[A][0]])),c[w[A][0]]=L+parseInt(w[A][1])}}}var P=0;for(var b in s){var B=l[b];if(B&&1==B[gc.t_talismanRes_type]){var O=s[b]||[],q=B[gc.t_talismanRes_resonance],M=!0,W=q.length;if(0>=W)continue;for(var A=0;W>A;A++)O[A]||(M=!1);if(M){P+=1;for(var F=B[gc.t_talismanRes_extraPro],U=0;U<F.length;U++){var L=0;o[F[U][0]]&&(L=parseInt(o[F[U][0]])),o[F[U][0]]=L+parseInt(F[U][1])}}}}var G=o[33]+(c[33]||0),K=o[34]+(c[34]||0),H=o[35]+(c[35]||0),J=o[36]+(c[36]||0),V=o[39]+(c[39]||0),j=o[40]+(c[40]||0),z=o[38]+(c[38]||0),Q=o[37]+(c[37]||0),Y=500;G=Math.floor(G),K=Math.floor(K),H=Math.floor(H),J=Math.floor(J),V=Math.floor(V),j=Math.floor(j),z=Math.floor(z),Q=Math.floor(Q);var X=gc.calBaseCombat(G,d,K,p,H,m,J,f,V,C,j,v,z,y,Q,h,Y,I);n=parseInt(X.toString());for(var b in o)o[b]=Math.floor(o[b]);return[n,o,E,D,P]},a.calTaliCombatById=function(e,r){var i=this,a=t.heroCtrl.getHeroEntityCtrl(e);if(!a)return 0;var s=a.get(gc.dsConsts.HeroEntity.talismanData)||{},n=0,o={33:0,34:0,35:0,36:0,37:0,38:0,39:0,40:0},c={},g=mo.getJSONWithFileName(gc.cfg_c_game),l=(mo.getJSONWithFileName(gc.cfg_t_talismanRes),mo.getJSONWithFileName(gc.cfg_t_talismanSkill)),_=g[gc.id_c_game.combatMult],u=_[0]/1e4,d=_[1]/1e4,p=_[2]/1e4,m=_[3]/1e4,f=_[4]/1e4,h=_[5]/1e4,y=_[6]/1e4,C=_[7]/1e4,v=_[8],I=s[r]||[1,0,0,0],E=I[4]||{},D=parseInt(r)+parseInt(I[0]),b=parseInt(I[1])/1e3;o[33]+=i._getPropByIndex(33,D)*(1+b),o[34]+=i._getPropByIndex(34,D)*(1+b),o[35]+=i._getPropByIndex(35,D)*(1+b),o[36]+=i._getPropByIndex(36,D)*(1+b),o[37]+=i._getPropByIndex(37,D)*(1+b),o[38]+=i._getPropByIndex(38,D)*(1+b),o[39]+=i._getPropByIndex(39,D)*(1+b),o[40]+=i._getPropByIndex(40,D)*(1+b);for(var S in E){var N=l[E[S]][gc.t_talismanSkill_type];if(1==N)for(var T=l[E[S]][gc.t_talismanSkill_effect],k=0;k<T.length;k++){var x=0;c[T[k][0]]&&(x=parseInt(c[T[k][0]])),c[T[k][0]]=x+parseInt(T[k][1])}}var R=o[33]+(c[33]||0),w=o[34]+(c[34]||0),A=o[35]+(c[35]||0),L=o[36]+(c[36]||0),P=o[39]+(c[39]||0),B=o[40]+(c[40]||0),O=o[38]+(c[38]||0),q=o[37]+(c[37]||0),M=500;R=Math.floor(R),w=Math.floor(w),A=Math.floor(A),L=Math.floor(L),P=Math.floor(P),B=Math.floor(B),O=Math.floor(O),q=Math.floor(q);var W=gc.calBaseCombat(R,u,w,d,A,p,L,m,P,y,B,C,O,h,q,f,M,v);return n=parseInt(W.toString())},a.useTrumpItem=function(e,r,i){var a=gc.iface.a_talisman_useTrumpItem_args,s={};s[a.itemId]=e,mo.requestWaiting4Server(gc.iface.a_talisman_useTrumpItem,s,function(e){var a=e[gc.dsConsts.ExUserData.userData]||{},s=e[gc.dsConsts.ExUserData.heroData]||[],n=e[gc.dsConsts.ExUserData.delBagItems]||{},o=t.userUtils.getNewBag(n,{});a[gc.dsConsts.UserEntity.bag]=o,t.userCtrl.updateEntity(a);for(var c=0;c<s.length;c++){var g=s[c][1];g&&t.heroCtrl.updateHeroEntityCtrl(g[gc.dsConsts.HeroEntity.id],g)}t.equipCtrl.pushNotify(t.equipCtrl.__class.ON_SMELT),r.call(i,n)})},a.wearTrump=function(e,r,i,a){var s=this,n=gc.iface.a_talisman_wearTrump_args,o={};o[n.tempId]=e,o[n.trumpId]=r,mo.requestWaiting4Server(gc.iface.a_talisman_wearTrump,o,function(e){var r={},n=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.delBagItems]||{},c=n[gc.dsConsts.HeroEntity.talismanData]||{},g=t.userUtils.getNewBag(o,{});r[gc.dsConsts.UserEntity.bag]=g,t.userCtrl.updateEntity(r),n&&t.heroCtrl.updateHeroEntityCtrl(n[gc.dsConsts.HeroEntity.id],n),s.pushNotify(s.__class.ON_GIFT_EQUIP_CHANGED);var l=t.heroCtrl.getHeroEntityCtrl(n[gc.dsConsts.HeroEntity.id]);l.pushNotify(s.__class.ON_GIFT_EQUIP_CHANGED),i.call(a,c)})},a.isCanUpLvl=function(e,r){var i=t.heroCtrl.getHeroByIndex(e);if(!i)return!1;var a=mo.getJSONWithFileName(gc.cfg_t_talismanLvl),s=i.get(gc.dsConsts.HeroEntity.talismanData)||{},n=s[r];if(!n)return!1;var o=a[r+n[0]],c=a[r+n[0]+1];if(!c)return!1;if(c[gc.t_talismanLvl_userLv]>t.userCtrl.getLvl())return!1;var g=t.userCtrl.getBag(),l=o[gc.t_talismanLvl_needItems];for(var _ in o[gc.t_talismanLvl_needItems]){var u=l[_][0],d=l[_][1],p=g[u]||0;if(d>p)return!1}return!0},a.upTrumpLvl=function(e,r,i,a){var s=this,n=gc.iface.a_talisman_upTrumpLvl_args,o={};o[n.tempId]=e,o[n.trumpId]=r,mo.requestWaiting4Server(gc.iface.a_talisman_upTrumpLvl,o,function(e){var n={},o=e[gc.dsConsts.ExUserData.heroData]||{},c=o[gc.dsConsts.HeroEntity.talismanData]||{},g=e[gc.dsConsts.ExUserData.delBagItems]||{},l=t.userUtils.getNewBag(g,{});n[gc.dsConsts.UserEntity.bag]=l,t.userCtrl.updateEntity(n),o&&t.heroCtrl.updateHeroEntityCtrl(o[gc.dsConsts.HeroEntity.id],o),s.pushNotify(s.__class.ON_GIFT_CHANGED,r,c[r]),i.call(a,c[r])})},a.isCanUpStar=function(e,r){var i=t.heroCtrl.getHeroEntityCtrl(e);if(!i)return!1;var a=mo.getJSONWithFileName(gc.cfg_t_talismanStar),s=i.get(gc.dsConsts.HeroEntity.talismanData)||{},n=s[r];if(!n)return!1;var o=n[0]||1,c=n[2]||0,g=a[parseInt(r)+parseInt(o)][gc.t_talismanLvl_starLimit];if(c>=g)return!1;var l=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.trumpCfg),_=l[2];if(c>=_)return!1;var u=t.userCtrl.getBag(),d=parseInt(r)+parseInt(c),p=a[d][gc.t_talismanLvl_needItems];for(var m in p){var f=p[m][0],h=p[m][1],y=u[f]||0;if(h>y)return!1}return!0},a.upTrumpStar=function(e,r,i,a){var s=this,n=gc.iface.a_talisman_upTrumpStar_args,o={};o[n.tempId]=e,o[n.trumpId]=r,mo.requestWaiting4Server(gc.iface.a_talisman_upTrumpStar,o,function(e){var n=e[gc.dsConsts.ExUserData.userData]||{},o=e[gc.dsConsts.ExUserData.heroData]||{},c=e[gc.dsConsts.ExUserData.delBagItems]||{},g=o[gc.dsConsts.HeroEntity.talismanData]||{},l=e[gc.dsConsts.ExUserData.isGetSkill],_=e[gc.dsConsts.ExUserData.isFull],u=t.userUtils.getNewBag(c,{});n[gc.dsConsts.UserEntity.bag]=u,t.userCtrl.updateEntity(n),o&&t.heroCtrl.updateHeroEntityCtrl(o[gc.dsConsts.HeroEntity.id],o);var d=t.heroCtrl.getHeroEntityCtrl(o[gc.dsConsts.HeroEntity.id]);l&&d.pushNotify(t.HeroEntityCtrl.ON_GIFT_SKILL_CHANGED),s.pushNotify(s.__class.ON_GIFT_CHANGED,r,g[r]),i.call(a,[g[r],l,_])})},a.recastTrump=function(e,r,i,a){var s=this,n=gc.iface.a_talisman_recastTrump_args,o={};o[n.tempId]=e,o[n.trumpId]=r,mo.requestWaiting4Server(gc.iface.a_talisman_recastTrump,o,function(e){var n=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.isGetSkill],c=t.heroCtrl.getHeroEntityCtrl(n[gc.dsConsts.HeroEntity.id]);if(o){var g=e[gc.dsConsts.ExUserData.userData]||{};t.userCtrl.updateEntity(g),c.pushNotify(t.HeroEntityCtrl.ON_GIFT_SKILL_CHANGED)}n&&t.heroCtrl.updateHeroEntityCtrl(n[gc.dsConsts.HeroEntity.id],n);var l=n[gc.dsConsts.HeroEntity.talismanData]||{};s.pushNotify(s.__class.ON_GIFT_CHANGED,r,l[r]),i.call(a,l[r])})},a.compoundTrump=function(e,r,i,a){var s=this,n=gc.iface.a_talisman_compoundTrump_args,o={};o[n.tempId]=e,o[n.trumpId]=r,mo.requestWaiting4Server(gc.iface.a_talisman_compoundTrump,o,function(e){var r=e[gc.dsConsts.ExUserData.heroData]||{},n=e[gc.dsConsts.ExUserData.bagItems]||{};if(Object.keys(n).length>0){var o={},c=t.userUtils.getNewBag({},n);o[gc.dsConsts.UserEntity.bag]=c,t.userCtrl.updateEntity(o)}r&&t.heroCtrl.updateHeroEntityCtrl(r[gc.dsConsts.HeroEntity.id],r);var g=t.heroCtrl.getHeroEntityCtrl(r[gc.dsConsts.HeroEntity.id]);g.pushNotify(s.__class.ON_GIFT_EQUIP_CHANGED),i.call(a,n)})},a.baptizeTrump=function(e,r,i,a,s){var n=this,o=gc.iface.a_talisman_baptizeTrump_args,c={};c[o.tempId]=e,c[o.trumpId]=r,c[o.isCheck]=i,mo.requestWaiting4Server(gc.iface.a_talisman_baptizeTrump,c,function(e){var i=e[gc.dsConsts.ExUserData.heroData]||{},o=e[gc.dsConsts.ExUserData.delBagItems]||{},c=e[gc.dsConsts.ExUserData.baptizeValue]||{},g=i[gc.dsConsts.HeroEntity.talismanData]||{},l=t.userUtils.getNewBag(o,{}),_={};_[gc.dsConsts.UserEntity.bag]=l,t.userCtrl.updateEntity(_),i&&t.heroCtrl.updateHeroEntityCtrl(i[gc.dsConsts.HeroEntity.id],i),n.pushNotify(n.__class.ON_GIFT_CHANGED,r,g[r]),a.call(s,g[r],c)})},a.confirmBaptizeTrump=function(e,r,i,a){var s=this,n=gc.iface.a_talisman_confirmBaptizeTrump_args,o={};o[n.tempId]=e,o[n.trumpId]=r,mo.requestWaiting4Server(gc.iface.a_talisman_confirmBaptizeTrump,o,function(e){var n=e[gc.dsConsts.ExUserData.heroData]||{},o=n[gc.dsConsts.HeroEntity.talismanData]||{};n&&t.heroCtrl.updateHeroEntityCtrl(n[gc.dsConsts.HeroEntity.id],n),s.pushNotify(s.__class.ON_GIFT_CHANGED,r,o[r]),i.call(a,o[r])})},a.cancelBaptizeTrump=function(e,r,i,a){var s=this,n=gc.iface.a_talisman_cancelBaptizeTrump_args,o={};o[n.tempId]=e,o[n.trumpId]=r,mo.requestWaiting4Server(gc.iface.a_talisman_cancelBaptizeTrump,o,function(e){var n=e[gc.dsConsts.ExUserData.heroData]||{},o=n[gc.dsConsts.HeroEntity.talismanData]||{};n&&t.heroCtrl.updateHeroEntityCtrl(n[gc.dsConsts.HeroEntity.id],n),s.pushNotify(s.__class.ON_GIFT_CHANGED,r,o[r]),i.call(a,o[r])})},a._getPropByIndex=function(t,e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_talismanLvl,e);if(!r)return 0;for(var i=r[gc.t_talismanLvl_propertys],a=0,s=0;s<i.length;s++){var n=i[s],o=n[0],c=n[1];if(o==t){a=c;break}}return a},a.getPropObjBy=function(t,e,r){var i={},a=mo.getJSONWithFileNameAndID(gc.cfg_t_talismanLvl,t+r);if(!a)return 0;for(var s=a[gc.t_talismanLvl_propertys],n=0;n<s.length;n++){var o=s[n],c=o[0],g=o[1];i[c]=g*(1+e/1e3)>>0}return i},a.getMaxZiZhi=function(t,e){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_talisman,t),i=mo.getJSONWithFileNameAndID(gc.cfg_t_talismanStar,t+e);return r[gc.t_talisman_atEnd]+i[gc.t_talismanStar_aptitude]},a.getSkillList=function(t,e){for(var r=[],i=mo.getJSONWithFileName(gc.cfg_t_talismanStar),a=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.trumpCfg),s=0;s<=a[2];++s){var n=i[t+s];if(!n)break;var o=n[gc.t_talismanStar_skillId];if(o){var c={skillId:o,jiHuo:!1,star:s};e&&e[s+1]&&(c.jiHuo=!0),r.push(c)}}return r},r.ON_GIFT_CHANGED="ON_GIFT_CHANGED",r.ON_GIFT_EQUIP_CHANGED="ON_GIFT_EQUIP_CHANGED",r}(mo.DataController);t.HeroTalismanCtrl=e,egret.registerClass(e,"gd.HeroTalismanCtrl"),t.heroTalismanCtrl=e.getInstance()}(gd||(gd={}));var gd;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),this._expHeroBase={},this.DATA_KEY=gc.dsConsts.ExpeditionEntity},i.getInfo=function(t,e){var r=this;mo.requestWaiting4Server(gc.iface.a_expedition_getInfo,{},function(i){var a=i[gc.dsConsts.ExpeditionData.expData];r.init(a),r._expHeroBase=i[gc.dsConsts.ExpeditionData.expHeroData],t&&t.call(e,i)})},i.wearSoul=function(t,e,r,i){var a={},s=gc.iface.a_expedition_wearSoul_args;a[s.tempId]=t,a[s.soulId]=e,mo.requestWaiting4Server(gc.iface.a_expedition_wearSoul,a,function(t){r&&r.call(i,t)})},i.startBattle=function(t,e,r){var i={},a=gc.iface.a_expedition_startBattle_args;i[a.stageId]=t,mo.requestWaiting4Server(gc.iface.a_expedition_startBattle,i,function(t){e&&e.call(r,t)})},i.endBattle=function(t,e,r,i){var a={},s=gc.iface.a_expedition_endBattle_args;a[s.isWin]=t,a[s.herosHp]=e,mo.requestWaiting4Server(gc.iface.a_expedition_endBattle,a,function(t){r&&r.call(i,t)})},e}(mo.DataController);t.ExpeditionCtrl=e,egret.registerClass(e,"gd.ExpeditionCtrl"),t.expeditionCtrl=e.getInstance()}(gd||(gd={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this)},i.onEnter=function(){t.prototype.onEnter.call(this)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.item0.label_text.visible=!1,e.item1.label_text.visible=!1,e.item2.label_text.visible=!1,e.item3.label_text.visible=!1,e.item0.onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.get("itemId"),null)}).show()}),e.item1.onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.get("itemId"),null)}).show()}),e.item2.onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.get("itemId"),null)}).show()}),e.item3.onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.get("itemId"),null)}).show()})},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data[0];e.item0.visible=r?!0:!1,e.item0.visible&&e.item0.setData({itemId:r[0],count:r[1]});var i=e.data[1];e.item1.visible=i?!0:!1,e.item1.visible&&e.item1.setData({itemId:i[0],count:i[1]});var a=e.data[2];e.item2.visible=a?!0:!1,e.item2.visible&&e.item2.setData({itemId:a[0],count:a[1]});var s=e.data[3];e.item3.visible=s?!0:!1,e.item3.visible&&e.item3.setData({itemId:s[0],count:s[1]})},e}(mo.gui.Comp);t.BossRewardPanel=e,egret.registerClass(e,"g_comp.BossRewardPanel")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=this;e.red_point.visible=!1,e.new_point.visible=!1,e.img_s.visible=!1,e.img_s.source=e.iconDisplay.source+"_"},i.onClick=function(t,e,r){this._onClick=t,this._onClickCtx=e,this._onClickData=r||{}},e}(egret.gui.Button);t.Tab_Sys=e,egret.registerClass(e,"g_comp.Tab_Sys")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.setActivity=function(t){if(t){var e=this,r=t[gc.dsConsts.ActivityEntity.exData];if(r){var i=r[gc.c_prop.activityExDataTypeKey.titleIcon];if(i){var a="resource/ui2/ui_activity/"+i;RES.getResByUrl(a+"_3.jpg",function(t){e.img_bg.source=t},e,RES.ResourceItem.TYPE_IMAGE)}}uiHelper.setEventTime(e.lbl_time,Date.newDate(t[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(t[gc.dsConsts.ActivityEntity.endTime]))}},e}(mo.gui.Comp);t.ActivityItem=e,egret.registerClass(e,"g_comp.ActivityItem")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments),this._showEquipName=!1}__extends(e,t);var r=__define,i=e,a=i.prototype;return a._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this),this.showItemInfoOnClick=!1},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.label_count.visible=!1},r(a,"showEquipName",function(){return this._showEquipName},function(t){var e=this;if(e._showEquipName=t,t&&e.data.itemId){var r=mo.getJSONWithFileNameAndID(gc.cfg_t_item,e.data.itemId);if(r[gc.t_item_type]==gc.c_prop.itemTypeKey.equip){e.label_text.text=r[gc.t_item_name],e.label_count.visible=!0,e.label_count.text=mo.STR.format("Lv.%s",r[gc.t_item_level]);var i=e.getIcoMarkSource();e.ico_equipMark.visible=i.length>0,i.length>0&&(e.ico_equipMark.source=i)}}}),a.getIcoMarkSource=function(){var t=this,e="",r=gd.equipCtrl,i=r.isSpecialEquip(t.data.itemId),a=r.isRareEquip(t.data.itemId),s=r.isCustomEquipByTempId(t.data.itemId),n=r.isSuperEquip(t.data.itemId),o=r.isJingEquip(t.data.itemId);return i?e="ico_special":a?e="ico_best":s?e="ico_custom":n?e="ico_cao":o&&(e="ico_jing"),e},a.dataChanged=function(){t.prototype.dataChanged.call(this);
var e=this,r=e.get("itemId"),i=e.get("count")||1;if(r){("number"==typeof e.data||"string"==typeof e.data)&&(r=e.data);var a=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r);a||(r=99999,a=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r));var s=a[gc.t_item_type],n=gc.c_prop.itemTypeKey;e.ico.source=resHelper.getItemIconPath(r);var o=a[gc.t_item_color];e.ico_border.source=resHelper.getBorderByQuality(1,o),e.label_count.visible=i>1,e.label_count.visible&&(e.label_count.text=""+i);var c=e.get("pileCount");if(null!=c?e.label_count.text=c+"/"+i:e.label_count.text=i,e.ico_job.visible=null!=e.ico_job_visible?e.ico_job_visible:s==n.equip||s==n.gift,e.ico_equipMark.visible=!1,null!=e.hideLabelText&&(e.label_text.visible=!e.hideLabelText),s==n.equip){e.showEquipName?(e.label_text.text=a[gc.t_item_name],e.label_count.visible=!0,e.label_count.text=mo.STR.format("Lv.%s",a[gc.t_item_itemLvl])):e.label_text.text=mo.STR.format("Lv.%s",a[gc.t_item_itemLvl]);var g=e.getIcoMarkSource();e.ico_equipMark.visible=g.length>0,g.length>0&&(e.ico_equipMark.source=g)}else e.label_text.text=a[gc.t_item_name];e.ico_job.visible&&(e.ico_job.source="ico_job"+gd.equipCtrl.getEquipJob(r))}},a.onClick=function(t,e,r){this._onClick=t,this._onClickCtx=e,this._onClickData=r||{}},a._tap_rect_touch=function(t){var e=this;e.showItemInfoOnClick&&g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(e.data.itemId,e._showEquipName?null:e.data.count)}).show(),e._onClick&&e._onClick.call(e._onClickCtx,e,t.target,e._onClickData)},a.setLineWidth=function(t){var e=this;e.label_text.width=t},a.getTextHeight=function(){var t=this;return t.label_text.height},e}(mo.gui.Comp);t.Ico_Item=e,egret.registerClass(e,"g_comp.Ico_Item")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.img_red.visible=!1},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data.index,i=e.data.heroCtrl,a=i.hasHeroByIndex(r),s=i.isToBeOpen(r),n=i.isMy4thRole(r);if(e.enabled=a||s||n,e.invalidateSkinState(),s){var o=e.openCfg=3>r?i.getHeroOpenCfg(r):i.getSpHeroOpenCfg(r);e.label_unlock_lvl.text=mo.STR.format("%s级解锁",3>r?o[0]:o[0][0])}if(a){var c=i.getHeroByIndex(r);e.img_pos.source=mo.STR.format("ico_num%s",i.getFightList().indexOf(c)+1),n?e.ico.source=mo.STR.format("avatar_%s_%s_1",gc.c_prop.heroJobKey.ys,0):e.ico.source=mo.STR.format("avatar_%s_%s_1",c.job,c.sex)}},i.setRedPointShow=function(t){var e=this;e.img_red&&(e.img_red.visible=t)},i.setSelected=function(t){var e=this;e.img_light_border&&(e.img_light_border.visible=t)},i.getCurrentSkinState=function(){var t=this,e=t.data.heroCtrl;if(!e)return"disabled";var r=t.data.index,i=e.hasHeroByIndex(r);if(i)return"normal";var a=e.isToBeOpen(r);return a?"unlock":"disabled"},i.onClick=function(t,e,r){this._onClick=t,this._onClickCtx=e,this._onClickData=r||{}},i._tap_touch_rect=function(t){var e=this;e._onClick&&e._onClick.call(e._onClickCtx,e,t.target,e._onClickData)},e}(mo.gui.Comp);t.Ico_Hero=e,egret.registerClass(e,"g_comp.Ico_Hero")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data.icoId,i=e.data.vip;e.ico_role.source=uiHelper.getHeroIcon(r),i?(e.grp_vip.visible=!0,e.label_vipLv.text=i.toString()):e.grp_vip.visible=!1},e}(mo.gui.Comp);t.Ico_Head=e,egret.registerClass(e,"g_comp.Ico_Head")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.label_count.visible=!1},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.get("itemId"),i=e.get("count");("number"==typeof e.data||"string"==typeof e.data)&&(r=e.data);var a=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r);a||(r=99999,a=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r));var s=a[gc.t_item_type],n=gc.c_prop.itemTypeKey;e.ico.source=resHelper.getItemIconPath(r);var o=a[gc.t_item_color];e.ico_border.source=resHelper.getBorderByQuality(1,o),e.label_count.visible=i&&s!=n.equip;var c=e.get("pileCount");null!=c?e.label_count.text=c+"/"+i:e.label_count.text=i},i.onClick=function(t,e,r){this._onClick=t,this._onClickCtx=e,this._onClickData=r||{}},i._tap_ico_border=function(t){var e=this;e._onClick&&e._onClick.call(e._onClickCtx,e,t.target,e._onClickData)},i.setGray=function(t){return this},i.showTip=function(t){return this},i._setEquipState=function(){var t=this;t.get("equipState");return t},e}(mo.gui.Comp);t.Ico_Rune=e,egret.registerClass(e,"g_comp.Ico_Rune")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this),this.noAnimate=!1},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.efx_medal.ico.visible=!1},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.get("itemId"),i=mo.getJSONWithFileNameAndID(gc.cfg_t_medal,r),a=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r);e.ico_medal.visible=e.efx_medal.visible=e.label_medalTitle.visible=!1,i[gc.t_medal_iconId]&&!e.noAnimate?(e.efx_medal.effectId=i[gc.t_medal_iconId],e.efx_medal.visible=!0):i[gc.t_medal_staIconId]&&(e.ico_medal.source=resHelper.getWarPrintIconPath(r),e.ico_medal.visible=!0);var s=i[gc.t_medal_metalType];1==s&&(e.label_medalTitle.text=a[gc.t_item_name],e.label_medalTitle.visible=!0)},i.getShowType=function(){},i.checkNeedAdjuestPos=function(t){var e=mo.getJSONWithFileNameAndID(gc.cfg_t_medal,t),r=e[gc.t_medal_metalType];return 3==r},e}(mo.gui.Comp);t.Ico_Medal=e,egret.registerClass(e,"g_comp.Ico_Medal")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments),this._showEquipName=!1}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this),this.showItemInfoOnClick=!1},i._childrenCreated=function(){t.prototype._childrenCreated.call(this)},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.get("itemId");e.get("count")||1;if(r){("number"==typeof e.data||"string"==typeof e.data)&&(r=e.data);var i=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r);i||(r=99999,i=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r));i[gc.t_item_type],gc.c_prop.itemTypeKey;e.ico.source=resHelper.getItemIconPath(r);var a=i[gc.t_item_color];e.ico_border.source=resHelper.getBorderByQuality(1,a)}},i.onClick=function(t,e,r){this._onClick=t,this._onClickCtx=e,this._onClickData=r||{}},i._tap_rect_touch=function(t){var e=this;e.showItemInfoOnClick&&g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(e.data.itemId,e._showEquipName?null:e.data.count)}).show(),e._onClick&&e._onClick.call(e._onClickCtx,e,t.target,e._onClickData)},i.setLineWidth=function(t){var e=this;e.label_name.width=t},i.getTextHeight=function(){var t=this;return t.label_name.height},e}(mo.gui.Comp);t.Ico_Soul=e,egret.registerClass(e,"g_comp.Ico_Soul")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this)},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.get("itemId");if(e.ico_job.visible=0!=r,0!=r){var i=mo.getJSONWithFileNameAndID(gc.cfg_t_talisman,r);e.label_giftTitle.text=i[gc.t_talisman_name],e.ico_gift.source=resHelper.getItemIconPath(r),e.ico_job.source="ico_job"+gd.equipCtrl.getEquipJob(r)}else e.ico_gift.source=null,e.label_giftTitle.text=""},i.getShowType=function(){},e}(mo.gui.Comp);t.Ico_Gift=e,egret.registerClass(e,"g_comp.Ico_Gift")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e);r.prototype;return e}(egret.gui.Panel);t.Dlg_Close=e,egret.registerClass(e,"g_comp.Dlg_Close")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e);r.prototype;return e}(t.Dlg_Close);t.Dlg_Info_Close=e,egret.registerClass(e,"g_comp.Dlg_Info_Close")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this);var e=this;mo.gui.helper.setCompSkinName(e)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.gold.toString(),e._updateRes),e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.diamond.toString(),e._updateRes),e._updateRes()},i._updateRes=function(){var t=this;t.label_gold.text=gd.userCtrl.getGold(),t.label_yuanbao.text=gd.userCtrl.getDiamond()},i.showRes=function(t,e){var r=this;r.grp_gold.visible=t,r.grp_yuanbao.visible=e},i.dataChanged=function(){t.prototype.dataChanged.call(this)},e}(mo.gui.Comp);t.ResBar=e,egret.registerClass(e,"g_comp.ResBar")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=__define,i=e,a=i.prototype;return r(a,"text",function(){return this._textSource},function(t){var e=this;e._textSource=t,e.source=e._textSource}),e}(egret.gui.UIAsset);t.IcoLabel=e,egret.registerClass(e,"g_comp.IcoLabel")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments),this.showType=0}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.ico_item.ico_job_visible=!1},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;e.part=e.get("part"),e.hec=e.get("hec"),e.showType=e.get("showType")||0;var r=e.hec.getEquipIdByPart(e.part);e.equipId=r;var i=e.isEmpty=!r;if(e.ico_item.visible=!i,e.img_red.visible=!1,e.label_plus.visible=!1,e.img_num_bg.visible=!1,e.label_star.visible=!1,e.img_green_plus.visible=!1,e.img_red.visible=!1,!i){var a;a=gd.equipCtrl.isBreakRing(e.part)?r:e.hec.getEquipTempIdByPart(e.part),e.ico_item.setData({itemId:a})}switch(e.showType){case 0:e._setShowInRole();break;case 1:e._setShowInStr();break;case 2:e._setShowInStar();break;case 3:e._setShowInGem();break;case 4:e._setShowInRefine()}},i._setShowInStr=function(){var t=this,e=t.isEmpty;if(!e){t.ico_item.label_text.visible=!1,t._setStrLvl();var r=t.hec.isStrengthReddot();t.img_red.visible=!e&&-1!=r.indexOf(t.part)}},i._setShowInRefine=function(){var t=this,e=t.isEmpty;e||(t.ico_item.label_text.visible=!1,t._setStrLvl(),t.img_red.visible=!1)},i._setShowInStar=function(){var t=this,e=t.isEmpty;if(!e){t.ico_item.label_text.visible=!1,t._setStar();var r=t.hec.isUpStarReddot();t.img_red.visible=!e&&-1!=r.indexOf(t.part)}},i._setShowInGem=function(){var t=this,e=t.isEmpty;if(!e){t._setGemLvl();var r=t.hec.isUpGemReddot();t.img_red.visible=!e&&-1!=r.indexOf(t.part)}},i._setShowInRole=function(){var t=this,e=t.isEmpty;t.label_plus.visible=!e,t.label_star.visible=!e,t.img_num_bg.visible=!e,e||(t._setStrLvl(),t._setStar());var r=!1;if(gd.equipCtrl.isBreakRing(t.part)){r=e&&null!=t.hec.getStanbyBreakId(t.part);var i=t.hec.isTringReddot();t.img_red.visible=-1!=i.indexOf(t.part)&&!r}else{var a=t.hec.getStanbyEquip(t.part);r=e&&a.length>0;var s=t.hec.isEquipReddot();t.img_red.visible=!e&&-1!=s.indexOf(t.part)}t.canAdd=r,t.img_green_plus.visible=r},i._setStrLvl=function(){var t=this,e=t.hec.getStrLvlByEquipPart(t.part);t.label_plus.text=e,t.label_plus.visible=0!=e,t.img_num_bg.visible=0!=e},i._setStar=function(){var t=this,e=t.hec.getStarLvlByEquipPart(t.part);t.label_star.text=e,t.label_star.visible=0!=e},i._setGemLvl=function(){var t=this,e=t.hec.getGemInfoByPart(t.part),r=e[gc.c_gem_gemLvl];t.label_plus.text=r,t.label_plus.visible=0!=r,t.img_num_bg.visible=0!=r},i.onClick=function(t,e,r){this._onClick=t,this._onClickCtx=e,this._onClickData=r||{}},i._tap_rect_touch=function(t){var e=this;e._onClick&&e._onClick.call(e._onClickCtx,e,t.target,e._onClickData)},e}(mo.gui.Comp);t.Equip_Item=e,egret.registerClass(e,"g_comp.Equip_Item")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this)},i._getRealPart=function(){var t=this,e=t.data.hec,r=null!=t.data.part?t.data.part:e.getFirstEquipedPart();return r=e.isPartEquiped(r)?r:e.getFirstEquipedPart()},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.get("hec");if(r){var i=e._getRealPart();if(null==i)e.label_gem_0.text=["未激活",""],e.label_gem_1.text=["未激活",""],e.label_gem_2.text=["未激活",""],e.label_gem_3.text=["未激活",""],e.img_gem0.source="gem_gray",e.img_gem1.source="gem_gray",e.img_gem2.source="gem_gray",e.img_gem3.source="gem_gray";else{var a=r.getGemInfoByPart(i),s=gc.c_prop.heroProp,n=function(t,e){return e>0?mo.STR.format("%s+%s",s[t].replace("加成",""),e):"未激活"},o=function(t,e){return e>0?"ico_"+t:"gem_gray"};e.label_gem_0.text=[a[gc.c_gem_items1],mo.STR.format("%s+%s",s[a[gc.c_gem_effectType1]].replace("加成",""),a[gc.c_gem_effectPro1])],e.label_gem_1.text=[a[gc.c_gem_items2],n(a[gc.c_gem_effectType2],a[gc.c_gem_effectPro2])],e.label_gem_2.text=[a[gc.c_gem_items3],n(a[gc.c_gem_effectType3],a[gc.c_gem_effectPro3])],e.label_gem_3.text=[a[gc.c_gem_items4],n(a[gc.c_gem_effectType4],a[gc.c_gem_effectPro4])],e.img_gem0.source="ico_"+a[gc.c_gem_gemId0],e.img_gem1.source=o(a[gc.c_gem_gemId1],a[gc.c_gem_effectPro2]),e.img_gem2.source=o(a[gc.c_gem_gemId2],a[gc.c_gem_effectPro3]),e.img_gem3.source=o(a[gc.c_gem_gemId3],a[gc.c_gem_effectPro4])}}},e}(mo.gui.Comp);t.Gem_Stone=e,egret.registerClass(e,"g_comp.Gem_Stone")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this)},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;if(e.part=e.get("part"),null==e.part)return e.img_part.visible=!1,void(e.img_txt_part.visible=!1);e.img_part.visible=!0,e.img_txt_part.visible=!0;var r=uiHelper.getPartRes(e.part);e.img_part.source=r[0],e.img_txt_part.source=r[1]},e}(mo.gui.Comp);t.Part_Item=e,egret.registerClass(e,"g_comp.Part_Item")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.performanceControl=!0,this.needPlay=!0}__extends(r,e);var i=__define,a=r,s=a.prototype;return s._initProp=function(){e.prototype._initProp.call(this),mo.gui.helper.setCompSkinName(this)},s._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;if(t.autoPlay=null!=t.autoPlay?t.autoPlay:!0,t.performanceControl){var r=t.efx.getQueryString("high");r&&"true"==r?t.needPlay=!0:r&&"false"==r&&(t.needPlay=!1)}t.efx.autoPlay=t.autoPlay,t.efx.effectId=t._effectId,t._effectId&&t.needPlay&&t.efx.startLoadByKey(t._effectId,function(){t.efx&&(t.efx.width=t.efx.height=0)}),t._source&&(t.ico.source=t._source)},i(s,"source",void 0,function(t){var e=this;e._source!=t&&(e._source=t),e.ico&&(e.ico.source=t)}),s.playEffect=function(t){var e=this;e.efx&&e.needPlay&&(e.efx.autoPlay=t,uiHelper.playUIEffect(e.efx,t))},s._onEfxIdChanged=function(t){var e=this;e.efx&&e.needPlay&&(e.playEffect(!1),e._effectId&&e.needPlay&&(e.efx.autoPlay=e.autoPlay,e.efx.startLoadByKey(e._effectId,function(){e.efx&&(e.efx.width=e.efx.height=0),e.playEffect(!0)})))},i(s,"effectId",void 0,function(t){var e=this;e._effectId!=t&&(e._effectId=t,e._onEfxIdChanged(t))}),s.onClick=function(t,e,r){this._onClick=t,this._onClickCtx=e,this._onClickData=r||{}},s._tap_ico=function(t){var e=this;e._onClick&&e._onClick.call(e._onClickCtx,e,t.target,e._onClickData)},r.createEfxAsset=function(e,r,i){var a=new t.EfxAsset;return a.source=e,a.autoPlay=i,a.effectId=r,a},r}(mo.gui.Comp);t.EfxAsset=e,egret.registerClass(e,"g_comp.EfxAsset")}(g_comp||(g_comp={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this)},i.onEnter=function(){t.prototype.onEnter.call(this)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this)},i.updateHp=function(t,e){var r=this;0==e&&(t=e=1);var i=r.img_hp.height-Math.floor((1-t/e)*r.img_hp.height);r.img_hp.mask=new egret.Rectangle(0,r.img_hp.height-i,r.img_hp.width,i)},i.updateMp=function(t,e){var r=this;0==e&&(t=e=1);var i=r.img_mp.height-Math.floor((1-t/e)*r.img_mp.height);r.img_mp.mask=new egret.Rectangle(0,r.img_mp.height-i,r.img_mp.width,i)},e}(mo.gui.Comp);t.Fight_Info=e,egret.registerClass(e,"g_comp.Fight_Info")}(g_comp||(g_comp={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var r=this;e.prototype._initProp.call(this),r._Item_list_items=t.BaseItemCell},a._data_list_items=function(){var t=this;return t.actItems},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,r=t.data.type;0==r?(t.label_hint.text="恭喜你获得:",t.ico_hint.source="ico_wgift_get"):1==r&&(t.label_hint.text="今天已领取过:",t.ico_hint.source="ico_wgift_hint"),t.actItems=[];var i=t.data.giftId,a=mo.getJSONWithFileName(gc.cfg_c_giftPack),s=a[i];if(s)for(var n=s[gc.c_giftPack_content],o=0;o<n.length;o++){var c=n[o];t.actItems.push({itemId:c[0],count:c[1]})}t.refreshList("list_items")},a.onExit=function(){var e=this;t.loginCtrl.showNoticeOrFirstEnterGame(e.data.exData)},r}(mo.gui.Dlg);t.WanbaGift=e,egret.registerClass(e,"g_base.WanbaGift")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments),this.loop=!1}__extends(e,t);var r=(__define,e),i=r.prototype;return i.initMc=function(){var t=this;if(t.jsonData&&t.texture){var e=new egret.MovieClipDataFactory(t.jsonData,t.texture);t.movieClipData=e.generateMovieClipData(),t.frameRate=10,t.playAction()}},i.playAction=function(){this.loop?this.play(-1):this.gotoAndPlay(1,1)},i.loadRes=function(t,e,r,i){if(void 0===r&&(r=null),void 0===i&&(i=null),this.avatarSet!=t){this.avatarSet=t;var a=this,s=t,n="resource/dynamic2/"+t+".png";a.jsonData=mo.getData("mc",s),a.texture=null,RES.getResByUrl(n,function(s){a.avatarSet==t&&(a.texture=s,a.loop=e,a.initMc(),a.jsonData&&a.texture&&r&&r.call(i))},a)}},e}(egret.MovieClip);t.ActionPlayer=e,egret.registerClass(e,"g_base.ActionPlayer")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=__define,a=r,s=a.prototype;return s._initProp=function(){var t=this;e.prototype._initProp.call(this),t.redKeyArr=[-1,gc.c_prop.pointRedKey.home_main,gc.c_prop.pointRedKey.role_main,gc.c_prop.pointRedKey.make_main,-1,gc.c_prop.pointRedKey.shopMain],t._checkLvls=[30,50,80,110],t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.redPointData.toString(),t._updateRed)},s._childrenCreated=function(){e.prototype._childrenCreated.call(this);var r=this;r.modViewArr=[r.btn_fight,r.btn_home,r.btn_role,r.btn_forge,r.btn_bag,r.btn_shop],r._updateRed(),r.selected=t.modIdx},s._updateRed=function(){var t=this;if(t.modViewArr)for(var e=0,r=t.redKeyArr.length;r>e;e++){var i=t.modViewArr[e],a=t.redKeyArr[e];a>0?i.red_point.visible=gd.pointCtrl.isShow(a):i.red_point.visible=!1}},s._tap_btn_fight=function(){this._onTabClick(this.btn_fight);var t=this;mo.moduleMgr.runModule(g_consts.moduleId.fight,null,function(){egret.setTimeout(function(){t._checkBindCondtion()},t,200)})},s._tap_btn_home=function(){this._onTabClick(this.btn_home),mo.moduleMgr.runModule(g_consts.moduleId.home)},s._tap_btn_role=function(){this._onTabClick(this.btn_role),mo.moduleMgr.runModule(g_consts.moduleId.role)},s._tap_btn_forge=function(){this._onTabClick(this.btn_forge),mo.moduleMgr.runModule(g_consts.moduleId.forge)},s._tap_btn_bag=function(){this._onTabClick(this.btn_bag),mo.moduleMgr.runModule(g_consts.moduleId.bag)},s._tap_btn_shop=function(){this._onTabClick(this.btn_shop),mo.moduleMgr.runModule(g_consts.moduleId.shop)},s._onTabClick=function(t){for(var e=this,r=e.modViewArr,i=0,a=r.length;a>i;i++){var s=r[i];s.enabled=!0,s.img_s.visible=!1}t.enabled=!1,t.img_s.visible=!0,e.curModIdx=r.indexOf(t),e._updateRed()},s._checkBindCondtion=function(){var t=this,e=parseInt(gd.userCtrl.getLvl()),r=t._checkLvls;r.indexOf(e)>=0&&mo.moduleMgr.runModule(g_consts.moduleId.bindPhone)},i(s,"selected",function(){return this.curModIdx},function(t){var e=this;if(e.curModIdx!=t){for(var r=e.modViewArr,i=0,a=r.length;a>i;i++){var s=r[i];s.enabled=i!=t,s.img_s.visible=i==t}e.fight_hp.visible=0==t?!0:!1,e.btn_fight.visible=0!=t?!0:!1,e.curModIdx=t}}),s.updateHP=function(t){var e=this;e.fight_hp.updateHp(t[0],t[1])},s.updateMP=function(t){var e=this;e.fight_hp.updateMp(t[0],t[1])},r}(mo.gui.MenuLayer);t.BaseBottomBar=e,egret.registerClass(e,"g_base.BaseBottomBar")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){var e=this;t.prototype._initProp.call(this),e.touchEnabled=!1,e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.gold.toString(),e._updateRes),e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.diamond.toString(),e._updateRes),e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.lvl.toString(),e._updateRes),e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.combat.toString(),e._updateRes),e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.expc.toString(),e._updateExp),e.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.vip.toString(),e._updateRes),e.registerClassByKey(gd.PkOutCtrl,gc.dsConsts.PkOutEntity.pkValue.toString(),e._setUserName),e.registerClassByKey(gd.CoffersCtrl,gd.CoffersCtrl.ON_COFFERS_FIGHT,e.showCopyNameCoffers)},i.init=function(e){var r=this;r.__class;t.prototype.init.call(this,e),r.ownerScene=e},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.label_vip.text=gd.userCtrl.getVip().toString();var r=uiHelper.getHeroIcon(gd.userCtrl.getIconId(),1);mo.R.loadTo(e.ownerScene,r,function(){}),e.img_head.source=r,e._setUserName();var i=[],a=gd.userCtrl.getLvl(),s=a-1,n=mo.getJSONWithFileName(gc.cfg_c_lvl),o=0;for(var c in n)n.hasOwnProperty(c)&&o++;for(var g,l=0;o>l&&(g=n[l+1],g);l++)i.push(g[gc.c_lvl_reqExp]);e._total=mo.getJSONWithFileName(gc.cfg_c_lvl)[a][gc.c_lvl_minExp],e._total+=gd.userCtrl.getExp();var _=mo.gui.helper;_.initProgress(e.pb_exp,{baseArr:i,baseValue:gd.userCtrl.getExp(),baseIndex:s,onBaseChange:function(t){}}),e._updateRes(),mo.moduleMgr.curModule.name==g_consts.moduleId.home&&(e.grp_copyShow.visible=!1)},i._setUserName=function(){var t=this;t.label_name&&(t.label_name.text=gd.userCtrl.getName(),t.label_name.textColor=uiHelper.getUserNameColor(gd.pkOutCtrl.getPkValue()))},i.showCopyName=function(t,e){var r=this,i=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,t),a=mo.getJSONWithFileName(gc.cfg_t_monster),s=a[e];null!=s&&0!=s[gc.t_monster_bossLevel]?(r.label_copyId.visible=!1,r.ico_boss.visible=!0,r.label_copy_name.text=s[gc.t_monster_name]):(r.label_copyId.visible=!0,r.ico_boss.visible=!1,r.label_copyId.text=""+t,r.label_copy_name.text=i[gc.t_copy_name])},i.showCopyNameCoffers=function(t,e){var r=this;r.label_copyId.visible=!0,r.ico_boss.visible=!1,r.label_copyId.text=t+"服",r.label_copy_name.text=gc.c_prop.offersDoor[e]+"门"},i._updateRes=function(){var t=this;t.label_yuanbao.text=gd.userCtrl.getDiamond(),t.label_gold.text=gd.userCtrl.getGold()>1e6?(gd.userCtrl.getGold()/1e4>>0)+"万":gd.userCtrl.getGold(),t.label_lvl.text=gd.userCtrl.getLvl(),t.label_combat.text=gd.userCtrl.getCombat()+"",t.label_vip.text=gd.userCtrl.getVip().toString()},i._updateExp=function(t){var e=this,r=gd.userCtrl.getLvl(),i=mo.getJSONWithFileName(gc.cfg_c_lvl)[r][gc.c_lvl_minExp]+t;e.pb_exp&&null!=mo.utils.getExtData(e.pb_exp,"progressOpt")&&mo.gui.helper.progress(e.pb_exp,i-e._total)},i._tap_btn_plus_gold=function(){var t=this;gd.userCtrl.buyGold(function(){},t)},i._tap_btn_plus_yuanbao=function(){mo.moduleMgr.pushModule(g_consts.moduleId.recharge)},i._tap_img_vip=function(){mo.moduleMgr.pushModule(g_consts.moduleId.vip)},i._tap_img_detail=function(){var t=mo.moduleMgr.curModule.target;t&&t.layer.showProfileInfo()},e}(mo.gui.MenuLayer);t.BaseTopBar=e,egret.registerClass(e,"g_base.BaseTopBar")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var t=this;e.prototype._initProp.call(this),t._curHeroIdx=0,t._redKeyArr=[[gc.c_prop.pointRedKey.role1_main,gc.c_prop.pointRedKey.role2_main,gc.c_prop.pointRedKey.role3_main,gc.c_prop.pointRedKey.role4_main],[gc.c_prop.pointRedKey.role1_dazao,gc.c_prop.pointRedKey.role2_dazao,gc.c_prop.pointRedKey.role3_dazao],[]]},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.redPointData.toString(),t.checkRedPoint),t.registerClassByKey(gd.HeroEntityCtrl,gc.dsConsts.HeroEntity.combat.toString(),t._updateCombat),t.label_nickName.visible=!1,t.ico_hero0.onClick(t.onIconClick,t),t.ico_hero1.onClick(t.onIconClick,t),t.ico_hero2.onClick(t.onIconClick,t),t.ico_hero3.onClick(t.onIconClick,t);var r=gd.heroCtrl.getHeroByIndex(0);t._curHeroIdx=0,t.label_job.text=gc.c_prop.heroJob[r.job],t.label_combat.text=r.combat,t.setRoleSelected(t.ico_hero0),t.dataChanged()},a._updateCombat=function(){var t=this,e=gd.heroCtrl.getHeroByIndex(t._curHeroIdx);t.label_combat.text=e.combat},a.hideCombat=function(){var t=this;t.label_combat.visible=!1,t.ico_combat.visible=!1},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;t.ico_hero0.setData({index:0,heroCtrl:gd.heroCtrl}),t.ico_hero1.setData({index:1,heroCtrl:gd.heroCtrl}),t.ico_hero2.setData({index:2,heroCtrl:gd.heroCtrl}),t.ico_hero3.setData({index:3,heroCtrl:gd.heroCtrl}),t.checkRedPoint(),t.data.redType&&0!=t.data.redType?1==t.data.redType?t.img_title.source="ntc_text_forge":2==t.data.redType&&(t.img_title.source="tit_txt_g_fabaosf"):t.img_title.source="ntc_text_role"},a.checkRedPoint=function(){var t=this,e=t.data.redType||0;t.ico_hero0.setRedPointShow(gd.pointCtrl.isShow(t._redKeyArr[e][0])),t.ico_hero1.setRedPointShow(gd.pointCtrl.isShow(t._redKeyArr[e][1])),t.ico_hero2.setRedPointShow(gd.pointCtrl.isShow(t._redKeyArr[e][2])),t.ico_hero3.setRedPointShow(gd.pointCtrl.isShow(t._redKeyArr[e][3]))},a.setRoleSelected=function(t){var e=this;e.ico_hero0.setSelected(!1),e.ico_hero1.setSelected(!1),e.ico_hero2.setSelected(!1),e.ico_hero3.setSelected(!1),t.setSelected(!0)},a.onIconClick=function(e){var r=this,i=e.data.index;if(gd.heroCtrl.hasHeroByIndex(i)){gd.heroCtrl.curSelRoleIdx=i,r.setRoleSelected(e),r._curHeroIdx=i;var a=gd.heroCtrl.getHeroByIndex(i);return r.emitter.emit(r.__class.ON_HERO_CHANGED,a,i,r),r.label_job.text=gc.c_prop.heroJob[a.job],void(r.label_combat.text=a.combat)}3>i?gd.heroCtrl.isToBeOpen(i)&&t.CreateRole.create().setData({action:1}).show().onClose(r._updateIcons,r):gd.userCtrl.get(gc.dsConsts.UserEntity.lvl)>=145?t.Create4thRole.create().show().onClose(r._updateIcons,r):mo.showMsg(gc.id_c_msgCode.openRole4LvNotEnough)},a._updateIcons=function(){var t=this;t.ico_hero0.dataChanged(),t.ico_hero1.dataChanged(),t.ico_hero2.dataChanged(),t.ico_hero3.dataChanged()},a.hide4thRole=function(t){var e=this;e.ico_hero3.visible=!t,e.ico_hero3.includeInLayout=!t},r.ON_HERO_CHANGED="on_hero_changed",r}(mo.gui.MenuLayer);t.BaseTopRole=e,egret.registerClass(e,"g_base.BaseTopRole")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.tapShowDetail=!1}__extends(r,e);var i=(__define,r),a=i.prototype;return a._childrenCreated=function(){e.prototype._childrenCreated.call(this)},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,r=t.data,i=t.ico_item;"object"==typeof r?i.setData({itemId:r.itemId,count:r.count}):i.setData({itemId:r})},a._tap_rect_touch=function(e){var r=this;r.tapShowDetail&&t.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(r.ico_item.get("itemId"),null)}).show()},r}(mo.gui.ItemRenderer);t.BaseItemCell=e,egret.registerClass(e,"g_base.BaseItemCell")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){var e=this;t.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1},i._childrenCreated=function(){t.prototype._childrenCreated.call(this)},i.onEnter=function(){t.prototype.onEnter.call(this);var e=this;mo.runAction(e.label_msg,mo.moveBy(5,mo.p(-e.width,0)))},e}(mo.gui.TopLayer);t.BaseTopMsg=e,egret.registerClass(e,"g_base.BaseTopMsg")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a.partAdded=function(t,r){e.prototype.partAdded.call(this,t,r);var i=this,a=egret.TouchEvent.TOUCH_TAP;if("container"==t){var s=r.btn_info;s&&s.addEventListener(a,i._tap_btn_info,i)}},a._tap_btn_info=function(){var e=this;null!=e._helpDataId&&t.BaseShowTip.create().setData({id:e._helpDataId}).show()},r}(mo.gui.Dlg);t.CloseInfoDlg=e,egret.registerClass(e,"g_base.CloseInfoDlg")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this)},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data;if(r.length&&!r.hasOwnProperty("label")){var i=(r[0],""),a=[null,["熔炼","","活动","野外PK","聊天","签到","充值","VIP%s礼包"],["装备副本","炼狱副本","元神副本","竞技场商店","竞技场","","","日常任务","","签到"],["","技能","","翅膀","",""],["强化","升星","宝石","","",""],["","","","","",""],["","","商城","","",""],["","探宝"],["","行会宝库"],["装备副本(110级以上)","","元神副本(玄冰古道1以上)"]],s=parseInt(r[0]),n=parseInt(r[1]),o=parseInt(r[2]?r[2]:0);if(a[s]&&(i=a[s][n]),2==s&&0!=o)if(10==n){var c=o,g=mo.getJSONWithFileNameAndID(gc.cfg_c_vipCopy,c);i=g[gc.c_vipCopy_name]}else{var l=o,_=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,l);i=_[gc.t_copy_name]}else 1==s&&0!=o?i=mo.STR.format(i,o):99==s&&(i=gc.c_prop.outActivityType[n]);e.label_copyName.text=i}},e}(mo.gui.ItemRenderer);t.GainWayItem=e,egret.registerClass(e,"g_base.GainWayItem")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments),this.curShowItemIds=[],this.curFromItemIds=[]}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var r=this;r._Item_list_gainWay=t.GainWayItem},a._childrenCreated=function(){e.prototype._childrenCreated.call(this)},a.onEnter=function(){e.prototype.onEnter.call(this);var t=this,r=t.data.itemId;t.setShowItemId(r,0)},a.setShowItemId=function(e,r){var i,a=this,s=mo.getJSONWithFileNameAndID(gc.cfg_t_item,e);if(!gd.heroCtrl.isRuneCom(e))return t.GainWay.canBuyFromShop(e)?t.GainWayShop.create().setData({itemId:e}).show():t.GainWay.create().setData({itemId:e}).show(),void a.close();
if(a.curShowItemIds.length=r+1,a.curShowItemIds[r]=e,a.ico_arrow0.visible=!1,a.ico_arrow1.visible=!1,a.ico_topItem1.visible=!1,a.ico_topItem2.visible=!1,0==r?i=a.ico_topItem0:1==r?(a.ico_topItem1.visible=!0,i=a.ico_topItem1,a.ico_arrow0.visible=!0):2==r&&(a.ico_topItem1.visible=a.ico_topItem2=!0,i=a.ico_topItem2,a.ico_arrow0.visible=a.ico_arrow1.visible=!0),a.ico_light.x=i.x-4,a.ico_light.y=i.y-4,a.label_name.text=s[gc.t_item_name],i.setData({itemId:e,count:0}),a.ico_toItem.setData({itemId:e,count:0}),a.btn_back.visible=a.btn_merge.visible=!1,gd.heroCtrl.isRuneCom(e)){a.list_gainWay.visible=!1,a.grp_merge.visible=!0;var n=mo.getJSONWithFileNameAndID(gc.cfg_c_compound,e),o={},c=n[gc.c_compound_reqItems1];a.curFromItemIds.length=0,0!=c&&(o[c]=n[gc.c_compound_reqCount1],a.curFromItemIds.push(c));var g=n[gc.c_compound_reqItems2];0!=g&&(o[g]=n[gc.c_compound_reqCount2],a.curFromItemIds.push(g));var l=n[gc.c_compound_reqItems3];0!=l&&(o[l]=n[gc.c_compound_reqCount3],a.curFromItemIds.push(l));var _=n[gc.c_compound_reqItems4];0!=_&&(o[_]=n[gc.c_compound_reqCount4],a.curFromItemIds.push(_)),a.ico_line1.visible=!1,a.ico_line2.visible=!1,a.ico_line3.visible=!1,a.ico_fromItem1.visible=!1,a.ico_fromItem2.visible=!1,a.ico_fromItem0.x=87,1==a.curFromItemIds.length?a.ico_line1.visible=!0:2==a.curFromItemIds.length?(a.ico_line2.visible=!0,a.ico_fromItem1.visible=!0,a.ico_fromItem0.x=0):3==a.curFromItemIds.length&&(a.ico_line3.visible=!0,a.ico_fromItem1.visible=!0,a.ico_fromItem2.visible=!0,a.ico_fromItem0.x=0);for(var u,d=0;d<a.curFromItemIds.length;++d){var e=a.curFromItemIds[d],p=o[e],m=gd.heroCtrl.getRealmCount(e);0==d?u=a.ico_fromItem0:1==d?u=a.ico_fromItem1:2==d&&(u=a.ico_fromItem2),u.setData({itemId:e,pileCount:m,count:p})}a.btn_merge.visible=!0}else{a.grp_merge.visible=!1;var f=[].concat(s[gc.t_item_dropId]||[]);f.length?(a.list_gainWay.dataProvider=new egret.gui.ArrayCollection(f),a.list_gainWay.visible=!0):a.list_gainWay.visible=!1,a.btn_back.visible=!0}},a._tap_ico_topItem0=function(){var t=this;t.setShowItemId(t.curShowItemIds[0],0)},a._tap_ico_topItem1=function(){var t=this;t.setShowItemId(t.curShowItemIds[1],1)},a._tap_ico_fromItem0=function(){var t=this;t.setShowItemId(t.curFromItemIds[0],t.curShowItemIds.length)},a._tap_ico_fromItem1=function(){var t=this;t.setShowItemId(t.curFromItemIds[1],t.curShowItemIds.length)},a._tap_ico_fromItem2=function(){var t=this;t.setShowItemId(t.curFromItemIds[2],t.curShowItemIds.length)},a._tap_btn_merge=function(){var t=this,e=t.data.itemId;gd.equipCtrl.compound(e,function(){t.close(),t.data.delegate&&t.data.delegate.reset()},t)},a._tap_btn_back=function(){var t=this;t.curShowItemIds.length<=1?t.close():t.setShowItemId(t.curShowItemIds[t.curShowItemIds.length-2],t.curShowItemIds.length-2)},a._click_list_gainWay=function(e){var r,i=e.item,a=i,s=parseInt(a[0]),n=parseInt(a[1]),o=parseInt(a[2]?a[2]:0);switch(s){case 6:r={subModuleId:n},mo.moduleMgr.runModule(g_consts.moduleId.shop,r);break;case 4:r={subModuleId:n},mo.moduleMgr.runModule(g_consts.moduleId.forge,r);break;case 3:r={subModuleId:n},mo.moduleMgr.runModule(g_consts.moduleId.role,r);break;case 2:if(0!=o)if(10==n)mo.moduleMgr.runModule(g_consts.moduleId.vipCopy,{vip:o});else{var c=o;gd.copyCtrl.isCopyLocked(c)?mo.showMsg("该副本还未解锁！"):t.CopyLoot.create().setData({copyId:c}).show()}else r={subModuleId:n},mo.moduleMgr.runModule(g_consts.moduleId.home,r);break;case 1:r={subModuleId:n},mo.moduleMgr.runModule(g_consts.moduleId.fight,r)}},r}(mo.gui.Dlg);t.ItemMerge=e,egret.registerClass(e,"g_base.ItemMerge")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return r.canBuyFromShop=function(t){for(var e=mo.getJSONWithFileNameAndID(gc.cfg_t_item,t),r=[].concat(e[gc.t_item_dropId]||[]),i=!1,a=0;a<r.length;++a){var s=r[a];if(6==s[0]&&2==s[1]){i=!0;break}}return i},a._initProp=function(){e.prototype._initProp.call(this);var r=this;r._Item_list_gainWay=t.GainWayItem},a.onEnter=function(){e.prototype.onEnter.call(this);var t=this,r=t.data.itemId,i=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r);t.ico_item.setData({itemId:r,count:0}),t.label_name.text=i[gc.t_item_name],t.showGainWayList()},a.showGainWayList=function(){var t=this,e=t.data.itemId,r=mo.getJSONWithFileNameAndID(gc.cfg_t_item,e),i=r[gc.t_item_dropId]||[],a=gd.activityCtrl.getLotteryActivity();if(!a)for(var s=0;s<i.length;++s){var n=i[s],o=parseInt(n[0]);if(7==o){i.splice(s,1);break}}t.list_gainWay.dataProvider=new egret.gui.ArrayCollection(i),t.label_noOut.visible=0==i.length,t.list_gainWay.visible=0!=i.length},a._tap_btn_back=function(){var t=this;t.close()},a._click_list_gainWay=function(e){var r,i=e.item,a=this,s=i,n=parseInt(s[0]),o=parseInt(s[1]),c=parseInt(s[2]?s[2]:0);switch(n){case 8:r={subModuleId:o},gd.guildCtrl.getInfo(function(t){var e=t[0];e?mo.moduleMgr.runModule(g_consts.moduleId.guildMineLayer,r):mo.showMsg(gc.id_c_msgCode.noGuild)},a);break;case 7:r={subModuleId:o},mo.moduleMgr.runModule(g_consts.moduleId.treasure,r);break;case 6:r={subModuleId:o},mo.moduleMgr.runModule(g_consts.moduleId.shop,r);break;case 4:r={subModuleId:o},mo.moduleMgr.runModule(g_consts.moduleId.forge,r);break;case 3:r={subModuleId:o},mo.moduleMgr.runModule(g_consts.moduleId.role,r);break;case 2:if(0!=c)if(10==o)mo.moduleMgr.runModule(g_consts.moduleId.vipCopy,{vip:c});else{var g=c;gd.copyCtrl.isCopyLocked(g)?mo.showMsg("该副本还未解锁！"):t.CopyLoot.create().setData({copyId:g}).show()}else r={subModuleId:o},mo.moduleMgr.runModule(g_consts.moduleId.home,r);break;case 1:process.nextTick(function(){r={subModuleId:o,param:c},mo.moduleMgr.runModule(g_consts.moduleId.fight,r)});break;case 99:}},r}(mo.gui.Dlg);t.GainWay=e,egret.registerClass(e,"g_base.GainWay")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this)},i.onEnter=function(){t.prototype.onEnter.call(this);var e=this,r=e.data.count||0;1>r&&(r=1),e.buyNum=r;var i=e.getShopType();gd.shopCtrl.getList(i,function(t){for(var r=0;r<t.length;++r){var i=t[r],a=i[0];if(a==e.data.itemId){e.shopItem=i,e.index=r,e.label_costOne.text=i[3],e.showNum();break}}},e)},i.showGainWayList=function(){var t=this,e=t.data.itemId,r=mo.getJSONWithFileNameAndID(gc.cfg_t_item,e),i=[].concat(r[gc.t_item_dropId]||[]);if(i.length){for(var a=0;a<i.length;++a){var s=i[a];if(6==s[0]&&2==s[1]){i.splice(a--,1);break}}t.list_gainWay.dataProvider=new egret.gui.ArrayCollection(i)}t.label_noOut.visible=0==i.length,t.list_gainWay.visible=0!=i.length},i.getShopType=function(){var t=this,e=mo.getJSONWithFileNameAndID(gc.cfg_t_item,t.data.itemId),r=0;return r=e[gc.t_item_type]==gc.c_prop.itemTypeKey.gem?gc.c_prop.shopTypeKey.gem:gc.c_prop.shopTypeKey.normal},i.setCurShopItem=function(){var t=this,e=t.shopItem;e[0],e[1],e[2],e[3],e[4]},i._tap_btn_sub=function(){var t=this;t.buyNum>1&&(t.buyNum--,t.showNum())},i._tap_btn_add=function(){var t=this;t.buyNum<t._getMaxBuyNum()&&(t.buyNum++,t.showNum())},i._tap_btn_min=function(){var t=this;t.buyNum-=10,t.buyNum<1&&(t.buyNum=1),t.showNum()},i._tap_btn_max=function(){var t=this;t.buyNum+=10,t.buyNum>t._getMaxBuyNum()&&(t.buyNum=t._getMaxBuyNum()),t.showNum()},i.showNum=function(){var t=this;t.label_num.text=t.buyNum,t.label_costAll.text=t.buyNum*t.shopItem[3]},i._getMaxBuyNum=function(){var t=this,e=t.shopItem,r=e[2],i=utils.getCurrencyTypeItemId(r),a=e[4],s=e[3];return 0>a?Math.max(1,Math.floor(gd.userCtrl.getItemNum(i)/s)):a},i._tap_btn_ok=function(){var t=this,e=t.getShopType();gd.shopCtrl.buy(e,t.index,t.buyNum,function(){t.close()},t)},i._tap_btn_recharge=function(){mo.moduleMgr.pushModule(g_consts.moduleId.recharge)},e}(t.GainWay);t.GainWayShop=e,egret.registerClass(e,"g_base.GainWayShop")}(g_base||(g_base={}));var g_base;!function(t){t.isShowOffline=!1;var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var t=this;e.prototype._initProp.call(this),t.outsideClosable=!0},a.onExit=function(){e.prototype.onExit.call(this);var r=mo.getLocalStorageItem("noticeCloseCount");if(mo.setLocalStorageItem("noticeCloseCount",parseInt(r)+1),!t.isShowOffline){t.isShowOffline=!0;var i=gd.userCtrl&&gd.userCtrl.offLineData||[];i[0]>0&&mo.showMsg(gc.id_c_msgCode.offlineGain,{offlineProfit:i})}},a._handleExtArg=function(t){var e=this,r=t.sysNotice;if(r){e.label_title.text=r[gc.dsConsts.NoticeEntity.title],e.label_text.text=r[gc.dsConsts.NoticeEntity.content];var i=r[gc.dsConsts.NoticeEntity.exData];if(i){var a=i[1];if(a){var s="resource/ui2/ui_notice/"+a;RES.getResByUrl(s,function(t){e.ico_head.source=t},e,RES.ResourceItem.TYPE_IMAGE)}}}},r}(mo.gui.MsgDlg);t.Notice=e,egret.registerClass(e,"g_base.Notice")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var t=this;e.prototype._initProp.call(this),t.outsideClosable=!0},a._tap_ico_title_1=function(){t.NoticeContentDlg.create().setData({notices:gd.NoticeCtrl.getTpyeNotice(3)}).show()},a._tap_ico_title_4=function(){t.NoticeContentDlg.create().setData({notices:gd.NoticeCtrl.getTpyeNotice(4)}).show()},a._tap_ico_title_2=function(){t.NoticeContentDlg.create().setData({notices:gd.NoticeCtrl.getTpyeNotice(2)}).show()},r}(mo.gui.Dlg);t.NoticeDlg=e,egret.registerClass(e,"g_base.NoticeDlg")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){var e=this;t.prototype._initProp.call(this),e.outsideClosable=!0},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data.notices;if(0==r.length)return e.label_title.text="暂无",void(e.label_text.text="");var i=r[0],a=i[gc.dsConsts.NoticeEntity.iconType];if(4!=a){e.label_title.text=i[gc.dsConsts.NoticeEntity.title],e.label_text.text=i[gc.dsConsts.NoticeEntity.content];var s=i[gc.dsConsts.NoticeEntity.exData];if(s){var n=s[1];if(n){var o="resource/ui2/ui_notice/"+n;RES.getResByUrl(o,function(t){e.ico_head.source=t},e,RES.ResourceItem.TYPE_IMAGE)}}}else{e.label_title.text="跨服战况";for(var c="",g=0;g<r.length;++g){var l=r[g];c+=l[gc.dsConsts.NoticeEntity.content]+"\n\n"}e.label_text.text=c}},e}(mo.gui.Dlg);t.NoticeContentDlg=e,egret.registerClass(e,"g_base.NoticeContentDlg")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this,r=mo_channel.getCurChannel();("weibo"==r||"100191"==r)&&(e.ico_sanpin_txt.visible=!1)},e}(mo.gui.MsgDlg);t.FirstEnterGame=e,egret.registerClass(e,"g_base.FirstEnterGame")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var r=this;e.prototype._initProp.call(this),r.outsideClosable=!0,mo.gui.helper.setSkinName(this,t.BaseShowTip.__className)},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;t.label_tips.text=t.data.msg;var r=t.data.interval;null!=r&&(t._timer=egret.setTimeout(t.close,t,1e3*r)),process.nextTick(function(){process.nextTick(function(){t.ico_bg.height=2*t.label_tips.y+t.label_tips.height,t._timer&&t.onClose(function(){egret.clearTimeout(t._timer),t._timer=null})})})},r}(mo.gui.Dlg);t.BaseShowMsg=e,egret.registerClass(e,"g_base.BaseShowMsg")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){var e=this;t.prototype._initProp.call(this),e.outsideClosable=!0},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=mo.getJSONWithFileNameAndID(gc.cfg_c_help,e.data.id),i=e.data.param1,a=e.data.param2,s=e.data.param3;void 0!=i&&void 0!=a&&void 0!=s?e.label_tips.text=mo.STR.format(r[gc.c_help_helpText],i,a,s):void 0!=i&&void 0!=a?e.label_tips.text=mo.STR.format(r[gc.c_help_helpText],i,a):void 0!=i?e.label_tips.text=mo.STR.format(r[gc.c_help_helpText],i):e.label_tips.text=r[gc.c_help_helpText],process.nextTick(function(){process.nextTick(function(){e.ico_bg.height=2*e.label_tips.y+e.label_tips.height})})},e}(mo.gui.Dlg);t.BaseShowTip=e,egret.registerClass(e,"g_base.BaseShowTip")}(g_base||(g_base={}));var g_base;!function(t){t.baseShowAnnounce=null;var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var r=this;e.prototype._initProp.call(this),mo.gui.helper.setSkinName(this,t.BaseShowTip.__className),this.outsideClosable=!1,r.dlgParam={},r.msgData={},r.msgArgs=[]},a.dataChanged=function(){e.prototype.dataChanged.call(this);var r=this;r.curAnnounce=r.data[0];var i=r.curAnnounce[gc.dsConsts.ChatData.sysArgs];r.label_tips.text=i[1];var a=i[i.length-1];process.nextTick(function(){process.nextTick(function(){r.ico_bg.height=2*r.label_tips.y+r.label_tips.height,a>0&&(r.curTimer=egret.setTimeout(r.close,r,1e3*a)),r.onClose(function(){t.baseShowAnnounce=null,egret.clearTimeout(r.curTimer),r.curTimer=null,gd.hoodinnCtlr.delAnnounce(r.curAnnounce[gc.dsConsts.ChatData.uniqueId]);var e=gd.hoodinnCtlr.getAllAnnounces();e.length&&(t.baseShowAnnounce=t.BaseShowAnnounce.create().setData(e).show())})})})},r}(mo.gui.MsgDlg);t.BaseShowAnnounce=e,egret.registerClass(e,"g_base.BaseShowAnnounce")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments),this.outsideClosable=!0}__extends(e,t);var r=(__define,e),i=r.prototype;return i._childrenCreated=function(){t.prototype._childrenCreated.call(this),this.ico_item.label_text.visible=!1,this.label_specialEquip.visible=!1,this.label_locked.visible=!1,this.label_unlocked.visible=!1},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data.bdc;e.ico_item.set("itemId",r.tempId),e.label_name.text=r.name,e.grp_equip.visible=!1,e.grp_item_sale.visible=!1,r.isEquip()?(e.grp_equip.visible=!0,e._setEquipInfo(),e.img_bg.height=440):e._setItemInfo();var i=e.data.isBag;i&&0!=i||(e.grp_equip.visible=!1,e.grp_item_sale.visible=!1,e.btn_ok.visible=!0,e.img_bg.height=400)},i._calculateRewards=function(){var t=this;t.label_items.text="",t.grp_gold.parent&&t.grp_gold_container.removeElement(t.grp_gold),t.grp_yuanbao.parent&&t.grp_gold_container.removeElement(t.grp_yuanbao);for(var e in t.rewards){var r=t.rewards[e];99==e?(t.grp_gold.parent||t.grp_gold_container.addElement(t.grp_gold),t.label_gold.text="获得: "+r.c*t.buyNum):200==e?(t.grp_yuanbao.parent||t.grp_gold_container.addElement(t.grp_yuanbao),t.label_yuanbao.text=""+r.c*t.buyNum):t.label_items.text=t.label_items.text+" "+r.n+"x"+r.c*t.buyNum}process.nextTick(function(){process.nextTick(function(){t.img_bg.height=t.grp_item_sale.y-t.img_bg.y+t.grp_item_sale.height+20})})},i._setItemInfo=function(){var t=this;this.ico_item.label_text.visible=!1;var e=t.data.bdc;t.label_desc1.text=mo.STR.format("需求等级Lv%s",e.level),t.label_desc2.text=e.note,t.label_desc3.visible=!1;var r=mo.getJSONWithFileName(gc.cfg_t_sellItem);if(r[e.tempId]){t.rewards={},t.buyNum=1,t.grp_item_sale.visible=!0;for(var i=r[e.tempId][gc.t_sellItem_items],a=0;a<i.length;a++){var s=i[a][0],n=i[a][1],o=t.rewards[s];if(o)t.rewards[s].c=o.c+n;else{var c=mo.getJSONWithFileNameAndID(gc.cfg_t_item,s);t.rewards[s]={c:n,n:c[gc.t_item_name]}}}t._calculateRewards()}else t.grp_item_sale.visible=!1,t.btn_ok.visible=!0,t.img_bg.height=395,t.btn_ok.icon="btn_txt_g_ok",e.type==gc.c_prop.itemTypeKey.custom&&(t.btn_ok.icon="btn_txt_g_dingzisfg")},i._setEquipInfo=function(){var t=this;this.ico_item.label_text.visible=!0;var e=t.data.bdc,r=t.data.extra,i=null==e.equipId&&!r&&!(gd.equipCtrl.isSpecialEquip(e.tempId)||gd.equipCtrl.isRareEquip(e.tempId)),a=i?0:e.equipId?gd.equipCtrl.getEquipEvaluate(e.equipId):r&&null!=r[0]?r[0]:gd.equipCtrl.getSpecialEquipEvaluate(e.tempId),s=i?[]:e.equipId?gd.equipCtrl.getEquipExtraObj(e.equipId):utils.kvArr2KvObj(r&&null!=r[1]?r[1]:gd.equipCtrl.getSpecialEquipExtra(e.tempId));t.label_desc1.text=i?mo.STR.format("[ubb]部位: %s[/ubb]",e.equipTypeName):mo.STR.format("[ubb]评分: %s[/ubb][/br][ubb]部位: %s[/ubb]",a,e.equipTypeName);for(var n,o=e.proptys,c="[ubb]%s: %s[/ubb][ubb] +%s[/ubb][/br]",g="[ubb color=0x2EAAF7]%s: %s[/ubb][ubb color=0x2EAAF7] +%s[/ubb][/br]",l="",_=0,u=o.length;u>_;_++){n=o[_];var d=n[0],p=n[1];l+=mo.STR.format(0==_?c:g,gc.c_prop.equipProp[d],p,i?" ?":s[d]||0)}t.label_desc2.text=l,t.label_desc3.text=mo.STR.format("需求等级Lv%s",e.level),uiHelper.setLabelGreenOrRed(t.label_desc3,gd.userCtrl.getLvl()>=e.level),t.label_specialEquip.visible=gd.equipCtrl.isSpecialEquip(e.tempId),t.label_locked.visible=e.islock?!0:!1,t.label_unlocked.visible=e.islock?!1:!0,1==e.islock?(t.grp_sell_btns.visible=!1,t.btn_unlock.visible=!0):(t.grp_sell_btns.visible=!0,t.btn_unlock.visible=!1)},i._tap_btn_lock=function(){var t=this,e=t.data.bdc,r=t.data.item;e.isEquip()&&gd.equipCtrl.updateEquipItemLockStatus(e.equipId,!0,function(){e.islock=1,t.label_locked.visible=e.islock?!0:!1,t.label_unlocked.visible=e.islock?!1:!0,t.btn_lock.visible=!1,t.btn_unlock.visible=!0,r.ico_lock.visible=!0,t.grp_sell_btns.visible=!1},t)},i._tap_btn_unlock=function(){var t=this,e=t.data.bdc,r=t.data.item;e.isEquip()&&gd.equipCtrl.updateEquipItemLockStatus(e.equipId,!1,function(){e.islock=0,t.label_locked.visible=e.islock?!0:!1,t.label_unlocked.visible=e.islock?!1:!0,t.btn_lock.visible=!0,t.btn_unlock.visible=!1,r.ico_lock.visible=!1,t.grp_sell_btns.visible=!0},t)},i._tap_btn_sell=function(){var t=this,e=t.data.bdc,r="",i=mo.getJSONWithFileName(gc.cfg_t_sellItem);if(i[e.tempId]){var a=i[e.tempId][gc.t_sellItem_items];for(var s in a){var n=a[s],o=mo.getJSONWithFileNameAndID(gc.cfg_t_item,n[0]);r=r+" "+o[gc.t_item_name]+"x"+n[1]*t.buyNum}}mo.showMsg(gc.id_c_msgCode.ifSellItem,r,function(){gd.userCtrl.sellItems(e.tempId,t.buyNum,function(){t.close()},t)})},i._tap_btn_sale=function(){var t=this,e=t.data.bdc,r="",i=mo.getJSONWithFileName(gc.cfg_t_sellItem),a="",s=null;if(i[e.tempId]){var n=i[e.tempId][gc.t_sellItem_items];s=i[e.tempId][gc.t_sellItem_sells];for(var o in s){var c=s[o],g=mo.getJSONWithFileNameAndID(gc.cfg_t_item,c[0]);a=a+" "+g[gc.t_item_name]+"x"+c[1]}for(var o in n){var c=n[o],g=mo.getJSONWithFileNameAndID(gc.cfg_t_item,c[0]);r=r+" "+g[gc.t_item_name]+"x"+c[1]}}a.length>0?mo.showMsg(gc.id_c_msgCode.ifSellItem3,a,r,function(){var r=t.checkNeedItemEnough(s);return 0==r?void mo.showMsg("物品不足"):void gd.equipCtrl.sellEquipItem([e.equipId],function(){t.close()},t)}):mo.showMsg(gc.id_c_msgCode.ifSellItem,r,function(){gd.equipCtrl.sellEquipItem([e.equipId],function(){t.close()},t)})},i.checkNeedItemEnough=function(t){return!0},i._tap_btn_ok=function(){var t=this;t.close();var e=t.data.bdc;e.type==gc.c_prop.itemTypeKey.custom&&mo.moduleMgr.runModule(g_consts.moduleId.customList,{itemId:e.tempId})},i._tap_btn_sub=function(){var t=this;t.buyNum>1&&(t.buyNum--,t.showNum())},i._tap_btn_add=function(){var t=this;t.buyNum<t.data.bdc.count&&(t.buyNum++,t.showNum())},i._tap_btn_min=function(){var t=this;t.buyNum=1,t.showNum()},i._tap_btn_max=function(){var t=this;t.buyNum=t.data.bdc.count,t.showNum()},i.showNum=function(){var t=this;t.data.bdc;t.label_num.text=t.buyNum,t._calculateRewards()},e}(mo.gui.Dlg);t.BaseItemDetail=e,egret.registerClass(e,"g_base.BaseItemDetail")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this)},i.onEnter=function(){t.prototype.onEnter.call(this);var e=this;e.label_hour.text=Math.floor(mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.offlineCfg)[1]/3600)+""},i._handleExtArg=function(t){var e=this,r=t.offlineProfit;if(r){var i=(gd.userCtrl.getVip(),r[0]),a=Math.floor(i/3600),s=Math.floor((i-3600*a)/60);i%=60,e.label_offlineTime.text=mo.STR.format("%s时%s分%s秒",a,s,i),e.label_offlineExp.text=mo.STR.format("经验：%s",r[1]),e.label_offlineGold.text=mo.STR.format("金币：%s",r[2]),e.label_offlineEquip.text=mo.STR.format("%s级装备*%s",r[3],r[4]),e.label_offlineEquip.visible=0!=r[4],e.label_autoSell.text=mo.STR.format("因背包已满，自动出售%s件装备",r[5]),e.label_autoSell.visible=0!=r[5];for(var n=r[6],o="",c=0;c<n.length;++c){var g=n[c],l=g[0],_=g[1],u=mo.getJSONWithFileNameAndID(gc.cfg_t_item,l);o+=u[gc.t_item_name]+": "+_+"个\n"}e.label_box.text=o}},i._tap_btn_ok=function(){var t=this;t.close()},e}(mo.gui.MsgDlg);t.OfflineGain=e,egret.registerClass(e,"g_base.OfflineGain")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),this._layerOpt.activateUnderDisabled=!0},i.onEnter=function(){t.prototype.onEnter.call(this);var e=this.grp_juHua;mo.ACT.stop(e),mo.ACT.run(e,mo.repeatForever(mo.rotateBy(2,360)))},i.onExit=function(){t.prototype.onExit.call(this);var e=this.grp_juHua;mo.ACT.stop(e)},e}(mo.gui.TopLayer);t.BaseJuHua=e,egret.registerClass(e,"g_base.BaseJuHua")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var r=this;e.prototype._initProp.call(this),r._Item_list_items=t.BaseItemCell},a._data_list_items=function(){var t=this;return gd.userUtils.getLoots(gd.copyCtrl.getCopyLootList(t.data.copyId))},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,r=t.data.copyId,i=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,r);t.titleDisplay.text=i[gc.t_copy_name],t.label_rest.text=gd.copyCtrl.getCopyCount(r);var a=gd.copyCtrl.getCopyType(r),s=a==gc.c_prop.copyTypeKey.equip?gc.c_prop.spItemIdKey.equipTessera:gc.c_prop.spItemIdKey.realmTessera,n=gd.copyCtrl.getTesseraCount(s),o=n>0;t.TesseraKey=s,t.grp_res0.visible=!o,t.label_cost.visible=o,o?t.label_cost.text=mo.STR.format("[ubb color=0x6deb82]%s[/ubb]:%s/%s",gc.c_prop.spItemId[s],gd.copyCtrl.getTesseraCount(s),1):uiHelper.setResGrp(t.grp_res0,gc.c_prop.spItemIdKey.diamond,gd.copyCtrl.getTesseraPrice(s));var c=Math.min(n,gd.copyCtrl.getCopyCount(r));t.label_saoDang.visible=c>0,c>0&&(t.label_saoDang.text=c)},a._tap_btn_buy_times=function(){var t=this,e=t.data.copyId;gd.copyCtrl.buyCopyCount1(e,function(){t.label_rest.text=gd.copyCtrl.getCopyCount(e)},t)},a._tap_btn_enter=function(){var t=this,e=t.data.copyId;gd.fightCtrl.enterCopy(e)},a._tap_btn_sweep=function(){var e=this,r=e.data.copyId,i=gd.copyCtrl.getCopyStar(r);if(3>i)return mo.showMsg(gc.id_c_msgCode.notPerfect);if(gd.copyCtrl.getCopyCount(r)<=0)return void gd.copyCtrl.buyCopyCount1(r,function(){e.label_rest.text=gd.copyCtrl.getCopyCount(r)},e);if(gd.copyCtrl.getTesseraCount(e.TesseraKey)>0)gd.copyCtrl.copyWipe(r,function(i){t.CopySweepAward.create().setData({copyId:r,items:i[0],num:i[1]}).show(),e.dataChanged(),e.close()},e);else{var a=gd.copyCtrl.getTesseraPrice(e.TesseraKey)*gd.copyCtrl.getCopyCount(r);mo.showMsg(gc.id_c_msgCode.noticket,a,gd.copyCtrl.getCopyCount(r),function(){gd.copyCtrl.copyWipe(r,function(i){t.CopySweepAward.create().setData({copyId:r,items:i[0],num:i[1]}).show(),e.dataChanged(),e.close()},e)})}},a._tap_btn_wipe=function(){},r}(mo.gui.Dlg);t.CopyLoot=e,egret.registerClass(e,"g_base.CopyLoot")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var r=this;e.prototype._initProp.call(this),r._Item_list_items=t.BaseItemCell},a._data_list_items=function(){var t=this,e=t.data.items,r=[];for(var i in e)r.push({itemId:i,count:e[i]});return r},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,r=t.data.copyId,i=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,r);t.titleDisplay.text=i[gc.t_copy_name],t.sweep_num.text="本次操作扫荡副本"+t.data.num+"次"},a.onEnter=function(){e.prototype.onEnter.call(this);var t=this,r=10;t.setCDTime(r)},a._tap_btn_enter=function(){var t=this;t._tap_btn_back()},a.onExit=function(){e.prototype.onExit.call(this);var t=this;t.timeTrigger&&(tm.timer.remove(t.timeTrigger),t.timeTrigger=null)},a.setCDTime=function(t){var e=this;if(t>0){e.timeTrigger&&(tm.timer.remove(e.timeTrigger),e.timeTrigger=null);var r=Date.newDate(Date.newDate().getTime()+1e3*t),i=e.timeTrigger=new tm.Trigger(r);i.on(tm.Trigger.ON_SECOND,e.timeSec,e),i.on(tm.Trigger.ON_END,e.timeOut,e),tm.timer.add(i),e.label_cost.text=mo.STR.format("确定(%s)",t.toString())}},a.timeSec=function(t,e,r){var i=this,a=Date.newDate().getTime(),s=Date.newDate(r).getTime(),n=s-a;i.label_cost.text=mo.STR.format("确定(%s)",Math.floor(n/1e3).toString())},a.timeOut=function(t,e,r){var i=this;i._tap_btn_back()},a._tap_btn_back=function(){var t=this;t.close()},r}(mo.gui.Dlg);t.CopySweepAward=e,egret.registerClass(e,"g_base.CopySweepAward")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var r=this;e.prototype._initProp.call(this),r._Item_list_items=t.BaseItemCell},a._data_list_items=function(){var t=this;return gd.userUtils.getLoots(gd.copyCtrl.getCopyLootList(t.data.copyId))},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,r=t.data.copyId,i=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,r);t.titleDisplay.text=i[gc.t_copy_name];var a=gd.copyCtrl.getCopyVip(r);t.label_rest.text=[gd.copyCtrl.getVipCopyReTimes(a),gd.copyCtrl.getMaxVipCopyTimes(a)]},a._tap_btn_enter=function(){var t=this,e=t.data.copyId;gd.fightCtrl.enterCopy(e)},r}(mo.gui.Dlg);t.VipCopyLoot=e,egret.registerClass(e,"g_base.VipCopyLoot")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._isCustomName=!1}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var r=this;e.prototype._initProp.call(this),r._layerOpt.shownWithAction=!1,r._Item_list_jobs=t.CreateRoleItem},a._data_list_jobs=function(){return[1,2,3]},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;"Android"==egret.Capabilities.os&&(t.inputName.touchEnabled=!0,t.inputName.editable=!1,t.inputName.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var e=prompt("请输入角色名",t.inputName.text);null!=e&&(t.inputName.text=e)},t))},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,r=t.data.action||0,i=1==r;if(t.btn_back.visible=i,t.grp_create.visible=!i,t.label_unlock.visible=i,t.grp_userAgreement.visible=!i,i){for(var a=1;3>=a;a++)if(!gd.heroCtrl.hasHeroByJob(a)){t.list_jobs.selectedItem=a,t._setJobDesc(a);break}t.label_unlock.text=gd.heroCtrl.getList().length+1}else{var s=null,n=gd.accountCtrl.get(gc.dsConsts.AccountEntity.sdkData);n&&(s=n.name);var o={};mo.requestWaiting4Server(gc.iface.c_account_getThirdUserInfo,o,function(e){t._isCustomName=null==e;var r=e?e.nickname:mo.STR.sub(utils.filterName(s,gc.c_prop.sexKey.male),0,14);t.inputName.text=r}),t.list_jobs.selectedIndex=0,t._setJobDesc(1)}t._gender=gc.c_prop.sexKey.male},a._setJobDesc=function(t){var e=this,r=mo.getJSONWithFileName(gc.cfg_t_hero),i=r[t];e.label_job_desc.text=[i[gc.t_hero_name],i[gc.t_hero_describe]],e._job=t},a._tap_btn_create=function(){var e=this,r=e.data.action||0,i=1==r;if(i){var a=gd.heroCtrl.getHeroOpenCfg(gd.heroCtrl.getNextIdxToBeOpen());if(gd.userCtrl.getLvl()<a[0]){gd.heroCtrl.getNextIdxToBeOpen()+1;if(a[1]>gd.userCtrl.getVip())return mo.showMsg(gc.id_c_msgCode.ifBuyRole,a[1]);gd.heroCtrl.callHero(e._job,e._gender,e.close,e)}else gd.heroCtrl.callHero(e._job,e._gender,e.close,e)}else{if(!e.ckb_argree.selected)return mo.showMsg(gc.id_c_msgCode.disAgree);gd.UserCtrl.createUser(e.inputName.text,e._job,e._gender,function(){t.loginCtrl.enterGame(!0)},e)}},a._tap_btn_back=function(){var t=this;t.close()},a._tap_btn_dice=function(){var t=this,e=utils.getRandomName(t._gender);t.inputName.text=e},a._tap_img_userAgreement=function(){mo.moduleMgr.runModule(g_consts.moduleId.userAgreement)},a._initItem_list_jobs=function(e){var r=this;e.emitter.on(t.CreateRoleItem.ON_GENDER_CHANGED,function(t,e){if(r._setJobDesc(e),r._gender=t,r._isCustomName){var i=utils.getRandomName(r._gender);r.inputName.text=i}},r)},r}(mo.gui.Dlg);t.CreateRole=e,egret.registerClass(e,"g_base.CreateRole")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.img_border.visible=!1},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data;e.enabled=gd.heroCtrl?!gd.heroCtrl.hasHeroByJob(r):!0,e.enabled?(e.ico_0.source=mo.STR.format("avatar_%s_%s_1",r,0),e.ico_1.source=mo.STR.format("avatar_%s_%s_1",r,1)):(e.ico_0.source=mo.STR.format("avatar_%s_%s_2",r,0),e.ico_1.source=mo.STR.format("avatar_%s_%s_2",r,1)),e.ico_job.source=mo.STR.format("txt_job_%s",r),e.img_border.visible=!1,e.invalidateSkinState()},i._ico_clicked=function(t){var e=this,r=t.width,i=t.height,a=e.img_border.width,s=e.img_border.height;e.img_border.x=t.x-(a-r)/2,e.img_border.y=t.y-(s-i)/2},i._tap_ico_0=function(){var t=this;t._ico_clicked(t.ico_0),t.emitter.emit(t.__class.ON_GENDER_CHANGED,gc.c_prop.sexKey.female,t.data,t)},i._tap_ico_1=function(){var t=this;t._ico_clicked(t.ico_1),t.emitter.emit(t.__class.ON_GENDER_CHANGED,gc.c_prop.sexKey.male,t.data,t)},i.getCurrentSkinState=function(){var e=t.prototype.getCurrentSkinState.call(this);return this.img_border.visible=this.selected,this.selected||this._ico_clicked(this.ico_1),e},e.ON_GENDER_CHANGED="on_gender_changed",e}(mo.gui.ItemRenderer);t.CreateRoleItem=e,egret.registerClass(e,"g_base.CreateRoleItem")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.show=function(){var e=this;return t.prototype.show.call(this),e.visible=e._isFightScene(),e},i._onShowReady=function(){t.prototype._onShowReady.call(this)},i._isFightScene=function(){var t=mo.moduleMgr.curModule.name;return"FightScene"==t},e}(mo.gui.Dlg);t.BaseFightDlg=e,egret.registerClass(e,"g_base.BaseFightDlg")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data.clothesID,i=e.data.weaponID,a=e.data.wingID,s=e.data.sex,n=e.data.isKing;r?e.ico_clothes.source=resHelper.getHeroClothesIconPath(r):e.ico_weapon.source=null,i?e.ico_weapon.source=resHelper.getHeroWeaponIconPath(i):e.ico_weapon.source=null,a?s==gc.c_prop.sexKey.male?(e.ico_wing_male.source=resHelper.getHeroWingIconPath(a),e.ico_wing_female.source=null):(e.ico_wing_female.source=resHelper.getHeroWingIconPath(a),e.ico_wing_male.source=null):(e.ico_wing_male.source=null,e.ico_wing_female.source=null),e.ico_isKing.visible=n},e}(mo.gui.Layer);t.RoleAvatar=e,egret.registerClass(e,"g_base.RoleAvatar")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments),this.doWhat=0}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this),this.outsideClosable=!1},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;e.inputBox.text=e.data.text||"",e.titleDisplay.text=e.data.title||""},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.container.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,e.click_btn_close,e)},i.click_btn_close=function(){var t=this;
t.doWhat=0,t.container.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,t.click_btn_close,t)},i._tap_btn_confirm=function(){var t=this;t.doWhat=1,t.close()},i._tap_btn_cancel=function(){var t=this;t.doWhat=0,t.close()},e}(mo.gui.Dlg);t.BasePromoteInput=e,egret.registerClass(e,"g_base.BasePromoteInput")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){var e=this;t.prototype._initProp.call(this),e.outsideClosable=!0},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.dataChanged()},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=gd.demonLotusCtrl.calGenuineQi(),i=mo.getJSONWithFileNameAndID(gc.cfg_c_help,57),a=(mo.getJSONWithFileName(gc.cfg_c_genuineQi),gd.userCtrl.getData(),r[2]);e.label_zhenQiTotal.text=r[0]+"/"+r[1],e.label_zhenQiAdd.text=(60*a>>0)+"/分钟",e.label_desc.text=i[gc.c_help_helpText]},e}(mo.gui.Dlg);t.ZhenQiDetail=e,egret.registerClass(e,"g_base.ZhenQiDetail")}(g_base||(g_base={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var t=this;e.prototype._initProp.call(this),t._layerOpt.shownWithAction=!1},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.infuseExpc.toString(),t._refreshUI),t.efx_open.visible=!1,t._upStarEfxPlayer=uiHelper.EfxPlayer.create(t.efx_hit1),t._hitEfxPlayer=uiHelper.EfxPlayer.create(t.efx_hit2);var r=mo.getJSONWithFileName(gc.cfg_c_game)[gc.id_c_game.fourRole],i=r[2];t.pb_exp.maximum=i,t.pb_exp.labelFunction=function(t,e){return mo.STR.format("%s/%s",t,e)};var a=gd.heroCtrl.getSpHeroOpenCfg(3);t.img_openTips.visible=a[1][3]>gd.userCtrl.getRebirthLvl(),t.mpUpdateTimer=setInterval(function(){t._refreshMyRes()},1e3),t._refreshUI(),t.label_ZQV.text=[r[6].split(",")[0]/1e4>>0,r[6].split(",")[1]/1e4>>0],t.label_YBV.text=[r[10].split(",")[0]/1e4>>0,r[10].split(",")[1]/1e4>>0]},a.onExit=function(){var t=this;e.prototype.onExit.call(this),t.mpUpdateTimer&&clearInterval(t.mpUpdateTimer),t.mpUpdateTimer=null},a._refreshUI=function(){var t=this,e=gd.userCtrl.isOpenInfuseExpc();t.cb_auto.selected=e,t.pb_exp.value=gd.userCtrl.getInfuseExpc();var r=mo.getJSONWithFileName(gc.cfg_c_game)[gc.id_c_game.fourRole][2],i=gd.userCtrl.getInfuseExpc()>=r;t.grp_full.visible=i,t.grp_inject.visible=!i,uiHelper.setResGrp(t.grp_resZQ,gc.c_prop.spItemIdKey.genuineQi,gd.heroCtrl.getInjectCost(gc.c_prop.extraInfuseTypeKey.genuineQi)),uiHelper.setResGrp(t.grp_resYB,gc.c_prop.spItemIdKey.diamond,gd.heroCtrl.getInjectCost(gc.c_prop.extraInfuseTypeKey.diamond)),t._refreshMyRes()},a._refreshMyRes=function(){var t=this;uiHelper.setResGrp(t.grp_myZq,gc.c_prop.spItemIdKey.genuineQi,gd.demonLotusCtrl.calGenuineQi()[0]),uiHelper.setResGrp(t.grp_myYB,gc.c_prop.spItemIdKey.diamond,gd.userCtrl.getDiamond())},a._tap_btn_back=function(){var t=this;t.close()},a._chg_cb_auto=function(){var t=this;return gd.heroCtrl.isOpenCfgOk(3)?void gd.heroCtrl.autoInfuseSwitch(t.cb_auto.selected,function(){t._refreshUI(),mo.showMsg(mo.STR.format("自动注入:%s",t.cb_auto.selected?"[ubb color=green]开启[/ubb]":"[ubb color=red]关闭[/ubb]"))},t):(process.nextTick(function(){t.cb_auto.selected=!1}),mo.showMsg(gc.id_c_msgCode.careerNotOpen))},a._tap_btn_create=function(){var t=this;gd.heroCtrl.callHero(gc.c_prop.heroJobKey.ys,0,function(){t.efx_open.visible=!0,t.efx_open.play(1),t.efx_open.addEventListener(egret.Event.COMPLETE,function(){mo.showMsg("开启成功!"),t.close()},t)},t)},a._tap_btn_yuanbao=function(){var t=this;if(!gd.heroCtrl.isOpenCfgOk(3))return mo.showMsg(gc.id_c_msgCode.careerNotOpen);var e=gc.c_prop.extraInfuseTypeKey.diamond;return gd.heroCtrl.ybInjectTipsed?void t._doInject(e):(gd.heroCtrl.ybInjectTipsed=!0,mo.showMsg(gc.id_c_msgCode.buyPerfusion,gd.heroCtrl.getInjectCost(gc.c_prop.extraInfuseTypeKey.diamond),function(){t._doInject(e)}))},a._tap_btn_zq=function(){var t=this;if(!gd.heroCtrl.isOpenCfgOk(3))return mo.showMsg(gc.id_c_msgCode.careerNotOpen);var e=gc.c_prop.extraInfuseTypeKey.genuineQi;t._doInject(e)},a._doInject=function(t){var e=this;gd.heroCtrl.extraInfuse(t,function(t){var r=t[0],i=t[1];r&&e._hitEfxPlayer.play(),g_msg.UIMsgTextCtrl.push(mo.STR.format("[ubb]获得进度%s[/ubb]",i)),e._upStarEfxPlayer.play()},e)},a._tap_btn_help=function(){t.BaseShowTip.create().setData({id:103}).show()},a._tap_img_skill38=function(){t.SkillDescDlg.create().setData({skillId:38}).show()},a._tap_img_skill39=function(){t.SkillDescDlg.create().setData({skillId:39}).show()},a._tap_img_skill40=function(){t.SkillDescDlg.create().setData({skillId:40}).show()},a._tap_img_skill41=function(){t.SkillDescDlg.create().setData({skillId:41}).show()},a._tap_img_skill42=function(){t.SkillDescDlg.create().setData({skillId:42}).show()},r}(mo.gui.Dlg);t.Create4thRole=e,egret.registerClass(e,"g_base.Create4thRole")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){var e=this;t.prototype._initProp.call(this),e.outsideClosable=!0},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.data.skillId,i=mo.getJSONWithFileNameAndID(gc.cfg_t_skill,r),a=gd.userCtrl.getLvl(),s=Math.min(175,Math.max(145,a)),n=10*i[gc.t_skill_cd]/1e3,o=i[gc.t_skill_damage]/1e4,c=i[gc.t_skill_buffID];if(e.ico_skill.source=resHelper.getSkillIconPath(r),e.label_name.text=mo.STR.format("%s Lv.%s",i[gc.t_skill_name],s),0!=o){var g=i[gc.t_skill_damageScaleA]/1e4;o+=(s-1)*g,e.label_desc.text=mo.STR.format(i[gc.t_skill_desc],Math.abs(Math.round(100*-o)),n)}else if(0!=c){var l=mo.getJSONWithFileNameAndID(gc.cfg_t_buff,c),_=l[gc.t_buff_linerScale],u=(l[gc.t_buff_baseValue1]+_*(s-1))/1e4;u=Math.abs(u),e.label_desc.text=mo.STR.format(i[gc.t_skill_desc],Math.round(100*u),n)}else e.label_desc.text=mo.STR.format(i[gc.t_skill_desc])},e}(mo.gui.Dlg);t.SkillDescDlg=e,egret.registerClass(e,"g_base.SkillDescDlg")}(g_base||(g_base={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.initMc=function(){var t=this;if(t.mc||(t.mc=new egret.MovieClip,t.mc.addEventListener(egret.Event.LOOP_COMPLETE,t.onMcEvent,t),t.mc.addEventListener(egret.Event.COMPLETE,t.onMcEvent,t),t.source=t.mc),t.jsonData&&t.texture){var e=new egret.MovieClipDataFactory(t.jsonData,t.texture);t.mc.movieClipData=e.generateMovieClipData(t.mcName),isNaN(t.playTimes)||t.gotoAndPlay(t.frame,t.playTimes)}},i.loadRes=function(t,e,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var a=this;a.jsonData=null,a.texture=null,RES.getResByUrl(t,function(t){a.jsonData=t,a.initMc(),a.jsonData&&a.texture&&r&&r.call(i)},a),RES.getResByUrl(e,function(t){a.texture=t,a.initMc(),a.jsonData&&a.texture&&r&&r.call(i)},a)},i.gotoAndPlay=function(t,e){this.frame=t,this.playTimes=e,this.mc&&this.mc.movieClipData&&this.mc.gotoAndPlay(t,e)},i.gotoAndStop=function(t){this.mc&&this.mc.gotoAndStop(t)},i.nextFrame=function(){this.mc&&this.mc.nextFrame()},i.play=function(t){this.mc&&this.mc.movieClipData||(this.frame=1,this.playTimes=t),this.mc&&this.mc.movieClipData&&this.mc.play(t)},i.prevFrame=function(){this.mc&&this.mc.prevFrame()},i.stop=function(){this.mc&&this.mc.stop()},i.onMcEvent=function(t){this.dispatchEvent(new egret.Event(t.type))},e}(mo.gui.UIAsset);t.Effect=e,egret.registerClass(e,"g_base.Effect")}(g_base||(g_base={}));var g_comp;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=__define,i=e,a=i.prototype;return a.getQueryString=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),r=window.location.search.substr(1).match(e);return null!=r?decodeURI(r[2]):"Android"==egret.Capabilities.os||"Unknown"==egret.Capabilities.os?"false":"true"},a._initProp=function(){var e=this;t.prototype._initProp.call(this),e.touchEnabled=e.touchChildren=!1,e._playTimes=-1,e.autoPlay=!1,e.needPlay=!0,e.performanceControl=!0},r(a,"effectId",function(){return this._effectId},function(t){var e=this;e._effectId=t}),a.getEffect=function(t,e){var r=t;return e&&(r=mo.STR.format("resource/dynamic2/%s.%s",t,e)),r},a.startLoadByKey=function(t,e,r){var i=this;i.loadRes(i.getEffect(t),i.getEffect(t,"png"),e,r),i.autoPlay&&i.play(i._playTimes)},a._childrenCreated=function(){var e=this;if(t.prototype._childrenCreated.call(this),e.performanceControl){var r=e.getQueryString("high");r&&"true"==r?e.needPlay=!0:r&&"false"==r&&(e.needPlay=!1)}e._effectId&&e.needPlay&&e.startLoadByKey(e._effectId)},a.loadRes=function(t,e,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var a=this;a.jsonData=mo.getData("mc",t),a.texture=null,RES.getResByUrl(e,function(t){a.texture=t,a.initMc(),a.jsonData&&a.texture&&r&&r.call(i)},a)},e}(g_base.Effect);t.UIEffect=e,egret.registerClass(e,"g_comp.UIEffect")}(g_comp||(g_comp={}));var uiHelper;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.init=function(e,r,i){var a=this;a.__class;t.prototype.init.call(this);var s;e instanceof g_comp.UIEffect?(s=a.efx=e,s.visible=!1,s.addEventListener(egret.Event.COMPLETE,a._onPlayEnd,a)):(s=a.efx=g_comp.UIEffect.create(),s.effectId=r,s.x=i.x,s.y=i.y,e.addElement(s),s.addEventListener(egret.Event.COMPLETE,a._onPlayEnd2,a),s.play(1))},i.initByGroup=function(e){t.prototype.init.call(this);var r=this;r._efxs=e||[];for(var i=0,a=r._efxs.length;a>i;i++){var s=r._efxs[i];s.visible=!1,s.addEventListener(egret.Event.COMPLETE,r._onPlayEnd,r)}},i.setEndCallback=function(t,e){var r=this;r._endCb=t,r._endCtx=e},i._onPlayEnd=function(t){var e=this,r=t.target;r.gotoAndStop(1),r.visible=!1,e._endCb&&e._endCb.call(e._endCtx)},i._onPlayEnd2=function(){var t=this;t.efx.parent.removeElement(t.efx),t._endCb&&t._endCb.call(t._endCtx)},i.play=function(){var t=this;if(t._efxs)for(var e=0,r=t._efxs.length;r>e;e++){var i=t._efxs[e];i.visible=!0,i.gotoAndPlay(1,1)}else t.efx.visible=!0,t.efx.gotoAndPlay(1,1)},e.play=function(t,e,r,i,a){var s=new this;return s.init(t,e,r),s.setEndCallback(i,a),s},e.createPlayer=function(t,e,r){var i=new this;return i.init(t,null,null),i.setEndCallback(e,r),i},e.createPlayGroup=function(t){var e=new this;return e.initByGroup(t),e},e}(mo.Class);t.EfxPlayer=e,egret.registerClass(e,"uiHelper.EfxPlayer")}(uiHelper||(uiHelper={}));var gc;!function(t){t.Keys={curServerId:"curServerId",accountName:"AccountName",password:"Password",logined:"Logined",simulateFight:"SimulateFight",key_host:"key_host",key_port:"key_port",msgCode:"m",msgArgs:"a",msgValue:"v",token:"token",rankPkTime:"rpt"},t.RESP_MSG_CODE="m",t.RESP_MSG_ARGS="a",t.RESP_VALUE="v";var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var r=this;r.respKey_msgCode=t.RESP_MSG_CODE,r.respKey_msgArgs=t.RESP_MSG_ARGS,r.respKey_value=t.RESP_VALUE,r.httpKey_route="r",r.httpKey_args="a",r.httpKey_sessionId="s",r.httpKey_handler="h",r.key_host=t.Keys.key_host,r.key_port=t.Keys.key_port,r.loginRoute=t.iface.h_account_login,r.loginNameKey=t.iface.h_account_login_args.name,r.loginPwdKey=t.iface.h_account_login_args.pwd,r.loginNameKeyOfLocal=t.Keys.accountName,r.loginPwdKeyOfLocal=t.Keys.password,r.httpConnectRoute=t.iface.c_net_connect,r.httpDisconnectRoute=t.iface.c_net_disconnect},a.asyncAccount=function(t,e,r){void 0===e&&(e=!0),void 0===r&&(r=!0);var i=this;r&&(i._hasAsyncAccount=!1),e&&mo.playWaiting(),logger.net.info("开始同步账号信息!")},r}(mo.Net);t.Net=e,egret.registerClass(e,"gc.Net"),t.net=new t.Net,mo.registerNet({net:t.net,waitingView:g_base.BaseJuHua.getInstance(),reccnView:{show:function(t){}},kickView:{show:function(t){}},recnnFailed:function(){console.error("重连失败！")},netErrorView:{show:function(e){mo.showMsg(t.id_c_msgCode.checkYourNet,function(){e&&e(),mo_channel.getCurChannel().logout(function(){})})}}}),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var e=t.net,r=egret.project;e.httpHost=r.httpHost,e.httpPort=r.httpPort})}(gc||(gc={}));var gd;!function(t){var e=function(){function t(){this.maxHp=1e3,this.maxHpScale=200,this.attack=100,this.attackScale=100,this.defence=100,this.defenceScale=100,this.magicDefence=100,this.magicDefenceScale=100,this.hit=100,this.hitScale=100,this.dodge=100,this.dodgeScale=100,this.critical=100,this.criticalScale=100,this.disCritical=100,this.disCriticalScale=100,this.luckyValue=100,this.luckyValueScale=100,this.moveSpeed=150,this.moveSpeedScale=0,this.attackInterval=100,this.attackIntervalScale=100,this.damageIncrease=100,this.damageDecrease=100,this.benumbPro=100,this.disBenumbPro=100,this.poisoningRecoveryProb=100,this.benumbProSpan=100,this.reviveCount=100,this.reviveHPScale=100,this.maxHp2=100,this.disMaxHp2=100,this.maxHpTemp=100,this.attackTemp=100,this.defenceTemp=100,this.magicDefenceTemp=100,this.hitTemp=100,this.dodgeTemp=100,this.criticalTemp=100,this.disCriticalTemp=100,this.luckyValueTemp=100,this.moveSpeedTemp=0,this.attackIntervalTemp=100,this.damageIncreaseTemp=100,this.damageDecreaseTemp=100,this.property_index_max=46}var e=(__define,t);e.prototype;return t}();t.HeroProp=e,egret.registerClass(e,"gd.HeroProp")}(gd||(gd={}));var g_base;!function(t){var e=function(t){function e(){t.call(this),this.curProps=[],this.buffProps=[],this.isCritical=function(t){var e=this.criticalFight/(this.criticalFight+t);return Math.random()<=e};for(var r=1;r<e.MAX_PROP;++r)this.curProps[r]=0,this.buffProps[r]=0}__extends(e,t);var r=__define,i=e,a=i.prototype;return e.isPercentProp=function(t){return-1!=e.percentProps.indexOf(t)},a.setHeroProp=function(t){this.curProps=t.concat()},a.setMonsterInfo=function(t){this.curProps[1]=t[gc.t_monster_maxHp],this.curProps[3]=t[gc.t_monster_attack],this.curProps[5]=t[gc.t_monster_defense],this.curProps[7]=t[gc.t_monster_magicDefence],this.curProps[9]=t[gc.t_monster_hit],this.curProps[11]=t[gc.t_monster_dodge],this.curProps[13]=t[gc.t_monster_critical],this.curProps[15]=t[gc.t_monster_disCritical],this.curProps[19]=t[gc.t_monster_moveSpeed],this.curProps[21]=t[gc.t_monster_attackTime],this.curProps[23]=t[gc.t_monster_damageIncrease],this.curProps[24]=t[gc.t_monster_damageDecrease],this.curProps[25]=t[gc.t_monster_benumbPro],this.curProps[26]=t[gc.t_monster_disBenyumbPro],this.curProps[28]=t[gc.t_monster_benumbPro]},a.setPropByIndex=function(t,e){this.curProps[t]=e},a.getPropByIndex=function(t){return this.curProps[t]},a.setBuffPropByIndex=function(t,e){this.buffProps[t]=e},a.getBuffPropByIndex=function(t){return this.buffProps[t]},a.getCurAndBuffPropByIndex=function(t){return this.getPropByIndex(t)+this.getBuffPropByIndex(t)},a.getFightPropByIndex=function(t,r,i){return Math.floor(this.getCurAndBuffPropByIndex(t)*(1+this.getCurAndBuffPropByIndex(r)/e.Scale_Num)+this.getCurAndBuffPropByIndex(i))},r(a,"maxHpFight",function(){return this.getFightPropByIndex(1,2,33)}),r(a,"attackFight",function(){return this.getFightPropByIndex(3,4,34)}),r(a,"defenceFight",function(){return this.getFightPropByIndex(5,6,35)}),r(a,"magicDefenceFight",function(){return this.getFightPropByIndex(7,8,36)}),r(a,"hitFight",function(){return this.getFightPropByIndex(9,10,37)}),r(a,"dodgeFight",function(){return this.getFightPropByIndex(11,12,38)}),r(a,"criticalFight",function(){return this.getFightPropByIndex(13,14,39)}),r(a,"disCriticalFight",function(){return this.getFightPropByIndex(15,16,40)}),r(a,"luckyValueFight",function(){return this.getFightPropByIndex(17,18,41)}),r(a,"moveSpeedFight",function(){return this.getFightPropByIndex(19,20,42)}),r(a,"attackIntervalFight",function(){return this.getFightPropByIndex(21,22,43)}),r(a,"damageIncreaseFight",function(){var t=this.getCurAndBuffPropByIndex(23)+this.getCurAndBuffPropByIndex(44);return t/=e.Scale_Num,t=Math.floor(100*t)/100}),r(a,"damageDecreaseFight",function(){var t=this.getCurAndBuffPropByIndex(24)+this.getCurAndBuffPropByIndex(45);return t/=e.Scale_Num,t=Math.floor(100*t)/100}),r(a,"benumbProFight",function(){return this.getPropByIndex(25)/e.Scale_Num}),r(a,"disBenumbProFight",function(){return this.getPropByIndex(26)/e.Scale_Num}),r(a,"benumbProSpanFight",function(){return this.getPropByIndex(28)}),r(a,"reviveCountFight",function(){return this.getPropByIndex(29)}),r(a,"reviveHPScaleFight",function(){return this.getPropByIndex(30)/e.Scale_Num}),r(a,"maxHp2Fight",function(){var t=this.maxHpFight;return t=t*this.getPropByIndex(31)/e.Scale_Num}),r(a,"invincibleTimeFight",function(){return this.getPropByIndex(32)}),r(a,"penetrateFight",function(){return this.getPropByIndex(46)/e.Scale_Num}),a.isHitSucc=function(t){var e=this.hitFight/(this.hitFight+t);return Math.random()<=e},a.getCritDamage=function(t){return this.criticalFight/(this.criticalFight+t)*3},a.isBenumbProSucc=function(t){return Math.random()<=t?!1:Math.random()<=this.benumbProFight},a.getDefence=function(t,r,i){var a,s=t==e.BehaviorPhysics?this.defenceFight:t==e.BehaviorMagic?this.magicDefenceFight:(this.magicDefenceFight+this.defenceFight)/2;return 1e4>=s?(a=.002*s/(1+.015*r+.002*s),a=Math.min(a,.6)):6e4>s?(a=100/(1+.8*r+100)+.001*(s-1e4)/(1+1.25*r+.001*(s-1e4)),a=Math.min(a,.9)):(a=12e4>i?.8+s/(s+4e6):s/(s+.125*i),a=Math.min(a,.9)),a},e.MAX_PROP=47,e.Scale_Num=1e4,e.BehaviorPhysics=1,e.BehaviorMagic=2,e.BehaviorTaoism=3,e.percentProps=[2,4,6,8,10,12,14,16,20,22,23,24,25,26,30,31,42,43,44,45,46],e}(egret.EventDispatcher);t.PropBase=e,egret.registerClass(e,"g_base.PropBase")}(g_base||(g_base={}));var gd;!function(t){var e=function(){function t(){this.copyId=null,this.useLootDic={},this.unUseLootDic={},this.useBossLootDic={},this.unUseBossLootDic={}}var e=(__define,t);e.prototype;return t}();t.LootObj=e,egret.registerClass(e,"gd.LootObj")}(gd||(gd={}));var g_msg;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this);var e=this;e._btnNames=["btn_left","btn_center","btn_right"]},e}(mo.gui.MsgDlg);t.MsgAlert=e,egret.registerClass(e,"g_msg.MsgAlert")}(g_msg||(g_msg={}));var g_msg;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this);var e=this;e._btnNames=["btn_cancel","btn_ok"]},i.setMsgInfo=function(t,e){},e}(mo.gui.MsgDlg);t.MsgItem=e,egret.registerClass(e,"g_msg.MsgItem")}(g_msg||(g_msg={}));var g_msg;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._tipsArr=[],t._tipsRunning=!1,t._interval=600,t._penetrable=!0,t.toPauseGuide=!1},a.isNeedToClose=function(){var t=this;0==t.grp_container.numElements&&0==t._tipsArr.length&&t._tipsRunning&&(t._tipsRunning=!1,tm.clearInterval(t._intervalId),t.close())},a._setTips=function(t,e){this._tipsArr=e},a.setMsgInfo=function(t,r){e.prototype.setMsgInfo.call(this,t,r);var i=this;i._setTips(t,r),i._tipsRunning||(i._tipsRunning=!0,i._runActionQueue(),tm.setInterval4Tick(i._runActionQueue,i,i._interval))},a.onExit=function(){e.prototype.onExit.call(this);var t=this;t._tipsArr=[],t.removeChildren(),t._tipsRunning&&(t._tipsRunning=!1,tm.clearInterval(t._intervalId),t.close())},a._runActionQueue=function(){var t=this,e=t.grp_container;if(t._tipsArr.length>0){var r=t.createTip(t._tipsArr.shift()),i=mo.getStage(),a=(i.stageWidth,i.stageHeight);e.addElement(r),r.horizontalCenter=0,r.y=a/2;var s=2,n=mo.fadeIn(.2*s),o=mo.fadeOut(.2*s),c=mo.delayTime(.8*s),g=mo.sequence(mo.moveBy(s,mo.p(0,-360)),mo.callFunc(function(e){mo.gui.helper.rm(e),t.isNeedToClose()},t)),l=egret.action.Manager.getInstance();l.addAction(r,n),l.addAction(r,g),l.addAction(r,mo.sequence(c,o))}},a.createTip=function(e){var r=new t.MsgTipItem;return r.msg=e,r},r}(mo.gui.MsgDlg);t.MsgTips=e,egret.registerClass(e,"g_msg.MsgTips")}(g_msg||(g_msg={}));var g_msg;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.onEnter=function(){t.prototype.onEnter.call(this),this.label_msg.text=this.msg},e}(mo.gui.Comp);t.MsgTipItem=e,egret.registerClass(e,"g_msg.MsgTipItem")}(g_msg||(g_msg={}));var g_msg;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this),mo.gui.helper.setSkinName(this,t.MsgTips.__className),this._penetrable=!0},a._setTips=function(t,e){this._tipsArr=[mo.STR.format.apply(mo.STR,[t.text].concat(e))]},r}(t.MsgTips);t.MsgTip=e,egret.registerClass(e,"g_msg.MsgTip")}(g_msg||(g_msg={}));var g_msg;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._trayName="top"}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){e.prototype._initProp.call(this);var t=this;t._tipsArr=[],t._tipsRunning=!1,t._interval=600,t._penetrable=!0,t._layerOpt.shownWithAction=!1;var r={};r.maxHpFight="生    命",r.attackFight="攻    击",r.defenceFight="物    防",r.magicDefenceFight="法    防",r.hitFight="命    中",r.dodgeFight="闪    避",r.criticalFight="暴    击",r.disCriticalFight="抗    暴",r.damageIncreaseFight="伤害加深",r.damageDecreaseFight="伤害减免",r.benumbProFight="麻    痹",r.disBenumbProFight="抗    麻",t.propRef=r},a.setMsgInfo=function(t,e){},a._childrenCreated=function(){e.prototype._childrenCreated.call(this)},a.dataChanged=function(){e.prototype.dataChanged.call(this);var r=this,i=r.data.items||{},a=r.data.equips||[],s=r.data.changeProp,n=mo.getJSONWithFileName(gc.cfg_t_item);for(var o in i){var c=n[o],g=c[gc.t_item_name],l=c[gc.t_item_color],_=c[gc.t_item_type];if(_!=gc.c_prop.itemTypeKey.chest||0==gd.userCtrl.getNeedItems(o)[0]){var u=mo.STR.format("获得：[ubb color=%s]%s[/ubb] x%s",uiHelper.getColorByQuality(l),g,i[o]),d=new mo.gui.Label;d.size=22,d.text=u,d.stroke=2,d.strokeColor=0,d.textColor=65280,r._tipsArr.push(d)}else t.UIMsgTextCtrl.push(mo.STR.format("恭喜获得[ubb color=%s stroke=1 stroke=1 bold=true]%s[/ubb]%s个！",uiHelper.getColorByQuality(l),g,i[o]))}for(var p=0,m=a.length;m>p;p++){var o=a[p],c=n[o],g=c[gc.t_item_name],l=c[gc.t_item_color],u=mo.STR.format("获得：[ubb color=%s]%s[/ubb] x%s",uiHelper.getColorByQuality(l),g,1),d=new mo.gui.Label;d.size=22,d.text=u,d.stroke=2,d.strokeColor=0,d.textColor=65280,r._tipsArr.push(d)}if(s){var f=r.data.hec,d=new mo.gui.Label;d.size=25,d.style=g_consts.style.orange_103,d.text=mo.STR.format("%s:",gc.c_prop.heroJob[f.job]),r._tipsArr.push(d);for(var h in s){var u=mo.STR.format("%s：+%s",r.propRef[h],s[h]),d=new mo.gui.Label;d.size=22,d.textColor=65280,d.stroke=2,d.strokeColor=0,d.text=u,d.width=200,r._tipsArr.push(d)}}for(var r=this,y=r.grp_container,C=r.grp_tips,v=mo.getStage(),p=(v.stageWidth,v.stageHeight,0);p<r._tipsArr.length;p++){var I=r._tipsArr[p];C.addElement(I)}var E=2,D=mo.fadeIn(.2*E),b=mo.fadeOut(.2*E),S=mo.delayTime(.8*E),N=mo.sequence(mo.moveBy(E,mo.p(0,-360)),mo.callFunc(function(t){r.close()},r)),T=egret.action.Manager.getInstance();T.addAction(y,D),T.addAction(y,N),T.addAction(y,mo.sequence(S,b))},r}(mo.gui.Dlg);t.GetItemTips=e,egret.registerClass(e,"g_msg.GetItemTips")}(g_msg||(g_msg={}));var g_msg;!function(t){var e=function(t){function e(){t.apply(this,arguments),this._trayName="top",this._counter=0,this._tickNum=0,this._diff=0}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this);var e=this;e._penetrable=!0,e._layerOpt.shownWithAction=!1},i.setMsgInfo=function(t,e){},i._childrenCreated=function(){t.prototype._childrenCreated.call(this)},i._updateNumber=function(t){var e=this,r=e.grp_container;e._counter+=e._tickNum;var i=e._tickNum>0?e._counter>=e.data.newCombat:e._counter<=e.data.newCombat;if(i){e._counter=e.data.newCombat,tm.clearInterval(e._intervalId);var a=mo.delayTime(1),s=mo.sequence(a,mo.callFunc(function(t){e.close()},e));mo.ACT.run(r,s)}e.label_combat.text=e._counter},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,r=e.grp_container;e._counter=e.data.oldCombat,e._diff=e.data.newCombat-e.data.oldCombat,e._tickNum=Math.max(1,Math.abs(Math.floor(e._diff/20)))*(e._diff>0?1:-1),e.label_combat.text=e.data.oldCombat,e.label_diff.text=[e._diff>0?"+":"",e._diff];var i=e._diff>0?65280:16711680;e.label_diff.textColor!=i&&(e.label_diff.textColor=i);var a=mo.delayTime(1),s=mo.sequence(a,mo.callFunc(function(t){e.label_diff.visible=!1,e._intervalId=tm.setInterval4Tick(e._updateNumber,e,20)},e));mo.ACT.run(r,s)},e}(mo.gui.Dlg);t.CombatTips=e,egret.registerClass(e,"g_msg.CombatTips")}(g_msg||(g_msg={}));var g_base;!function(t){var e=function(t){function e(){t.apply(this,arguments),this._trayName="top"}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this);var e=this;e._penetrable=!0,e._layerOpt.shownWithAction=!1,e.touchChildren=e.touchEnabled=!1,e.registerClassByKey(gd.ChatCtrl,gd.ChatCtrl.ON_NOTICE_UPDATE,e.onNoticeUpdate)},i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.grp_notice.visible=!1,e.onNoticeUpdate(gd.chatCtrl.getNoticeList())},i.setMsgInfo=function(t,e){},i.dataChanged=function(){t.prototype.dataChanged.call(this)},i.onNoticeUpdate=function(t){var e=this;if(0==t.length)return void(e.grp_notice.visible=!1);if(!e.grp_notice.visible){e.curNotice=t[0];var r=gd.chatCtrl.getChatDataStr(e.curNotice);e.label_noticeContent.text=r,process.nextTick(function(){process.nextTick(function(){if(e.grp_notice){e.grp_notice.visible=!0,e.label_noticeContent.x=480,e.grp_notice.height=this.label_noticeContent.height;var t=-e.label_noticeContent.width;egret.Tween.get(e.label_noticeContent).to({x:t},40*Math.abs(t)).call(function(){e.grp_notice.visible=!1,gd.chatCtrl.delNotice(e.curNotice[gc.dsConsts.ChatData.uniqueId]),e.onNoticeUpdate(gd.chatCtrl.getNoticeList())},e)}})})}},e}(mo.gui.Dlg);t.BaseNotice=e,egret.registerClass(e,"g_base.BaseNotice")}(g_base||(g_base={}));var g_msg;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i._initProp=function(){t.prototype._initProp.call(this);var e=this;e._tipsArr=[],e._tipsRunning=!1,e._interval=600},i.setTips=function(t){var e=this;t instanceof Array?e._tipsArr=e._tipsArr.concat(t):e._tipsArr.push(t),e.begin()},i.begin=function(){var t=this;t._tipsRunning||(t._tipsRunning=!0,t._runActionQueue(),t._invId=tm.setInterval4Tick(t._runActionQueue,t,t._interval))},i.end=function(){var t=this;t._tipsArr=[],t._tipsRunning&&(t._tipsRunning=!1,tm.clearInterval(t._invId),t._invId=null)},i.checkEnd=function(){var t=this;0==t._tipsArr.length&&t.end()},i._runActionQueue=function(){var t,e=this;e._tipsArr.length>0&&(t=e._tipsArr.shift(),e.createNode(t))},i.createNode=function(t){var e=this;e.checkEnd()},e.show=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var r=this.getInstance();r.setTips.apply(r,t)},e.push=function(t){var e=this;e.showAtOnce?e.show(t):t instanceof Array?e._msgQueue=e._msgQueue.concat(t):e._msgQueue.push(t)},e.pop=function(){var t=this;t.show(t._msgQueue),t._msgQueue=[]},e.showAtOnce=!0,e._msgQueue=[],e}(mo.DataController);t.UIMsgCtrl=e,egret.registerClass(e,"g_msg.UIMsgCtrl")}(g_msg||(g_msg={}));var g_msg;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var r=(__define,e),i=r.prototype;return i.createNode=function(t){var e,r=this;if("string"==typeof t){var i=t.indexOf("ubb")>=0;if(i){var a=r.createMsgTips(t),s=4,n=mo.fadeIn(.2*s),o=mo.fadeOut(.2*s),c=mo.delayTime(.8*s),g=mo.sequence(mo.moveBy(s,mo.p(0,-360)),mo.callFunc(function(t){t.parent.removeChild(t),r.checkEnd()},r)),l=egret.action.Manager.getInstance();l.addAction(a,n),l.addAction(a,g),l.addAction(a,mo.sequence(c,o))}else{e=r.createLabel(t),e.scaleX=.5,e.scaleY=.5;var _=mo.spawn(mo.fadeOut(.5),mo.moveBy(.5,mo.p(0,-100))),u=mo.sequence(mo.scaleTo(.2,1).setEase(mo.Ease.backOut),mo.delayTime(1),_,mo.callFunc(function(t){t.parent.removeChild(t),r.checkEnd()},r));mo.runAction(e,u)}}},i.createLabel=function(t){var e=mo.getStage(),r=new egret.Point(mo.getStage().stageWidth/2,mo.getStage().stageHeight/2),i=new egret.gui.Group;i.x=r.x,i.y=r.y,i.width=0,i.height=0,i.horizontalCenter=0,i.verticalCenter=0,e.addChild(i);var a=new egret.gui.Group,s=new egret.gui.VerticalLayout;s.verticalAlign=egret.VerticalAlign.MIDDLE,s.horizontalAlign=egret.HorizontalAlign.CENTER,a.layout=s,a.horizontalCenter=0,a.verticalCenter=100;var n=new egret.gui.Label;return n.text=t,n.size=30,n.textColor=59675,n.stroke=1,n.strokeColor=3684408,a.addElement(n),i.addElement(a),i},i.createMsgTips=function(t){var e=mo.getStage(),r=new egret.Point(mo.getStage().stageWidth/2,mo.getStage().stageHeight/2),i=new egret.gui.Group;i.x=r.x,i.y=r.y,i.width=0,i.height=0,i.horizontalCenter=0,i.verticalCenter=0,e.addChild(i);var a=new egret.gui.Group,s=new egret.gui.VerticalLayout;s.verticalAlign=egret.VerticalAlign.MIDDLE,s.horizontalAlign=egret.HorizontalAlign.CENTER,a.layout=s,a.horizontalCenter=0,a.verticalCenter=0;var n=new mo.gui.Label;return n.size=30,n.stroke=2,n.text=t,a.addElement(n),i.addElement(a),i},e}(t.UIMsgCtrl);t.UIMsgTextCtrl=e,egret.registerClass(e,"g_msg.UIMsgTextCtrl")}(g_msg||(g_msg={}));var g_base;!function(t){var e=function(e){function r(){e.apply(this,arguments),this._trayName="top"}__extends(r,e);var i=(__define,r),a=i.prototype;return a._initProp=function(){var r=this;e.prototype._initProp.call(this),mo.gui.helper.setSkinName(this,t.BaseNotice.__className),r._penetrable=!0,r._layerOpt.shownWithAction=!1,r.touchChildren=r.touchEnabled=!1,r.registerClassByKey(gd.HoodinnCtlr,gd.HoodinnCtlr.ON_SYSNOTICE_UPDATE,r.onNoticeUpdate)},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t.grp_notice.visible=!1,t.onNoticeUpdate(gd.hoodinnCtlr.getAllNotices())},a.setMsgInfo=function(t,e){},a.dataChanged=function(){e.prototype.dataChanged.call(this)},a.onNoticeUpdate=function(t){var e=this;if(0==t.length)return void(e.grp_notice.visible=!1);if(!e.grp_notice.visible){e.curNotice=t[0];var r=e.curNotice[gc.dsConsts.ChatData.sysArgs],i=r[0],a=0,s=1;9999==i&&(a=r[r.length-1],s=r[r.length-2]);var n;n=9999==i?r[1]:gd.hoodinnCtlr.getSysNoticeStr(e.curNotice),e.label_noticeContent.text=n,process.nextTick(function(){process.nextTick(function(){if(e.grp_notice){e.grp_notice.visible=!0,e.label_noticeContent.x=480,e.grp_notice.getChildAt(0).height=e.label_noticeContent.height+10;var t=-e.label_noticeContent.width,r=Math.abs(t)/480*12e3;12e3>r&&(r=12e3),egret.Tween.get(e.label_noticeContent).to({x:t},r).call(function(){gd.hoodinnCtlr.delNotice(e.curNotice[gc.dsConsts.ChatData.uniqueId]);var t=gd.hoodinnCtlr.getAllNotices();e.grp_notice.visible=!1,t.length&&e.onNoticeUpdate(t)},e)}})})}},r.instance=null,r}(mo.gui.Dlg);t.BaseSysNotice=e,egret.registerClass(e,"g_base.BaseSysNotice")}(g_base||(g_base={}));var g_msg;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a.createNode=function(e){var r=this;t.GetItemTips.create().setData(e).show().onClose(function(){r.checkEnd()})},r}(t.UIMsgCtrl);t.UIMsgHeroPropCtrl=e,egret.registerClass(e,"g_msg.UIMsgHeroPropCtrl")}(g_msg||(g_msg={}));var g_msg;!function(t){var e=function(e){function r(){e.apply(this,arguments)}__extends(r,e);var i=(__define,r),a=i.prototype;return a.createNode=function(e){var r=this;t.CombatTips.create().setData(e).show().onClose(function(){r.checkEnd()})},r}(t.UIMsgCtrl);t.UIMsgCombatCtrl=e,egret.registerClass(e,"g_msg.UIMsgCombatCtrl")}(g_msg||(g_msg={}));var g_msg;!function(t){logger.initLogger(t,"g-msg"),logger.setLvl("g-msg",4),t.msgType={tip:10,alert:13,confirm:14,confirmRecharge:15,confirmPurchase:16,confirmUse:17,confirmUpgrade:18,confirmCountDown:19,retryToConnect:20,msgItem:21,alertLogout:22};
var e=function(){},r=function(){var e=res._jsData[gc.cfg_c_msgCode];mo.msgMgr.translate=function(t){return{text:t[gc.c_msgCode_text],type:t[gc.c_msgCode_region0],onTop:t[gc.c_msgCode_onTop],time:t[gc.c_msgCode_time]}},mo.setMsgData(e),mo.defaultMsgType=t.msgType.tip;var r="确定",i="取消";mo.registerMsgDlg(t.msgType.alert,t.MsgAlert,{btn_center:{text:r,callEnd:!0}}),mo.registerMsgWaitingDlg(t.msgType.alert),mo.registerMsgDlg(t.msgType.alertLogout,t.MsgAlert,{btn_center:{text:r,listener:function(){mo_channel.getCurChannel().logout(function(){})},callEnd:!0}}),mo.registerMsgWaitingDlg(t.msgType.alertLogout),mo.registerMsgDlg(t.msgType.retryToConnect,t.MsgAlert,{btn_center:{text:r,callEnd:!0}}),mo.registerMsgWaitingDlg(t.msgType.retryToConnect),mo.registerMsgDlg(t.msgType.confirm,t.MsgAlert,{btn_left:{text:r,callEnd:!0},btn_right:{text:i,event:"cancel"}}),mo.registerMsgDlg(t.msgType.confirmRecharge,t.MsgAlert,{btn_left:{text:"充值",moduleToPush:g_consts.moduleId.recharge},btn_right:{text:i}}),mo.registerMsgDlg(t.msgType.confirmPurchase,t.MsgAlert,{btn_left:{text:"购买",callEnd:!0},btn_right:{text:i}}),mo.registerMsgDlg(t.msgType.confirmUpgrade,t.MsgAlert,{btn_center:{text:r,moduleToPush:g_consts.moduleId.vip}}),mo.registerMsgDlg(t.msgType.confirmCountDown,t.MsgAlert),mo.registerMsgDlg(t.msgType.tip,t.MsgTip),mo.registerMsgDlg(t.msgType.msgItem,t.MsgItem,{btn_cancel:{},btn_ok:{callEnd:!0}}),mo.registerMsgDlg(999,t.GetItemTips,{}),mo.registerMsgDlg(998,g_base.Notice,{}),mo.registerMsgDlg(997,g_base.OfflineGain,{}),mo.registerMsgDlg(996,g_base.FirstEnterGame,{}),mo.registerValidModuleFunc(function(e,r){var i=e.id,a=(r||{}).subModuleId,s=mo.moduleMgr.curModule;if(s&&s.name==i&&null!=a){var n=g_consts.subModuleMap[i];if(n.indexOf(a)>=0){for(var o=s.subModules,c=0,g=o.length;g>c;c++)o[c]&&o[c].target&&o[c].target.close();for(var l=s.target,_=l.getTray("dlg");_.numElements>0;)_.getElementAt(0).close();return process.nextTick(function(){s.target.openSubModule&&s.target.openSubModule(a)}),!1}}var u=g_consts.moduleId;if(i==u.index||i==u.fight||i==u.home||i==u.role||i==u.forge||i==u.shop)return!0;var d=e.sysId;if(null==d)return!0;var p=mo.getJSONWithFileName(gc.cfg_c_open),m=p[d];if(!m)return t.debug(mo.STR.format("未在【c_open】表中配置模块【%s】的数据，请检查！",i)),!1;var f=m[gc.c_open_lvlRequired];return-1==f?(mo.showMsg(gc.id_c_msgCode.noOpenNow),!1):f>gd.userCtrl.getLvl()?(mo.showMsg(gc.id_c_msgCode.noRoleLvl,f),!1):!0}),mo.registerModuleNotFoundFunc(function(t){mo.showMsg(gc.id_c_msgCode.noOpenNow)})},i=function(t){r(),e(),t()};egret.Boot.onceAsync(egret.Boot.AFTER_CONFIG,i)}(g_msg||(g_msg={}));