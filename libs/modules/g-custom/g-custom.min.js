var g_custom;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),r=o.prototype;return r._childrenCreated=function(){t.prototype._childrenCreated.call(this)},r.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,o=e.data;if(null!=o){var r=e._getPartTempResId(e.delegate.colorType,o);e.ico.source=mo.STR.format(resHelper.dynamicTemp,resHelper.dynamic.item,mo.STR.fill(r,"000000"),"png");var i=e.delegate.colorType;e.ico_border.source=resHelper.getBorderByQuality(1,i),e.label_part.text=gc.c_prop.equipType[o]}},r._getPartTempResId=function(t,e){var o={};return o[gc.c_prop.equipColorKey.orange]=[700026,700027,700028,700031,700029,700030],o[gc.c_prop.equipColorKey.red]=[700032,700033,700034,700037,700035,700036],o[t][e]},r._tap_btn_goto=function(){var t=this,e=gd.customCtrl.getCustomTicket(t.delegate.colorType);e.length?mo.moduleMgr.runModule(g_consts.moduleId.custom,{itemId:e[0],equipType:t.data}):mo.showMsg("定制券不足!")},e}(mo.gui.ItemRenderer);t.CustomItem=e,egret.registerClass(e,"g_custom.CustomItem")}(g_custom||(g_custom={}));var g_custom;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var r=(__define,o),i=r.prototype;return i._initProp=function(){var o=this;e.prototype._initProp.call(this),o._layerOpt.shownWithAction=!1,o._Item_list_items=t.CustomItem},i._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;if(t.registerClassByKey(gd.CustomCtrl,gd.CustomCtrl.ON_CUSTOM,function(){t._refresh()}),t.moduleParam&&t.moduleParam.itemId){var o=mo.getJSONWithFileNameAndID(gc.cfg_c_customParameter,t.moduleParam.itemId);t.tab_bag.selectedIndex=o[gc.c_customParameter_color]-gc.c_prop.equipColorKey.orange}else t.moduleParam&&t.moduleParam.color?t.tab_bag.selectedIndex=t.moduleParam.color-gc.c_prop.equipColorKey.orange:t.tab_bag.selectedIndex=0;t._tap_tab_bag()},i._tap_tab_bag=function(){var t=this;t.colorType=t.tab_bag.selectedIndex+gc.c_prop.equipColorKey.orange,t._refresh()},i._refresh=function(){var t=this,e=t.list_items.scroller,o=e.scrollTop>=0?e.scrollTop:0;t.refreshList("list_items"),process.nextTick(function(){t.list_items&&e.throwVertically(o,0)}),t.label_tickets.text=[mo.STR.format("[ubb color=%s]%s[/ubb]",uiHelper.getColorByQuality(t.colorType),gc.c_prop.equipColor[t.colorType]),gd.customCtrl.getCustomTicket(t.colorType).length]},i._data_list_items=function(){return Object.keys(gc.c_prop.equipType)},i._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:39}).show()},o}(mo.gui.Dlg);t.CustomList=e,egret.registerClass(e,"g_custom.CustomList"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,t.fullScr=!0,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){e()})})}(g_custom||(g_custom={}));var g_custom;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),r=o.prototype;return r._childrenCreated=function(){t.prototype._childrenCreated.call(this)},r.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,o=e.data;e.label_prop.text=[gc.c_prop.equipProp[o[0]],o[1],Math.round(o[1]*gd.customCtrl.getExtrPropAddRatio()/1e4)],0==e.itemIndex&&(e.selected=!0)},e}(mo.gui.ItemRenderer);t.CustomPropItem=e,egret.registerClass(e,"g_custom.CustomPropItem")}(g_custom||(g_custom={}));var g_custom;!function(t){var e=function(e){function o(){e.apply(this,arguments),this.choosedPropNum=0}__extends(o,e);var r=(__define,o),i=r.prototype;return i._initProp=function(){var o=this;e.prototype._initProp.call(this),o._Item_list_items=t.CustomPropItem,o.job=gc.c_prop.heroJobKey.zs,o._layerOpt.shownWithAction=!1},i._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this,o=gc.c_prop.heroJob;for(var r in o){var i=t["ico_item_job"+r];i&&(i.onClick(t._onJobClick,t,r),i.label_text.visible=!1)}t.label_count.text=gd.customCtrl.getMaxCustomPropNum(),t._efxPlayer=uiHelper.EfxPlayer.createPlayer(t.efx),t._efxPlayer.setEndCallback(function(){t.close()},t),t.moduleParam&&t.setData(t.moduleParam)},i._tap_btn_sub=function(){var t=this,e=gd.customCtrl.getCustomLvlLimt(t.data.itemId);t.custom_lvl>e[0]&&(t.custom_lvl-=10,t.custom_lvl=t.custom_lvl>=e[0]?t.custom_lvl:e[0],t.showNum(),t._updateWearLvl())},i._tap_btn_add=function(){var t=this,e=gd.customCtrl.getCustomLvlLimt(t.data.itemId);t.custom_lvl<e[1]&&(t.custom_lvl+=10,t.custom_lvl=t.custom_lvl>=e[1]?e[1]:t.custom_lvl,t.showNum(),t._updateWearLvl())},i.showNum=function(){var t=this;t.label_lvl.text=t.custom_lvl;var e=gd.customCtrl.getTicketInfo(t.data.itemId,t.custom_lvl,t.data.equipType),o=gc.c_prop.heroJob;for(var r in o){var i=t["ico_item_job"+r];i&&i.setData({itemId:e[r],count:1})}t.refreshList("list_items")},i._moveLightBorder=function(t){var e=this,o=t.width,r=t.height,i=e.img_frame.width,a=e.img_frame.height;e.img_frame.x=t.x-(i-o)/2,e.img_frame.y=t.y-(a-r)/2},i._onJobClick=function(t,e,o){var r=this;r._moveLightBorder(t),r.job=o,r.refreshList("list_items"),r.label_count.text=gd.customCtrl.getMaxCustomPropNum()-r.choosedPropNum,r._updateWearLvl()},i._updateWearLvl=function(){var t=this,e=gd.customCtrl.getTicketInfo(t.data.itemId,t.custom_lvl,t.data.equipType),o=e[t.job];t.label_needLvl.text=gd.equipCtrl.getEquipWearLvl(o)},i.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,o=gd.customCtrl.getCustomLvlLimt(t.data.itemId);t.label_range.text=o,t.custom_lvl=o[1],t.showNum(),t._updateWearLvl()},i._data_list_items=function(){var t=this,e=gd.customCtrl.getTicketInfo(t.data.itemId,t.custom_lvl,t.data.equipType);return gd.equipCtrl.getBasePropArr(e[t.job])},i._click_list_items=function(t){var e=this,o=t.target,r=o.selectedItems,i=o.selectedIndices,a=t.itemRenderer,s=t.itemIndex,l=t.item;if(0==t.itemIndex)return process.nextTick(function(){a.selected=!0,-1==i.indexOf(s)&&i.push(s),-1==r.indexOf(l)&&r.push(l),o.selectedIndices=i,o.selectedItems=r}),mo.showMsg(gc.id_c_msgCode.mainProperty);var u=r.length-1;return gd.customCtrl.getMaxCustomPropNum()-u<0?(process.nextTick(function(){a.selected=!1,i.splice(i.indexOf(s),1),r.splice(r.indexOf(l),1),o.selectedIndices=i,o.selectedItems=r}),mo.showMsg(gc.id_c_msgCode.fullProperty)):(e.choosedPropNum=u,void(e.label_count.text=gd.customCtrl.getMaxCustomPropNum()-e.choosedPropNum))},i._tap_btn_custom=function(){var t=this;gd.customCtrl.customization(t.data.itemId,t.job,t.inputName.text,t.custom_lvl,t.list_items.selectedIndices,t.data.equipType,function(){t._efxPlayer.play()},t)},i._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:40}).show()},o}(mo.gui.Dlg);t.Custom=e,egret.registerClass(e,"g_custom.Custom"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,t.fullScr=!0,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){e()})})}(g_custom||(g_custom={}));var g_custom;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),r=o.prototype;return r._initProp=function(){var e=this;t.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1,mo.gui.helper.setSkinName(this,"CCEquip")},r._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.img_title.source="tit_txt_g_dizicuangcheng"},r.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,o=e.data.bdc;e.ico_item.set("itemId",o.tempId),e._setBeforeEquipInfo(e.grp_before,o),e._setAfterEquipInfo(e.grp_after)},r._setAfterEquipInfo=function(t){var e=this,o=gd.customCtrl.getInheritedEquipOpt(e.data.bdc.equipId),r=o.nextEquipInfo,i=r.tempId,a=mo.getJSONWithFileNameAndID(gc.cfg_t_item,i),s=r.name,l=a[gc.t_item_itemLvl],u=t.getChildByName("label_name_lvl"),c=t.getChildByName("label_score"),n=t.getChildByName("grp_props").getChildByName("label_props");u.text=mo.STR.format("[ubb color=%s]%s [/ubb][ubb color=#E8CA47]%s级[/ubb]",uiHelper.getColorByQuality(a[gc.t_item_color]),s,l);for(var m,p="",_=r.basePropArr,d=utils.kvArr2KvObj(r.extraPropArr),g="[ubb]%s: %s[/ubb][ubb] +%s[/ubb][/br]",h="[ubb color=0x2EAAF7]%s: %s[/ubb][ubb color=0x2EAAF7] +%s[/ubb][/br]",b=0,f=_.length;f>b;b++){m=_[b];var C=m[0],v=m[1];p+=mo.STR.format(0==b?g:h,gc.c_prop.equipProp[C],v,d[C]||0)}n.text=p,c.text=r.scrore,e.grp_lvlEnough.visible=o.nextEquipNeedLvlEnough,e.btn_chuanchen.visible=o.nextEquipNeedLvlEnough,e.grp_lvlNotEnough.visible=!o.nextEquipNeedLvlEnough,o.nextEquipNeedLvlEnough||(e.label_needLvl.text=o.nextEquipNeedLvl),uiHelper.setResGrp(e.grp_res,o.costItemId,o.costCount),uiHelper.setResGrp(e.grp_resMy,o.costItemId,gd.userCtrl.getItemNum(o.costItemId))},r._setBeforeEquipInfo=function(t,e){var o=t.getChildByName("label_name_lvl"),r=t.getChildByName("label_score"),i=t.getChildByName("grp_props").getChildByName("label_props");o.text=mo.STR.format("[ubb color=%s]%s [/ubb][ubb color=#E8CA47]%s级[/ubb]",uiHelper.getColorByQuality(e.quality),e.name,e.itemLvl),r.text=e.score;for(var a,s="",l=e.proptys,u=gd.equipCtrl.getEquipExtraObj(e.equipId),c="[ubb]%s: %s[/ubb][ubb] +%s[/ubb][/br]",n="[ubb color=0x2EAAF7]%s: %s[/ubb][ubb color=0x2EAAF7] +%s[/ubb][/br]",m=0,p=l.length;p>m;m++){a=l[m];var _=a[0],d=a[1];s+=mo.STR.format(0==m?c:n,gc.c_prop.equipProp[_],d,u[_]||0)}i.text=s},r._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:25}).show()},r._tap_btn_chuanchen=function(){var t=this,e=gd.customCtrl.getInheritedEquipOpt(t.data.bdc.equipId),o=e.nextEquipInfo,r=e.costItemId;e.isItemEnough?gd.customCtrl.upCustomization(e,function(){t.setData({bdc:gd.BagDataCtrl.create(o.tempId,e.equipId)})},t):g_base.GainWay.canBuyFromShop(r)?g_base.GainWayShop.create().setData({itemId:r,count:e.costCount-gd.userCtrl.getItemNum(e.costItemId)}).show().onClose(function(){t.dataChanged()}):g_base.GainWay.create().setData({itemId:r}).show()},e}(mo.gui.Dlg);t.CustomCCEquip=e,egret.registerClass(e,"g_custom.CustomCCEquip")}(g_custom||(g_custom={}));