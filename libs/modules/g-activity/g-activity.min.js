var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i._Item_list_items=g_base.BaseItemCell},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.list_items.verticalScrollPolicy=egret.gui.ScrollPolicy.OFF},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this;i.data;i.label_desc.text=mo.STR.format("累计登录%s天",i.itemIndex+1);var e=gd.activityCtrl.getSevenLoginStatus(i.itemIndex);0==e?(i.ico_hasGet.visible=!0,i.btn_get.visible=!1):1==e?(i.ico_hasGet.visible=!1,i.btn_get.visible=!0,i.btn_get.enabled=!0):(i.ico_hasGet.visible=!1,i.btn_get.visible=!0,i.btn_get.enabled=!1),i.list_items.dataProvider=new egret.gui.ArrayCollection(utils.itemObj2ObjArr(i.data[gc.dsConsts.ActivityItem.items]))},a._initItem_list_items=function(t){t.tapShowDetail=!0},a._tap_btn_get=function(){var t=this,i=t.delegate.data.exActivity;gd.activityCtrl.receive(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),t.itemIndex,function(){t.delegate.reset()},t)},i}(mo.gui.ItemRenderer);t.Activity7DayItem=i,egret.registerClass(i,"g_activity.Activity7DayItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._Item_list_items=t.Activity7DayItem},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.label_title.text=a[gc.dsConsts.ActivityEntity.title],uiHelper.setEventTime(t.label_date,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_desc.text=a[gc.dsConsts.ActivityEntity.content],t.actItems=e[gc.dsConsts.ExActivity.activityItems],t.refreshList("list_items")}},c._data_list_items=function(){var t=this;return t.actItems},e}(mo.gui.Layer);t.Activity7Days=i,egret.registerClass(i,"g_activity.Activity7Days")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i._Item_list_items=g_base.BaseItemCell},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.list_items.verticalScrollPolicy=egret.gui.ScrollPolicy.OFF},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.delegate.data.exActivity,a=i.data;i.label_desc.text=mo.STR.format("%s",a[gc.dsConsts.ActivityItem.rmb]);var c=gd.activityCtrl.getAllChargeCountStatus(gd.activityCtrl.getActivityValue(e,gc.dsConsts.ActivityEntity.id),i.itemIndex);0==c?(i.ico_hasGet.visible=!0,i.btn_get.visible=!1,uiHelper.playUIEffect(i.effect_get,!1)):1==c?(i.ico_hasGet.visible=!1,i.btn_get.visible=!0,uiHelper.playUIEffect(i.effect_get,!0)):(i.ico_hasGet.visible=!1,i.btn_get.visible=!0,uiHelper.playUIEffect(i.effect_get,!1)),i.list_items.dataProvider=new egret.gui.ArrayCollection(utils.itemObj2ObjArr(i.data[gc.dsConsts.ActivityItem.items])),i.list_items.height=i.list_items.dataProvider.length>=4?195:95,i.ico_bg.height=i.list_items.height+90},a._initItem_list_items=function(t){t.tapShowDetail=!0},a._tap_btn_get=function(){var t=this,i=t.delegate.data.exActivity,e=t.data,a=gd.activityCtrl.getAllChargeCountStatus(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),t.itemIndex);if(0==a);else if(1!=a)return mo.showMsg(gc.id_c_msgCode.totalChargeNotEnough1,e[gc.dsConsts.ActivityItem.rmb]);gd.activityCtrl.receive(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),t.itemIndex,function(){t.delegate.reset()},t)},i}(mo.gui.ItemRenderer);t.ActivityRechargeItem=i,egret.registerClass(i,"g_activity.ActivityRechargeItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._Item_list_items=t.ActivityRechargeItem},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.label_title.text=a[gc.dsConsts.ActivityEntity.title],uiHelper.setEventTime(t.label_date,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_desc.text=a[gc.dsConsts.ActivityEntity.content],t.actItems=e[gc.dsConsts.ExActivity.activityItems],t.label_money.text=e[gc.dsConsts.ExActivity.allRecharge].toString(),t.refreshList("list_items")}},c._data_list_items=function(){var t=this;return t.actItems},e}(mo.gui.Layer);t.ActivityRecharge=i,egret.registerClass(i,"g_activity.ActivityRecharge")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i.touchEnabled=!1},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.label_code.text=i.DEFAULT,e.label_code.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onLabelTap,this)},a.onLabelTap=function(t){var e=this;e.label_code.text==i.DEFAULT&&(e.label_code.text="")},a._tap_btn_code=function(){var t=this;return t.label_code.text==i.DEFAULT?mo.showMsg(gc.id_c_msgCode.cdKeyNull):void gd.couponCtrl.use(t.label_code.text,function(){},t)},i.DEFAULT="请输入兑换码",i}(mo.gui.Layer);t.ActivityRedeemCode=i,egret.registerClass(i,"g_activity.ActivityRedeemCode")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i.registerClassByKey(gd.ActivityCtrl,gd.ActivityCtrl.ACTIVITY_OP,i.checkRedPoint)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.ico_red.visible=!1},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data,a=e[gc.dsConsts.ExActivity.activity];i.ico_titile.source=resHelper.getEventIconPath(a[gc.dsConsts.ActivityEntity.type]),i.checkRedPoint()},a.checkRedPoint=function(){var t=this,i=t.data[gc.dsConsts.ExActivity.activity];t.ico_red.visible=gd.activityCtrl.isPoint(i[gc.dsConsts.ActivityEntity.id])},i}(mo.gui.ItemRenderer);t.ActivityTabItem=i,egret.registerClass(i,"g_activity.ActivityTabItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){var i=this;t.prototype._initProp.call(this),i.state=0},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data,a=utils.obj2KVArr(e[1]);if(i.ico_item.setData({itemId:a[0],count:a[1]}),i.state=gd.signCtrl.getState(e[0]),i.invalidateSkinState(),2==i.state){if(!i.efx){var c=i.efx=g_comp.UIEffect.create();c.performanceControl=!1,c.y=-5,c.effectId=18,c.autoPlay=!0,i.grp_center.addElement(c)}}else i.efx&&(i.efx.stop(),i.grp_center.removeElement(i.efx)),i.efx=null},a.getCurrentSkinState=function(){var t=this;return 1==t.state?"disabled":3==t.state?"canpatch":"up"},i}(mo.gui.ItemRenderer);t.SignItem=i,egret.registerClass(i,"g_activity.SignItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1,e._Item_list_items=t.SignItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.label_month.text=""+(Date.newDate().getMonth()+1)},c._data_list_items=function(){return gd.signCtrl.getSignItems()},c._click_list_items=function(t){var i=this,e=(t.item,t.itemRenderer.state);2==e?gd.signCtrl.sign(i._refresh,i):3==e&&gd.signCtrl.patchSign(i._refresh,i)},c._refresh=function(){var t=this;t.refreshList("list_items")},e}(mo.gui.Layer);t.ActivitySign=i,egret.registerClass(i,"g_activity.ActivitySign")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments),this._comps=[]}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._Item_list_activitys=t.ActivityTabItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var e=this;e._allExActivitys=gd.activityCtrl.getMainList(),e.list_activitys.selectedIndex=0,e.label_empty.visible=!1;for(var a=0;a<e._allExActivitys.length;++a){var c=e._allExActivitys[a],s=gd.activityCtrl.getActivityValue(c,gc.dsConsts.ActivityEntity.type);s==gc.c_prop.activityTypeKey.sevenLogin?e._comps.push(t.Activity7Days.create().setData({tray:e.container}).show()):s==gc.c_prop.activityTypeKey.allChargeCount?e._comps.push(t.ActivityRecharge.create().setData({tray:e.container}).show()):s==gc.c_prop.activityTypeKey.redeemCode?e._comps.push(t.ActivityRedeemCode.create().setData({tray:e.container}).show()):s==gc.c_prop.activityTypeKey.sign?e._comps.push(t.ActivitySign.create().setData({tray:e.container}).show()):s==gc.c_prop.activityTypeKey.mysterShop?e._comps.push(t.ActivityMysteryShop.create().setData({tray:e.container}).show()):s==gc.c_prop.activityTypeKey.singleCharge&&e._comps.push(t.ActivitySingleRchg.create().setData({tray:e.container}).show())}process.nextTick(function(){e._allExActivitys.length>0&&e.goTab(e._allExActivitys[0])})},c.onEnter=function(){i.prototype.onEnter.call(this)},c._hideAllComp=function(){for(var t=this,i=0,e=t._comps.length;e>i;i++)t._comps[i].visible=!1},c.reset=function(){var t=this;t.goTab(t._curExActivity)},c.goTab=function(t){var i=this,e=i._allExActivitys.indexOf(t);i._curExActivity=t,i._hideAllComp();var a=i._comps[e];a.visible=!0,a.setData({tray:i.container,exActivity:t})},c._data_list_activitys=function(){var t=this;return t._allExActivitys},c._click_list_activitys=function(t){var i=this,e=t.item;i.goTab(e)},e}(mo.gui.Dlg);t.ActivityDlg=i,egret.registerClass(i,"g_activity.ActivityDlg"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var i=new mo.ModuleCfgItem;i.fullScr=!0,i.targetClass=t.ActivityNewCenter,mo.moduleMgr.registerModule(i),i.onPreAsync(function(t,i){gd.activityCtrl.getInfo(function(){i()},this)})})}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._layerOpt.shownWithAction=!1,e._Item_list_items=t.FiveItem,e._targets=[["ico_diyitian","ico_wentian"],["ico_diertian","ico_senliu"],["ico_dishantian","ico_qiling"],["ico_dishitian","ico_tianxia"]],e.registerClassByKey(gd.FiveDaysTargetCtrl,gd.FiveDaysTargetCtrl.ON_RECEIVED,e.reset)},c._childrenCreated=function(){var t=this;i.prototype._childrenCreated.call(this);var e=gd.fiveDaysTargetCtrl;uiHelper.setEventTime(t.label_date,Date.newDate(e.getActivityStartTime()),e.getActivityEndTime())},c.reset=function(){var t=this;t.refreshList("list_items")},c._data_list_items=function(){var t=this;return t._targets},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:24}).show()},c._click_list_items=function(i){var e=i.itemIndex;t.FiveDetail.create().setData({idx:e}).show()},e}(mo.gui.Dlg);t.FiveDay=i,egret.registerClass(i,"g_activity.FiveDay"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=i,t.fullScr=!0,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,i){gd.fiveDaysTargetCtrl.getInfo(function(t){i()},this)})})}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this;i.ico_day.source=i.data[0],i.ico_title.source=i.data[1];var e=gd.fiveDaysTargetCtrl.getNormalTargetInfo(i.itemIndex),a=e[1];if(i.img_red.visible=a,i.img_selected.visible=i.itemIndex<=gd.fiveDaysTargetCtrl.getCurActDay(),i.label_date.visible=i.label_d.visible=!1,i.label_date.textColor=16516871,i.label_d.textColor=16516871,4!=i.itemIndex){i.label_date.visible=i.label_d.visible=!0;var c=gd.fiveDaysTargetCtrl,s=c.getStarTime(i.itemIndex),n=c.getCalTime(i.itemIndex);gd.fiveDaysTargetCtrl.isTodayTarget(i.itemIndex)&&(i.label_date.textColor=2685959,i.label_d.textColor=2685959),uiHelper.setEventTime(i.label_date,s,n)}},i}(mo.gui.ItemRenderer);t.FiveItem=i,egret.registerClass(i,"g_activity.FiveItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.label_empty.visible=!1;for(var e=0,a=2;a>e;e++)i["ico_item"+e].visible=!1,i["ico_item"+e].showEquipName=!0,i["ico_item"+e].onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.get("itemId"),null)}).show()},i)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data,a=gc.dsConsts.FiveDaysTargetEntity,c=i.delegate.data.idx,s=gd.fiveDaysTargetCtrl.isCertified(c);i.img_done.visible=s;for(var n=3*c+i.itemIndex,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.targetRank),o=r[n].split(","),l=0,_=2;_>l;l++){var v=null!=o[2*l];i["ico_item"+l].visible=v,v&&i["ico_item"+l].setData({itemId:o[2*l],count:o[2*l+1]})}var g=i.itemIndex,d=["1st","2nd","3rd"];3>g&&(i.ico_rank.source="ico_arena_"+d[g]);var y=null!=e;i.label_name.visible=y,i.label_rankType.visible=y,i.label_combat.visible=y,i.ico_head.visible=y,i.label_empty.visible=!y;var u=gd.fiveDaysTargetCtrl.getCurActDay()>c;y||(i.label_empty.text=u?"结算中...":"虚位以待"),y&&(i.label_name.text=e[a.userName],i.label_rankType.text=i.__class.rankType[i.delegate.data.idx],i.label_combat.text=e[a.rankValue],i.ico_head.setData({icoId:e[a.iconId],vip:e[a.pkWinCount]}))},i.rankType=["战力:","总阶数:","竞技场排名:","行会等级:",""],i}(mo.gui.ItemRenderer);t.FiveRankItem=i,egret.registerClass(i,"g_activity.FiveRankItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._layerOpt.shownWithAction=!1,e._Item_list_items=g_base.BaseItemCell,e._Item_list_ranks=t.FiveRankItem,e._targets=[["ico_diyitian","ico_wentian","grp_combat","ico_zanlipaiming",3100004,"label_combatNeed"],["ico_diertian","ico_senliu","grp_wing","ico_chibangpaiming",3100002,"label_wingLvlNeed"],["ico_dishantian","ico_qiling","grp_arena","ico_jinjichangpm",3100003,"label_arenaNum"],["ico_dishitian","ico_tianxia","img_guild","ico_hanhuidenjipm",3100005],["ico_diwutian","ico_weiwoduzhun","img_wc","ico_shouleipaiming"]]},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.idx;t.img_wczb.visible=4==e,t.title_day.visible=4>e,t.title_day.source=t._targets[e][0],t.ico_title.source=t._targets[e][1],t._hideAll(),t[t._targets[e][2]].visible=!0;var a=t._targets[e][4];if(a){var c=mo.getJSONWithFileNameAndID(gc.cfg_c_task,a),s=c[gc.c_task_targetValue],n=t[t._targets[e][5]];s&&n&&(n.text=s+"")}var r=gd.fiveDaysTargetCtrl.getNormalTargetInfo(e);t.img_unFinished.visible=!1,t.btn_get.visible=!1,t.btn_done.visible=!1;var o=r[0],l=r[1],_=r[2],v=r[3];if(t.img_unFinished.visible=!o&&!v,t.btn_get.visible=!(o&&_||v),t.btn_done.visible=_,t.btn_outdate.visible=v,t.img_rank.source=t._targets[e][3],t.label_date.visible=t.label_d.visible=!1,4!=e){t.label_date.visible=t.label_d.visible=!0;var g=gd.fiveDaysTargetCtrl;uiHelper.setEventTime(t.label_date,g.getStarTime(e),g.getCalTime(e))}t.img_red.visible=l},c._hideAll=function(){for(var t=this,i=["grp_combat","grp_wing","grp_arena","grp_wing","img_guild","img_wc"],e=0,a=i.length;a>e;e++)t[i[e]].visible=!1},c._data_list_items=function(){var t=this,i=t.data.idx,e=t._targets[i][4],a=null!=e?utils.itemObj2ObjArr(gd.taskCtrl.getTaskReward(e)):[];return a},c._data_list_ranks=function(){var t=this,i=t.data.idx;return 4==i?[]:gd.fiveDaysTargetCtrl.getRankList(t.data.idx)},c._tap_btn_get=function(){var t=this,i=t.data.idx;gd.fiveDaysTargetCtrl.receive(i,t.dataChanged,t)},c._initItem_list_items=function(t){var i=t.ico_item;i.showEquipName=!0,t.tapShowDetail=!0},e}(mo.gui.Dlg);t.FiveDetail=i,egret.registerClass(i,"g_activity.FiveDetail")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._layerOpt.shownWithAction=!1,mo.gui.helper.setSkinName(this,t.FiveDay.__className),e._Item_list_items=t.NewFiveItem,e.registerClassByKey(gd.NewFourDaysCtrl,gd.NewFourDaysCtrl.ON_RECEIVED,e.reset)},c._childrenCreated=function(){var t=this;i.prototype._childrenCreated.call(this),t._targets=[["ico_diyitiancibang","ico_senliu"],["ico_diertianbaoshi","ico_xuanguangs"],["ico_diyitianyuangsengs","ico_ningshengs"],["ico_disitianzanli","ico_wentian"]],uiHelper.setEventTime(t.label_date,Date.newDate(gd.newFourDaysCtrl.getActivityStartTime()),gd.newFourDaysCtrl.getActivityEndTime())},c.reset=function(){var t=this;t.refreshList("list_items")},c._data_list_items=function(){var t=this;return t._targets},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:24}).show()},c._click_list_items=function(i){var e=i.itemIndex;t.NewFiveDetail.create().setData({idx:e}).show()},e}(mo.gui.Dlg);t.NewFiveDay=i,egret.registerClass(i,"g_activity.NewFiveDay"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=i,t.fullScr=!0,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,i){gd.newFourDaysCtrl.getInfo(function(t){i()},this)})})}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);mo.gui.helper.setSkinName(this,t.FiveItem.__className)},c._childrenCreated=function(){i.prototype._childrenCreated.call(this)},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this;t.ico_day.source=t.data[0],t.ico_title.source=t.data[1];var e=gd.newFourDaysCtrl.getNormalTargetInfo(t.itemIndex),a=e[1];if(t.img_red.visible=a,t.img_selected.visible=t.itemIndex<=gd.newFourDaysCtrl.getCurActDay(),t.label_date.visible=t.label_d.visible=!1,t.label_date.textColor=16516871,t.label_d.textColor=16516871,4!=t.itemIndex){t.label_date.visible=t.label_d.visible=!0;var c=gd.newFourDaysCtrl.getStarTime(t.itemIndex),s=gd.newFourDaysCtrl.getCalTime(t.itemIndex);gd.newFourDaysCtrl.isTodayTarget(t.itemIndex)&&(t.label_date.textColor=2685959,t.label_d.textColor=2685959),uiHelper.setEventTime(t.label_date,c,s)}},e}(mo.gui.ItemRenderer);t.NewFiveItem=i,egret.registerClass(i,"g_activity.NewFiveItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);mo.gui.helper.setSkinName(this,t.FiveRankItem.__className)},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.label_empty.visible=!1;for(var e=0,a=2;a>e;e++)t["ico_item"+e].visible=!1,t["ico_item"+e].showEquipName=!0,t["ico_item"+e].onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.get("itemId"),null)}).show()},t)},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data,a=gc.dsConsts.FiveDaysTargetEntity,c=t.delegate.data.idx,s=gd.newFourDaysCtrl.isCertified(c);t.img_done.visible=s;for(var n=3*c+t.itemIndex,r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.newFourRank),o=r[n],l=o.split(","),_=0,v=0;l&&v<l.length;v+=2)_=v/2,t["ico_item"+_].setData({itemId:l[v],count:l[v+1]}),t["ico_item"+_].visible=!0;for(var g=_+1;2>g;++g)t["ico_item"+g].visible=!1;var d=t.itemIndex,y=["1st","2nd","3rd"];3>d&&(t.ico_rank.source="ico_arena_"+y[d]);var u=null!=e;t.label_name.visible=u,t.label_rankType.visible=u,t.label_combat.visible=u,t.ico_head.visible=u,t.label_empty.visible=!u;var h=gd.newFourDaysCtrl.getCurActDay()>c;u||(t.label_empty.text=h?"结算中...":"虚位以待"),u&&(t.label_name.text=e[a.userName],t.label_rankType.text=t.__class.rankType[t.delegate.data.idx],t.label_combat.text=e[a.rankValue],t.ico_head.setData({icoId:e[a.iconId],vip:e[a.pkWinCount]}))},e.rankType=["总阶数:","总级数:","总级数:","战力:",""],e}(mo.gui.ItemRenderer);t.NewFiveRankItem=i,egret.registerClass(i,"g_activity.NewFiveRankItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._layerOpt.shownWithAction=!1,mo.gui.helper.setSkinName(this,t.FiveDetail.__className),e._Item_list_items=g_base.BaseItemCell,e._Item_list_ranks=t.NewFiveRankItem,e._targets=[["ico_diyitiancibang","ico_senliu","grp_wing","ico_chibangpaiming",0,"label_combatNeed"],["ico_diertianbaoshi","ico_xuanguangs","grp_gem","ico_zuangbeibaospm",1,"label_gem"],["ico_diyitianyuangsengs","ico_ningshengs","grp_realm","ico_yuanshenzdjpm",2,"label_realm"],["ico_disitianzanli","ico_wentian","grp_combat","ico_zanlipaiming",3]]},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.idx;t.img_wczb.visible=4==e,t.title_day.visible=4>e,t.title_day.source=t._targets[e][0],t.ico_title.source=t._targets[e][1],t._hideAll(),t[t._targets[e][2]].visible=!0;var a=t._targets[e][4];if(a){var c=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.newFourNeedValue),s=c[a],n=t[t._targets[e][5]];s&&n&&(n.text=s+"")}var r=gd.newFourDaysCtrl.getNormalTargetInfo(e);t.img_unFinished.visible=!1,t.btn_get.visible=!1,t.btn_done.visible=!1;var o=r[0],l=r[1],_=r[2],v=r[3];t.img_unFinished.visible=!o&&!v,t.btn_get.visible=!(o&&_||v),t.btn_done.visible=_,t.btn_outdate.visible=v,t.img_rank.source=t._targets[e][3],t.label_date.visible=t.label_d.visible=!1,4!=e&&(t.label_date.visible=t.label_d.visible=!0,uiHelper.setEventTime(t.label_date,gd.newFourDaysCtrl.getStarTime(e),gd.newFourDaysCtrl.getCalTime(e))),t.img_red.visible=l},c._hideAll=function(){for(var t=this,i=["grp_combat","grp_wing","grp_arena","grp_wing","img_guild","img_wc"],e=0,a=i.length;a>e;e++)t[i[e]].visible=!1},c._data_list_items=function(){var t=this,i=t.data.idx,e=[],a=t._targets[i][4]+12,c=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.newFourRank),s=c[a],n=s.split(",");(!n||n.length<2)&&(e=[]);for(var r=0;r<n.length;r+=2)e.push({itemId:n[r],count:n[r+1]});return e},c._data_list_ranks=function(){var t=this,i=t.data.idx;return 4==i?[]:gd.newFourDaysCtrl.getRankList(t.data.idx)},c._tap_btn_get=function(){var t=this,i=t.data.idx;gd.newFourDaysCtrl.receive(i,t.dataChanged,t)},c._initItem_list_items=function(t){var i=t.ico_item;i.showEquipName=!0,t.tapShowDetail=!0},e}(mo.gui.Dlg);t.NewFiveDetail=i,egret.registerClass(i,"g_activity.NewFiveDetail")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._childrenCreated=function(){t.prototype._childrenCreated.call(this);for(var i=this,e=0;3>e;++e){var a=i["ico_item"+e];a.label_text.visible=!1,a.onClick(function(){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(this.get("itemId"),null)}).show()},a)}for(var e=0;2>e;++e){var a=i["ico_itemBuy"+e];a.label_text.visible=!1,a.onClick(function(){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(this.get("itemId"),null)}).show()},a)}i._hitEfxPlayer=uiHelper.EfxPlayer.create(i.efx_hit2)},a.reset=function(){var t=this;t.setData(t.data)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity],c=mo.getJSONWithFileNameAndID(gc.cfg_c_mysterShop,a[gc.dsConsts.ActivityEntity.exValues][0]),s=[c[gc.c_mysterShop_integralItem1],c[gc.c_mysterShop_integralItem2],c[gc.c_mysterShop_integralItem3]],n=[c[gc.c_mysterShop_giftBag1],c[gc.c_mysterShop_giftBag2]],r=gd.activityCtrl.getMysterShopArr(a[gc.dsConsts.ActivityEntity.id],a[gc.dsConsts.ActivityEntity.startTime],a[gc.dsConsts.ActivityEntity.endTime]),a=i.data.exActivity[gc.dsConsts.ExActivity.activity];uiHelper.setEventTime(i.label_date,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),i.img_title_bg.source="bg_secret_shop_"+(a[gc.dsConsts.ActivityEntity.tiIconType]||0),i.label_curScore.text=r[0]+"",i.label_title.text=a[gc.dsConsts.ActivityEntity.title],i.label_desc.text=a[gc.dsConsts.ActivityEntity.content];for(var o=0;3>o;++o){var l=i["ico_item"+o],_=s[o][0],v=s[o][1],g=mo.getJSONWithFileNameAndID(gc.cfg_t_item,_),d=i["label_item"+o],y=i["label_score"+o],u=i["label_exCount"+o];u.text=r[1][o]||"0",d.textColor=uiHelper.getColorByQuality(g[gc.t_item_color]),d.text=g[gc.t_item_name],y.text=s[o][2],l.setData({itemId:_,count:v})}for(var o=0;2>o;++o){var l=i["ico_itemBuy"+o],_=n[o][0],v=n[o][1],h=n[o][2],p=n[o][3],m=n[o][4],g=mo.getJSONWithFileNameAndID(gc.cfg_t_item,_),f=i["label_rmb"+o],y=i["label_scoreGet"+o],C=i["ico_res"+o],d=i["label_itemBuy"+o];d.textColor=uiHelper.getColorByQuality(g[gc.t_item_color]),d.text=g[gc.t_item_name],1==h?C.source="ico_gold":C.source="ico_yuanbao",f.text=p,y.text=m,l.setData({itemId:_,count:v})}}},a._tap_btn_exchange0=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.exChangeMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),0,function(){t.reset()},t)},a._tap_btn_exchange1=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.exChangeMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),1,function(){t.reset()},t)},a._tap_btn_exchange2=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.exChangeMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),2,function(){t.reset()},t)},a._tap_btn_buy0=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.buyMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),0,function(i){var e=i[0],a=i[1];e&&t._hitEfxPlayer.play(),a&&g_msg.UIMsgTextCtrl.push("+"+a),t.reset()},t)},a._tap_btn_buy1=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.buyMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),1,function(i){var e=i[0],a=i[1];e&&t._hitEfxPlayer.play(),a&&g_msg.UIMsgTextCtrl.push("+"+a),t.reset()},t)},i}(mo.gui.Layer);t.ActivityMysteryShop=i,egret.registerClass(i,"g_activity.ActivityMysteryShop")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._Item_list_items=t.ActivitySingleRchgItem},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.label_title.text=a[gc.dsConsts.ActivityEntity.title],uiHelper.setEventTime(t.label_date,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_desc.text=a[gc.dsConsts.ActivityEntity.content],t.actItems=e[gc.dsConsts.ExActivity.activityItems],t.refreshList("list_items")}},c._data_list_items=function(){var t=this;return t.actItems},e}(mo.gui.Layer);t.ActivitySingleRchg=i,egret.registerClass(i,"g_activity.ActivitySingleRchg")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i._Item_list_items=g_base.BaseItemCell},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.list_items.verticalScrollPolicy=egret.gui.ScrollPolicy.OFF},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data;i.label_desc.text=mo.STR.format("%s",e[gc.dsConsts.ActivityItem.rmb]/10),i.refreshList("list_items")},a._initItem_list_items=function(t){t.tapShowDetail=!0},a._data_list_items=function(){var t=this;return utils.itemObj2ObjArr(t.data[gc.dsConsts.ActivityItem.items])},i}(mo.gui.ItemRenderer);t.ActivitySingleRchgItem=i,egret.registerClass(i,"g_activity.ActivitySingleRchgItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments),this._comps=[]}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._Item_list_activitys=t.ActivityTabItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var e=this;e._allExActivitys=gd.activityCtrl.getFuliList(),e.list_activitys.selectedIndex=0,e.label_empty.visible=!1;for(var a=0;a<e._allExActivitys.length;++a){var c=e._allExActivitys[a],s=gd.activityCtrl.getActivityValue(c,gc.dsConsts.ActivityEntity.type);s==gc.c_prop.activityTypeKey.sevenLogin?e._comps.push(t.Activity7Days.create().setData({tray:e.container}).show()):s==gc.c_prop.activityTypeKey.allChargeCount?e._comps.push(t.ActivityRecharge.create().setData({tray:e.container}).show()):s==gc.c_prop.activityTypeKey.redeemCode?e._comps.push(t.ActivityRedeemCode.create().setData({tray:e.container}).show()):s==gc.c_prop.activityTypeKey.sign&&e._comps.push(t.ActivitySign.create().setData({tray:e.container}).show())}process.nextTick(function(){e._allExActivitys.length>0&&e.goTab(e._allExActivitys[0])})},c.onEnter=function(){i.prototype.onEnter.call(this)},c._hideAllComp=function(){for(var t=this,i=0,e=t._comps.length;e>i;i++)t._comps[i].visible=!1},c.reset=function(){var t=this;t.goTab(t._curExActivity)},c.goTab=function(t){var i=this,e=i._allExActivitys.indexOf(t);i._curExActivity=t,i._hideAllComp();var a=i._comps[e];a.visible=!0,a.setData({tray:i.container,exActivity:t})},c._data_list_activitys=function(){var t=this;return t._allExActivitys},c._click_list_activitys=function(t){var i=this,e=t.item;i.goTab(e)},e}(mo.gui.Dlg);t.FuliDlg=i,egret.registerClass(i,"g_activity.FuliDlg"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.fullScr=!0,t.targetClass=i,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,i){gd.activityCtrl.getInfo(function(){i()},this)})})}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=(i.delegate.data.exActivity,i.data),a=e[0];mo.getJSONWithFileNameAndID(gc.cfg_t_item,a);i.ico_item.setData({itemId:a,count:e[1]}),i.label_score.text=e[2]},a._tap_btn_exchange=function(){var t=this,i=t.delegate.data.index,e=t.delegate.data.exActivity;gd.activityCtrl.exChangeMysterShop(gd.activityCtrl.getActivityValue(e,gc.dsConsts.ActivityEntity.id),i+","+t.itemIndex,function(){t.dataChanged(),t.delegate.dataChanged()},t)},i}(mo.gui.ItemRenderer);t.ActivityAppExchangeCell=i,egret.registerClass(i,"g_activity.ActivityAppExchangeCell")
}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityAppExchangeCell},c._childrenCreated=function(){i.prototype._childrenCreated.call(this)},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity],c=gd.activityCtrl.getMysterShopArr(a[gc.dsConsts.ActivityEntity.id],a[gc.dsConsts.ActivityEntity.startTime],a[gc.dsConsts.ActivityEntity.endTime]);t.label_score.text=c[0]}},c._data_list_items=function(){var t=this,i=t.data.exActivity,e=t.data.index;if(i){var a=i[gc.dsConsts.ExActivity.activity],c=mo.getJSONWithFileNameAndID(gc.cfg_c_mysterShop,a[gc.dsConsts.ActivityEntity.exValues][0]),s=c[gc.c_mysterShop_integralItem1];return 0==e?s=c[gc.c_mysterShop_integralItem1]:1==e?s=c[gc.c_mysterShop_integralItem2]:2==e&&(s=c[gc.c_mysterShop_integralItem3]),s}},e}(mo.gui.Dlg);t.ActivityAppMysteryExchangeDlg=i,egret.registerClass(i,"g_activity.ActivityAppMysteryExchangeDlg")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._childrenCreated=function(){i.prototype._childrenCreated.call(this);for(var t=this,e=0;3>e;++e){var a=t["ico_item"+e];a.label_text.visible=!1,a.onClick(t["_tap_btn_exchange"+e],t)}for(var e=0;2>e;++e){var a=t["ico_itemBuy"+e];a.label_text.visible=!1,a.onClick(function(){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(this.get("itemId"),null)}).show()},a)}t._hitEfxPlayer=uiHelper.EfxPlayer.create(t.efx_hit2)},c.reset=function(){var t=this;t.setData(t.data)},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity],c=mo.getJSONWithFileNameAndID(gc.cfg_c_mysterShop,a[gc.dsConsts.ActivityEntity.exValues][0]),s=c[gc.c_mysterShop_picture],n=[c[gc.c_mysterShop_giftBag1],c[gc.c_mysterShop_giftBag2]],r=gd.activityCtrl.getMysterShopArr(a[gc.dsConsts.ActivityEntity.id],a[gc.dsConsts.ActivityEntity.startTime],a[gc.dsConsts.ActivityEntity.endTime]);t.label_yuanbao.text=gd.userCtrl.getDiamond(),t.head.setActivity(a),t.label_curScore.text=r[0]+"",uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content];for(var o=0;3>o;++o){var l=t["ico_item"+o],_=s[o],v=mo.getJSONWithFileNameAndID(gc.cfg_t_item,_),g=t["label_item"+o];g.text=v[gc.t_item_name],l.setData({itemId:_,count:1})}for(var o=0;2>o;++o){var l=t["ico_itemBuy"+o],_=n[o][0],d=n[o][1],y=n[o][2],u=n[o][3],h=n[o][4],v=mo.getJSONWithFileNameAndID(gc.cfg_t_item,_),p=t["label_rmb"+o],m=t["label_scoreGet"+o],f=t["ico_res"+o],g=t["label_itemBuy"+o];g.text=v[gc.t_item_name],1==y?f.source="ico_gold":f.source="ico_yuanbao",p.text=u,m.text=h,l.setData({itemId:_,count:d})}}},c._tap_btn_exchange0=function(){var i=this;t.ActivityAppMysteryExchangeDlg.create().setData({exActivity:i.data.exActivity,index:0}).show().onClose(function(){i.reset()})},c._tap_btn_exchange1=function(){var i=this;t.ActivityAppMysteryExchangeDlg.create().setData({exActivity:i.data.exActivity,index:1}).show().onClose(function(){i.reset()})},c._tap_btn_exchange2=function(){var i=this;t.ActivityAppMysteryExchangeDlg.create().setData({exActivity:i.data.exActivity,index:2}).show().onClose(function(){i.reset()})},c._tap_btn_buy0=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.buyAppMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),0,function(i){var e=i[0],a=i[1];e&&t._hitEfxPlayer.play(),a&&g_msg.UIMsgTextCtrl.push("+"+a),t.reset()},t)},c._tap_btn_buy1=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.buyAppMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),1,function(i){var e=i[0],a=i[1];e&&t._hitEfxPlayer.play(),a&&g_msg.UIMsgTextCtrl.push("+"+a),t.reset()},t)},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:201}).show()},e}(mo.gui.Dlg);t.ActivityAppMysteryShop=i,egret.registerClass(i,"g_activity.ActivityAppMysteryShop")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewCenterCell,e.registerClassByKey(gd.ActivityCtrl,gd.ActivityCtrl.ACTIVITY_OP,e.reset)},c._childrenCreated=function(){i.prototype._childrenCreated.call(this)},c._data_list_items=function(){return gd.activityCtrl.getMainList()},c.reset=function(){var t=this;t.refreshList("list_items")},c._click_list_items=function(i){var e=i.item,a=e[gc.dsConsts.ExActivity.activity],c=a[gc.dsConsts.ActivityEntity.type];c==gc.c_prop.activityTypeKey.allChargeCount?t.ActivityNewRchg.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.singleCharge?t.ActivityNewSingleRchg.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.mysterShop?t.ActivityNewMysteryShop.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.luckyTalos?t.ActivityNewLuckyTalos.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.everydayCharge?t.ActivityNewEverydayRchg.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.limitPanicBuying?t.ActivityNewLimitBuy.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.rebate?t.ActivityNewRebate.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.dayRecharge?t.ActivityNewTotalRchgOneDay.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.setTheWord?t.ActivityNewCollectCharacter.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.vPlan?t.ActivityNewVplan.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.appMysterShop?t.ActivityAppMysteryShop.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.luckyMajong?t.ActivityNewMaJiangTalos.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.userSurvey?t.ActivityNewAsk.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.activityNotice?t.ActivityNewNotice.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.newLuckyMajong?t.ActivityNewCardTalos.create().setData({exActivity:e}).show():c==gc.c_prop.activityTypeKey.newLimitPanicBuying&&t.ActivityNewDayLimitBuy.create().setData({exActivity:e}).show()},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:200}).show()},e}(mo.gui.Dlg);t.ActivityNewCenter=i,egret.registerClass(i,"g_activity.ActivityNewCenter")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this)},a.dataChanged=function(){var t=this,i=(t.data,t.data[gc.dsConsts.ExActivity.activity]),e=i[gc.dsConsts.ActivityEntity.exData];if(e){var a=e[gc.c_prop.activityExDataTypeKey.titleIcon],c=e[gc.c_prop.activityExDataTypeKey.desIcon];t.setIcon(a,c)}else t.setIcon("","");uiHelper.setEventTime(t.lbl_time,Date.newDate(i[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(i[gc.dsConsts.ActivityEntity.endTime]))},a.setIcon=function(t,i){var e=this;if(t&&""!=t){var a="resource/ui2/ui_activity/"+t;RES.getResByUrl(a+"_3.jpg",function(t){e.img_bg.source=t},e,RES.ResourceItem.TYPE_IMAGE)}else{var c=e.data[gc.dsConsts.ExActivity.activity],s="dbcz",n=c[gc.dsConsts.ActivityEntity.type];n==gc.c_prop.activityTypeKey.allChargeCount?s="lcfl":n==gc.c_prop.activityTypeKey.singleCharge?s="dbcz":n==gc.c_prop.activityTypeKey.mysterShop?s="smsd":n==gc.c_prop.activityTypeKey.luckyTalos?s="smtlp":n==gc.c_prop.activityTypeKey.everydayCharge?s="ttcz":n==gc.c_prop.activityTypeKey.limitPanicBuying?s="xsqg":n==gc.c_prop.activityTypeKey.appMysterShop&&(s="smsd"),e.setIcon(s,"")}if(i&&i.length>0){var r="resource/ui2/ui_activity/state_"+i+".png";RES.getResByUrl(r,function(t){e.img_state.source=t},e,RES.ResourceItem.TYPE_IMAGE)}},i}(mo.gui.ItemRenderer);t.ActivityNewCenterCell=i,egret.registerClass(i,"g_activity.ActivityNewCenterCell")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewSingleRchgItem},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content],t.actItems=e[gc.dsConsts.ExActivity.activityItems],t.refreshList("list_items")}},c._data_list_items=function(){var t=this;return t.actItems},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:203}).show()},e}(mo.gui.Dlg);t.ActivityNewSingleRchg=i,egret.registerClass(i,"g_activity.ActivityNewSingleRchg")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i._Item_list_items=g_base.BaseItemCell},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.list_items.verticalScrollPolicy=egret.gui.ScrollPolicy.OFF},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data;i.label_desc.text=mo.STR.format("%s",e[gc.dsConsts.ActivityItem.rmb]/10),i.refreshList("list_items")},a._initItem_list_items=function(t){t.tapShowDetail=!0},a._data_list_items=function(){var t=this;return utils.itemObj2ObjArr(t.data[gc.dsConsts.ActivityItem.items])},i}(mo.gui.ItemRenderer);t.ActivityNewSingleRchgItem=i,egret.registerClass(i,"g_activity.ActivityNewSingleRchgItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewEverydayRchgItem,e.registerClassByKey(gd.ActivityCtrl,gd.ActivityCtrl.ACTIVITY_OP,e.checkRedPoint),e.registerClassByKey(gd.RechargeCtrl,gd.RechargeCtrl.ON_RECHARGE_SUCC,e.rechargeSuccess)},c.rechargeSuccess=function(){var t=this;gd.activityCtrl.getInfo(function(){t.reset()})},c.checkRedPoint=function(){var t=this;t.reset()},c.reset=function(){var t=this,i=t.data.exActivity,e=i[gc.dsConsts.ExActivity.activity];t.setData({exActivity:gd.activityCtrl.getActivity(e[gc.dsConsts.ActivityEntity.id])});var a=t.list_items.scroller,c=a.scrollTop>=0?a.scrollTop:0;t.refreshList("list_items"),process.nextTick(function(){t.list_items&&a.throwVertically(c,0)})},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content],t.label_cost_have.text=gd.userCtrl.getDiamond(),t.actItems=[];var c=mo.getJSONWithFileName(gc.cfg_c_everydayCharge),s=e[gc.dsConsts.ExActivity.days];t.label_activity_charged.text="今日已充值"+e[gc.dsConsts.ExActivity.todayRecharge]+"元 , 已完成"+s+"天";var n=gd.userCtrl.get(gc.dsConsts.UserEntity.activity),r=n[a[gc.dsConsts.ActivityEntity.id]],o=0;for(var l in c){var _=c[l];_.activityId=a[gc.dsConsts.ActivityEntity.id],_.index=o,s>=o+1?r&&r[o]>0?_.status=1:_.status=3:_.status=2,t.actItems.push(_),o++}t.refreshList("list_items")}},c._data_list_items=function(){var t=this;return t.actItems},c._tap_btn_charge=function(){mo.moduleMgr.pushModule(g_consts.moduleId.recharge)},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:205}).show()},e}(mo.gui.Dlg);t.ActivityNewEverydayRchg=i,egret.registerClass(i,"g_activity.ActivityNewEverydayRchg")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewCollectCharacterBaseItem},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content],t.actItems=e[gc.dsConsts.ExActivity.activityItems],t.refreshList("list_items");var c=a[gc.dsConsts.ActivityEntity.exData],s=0;if(c){var n=c[gc.c_prop.activityExDataTypeKey.spItemId];t.ico_have_icon.source=resHelper.getItemIconPath(n),t.ico_cost_icon.source=resHelper.getItemIconPath(n),t.label_yuanbao_cost.text=a[gc.dsConsts.ActivityEntity.exValues][0]+"",t.label_yuanbao_left.text=gd.userCtrl.getItemNum(n)+"",s=c[gc.c_prop.activityExDataTypeKey.vipLimitLvl]||0}var r=gd.activityCtrl.getLimitPanicBuyCount(a[gc.dsConsts.ActivityEntity.id]),o=a[gc.dsConsts.ActivityEntity.exValues2][0];t.label_buy_count.text="当前已购买"+r+"次",r>=o?(t.label_buy_count.text="已达到购买上限",t.ico_hasGet.visible=!0):t.ico_hasGet.visible=!1,t.label_vipHint.visible=s>0,s>0&&(t.label_vipHint.text="vip"+s.toString()+"及以上才可购买")}},c._data_list_items=function(){for(var t=this,i=[],e=0;e<t.actItems.length;e++){var a=t.actItems[e],c=gc.dsConsts.ActivityItem.items,s=a[c];for(var n in s)i.push({itemId:n,count:s[n]})}return i},c._tap_btn_buy=function(){var t=this,i=t.data.exActivity[gc.dsConsts.ExActivity.activity];gd.activityCtrl.limitPanicBuying(i[gc.dsConsts.ActivityEntity.id],0,function(i){t.setData(t.data)},t)},c._click_list_items=function(t){var i=t.item;g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.itemId,null)}).show()},c._tap_btn_help=function(){var t=this,i=t.data.exActivity,e=i[gc.dsConsts.ExActivity.activity],a=e[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.subType]||0;a=parseInt(a);var c=0==a?206:a;g_base.BaseShowTip.create().setData({id:c}).show()},e}(mo.gui.Dlg);t.ActivityNewLimitBuy=i,egret.registerClass(i,"g_activity.ActivityNewLimitBuy")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var t=this;i.prototype._initProp.call(this),t._Item_list_items=g_base.BaseItemCell,t._selectedIndex=-1,t.haveClick=!1,t.detailActItems=null},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),t._updateGoldInfo();var c=mo.getJSONWithFileName(gc.cfg_c_luckyTalos),s=a[gc.dsConsts.ActivityEntity.exValues2][0],n=a[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.spItemId],r=a[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.subType]||0,o=gd.userCtrl.getLvl();t.actItems=[],t.detailActItems=[];for(var l in c){var _=c[l],v=_[gc.c_luckyTalos_subTypeDivide][0],g=_[gc.c_luckyTalos_subTypeDivide][1],d=o>=v&&g>=o;_[gc.c_luckyTalos_spItemId]==n&&r==_[gc.c_luckyTalos_subType]&&d&&(t.detailActItems.push({itemId:_[gc.c_luckyTalos_itemID],count:_[gc.c_luckyTalos_amount]}),_[gc.c_luckyTalos_color]>=s&&t.actItems.push({itemId:_[gc.c_luckyTalos_itemID],count:_[gc.c_luckyTalos_amount]}))}t.refreshList("list_items");for(var y=a[gc.dsConsts.ActivityEntity.exValues][0],u=0;4>u;++u){var h=t["label_cost_have"+u];h.text=""+utils.formatByWan(y,0);var p=t["ico_cost_icon"+u];p.source=resHelper.getItemIconPath(n),p.anchorOffsetY=-p.height}}},c._updateGoldInfo=function(){var t=this;t.label_jinbi.text=gd.userCtrl.getGold(),t.label_yuanbao.text=gd.userCtrl.getDiamond()},c._data_list_items=function(){var t=this,i=t.actItems.slice(0,4);return i},c._click_list_items=function(t){var i=t.item;g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.itemId,null)}).show()},c.clickCard=function(t){var i=this;if(!i.haveClick){if(i.haveClick=!0,i.clickTime=egret.setTimeout(function(){i.dealClickTime()},i,500),i._selectedIndex>=0)return void(1==i._aniStep&&(i._aniStep=2,i._runAnimation()));var e=i["grp_item"+t];if(!e.visible){var a=i.data.exActivity;gd.activityCtrl.luckyTalos(gd.activityCtrl.getActivityValue(a,gc.dsConsts.ActivityEntity.id),t,function(e){i._selectedIndex=t,i.initCardsWithIds(e,t),i._updateGoldInfo(),i.haveClick=!1})}}},c.dealClickTime=function(){var t=this;t.haveClick=!1,egret.clearTimeout(t.clickTime)},c.clickFlip=function(t){var i=this;1==i._aniStep&&(i._aniStep=2,i._goNext())},c.initCardsWithIds=function(t,i){var e=this;e._gotCards=t,e._aniIdx=[];for(var a=0;4>a;++a){var c=e["ico_item"+a];c.onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.data.itemId,null)}).show()}),a==i?e._aniIdx.unshift(a):e._aniIdx.push(a)}e._gotCards=t,e._aniStep=0,e._runAnimation(),e.idTime1=egret.setTimeout(function(){0==e._aniStep&&(e._aniStep=1,e._runAnimation())},e,500)},c._runAnimation=function(){var t=this;if(t._aniStep>=2)return egret.clearTimeout(t.idTime2),void t._goNext();var i=t._gotCards;if(0==t._aniStep){var e=t._aniIdx[0];t._showItemAtIndex(mo.getJSONWithFileNameAndID(gc.cfg_c_luckyTalos,i[e]),e,function(){})}else 1==t._aniStep&&(t._showItemAtIndex(mo.getJSONWithFileNameAndID(gc.cfg_c_luckyTalos,i[t._aniIdx[1]]),t._aniIdx[1]),t._showItemAtIndex(mo.getJSONWithFileNameAndID(gc.cfg_c_luckyTalos,i[t._aniIdx[2]]),t._aniIdx[2]),t._showItemAtIndex(mo.getJSONWithFileNameAndID(gc.cfg_c_luckyTalos,i[t._aniIdx[3]]),t._aniIdx[3]),t.idTime2=egret.setTimeout(function(){1==t._aniStep&&(t._aniStep=2,t._runAnimation())},t,3e3))},c._goNext=function(){var t=this;egret.clearTimeout(t.idTime2),egret.clearTimeout(t.idTime1),t._hideItemAtIndex(0),t._hideItemAtIndex(1),t._hideItemAtIndex(2),t._hideItemAtIndex(3),t._selectedIndex=-1,t.haveClick=!1},c._showItemAtIndex=function(t,i,e){var a=this,c=a["ico_item"+i];if(c){var s=a["label_item"+i];if(s){var n=a["card_effect"+i];n.visible=!0;var r=uiHelper.EfxPlayer.create(n);r.setEndCallback(function(){n.visible=!1,e&&e.call()}),r.play();var o=t[gc.c_luckyTalos_itemID];c.setData({itemId:o,count:t[gc.c_luckyTalos_amount]});var l=mo.getJSONWithFileNameAndID(gc.cfg_t_item,o);s.text=l[gc.t_item_name];var _=a["btn_card"+i];_.visible=!1;var v=a["grp_item"+i];v.visible=!0}}},c._hideItemAtIndex=function(t){var i=this,e=i["ico_item"+t];if(e){var a=i["label_item"+t];if(a){var c=i["card_effect"+t];c.visible=!0;var s=uiHelper.EfxPlayer.create(c);s.setEndCallback(function(){c.visible=!1}),s.play(),a.text="";var n=i["btn_card"+t];n.visible=!0;var r=i["grp_item"+t];r.visible=!1}}},c._tap_btn_card0=function(){var t=this;t.clickCard(0)},c._tap_btn_card1=function(){var t=this;t.clickCard(1)},c._tap_btn_card2=function(){var t=this;t.clickCard(2)},c._tap_btn_card3=function(){var t=this;t.clickCard(3)},c._tap_btn_flipped0=function(){var t=this;t.clickFlip(0)},c._tap_btn_flipped1=function(){var t=this;t.clickFlip(1)},c._tap_btn_flipped2=function(){var t=this;t.clickFlip(2)},c._tap_btn_flipped3=function(){var t=this;t.clickFlip(3)},c._tap_btn_container=function(){},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:204}).show()},c._tap_btn_detail=function(){var i=this;t.ActivityNewDetail.create().setData({actItems:i.detailActItems,extrItems:null}).show()},e}(mo.gui.Dlg);t.ActivityNewLuckyTalos=i,egret.registerClass(i,"g_activity.ActivityNewLuckyTalos")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._childrenCreated=function(){t.prototype._childrenCreated.call(this);for(var i=this,e=0;3>e;++e){var a=i["ico_item"+e];a.label_text.visible=!1,a.onClick(function(){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(this.get("itemId"),null)}).show()},a)}for(var e=0;2>e;++e){var a=i["ico_itemBuy"+e];a.label_text.visible=!1,a.onClick(function(){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(this.get("itemId"),null)}).show()},a)}i._hitEfxPlayer=uiHelper.EfxPlayer.create(i.efx_hit2)},a.reset=function(){var t=this;t.setData(t.data)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity],c=mo.getJSONWithFileNameAndID(gc.cfg_c_mysterShop,a[gc.dsConsts.ActivityEntity.exValues][0]),s=[c[gc.c_mysterShop_integralItem1][0],c[gc.c_mysterShop_integralItem2][0],c[gc.c_mysterShop_integralItem3][0]],n=[c[gc.c_mysterShop_giftBag1],c[gc.c_mysterShop_giftBag2]],r=gd.activityCtrl.getMysterShopArr(a[gc.dsConsts.ActivityEntity.id],a[gc.dsConsts.ActivityEntity.startTime],a[gc.dsConsts.ActivityEntity.endTime]);i.label_yuanbao.text=gd.userCtrl.getDiamond(),i.head.setActivity(a),i.label_curScore.text=r[0]+"",uiHelper.setEventTime(i.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),i.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content];for(var o=0;3>o;++o){var l=i["ico_item"+o],_=s[o][0],v=s[o][1],g=mo.getJSONWithFileNameAndID(gc.cfg_t_item,_),d=i["label_item"+o],y=i["label_score"+o],u=i["label_exCount"+o];u.text=r[1][o]||"0",d.text=g[gc.t_item_name],y.text=s[o][2],l.setData({itemId:_,count:v})}for(var o=0;2>o;++o){var l=i["ico_itemBuy"+o],_=n[o][0],v=n[o][1],h=n[o][2],p=n[o][3],m=n[o][4],g=mo.getJSONWithFileNameAndID(gc.cfg_t_item,_),f=i["label_rmb"+o],y=i["label_scoreGet"+o],C=i["ico_res"+o],d=i["label_itemBuy"+o];d.text=g[gc.t_item_name],1==h?C.source="ico_gold":C.source="ico_yuanbao",f.text=p,y.text=m,l.setData({itemId:_,count:v})}}},a._tap_btn_exchange0=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.exChangeMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),0,function(){t.reset()},t)},a._tap_btn_exchange1=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.exChangeMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),1,function(){t.reset()},t)},a._tap_btn_exchange2=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.exChangeMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),2,function(){t.reset()},t)},a._tap_btn_buy0=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.buyMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),0,function(i){var e=i[0],a=i[1];e&&t._hitEfxPlayer.play(),a&&g_msg.UIMsgTextCtrl.push("+"+a),t.reset()},t)},a._tap_btn_buy1=function(){var t=this,i=t.data.exActivity;gd.activityCtrl.buyMysterShop(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),1,function(i){var e=i[0],a=i[1];e&&t._hitEfxPlayer.play(),a&&g_msg.UIMsgTextCtrl.push("+"+a),t.reset()},t)},a._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:201}).show()},i}(mo.gui.Dlg);t.ActivityNewMysteryShop=i,egret.registerClass(i,"g_activity.ActivityNewMysteryShop")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewRchgItem},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content],t.label_all_charge.text=e[gc.dsConsts.ExActivity.allRecharge].toString(),t.actItems=e[gc.dsConsts.ExActivity.activityItems],t.refreshList("list_items")}},c._data_list_items=function(){var t=this;return t.actItems},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:202}).show()},e}(mo.gui.Dlg);t.ActivityNewRchg=i,egret.registerClass(i,"g_activity.ActivityNewRchg")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i._Item_list_items=g_base.BaseItemCell},a._childrenCreated=function(){t.prototype._childrenCreated.call(this)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.delegate.data.exActivity,a=i.data;i.label_desc.text=mo.STR.format("%s",a[gc.dsConsts.ActivityItem.rmb]);var c=gd.activityCtrl.getAllChargeCountStatus(gd.activityCtrl.getActivityValue(e,gc.dsConsts.ActivityEntity.id),i.itemIndex);0==c?(i.ico_sel.visible=!1,i.ico_hasGet.visible=!0,i.btn_get.visible=!1,uiHelper.playUIEffect(i.effect_get,!1)):1==c?(i.ico_sel.visible=!0,i.ico_hasGet.visible=!1,i.btn_get.visible=!0,uiHelper.playUIEffect(i.effect_get,!0)):(i.ico_sel.visible=!1,i.ico_hasGet.visible=!1,i.btn_get.visible=!0,uiHelper.playUIEffect(i.effect_get,!1)),i.list_items.dataProvider=new egret.gui.ArrayCollection(utils.itemObj2ObjArr(i.data[gc.dsConsts.ActivityItem.items]));var s=Math.ceil(i.list_items.dataProvider.length/4);i.list_items.height=1==s?95:95*s+5*(s-1),i.ico_bg.height=i.list_items.height+75},a._initItem_list_items=function(t){t.tapShowDetail=!0},a._tap_btn_get=function(){var t=this,i=t.delegate.data.exActivity,e=t.data,a=gd.activityCtrl.getAllChargeCountStatus(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),t.itemIndex);if(0==a);else if(1!=a)return mo.showMsg(gc.id_c_msgCode.totalChargeNotEnough1,e[gc.dsConsts.ActivityItem.rmb]);gd.activityCtrl.receive(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),t.itemIndex,function(){t.delegate.reset()},t)},i}(mo.gui.ItemRenderer);t.ActivityNewRchgItem=i,egret.registerClass(i,"g_activity.ActivityNewRchgItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i._Item_list_items=g_base.BaseItemCell},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.list_items.verticalScrollPolicy=egret.gui.ScrollPolicy.OFF},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data;i.label_desc.text=mo.STR.format("%s",e[gc.c_everydayCharge_id]);var a=this.data.status;1==a?(i.btn_get.visible=!1,i.ico_got.visible=!0,i.ico_unreach.visible=!1):2==a?(i.btn_get.visible=!1,i.ico_got.visible=!1,i.ico_unreach.visible=!0):(i.btn_get.visible=!0,i.ico_got.visible=!1,i.ico_unreach.visible=!1),i.act_items=[];var c=i.data[gc.c_everydayCharge_awardId];for(var s in c){var n={},r=c[s];n.itemId=r[0],n.count=r[1],i.act_items.push(n)}i.refreshList("list_items")},a._initItem_list_items=function(t){t.tapShowDetail=!0},a._data_list_items=function(){var t=this;return t.act_items},a._tap_btn_get=function(){var t=this;gd.activityCtrl.everydayCharge(t.data.activityId,t.data.index,function(t){},t)},i}(mo.gui.ItemRenderer);t.ActivityNewEverydayRchgItem=i,egret.registerClass(i,"g_activity.ActivityNewEverydayRchgItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewRebateItem},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content],t.label_all_charge.text=e[gc.dsConsts.ExActivity.allCost].toString(),t.actItems=e[gc.dsConsts.ExActivity.activityItems],t.refreshList("list_items")}},c._data_list_items=function(){var t=this;return t.actItems},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:203}).show()},e}(mo.gui.Dlg);t.ActivityNewRebate=i,egret.registerClass(i,"g_activity.ActivityNewRebate")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i._Item_list_items=g_base.BaseItemCell},a._childrenCreated=function(){t.prototype._childrenCreated.call(this)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.delegate.data.exActivity,a=i.data;i.label_desc.text=mo.STR.format("%s",a[gc.dsConsts.ActivityItem.diamond]);var c=gd.activityCtrl.getActivityValue(e,gc.dsConsts.ActivityEntity.exValues2)||[];1==c.length?(i.label_title.text=gc.c_prop.diamondCostType[c[0]],i.ico_hint.source="txt_zhongxiaohao"):(i.label_title.text="",i.ico_hint.source="txt_yuanbaozongxiaohao");var s=gd.activityCtrl.getAllRebateStatus(gd.activityCtrl.getActivityValue(e,gc.dsConsts.ActivityEntity.id),i.itemIndex);1==s?(i.ico_sel.visible=!1,i.ico_hasGet.visible=!0,i.btn_get.visible=!1,uiHelper.playUIEffect(i.effect_get,!1)):2==s?(i.ico_sel.visible=!1,i.ico_hasGet.visible=!1,i.btn_get.visible=!0,uiHelper.playUIEffect(i.effect_get,!1)):(i.ico_sel.visible=!0,i.ico_hasGet.visible=!1,i.btn_get.visible=!0,uiHelper.playUIEffect(i.effect_get,!0)),i.list_items.dataProvider=new egret.gui.ArrayCollection(utils.itemObj2ObjArr(i.data[gc.dsConsts.ActivityItem.items]));var n=Math.ceil(i.list_items.dataProvider.length/4);i.list_items.height=1==n?95:95*n+5*(n-1),i.ico_bg.height=i.list_items.height+95},a._initItem_list_items=function(t){t.tapShowDetail=!0},a._tap_btn_get=function(){var t=this,i=t.delegate.data.exActivity,e=(t.data,gd.activityCtrl.getAllRebateStatus(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),t.itemIndex));if(1==e);else{if(2==e)return mo.showMsg("目标尚未达成!");gd.activityCtrl.receive(gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),t.itemIndex,function(){t.delegate.reset()},t)}},i}(mo.gui.ItemRenderer);t.ActivityNewRebateItem=i,egret.registerClass(i,"g_activity.ActivityNewRebateItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments),this.hideLeftMillisecond=-1}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewTotalRchgOneDayItem},c.refresh=function(){var t=this;gd.activityCtrl.getInfo(function(i){gd.activityCtrl.pushNotify(gd.ActivityCtrl.ACTIVITY_OP,{});var e=gd.activityCtrl.getMainList();for(var a in e){var c=e[a],s=c[gc.dsConsts.ExActivity.activity][gc.dsConsts.ActivityEntity.id];if(s==t.data.exActivity[gc.dsConsts.ExActivity.activity][gc.dsConsts.ActivityEntity.id])return t.data.exActivity=c,void t.reset()}})},c.reset=function(){var t=this;
t.setData(t.data),t.refreshList("list_items")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content];var c=e[gc.dsConsts.ExActivity.todayRecharge];t.label_all_charge.text=c?c:"0",t.actItems=e[gc.dsConsts.ExActivity.activityItems],t.refreshList("list_items");var s=e[gc.dsConsts.ExActivity.leftTime];s>0&&t.setCDTime(s)}},c._data_list_items=function(){var t=this;return t.actItems},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:212}).show()},c._timeInterval=function(){var t=this;t.label_left_time.text=mo.getTimeStr(t.hideLeftMillisecond)+" 后刷新"},c._timeFinish=function(){var t=this;t.label_left_time.text="",t.refresh()},c.setCDTime=function(t){var i=this;if(t>0){i.timeTrigger&&(tm.timer.remove(i.timeTrigger),i.timeTrigger=null);var e=Date.newDate(Date.newDate().getTime()+1e3*t),a=i.timeTrigger=new tm.Trigger(e);a.on(tm.Trigger.ON_SECOND,i.timeSec,i),a.on(tm.Trigger.ON_END,i.timeOut,i),tm.timer.add(a)}},c.cleanCDTime=function(){var t=this;t.timeTrigger&&(tm.timer.remove(t.timeTrigger),t.timeTrigger=null)},c.timeSec=function(t,i,e){var a=this,c=Date.newDate().getTime(),s=Date.newDate(e).getTime();a.hideLeftMillisecond=s-c,a.hideLeftMillisecond<0&&(a.hideLeftMillisecond=0),a._timeInterval()},c.timeOut=function(t,i,e){var a=this;a.hideLeftMillisecond=-1,a._timeFinish()},e}(mo.gui.Dlg);t.ActivityNewTotalRchgOneDay=i,egret.registerClass(i,"g_activity.ActivityNewTotalRchgOneDay")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this);var i=this;i._Item_list_items=g_base.BaseItemCell},a._childrenCreated=function(){t.prototype._childrenCreated.call(this)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.delegate.data.exActivity,a=i.data;i.label_desc.text=mo.STR.format("%s",a[gc.dsConsts.ActivityItem.rmb]);var c=gd.activityCtrl.getDayRechargeStatus(gd.activityCtrl.getActivityValue(e,gc.dsConsts.ActivityEntity.id),i.itemIndex);1==c?(i.ico_sel.visible=!1,i.ico_hasGet.visible=!0,i.ico_unfinished.visible=!1,i.ico_finished.visible=!1):2==c?(i.ico_sel.visible=!1,i.ico_hasGet.visible=!1,i.ico_unfinished.visible=!0,i.ico_finished.visible=!1):(i.ico_sel.visible=!0,i.ico_hasGet.visible=!1,i.ico_unfinished.visible=!1,i.ico_finished.visible=!0),i.list_items.dataProvider=new egret.gui.ArrayCollection(utils.itemObj2ObjArr(i.data[gc.dsConsts.ActivityItem.items]));var s=Math.ceil(i.list_items.dataProvider.length/4);i.list_items.height=1==s?95:95*s+5*(s-1),i.ico_bg.height=i.list_items.height+75},a._initItem_list_items=function(t){t.tapShowDetail=!0},i}(mo.gui.ItemRenderer);t.ActivityNewTotalRchgOneDayItem=i,egret.registerClass(i,"g_activity.ActivityNewTotalRchgOneDayItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewCollectCharacterItem,e.registerClassByKey(gd.ActivityCtrl,gd.ActivityCtrl.ACTIVITY_OP,e.checkRedPoint),e.subType=0},c.checkRedPoint=function(){var t=this;t.reset()},c.updateActivity=function(){var t=this,i=t.list_items.scroller,e=i.scrollTop>=0?i.scrollTop:0;t.refreshList("list_items"),process.nextTick(function(){t.list_items&&i.throwVertically(e,0)})},c.reset=function(){var t=this,i=t.data.exActivity,e=i[gc.dsConsts.ExActivity.activity];t.setData({exActivity:gd.activityCtrl.getActivity(e[gc.dsConsts.ActivityEntity.id])});var a=t.list_items.scroller,c=a.scrollTop>=0?a.scrollTop:0;t.refreshList("list_items"),process.nextTick(function(){t.list_items&&a.throwVertically(c,0)})},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=a[gc.dsConsts.ActivityEntity.content];var c=a[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.subType]||0;t.subType=parseInt(c),t.actItems=[];var s=0,n=a[gc.dsConsts.ActivityEntity.exValues],r=a[gc.dsConsts.ActivityEntity.items];for(var o in n){var l=n[o]||{},_={};_.i=l,_.c=gd.activityCtrl.getSetTheWordCount(a[gc.dsConsts.ActivityEntity.id],s);var v=r[s]||{};_.r=v,_.activityId=a[gc.dsConsts.ActivityEntity.id],_.p=t,_.index=s,t.actItems.push(_),s++}t.refreshList("list_items")}},c._data_list_items=function(){var t=this;return t.actItems},c._tap_btn_help=function(){var t=this,i=214;i=t.subType<=1?1==t.subType?214:216:t.subType,g_base.BaseShowTip.create().setData({id:i}).show()},c._tap_btn_source=function(){var t=this,i=215;i=t.subType<=1?1==t.subType?215:217:t.subType+1,g_base.BaseShowTip.create().setData({id:i}).show()},e}(mo.gui.Dlg);t.ActivityNewCollectCharacter=i,egret.registerClass(i,"g_activity.ActivityNewCollectCharacter")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._Item_list_items=t.ActivityNewCollectCharacterBaseItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.list_items.verticalScrollPolicy=egret.gui.ScrollPolicy.OFF,t.ico_item.onClick(function(){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(this.get("itemId"),null)}).show()},t.ico_item)},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.i,a=0;t.btn_get.visible=!0,t.act_items=[],t.hasCount=0;var c=1;for(var s in e){var n={},r=gd.userCtrl.getItemNum(s);e[s];n.itemId=parseInt(s),n.count=r,c>0?(t.hasCount=r,c-=1):t.hasCount>r&&(t.hasCount=r),t.act_items.push(n)}var o=t.data.r;for(var l in o)t.ico_item.setData({itemId:l,count:o[l]});a=t.act_items.length,t.label_desc.text=mo.STR.format("%s",a),t.label_count.text=mo.STR.format("已领取次数:%s",t.data.c),t.label_collected.text=mo.STR.format("已集齐:%s组",t.hasCount),t.refreshList("list_items");var _=Math.ceil(t.list_items.dataProvider.length/4);t.list_items.height=1==_?95:95*_+5*(_-1),t.ico_bg.height=t.list_items.height+105;t.group_reward.height;t.group_reward.y=t.group_list.y+.5*t.list_items.height-47.5},c._initItem_list_items=function(t){t.tapShowDetail=!0},c._data_list_items=function(){var t=this;return t.act_items},c._tap_btn_get=function(){var t=this;return t.hasCount<1?mo.showMsg("集齐对应的字才能兑换"):void gd.activityCtrl.setTheWord(t.data.activityId,t.data.index,function(i){var e=t.data.p;e.updateActivity()},t)},e}(mo.gui.ItemRenderer);t.ActivityNewCollectCharacterItem=i,egret.registerClass(i,"g_activity.ActivityNewCollectCharacterItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments),this.tapShowDetail=!1}__extends(i,t);var e=(__define,i),a=e.prototype;return a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.setLineWidth(80)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this,e=i.data;"object"==typeof e?i.ico_item.setData({itemId:e.itemId,count:e.count}):i.ico_item.setData({itemId:e}),process.nextTick(function(){i.ico_item.label_count.visible=!0,i.ico_item.label_count.text=""+e.count})},a._tap_rect_touch=function(t){var i=this;i.tapShowDetail&&g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.ico_item.get("itemId"),null)}).show()},a.setLineWidth=function(t){var i=this;i.ico_item.label_text.width=t},a.getTextHeight=function(){var t=this;return t.ico_item.label_text.height},i}(mo.gui.ItemRenderer);t.ActivityNewCollectCharacterBaseItem=i,egret.registerClass(i,"g_activity.ActivityNewCollectCharacterBaseItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewVplanItem,e.registerClassByKey(gd.ActivityCtrl,gd.ActivityCtrl.ACTIVITY_OP,e.checkRedPoint)},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.medalType=0},c.checkRedPoint=function(){var t=this;t.reset()},c.updateActivity=function(){var t=this;gd.activityCtrl.getInfo(function(){t.reset()})},c.reset=function(){var t=this,i=t.data.exActivity,e=i[gc.dsConsts.ExActivity.activity];t.setData({exActivity:gd.activityCtrl.getActivity(e[gc.dsConsts.ActivityEntity.id])});var a=t.list_items.scroller,c=a.scrollTop>=0?a.scrollTop:0;t.refreshList("list_items"),process.nextTick(function(){t.list_items&&a.throwVertically(c,0)})},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime])),t.actItems=[];var c=0,s=a[gc.dsConsts.ActivityEntity.exValues],n=a[gc.dsConsts.ActivityEntity.items];for(var r in s){var o=s[r]||{},l={};l.i=o;var _=n[c]||{};l.r=_,l.activityId=a[gc.dsConsts.ActivityEntity.id],l.p=t,l.itemIndex=c,t.actItems.push(l),c++}t.refreshList("list_items");var v=t.actItems[0];if(v){var g=v.i;t.medalType=t.getMedalValue(g[0])}}},c._data_list_items=function(){var t=this;return t.actItems},c._tap_btn_help=function(){var t=this;1==t.medalType?227:228;g_base.BaseShowTip.create().setData({id:214}).show()},c._tap_btn_source=function(){var t=this,i=1==t.medalType?225:226;g_base.BaseShowTip.create().setData({id:i}).show()},c.getMedalValue=function(t){for(var i=[10500,10490],e=0;e<i.length;e++)if(t==i[e])return e+1;return 0},e}(mo.gui.Dlg);t.ActivityNewVplan=i,egret.registerClass(i,"g_activity.ActivityNewVplan")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._Item_list_items=t.ActivityNewCollectCharacterBaseItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this)},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this;if(t.data){var e=t.data.i;t.label_desc.text=t.getDescTxt(e);var a=t.data.activityId,c=t.data.itemIndex,s=gd.activityCtrl.getVPlanStatus(a,c);0==s?(t.ico_hasGet.visible=!1,t.btn_get.visible=!0):(t.ico_hasGet.visible=!0,t.btn_get.visible=!1),t.act_items=[];var n=t.data.r,r=0,o=!1;for(var l in n){var _={};_.itemId=parseInt(l),_.count=parseInt(n[l]),t.act_items.push(_),r+=1,0==o&&t.getMedalValue(_.itemId)>0&&(o=!0)}var v=1==r?74:74*r+6*(r-1),g=154;t.list_items.width=v>g?g:v;var d=o?0:t.getMedalValue(e[0]),y="bg_panel_"+(d+1).toString()+".png",u="resource/ui2/ui_activity/"+y;RES.getResByUrl(u,function(i){t.ico_bg.source=i},t,RES.ResourceItem.TYPE_IMAGE),t.refreshList("list_items")}},c.getMedalValue=function(t){for(var i=[10500,10490],e=0;e<i.length;e++)if(t==i[e])return e+1;return 0},c.getDescTxt=function(t){var i=this,e="成为V会员%s,",a="单笔充值达到%s可领取",c=t[0],s=t[1],n=i.getMedalValue(c),r=1==n?"守护者":"长老";return e=e.replace("%s",r),a=a.replace("%s",s.toString()),e+=a},c._initItem_list_items=function(t){t.tapShowDetail=!0},c._data_list_items=function(){var t=this;return t.act_items},c._tap_btn_get=function(){var t=this;gd.activityCtrl.vPlan(t.data.activityId,t.data.itemIndex,function(i){var e=t.data.p;e.updateActivity()},t)},e}(mo.gui.ItemRenderer);t.ActivityNewVplanItem=i,egret.registerClass(i,"g_activity.ActivityNewVplanItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_rewards=t.ActivityNewCollectCharacterBaseItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.dataArr=null},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this;if(t.data){t.actItems=t.data.actItems||[];var e=t.data.textData||"";e.length>0&&(t.label_red.text=e),t.refreshList("list_rewards")}},c._data_list_rewards=function(){var t=this;return t.actItems},e}(mo.gui.Dlg);t.ActivityNewDetail=i,egret.registerClass(i,"g_activity.ActivityNewDetail")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewCollectCharacterBaseItem,e._Item_list_itemsOther=g_base.BaseItemCell,e._selectedIndex=-1,e.haveClick=!1,e.maxCardNum=6,e.maxLuckValue=0,e.helpId=0},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.maxLuckValue=a[gc.dsConsts.ActivityEntity.exValues3][1];var c=gd.activityCtrl.getActivityValue(e,gc.dsConsts.ActivityEntity.id),s=gd.activityCtrl.getLuckValue(c);t.setLuck(s),t.detailExtrItems=null,t.detailActItems=null}},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items"),t.refreshList("list_itemsOther")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),t._updateGoldInfo();var c=mo.getJSONWithFileName(gc.cfg_c_luckyMajong),s=a[gc.dsConsts.ActivityEntity.exValues2][0],n=a[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.spItemId],r=a[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.subType]||0,o=a[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.bgIcon]||"";t.helpId=""==o?0:parseInt(o);var l=gd.userCtrl.getLvl();t.actItems=[],t.extrItems=[],t.detailExtrItems=[],t.detailActItems=[];for(var _ in c){var v=c[_],g=v[gc.c_luckyMajong_subTypeDivide][0],d=v[gc.c_luckyMajong_subTypeDivide][1],y=l>=g&&d>=l;v[gc.c_luckyMajong_spItemId]==n&&r==v[gc.c_luckyMajong_subType]&&v[gc.c_luckyMajong_color]>=s&&y&&(1==v[gc.c_luckyMajong_ifRare]?t.extrItems.push({itemId:v[gc.c_luckyMajong_itemID],count:v[gc.c_luckyMajong_amount],color:v[gc.c_luckyMajong_color]}):t.actItems.push({itemId:v[gc.c_luckyMajong_itemID],count:v[gc.c_luckyMajong_amount]})),v[gc.c_luckyMajong_spItemId]==n&&r==v[gc.c_luckyMajong_subType]&&y&&t.detailActItems.push({itemId:v[gc.c_luckyMajong_itemID],count:v[gc.c_luckyMajong_amount]})}t.extrItems.sort(function(t,i){return i.color-t.color}),t.refreshList("list_items");for(var u=a[gc.dsConsts.ActivityEntity.exValues][0],h=0;h<t.maxCardNum;++h){var p=t["label_cost_have"+h];p.text=""+utils.formatByWan(u,0);var m=t["ico_cost_icon"+h];n==gc.c_prop.spItemIdKey.gold?t.setItemIcon(m,n):n==gc.c_prop.spItemIdKey.diamond?m.source="ico_yuanbao":(m.source=resHelper.getItemIconPath(n),m.scaleX=.5,m.scaleY=.5,m.anchorOffsetY=.5*m.height)}}},c.setItemIcon=function(t,i){var e=resHelper.getSmallItemPath(i);RES.getResByUrl(e,function(i){t.source=i},self,RES.ResourceItem.TYPE_IMAGE)},c._updateGoldInfo=function(){var t=this;t.label_jinbi.text=gd.userCtrl.getGold(),t.label_yuanbao.text=gd.userCtrl.getDiamond()},c._data_list_items=function(){var t=this,i=t.actItems.slice(0,4);return i},c._data_list_itemsOther=function(){var t=this,i=null,e=t.helpId;if(t.extrItems.length>2&&e>0){i=[];var a={itemId:e,count:1};i.push(a)}else i=t.extrItems.slice(0,2);return i},c._click_list_items=function(t){var i=t.item;g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.itemId,null)}).show()},c._click_list_itemsOther=function(t){var i=t.item;g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.itemId,null)}).show()},c.clickCard=function(t){var i=this;if(!i.haveClick){if(i.haveClick=!0,i.clickTime=egret.setTimeout(function(){i.dealClickTime()},i,500),i._selectedIndex>=0)return void(1==i._aniStep&&(i._aniStep=2,i._runAnimation()));var e=i["grp_item"+t];if(!e.visible){var a=i.data.exActivity,c=gd.activityCtrl.getActivityValue(a,gc.dsConsts.ActivityEntity.id);gd.activityCtrl.luckyMajong(c,t,function(e){i._selectedIndex=t,i.initCardsWithIds(e,t),i._updateGoldInfo(),i.haveClick=!1;var a=gd.activityCtrl.getLuckValue(c);i.setLuck(a)})}}},c.dealClickTime=function(){var t=this;t.haveClick=!1,egret.clearTimeout(t.clickTime)},c.clickFlip=function(t){var i=this;1==i._aniStep&&(i._aniStep=2,i._goNext())},c.initCardsWithIds=function(t,i){var e=this;e._gotCards=t,e._aniIdx=[];for(var a=0;a<e.maxCardNum;++a){var c=e["ico_item"+a];c.onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.data.itemId,null)}).show()}),a==i?e._aniIdx.unshift(a):e._aniIdx.push(a)}e._gotCards=t,e._aniStep=0,e._runAnimation(),e.idTime1=egret.setTimeout(function(){0==e._aniStep&&(e._aniStep=1,e._runAnimation())},e,500)},c._runAnimation=function(){var t=this;if(t._aniStep>=2)return egret.clearTimeout(t.idTime2),void t._goNext();var i=t._gotCards;if(0==t._aniStep){var e=t._aniIdx[0];t._showItemAtIndex(mo.getJSONWithFileNameAndID(gc.cfg_c_luckyMajong,i[e]),e)}else if(1==t._aniStep){for(var a=1;a<t.maxCardNum;a++){var c=t._aniIdx[a];t._showItemAtIndex(mo.getJSONWithFileNameAndID(gc.cfg_c_luckyMajong,i[c]),c)}t.idTime2=egret.setTimeout(function(){1==t._aniStep&&(t._aniStep=2,t._runAnimation())},t,3e3)}},c._goNext=function(){var t=this;egret.clearTimeout(t.idTime2),egret.clearTimeout(t.idTime1);for(var i=0;i<t.maxCardNum;i++)t._hideItemAtIndex(i);t._selectedIndex=-1,t.haveClick=!1},c._showItemAtIndex=function(t,i,e){var a=this,c=a["ico_item"+i];if(c){var s=a["label_item"+i];if(s){var n=a["card_effect"+i];n.visible=!0;var r=uiHelper.EfxPlayer.create(n);r.setEndCallback(function(){n.visible=!1,e&&e.call()}),r.play();var o=t[gc.c_luckyMajong_itemID];c.setData({itemId:o,count:t[gc.c_luckyMajong_amount]});var l=mo.getJSONWithFileNameAndID(gc.cfg_t_item,o);s.text=l[gc.t_item_name];var _=a["btn_card"+i];_.visible=!1;var v=a["grp_item"+i];v.visible=!0}}},c._hideItemAtIndex=function(t){var i=this,e=i["ico_item"+t];if(e){var a=i["label_item"+t];if(a){var c=i["card_effect"+t];c.visible=!0;var s=uiHelper.EfxPlayer.create(c);s.setEndCallback(function(){c.visible=!1}),s.play(),a.text="";var n=i["btn_card"+t];n.visible=!0;var r=i["grp_item"+t];r.visible=!1}}},c._tap_btn_card0=function(){var t=this;t.clickCard(0)},c._tap_btn_card1=function(){var t=this;t.clickCard(1)},c._tap_btn_card2=function(){var t=this;t.clickCard(2)},c._tap_btn_card3=function(){var t=this;t.clickCard(3)},c._tap_btn_card4=function(){var t=this;t.clickCard(4)},c._tap_btn_card5=function(){var t=this;t.clickCard(5)},c._tap_btn_flipped0=function(){var t=this;t.clickFlip(0)},c._tap_btn_flipped1=function(){var t=this;t.clickFlip(1)},c._tap_btn_flipped2=function(){var t=this;t.clickFlip(2)},c._tap_btn_flipped3=function(){var t=this;t.clickFlip(3)},c._tap_btn_flipped4=function(){var t=this;t.clickFlip(4)},c._tap_btn_flipped5=function(){var t=this;t.clickFlip(5)},c._tap_btn_container=function(){},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:229}).show()},c._tap_btn_detail=function(){var i=this;t.ActivityNewDetail.create().setData({actItems:i.detailActItems,extrItems:null}).show()},c.setLuck=function(t){var i=this,e="幸运值:"+t+"/"+i.maxLuckValue;i.label_activity_desc2.text=e;var a=Math.floor(t/i.maxLuckValue*100);i.progress_luck.setValue(a)},e}(mo.gui.Dlg);t.ActivityNewMaJiangTalos=i,egret.registerClass(i,"g_activity.ActivityNewMaJiangTalos")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.survey_type=0},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this;if(i.data){var e=i.data;i.label_count.text=e.option,i.survey_type=e.survey_type,i.ckb_choice.selected=e.select}},a._chg_ckb_choice=function(){var t=this,i=t.ckb_choice.selected,e=t.data;if(e){var a=e.p;if(a){var c=e.index;a.changOption(c,i)}}},a.changeSelect=function(t){var i=this;i.ckb_choice.selected=t},i}(mo.gui.ItemRenderer);t.ActivityNewAskChoiceItem=i,egret.registerClass(i,"g_activity.ActivityNewAskChoiceItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this);var e=this;e._Item_list_items=t.ActivityNewAskChoiceItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.survey_type=0,t.optionArr=null,t.dataArr=null},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this;if(t.data){t.id=t.data.id;var e=t.data.p,a=mo.getJSONWithFileNameAndID(gc.cfg_c_userSurvey,t.id);t.label_title.text=a[gc.c_userSurvey_question];var c=a[gc.c_userSurvey_optionContent];t.survey_type=a[gc.c_userSurvey_type],t.dataArr=[],t.optionArr=[];for(var s=0;s<c.length;s++){var n={};n.p=t,n.option=c[s],n.survey_type=t.survey_type,n.select=e.getQuestSelect(t.id,s),n.select&&t.dataArr.push(s),n.index=s,t.optionArr.push(n)}t.refreshList("list_items"),t.list_items.width=t.group_content.width}},c._data_list_items=function(){var t=this;return t.optionArr},c.changOption=function(t,i){var e=this;if(1==e.survey_type)i?(e.dataArr[0]=t,e.changeOtherSelect(t)):e.dataArr.splice(0,1);else if(2==e.survey_type)if(i)e.dataArr.push(t);else{var a=e.getIndexInArr(t);a>-1&&e.dataArr.splice(a,1)}else{var c=e.optionArr.length;if(t==c-1)if(i){var s=e.dataArr.length;s>0&&(e.changeOtherSelect(c-1),e.dataArr.splice(0,s)),e.dataArr.push(t)}else e.dataArr.splice(0,1);else if(i){var n=e.getIndexInArr(c-1);if(n>-1){var r=e.list_items.dataGroup.getElementAt(c-1);r&&r.changeSelect(!1),e.dataArr.splice(n,1)}e.dataArr.push(t)}else{var a=e.getIndexInArr(t);a>-1&&e.dataArr.splice(a,1)}}var o=e.data.p;o&&o.changOption(e.id,e.dataArr)},c.getIndexInArr=function(t){for(var i=this,e=0;e<i.dataArr.length;e++){var a=i.dataArr[e];if(a==t)return e}return-1},c.changeOtherSelect=function(t){for(var i=this,e=0;e<i.optionArr.length;e++)if(e!=t){var a=i.list_items.dataGroup.getElementAt(e);a&&a.changeSelect(!1)}},e}(mo.gui.ItemRenderer);t.ActivityNewAskItem=i,egret.registerClass(i,"g_activity.ActivityNewAskItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewCollectCharacterBaseItem,e._Item_list_questItems=t.ActivityNewAskItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.medalType=0,t.questMap={}},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.head.setActivity(a),uiHelper.setEventTime(t.label_activity_time,Date.newDate(a[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(a[gc.dsConsts.ActivityEntity.endTime]));var c=a[gc.dsConsts.ActivityEntity.id],s=gd.activityCtrl.getUserSurveyStatus(c);t.setAskState(1==s),t.actItems=[],t.questionArr=[];for(var n=a[gc.dsConsts.ActivityEntity.exValues],r=0,o=0;o<n.length;o++){var l={};l.id=n[o],l.p=t,l.itemIndex=r,t.questionArr.push(l),r+=1}for(var _=e[gc.dsConsts.ExActivity.activityItems],o=0;o<_.length;o++){var v=_[o],g=gc.dsConsts.ActivityItem.items,d=v[g];for(var y in d)t.actItems.push({itemId:y,count:d[y]})}t.refreshList("list_items"),t.refreshList("list_questItems")}},c._data_list_items=function(){var t=this,i=t.actItems.slice(0,4);return i},c._data_list_questItems=function(){var t=this;return t.questionArr},c._tap_btn_detail=function(){var i=this,e="完成调查后,将获得如下奖励";t.ActivityNewDetail.create().setData({actItems:i.actItems,extrItems:null,textData:e}).show()},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:232}).show()},c._tap_btn_sure=function(){var t=this,i=t.data.exActivity,e=i[gc.dsConsts.ExActivity.activity],a=e[gc.dsConsts.ActivityEntity.id],c=e[gc.dsConsts.ActivityEntity.exValues];if(t.testData(),1==gd.activityCtrl.getUserSurveyStatus(a))return void mo.showMsg("你已经测试");if(0==t.checkAskAllQuest(c))return void mo.showMsg("请完成所有题目！");var s=0;gd.activityCtrl.userSurvey(a,s,t.questMap,function(i){mo.showMsg("奖励已经发至邮箱！"),t.setAskState(!0)},t)},c._click_list_items=function(t){var i=t.item;g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.itemId,null)}).show()},c.changOption=function(t,i){var e=this,a=null;for(var c in e.questMap)if(t==parseInt(c)){a=e.questMap[c];break}null==a&&(a=[],e.questMap[t]=a),a.splice(0,a.length);for(var s=0;s<i.length;s++)a[s]=i[s]},c.checkAskAllQuest=function(t){var i=this;if(!t)return!1;for(var e=0;e<t.length;e++){var a=t[e],c=i.questMap[a];if(!c||0==c.length)return!1}return!0},c.testData=function(){var t=this;for(var i in t.questMap){for(var e=t.questMap[i],a="",c=0;c<e.length;c++)a+=e[c]+",";console.log("key= %s,data = %s",i,a)}},c.getQuestSelect=function(t,i){var e=this,a=e.questMap[t];if(a)for(var c=0;c<a.length;c++){var s=a[c];if(s==i)return!0}return!1},c.setAskState=function(t){var i=this;i.img_achive.visible=t,i.list_questItems.visible=!t,i.btn_sure.visible=!t},e}(mo.gui.Dlg);t.ActivityNewAsk=i,egret.registerClass(i,"g_activity.ActivityNewAsk")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this)},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.subType=0},c.dataChanged=function(){i.prototype.dataChanged.call(this);var e=this,a=e.data.exActivity;if(a){var c=a[gc.dsConsts.ExActivity.activity];e.head.setActivity(c);var s=c[gc.dsConsts.ActivityEntity.exData],n=s[gc.c_prop.activityExDataTypeKey.subType];e.subType=n;var r=null;r=1==n?t.ActivityNewNoticeSimple.create().setData({activity:c}):t.ActivityNewNoticeReward.create().setData({activity:c}),e.group_content.addElement(r)}},c._tap_btn_help=function(){var t=this,i=1==t.subType?230:231;g_base.BaseShowTip.create().setData({id:i}).show()},e}(mo.gui.Dlg);t.ActivityNewNotice=i,egret.registerClass(i,"g_activity.ActivityNewNotice")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this;if(i.data){var e=i.data.activity;if(e){var a=e[gc.dsConsts.ActivityEntity.content];i.label_text.text=a;var c=e[gc.dsConsts.ActivityEntity.exData],s=c[gc.c_prop.activityExDataTypeKey.bgIcon]||"";if(s.length>0){var n="resource/ui2/ui_activity/"+s+".png";RES.getResByUrl(n,function(t){i.ico_head.source=t},i,RES.ResourceItem.TYPE_IMAGE)}}}},i}(mo.gui.Layer);t.ActivityNewNoticeSimple=i,egret.registerClass(i,"g_activity.ActivityNewNoticeSimple")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_rewards=t.ActivityNewCollectCharacterBaseItem},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.actItems=null},c.dataChanged=function(){i.prototype.dataChanged.call(this);var t=this;if(t.data){var e=t.data.activity;if(e){uiHelper.setEventTime(t.label_activity_time,Date.newDate(e[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(e[gc.dsConsts.ActivityEntity.endTime]));var a=e[gc.dsConsts.ActivityEntity.content];t.label_text.text=a;var c=e[gc.dsConsts.ActivityEntity.exData],s=c[gc.c_prop.activityExDataTypeKey.bgIcon]||"";if(s.length>0){var n="resource/ui2/ui_activity/"+s+".png";RES.getResByUrl(n,function(i){t.ico_head.source=i},t,RES.ResourceItem.TYPE_IMAGE)}t.actItems=[];for(var r=e[gc.dsConsts.ActivityEntity.items],o=0;o<r.length;o++){var l=r[o];for(var _ in l)t.actItems.push({itemId:_,count:l[_]})}t.refreshList("list_rewards")}}},c._data_list_rewards=function(){var t=this;return t.actItems},c._click_list_rewards=function(t){var i=t.item;g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.itemId,null)}).show()},e}(mo.gui.Layer);t.ActivityNewNoticeReward=i,egret.registerClass(i,"g_activity.ActivityNewNoticeReward")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){var e=this;i.prototype._initProp.call(this),e._Item_list_items=t.ActivityNewCollectCharacterBaseItem,e._Item_list_itemsOther=g_base.BaseItemCell,e.maxLuckValue=0,e.helpId=0},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this,e=t.data.exActivity;if(e){var a=e[gc.dsConsts.ExActivity.activity];t.maxLuckValue=a[gc.dsConsts.ActivityEntity.exValues3][1];var c=gd.activityCtrl.getActivityValue(e,gc.dsConsts.ActivityEntity.id),s=gd.activityCtrl.getNewLuckValue(c);t.setLuck(s),t.detailExtrItems=null,t.detailActItems=null}},c.reset=function(){var t=this;t.setData(t.data),t.refreshList("list_items"),t.refreshList("list_itemsOther")},c.dataChanged=function(){i.prototype.dataChanged.call(this);var e=this,a=e.data.exActivity;if(a){var c=a[gc.dsConsts.ExActivity.activity];e.head.setActivity(c),e._updateGoldInfo();var s=mo.getJSONWithFileName(gc.cfg_c_luckyMajong),n=c[gc.dsConsts.ActivityEntity.exValues2][0],r=c[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.spItemId],o=c[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.subType]||0,l=c[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.bgIcon]||"";e.helpId=""==l?0:parseInt(l);var _=gd.userCtrl.getLvl();e.actItems=[],e.extrItems=[],e.detailExtrItems=[],e.detailActItems=[];for(var v in s){var g=s[v],d=g[gc.c_luckyMajong_subTypeDivide][0],y=g[gc.c_luckyMajong_subTypeDivide][1],u=_>=d&&y>=_;g[gc.c_luckyMajong_spItemId]==r&&o==g[gc.c_luckyMajong_subType]&&g[gc.c_luckyMajong_color]>=n&&u&&(1==g[gc.c_luckyMajong_ifRare]?e.extrItems.push({itemId:g[gc.c_luckyMajong_itemID],count:g[gc.c_luckyMajong_amount],color:g[gc.c_luckyMajong_color]}):e.actItems.push({itemId:g[gc.c_luckyMajong_itemID],count:g[gc.c_luckyMajong_amount]})),g[gc.c_luckyMajong_spItemId]==r&&o==g[gc.c_luckyMajong_subType]&&u&&e.detailActItems.push({itemId:g[gc.c_luckyMajong_itemID],count:g[gc.c_luckyMajong_amount]})}e.extrItems.sort(function(t,i){return i.color-t.color}),e.refreshList("list_items");var h=gd.activityCtrl.getActivityValue(a,gc.dsConsts.ActivityEntity.id),p=t.ActivityNewCardGroup.create().setData({activityId:h,activity:c,root:e});e.btn_container.addElement(p)}},c.updateInfo=function(){var t=this;t._updateGoldInfo();var i=t.data.exActivity,e=gd.activityCtrl.getActivityValue(i,gc.dsConsts.ActivityEntity.id),a=gd.activityCtrl.getNewLuckValue(e);t.setLuck(a)},c._updateGoldInfo=function(){var t=this;t.label_jinbi.text=gd.userCtrl.getGold(),t.label_yuanbao.text=gd.userCtrl.getDiamond()},c._data_list_items=function(){var t=this,i=t.actItems.slice(0,4);return i},c._data_list_itemsOther=function(){var t=this,i=null,e=t.helpId;if(t.extrItems.length>2&&e>0){i=[];var a={itemId:e,count:1};i.push(a)}else i=t.extrItems.slice(0,2);
return i},c._click_list_items=function(t){var i=t.item;g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.itemId,null)}).show()},c._click_list_itemsOther=function(t){var i=t.item;g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(i.itemId,null)}).show()},c._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:233}).show()},c._tap_btn_detail=function(){var i=this;t.ActivityNewDetail.create().setData({actItems:i.detailActItems,extrItems:null}).show()},c.setLuck=function(t){var i=this,e="幸运值:"+t+"/"+i.maxLuckValue;i.label_activity_desc2.text=e;var a=Math.floor(t/i.maxLuckValue*100);i.progress_luck.setValue(a)},e}(mo.gui.Dlg);t.ActivityNewCardTalos=i,egret.registerClass(i,"g_activity.ActivityNewCardTalos")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(i){function e(){i.apply(this,arguments)}__extends(e,i);var a=(__define,e),c=a.prototype;return c._initProp=function(){i.prototype._initProp.call(this)},c._childrenCreated=function(){i.prototype._childrenCreated.call(this);var t=this;t.cardItemArr=[],t.activityId=0,t._selectedIndex=-1,t.haveClick=!1,t.root=null,t.cost=0},c.dataChanged=function(){i.prototype.dataChanged.call(this);var e=this;if(e.data){var a=e.data.activity;if(a){e.maxCardNum=3;for(var c=0;c<e.maxCardNum;c++){var s=e.group_cardList.getChildAt(c),n=t.ActivityNewCardItem.create().setData({index:c,activity:a,root:e});s.addElement(n),e.cardItemArr.push(n)}var r=a[gc.dsConsts.ActivityEntity.exValues][0],o=a[gc.dsConsts.ActivityEntity.exData][gc.c_prop.activityExDataTypeKey.spItemId];e.activityId=e.data.activityId,e.root=e.data.root,e.cost=r,e.costItemId=o,e.updateItemInfo()}}},c.updateItemInfo=function(){var t=this,i=t.activityId,e=gd.activityCtrl.getTodayActivityCount(i),a=gd.activityCtrl.getFreeDay(i),c=gd.activityCtrl.getTotalDay(i),s=a>e?a-e:0,n=s>0?0:t.cost,r={};r.freeNum=s,r.totalFreeCount=a,r.neeMoney=n,r.costItemId=t.costItemId;for(var o=0;o<t.maxCardNum;o++){var l=t.cardItemArr[o];l.setMoneyInfo(r)}t.label_count.text=e.toString()+"/"+c.toString()},c.clickCard=function(t){var i=this;if(!i.haveClick){if(i.haveClick=!0,i.clickTime=egret.setTimeout(function(){i.dealClickTime()},i,500),i._selectedIndex>=0)return void(1==i._aniStep&&(i._aniStep=2,i._runAnimation()));var e=i.activityId;gd.activityCtrl.newLuckyMajong(e,t,function(e){i._selectedIndex=t,i.initCardsWithIds(e,t),i.haveClick=!1,i.root.updateInfo(),i.updateItemInfo()})}},c.dealClickTime=function(){var t=this;t.haveClick=!1,egret.clearTimeout(t.clickTime)},c.clickFlip=function(t){var i=this;1==i._aniStep&&(i._aniStep=2,i._goNext())},c.initCardsWithIds=function(t,i){var e=this;e._gotCards=t,e._aniIdx=[];for(var a=0;a<e.maxCardNum;++a)a==i?e._aniIdx.unshift(a):e._aniIdx.push(a);e._gotCards=t,e._aniStep=0,e._runAnimation(),e.idTime1=egret.setTimeout(function(){0==e._aniStep&&(e._aniStep=1,e._runAnimation())},e,500)},c._runAnimation=function(){var t=this;if(t._aniStep>=2)return egret.clearTimeout(t.idTime2),void t._goNext();var i=t._gotCards;if(0==t._aniStep){var e=t._aniIdx[0];t._showItemAtIndex(mo.getJSONWithFileNameAndID(gc.cfg_c_luckyMajong,i[e]),e)}else if(1==t._aniStep){for(var a=1;a<t.maxCardNum;a++){var c=t._aniIdx[a];t._showItemAtIndex(mo.getJSONWithFileNameAndID(gc.cfg_c_luckyMajong,i[c]),c)}t.idTime2=egret.setTimeout(function(){1==t._aniStep&&(t._aniStep=2,t._runAnimation())},t,3e3)}},c._goNext=function(){var t=this;egret.clearTimeout(t.idTime2),egret.clearTimeout(t.idTime1);for(var i=0;i<t.maxCardNum;i++)t._hideItemAtIndex(i);t._selectedIndex=-1,t.haveClick=!1},c._showItemAtIndex=function(t,i){var e=this,a=e.getAskItemByIndex(i);a&&a.showItem(t)},c._hideItemAtIndex=function(t){var i=this,e=i.getAskItemByIndex(t);e&&e.hideItem()},c.getAskItemByIndex=function(t){var i=this,e=null;return t>=0&&t<i.maxCardNum&&(e=i.cardItemArr[t]),e},e}(mo.gui.Layer);t.ActivityNewCardGroup=i,egret.registerClass(i,"g_activity.ActivityNewCardGroup")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var i=this;i.index=-1,i.root=null},a.dataChanged=function(){t.prototype.dataChanged.call(this);var i=this;i.data&&(i.index=i.data.index,i.root=i.data.root,i.btn_flipped.visible=!0,i.group_card.visible=!0,i.ico_item.setLineWidth(80),i.ico_item.onClick(function(t){g_base.BaseItemDetail.create().setData({bdc:gd.BagDataCtrl.create(t.data.itemId,null)}).show()}))},a.setIndex=function(t){var i=this;i.index=t},a._tap_group_card=function(){var t=this;t.root.clickCard(t.index)},a._tap_btn_flipped=function(){var t=this;t.root.clickFlip(t.index)},a.setMoneyInfo=function(t){var i=this,e=t.freeNum,a=t.neeMoney,c=t.costItemId,s=t.totalFreeCount;if(i.group_free.visible=e>0,i.group_money.visible=0==e,e>0)i.label_freenum.text=e.toString()+"/"+s.toString();else{var n=i.label_cost_have;n.text=""+utils.formatByWan(a,0);var r=i.ico_cost_icon;c==gc.c_prop.spItemIdKey.gold?i.setItemIcon(r,c):c==gc.c_prop.spItemIdKey.diamond?r.source="ico_yuanbao":(r.source=resHelper.getItemIconPath(c),r.scaleX=.5,r.scaleY=.5,r.anchorOffsetY=.5*r.height)}},a.setItemIcon=function(t,i){var e=this,a=resHelper.getSmallItemPath(i);RES.getResByUrl(a,function(i){t.source=i},e,RES.ResourceItem.TYPE_IMAGE)},a.showItem=function(t){var i=this;if(i.ico_item){var e=i.card_effect;e.visible=!0;var a=uiHelper.EfxPlayer.create(e);a.setEndCallback(function(){e.visible=!1}),a.play();var c=t[gc.c_luckyMajong_itemID];i.ico_item.setData({itemId:c,count:t[gc.c_luckyMajong_amount]});var s=i.ico_item.getTextHeight();i.rect_textBg.height=s+7,i.group_card.visible=!1;var n=i.grp_item;n.visible=!0}},a.hideItem=function(){var t=this,i=t.card_effect;i.visible=!0;var e=uiHelper.EfxPlayer.create(i);e.setEndCallback(function(){i.visible=!1}),e.play(),t.group_card.visible=!0;var a=t.grp_item;a.visible=!1},i}(mo.gui.Layer);t.ActivityNewCardItem=i,egret.registerClass(i,"g_activity.ActivityNewCardItem")}(g_activity||(g_activity={}));var g_activity;!function(t){var i=function(t){function i(){t.apply(this,arguments)}__extends(i,t);var e=(__define,i),a=e.prototype;return a._initProp=function(){t.prototype._initProp.call(this)},a.dataChanged=function(){var t=this,i=t.data.exActivity;if(i){var e=i[gc.dsConsts.ExActivity.activity];t.head.setActivity(e),uiHelper.setEventTime(t.label_activity_time,Date.newDate(e[gc.dsConsts.ActivityEntity.startTime]),Date.newDate(e[gc.dsConsts.ActivityEntity.endTime])),t.label_activity_desc.text=e[gc.dsConsts.ActivityEntity.content],t.actItems=i[gc.dsConsts.ExActivity.activityItems],t.refreshList("list_items");var a=e[gc.dsConsts.ActivityEntity.exData],c="";if(a){var s=a[gc.c_prop.activityExDataTypeKey.spItemId];t.ico_have_icon.source=resHelper.getItemIconPath(s),t.ico_cost_icon.source=resHelper.getItemIconPath(s),t.label_yuanbao_cost.text=e[gc.dsConsts.ActivityEntity.exValues][0]+"",t.label_yuanbao_left.text=gd.userCtrl.getItemNum(s)+"",c=a[gc.c_prop.activityExDataTypeKey.funcName]||""}var n=e[gc.dsConsts.ActivityEntity.id],r=gd.activityCtrl.getTodayNewLimitPanicBuyCount(n),o=gd.activityCtrl.getTotalDay(n),l=o,_=gd.userCtrl.getVip(),v=a[gc.c_prop.activityExDataTypeKey.vipLimitLvl]||0;c.length>0&&"function"==typeof gc[c]&&(l=gc[c](_,v)),t.label_vipHint.visible=v>0,v>0&&(t.label_vipHint.text="vip"+v.toString()+"及以上才可购买"),t.label_buy_count.text="今日购买次数:"+r+"/"+l,r>=l?(t.label_buy_count.text="已达到购买上限",t.ico_hasGet.visible=!0):t.ico_hasGet.visible=!1}},a._tap_btn_buy=function(){var t=this,i=t.data.exActivity[gc.dsConsts.ExActivity.activity];gd.activityCtrl.newLimitPanicBuy(i[gc.dsConsts.ActivityEntity.id],0,function(i){t.setData(t.data)},t)},i}(t.ActivityNewLimitBuy);t.ActivityNewDayLimitBuy=i,egret.registerClass(i,"g_activity.ActivityNewDayLimitBuy")}(g_activity||(g_activity={}));