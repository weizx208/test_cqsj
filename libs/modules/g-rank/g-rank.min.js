var g_rank;!function(a){var t=function(a){function t(){a.apply(this,arguments)}__extends(t,a);var e=(__define,t),n=e.prototype;return n.dataChanged=function(){a.prototype.dataChanged.call(this);var t=this;if(t.data.userData){var e=t.data.userData,n=t.data.guildNames,r=t.data.rank,s=["1st","2nd","3rd"],i=e[gc.dsConsts.UserRankEntity.rankType],o=t.getDescByType(i);""!=o?(t.label_rankBy.text=mo.STR.format("%s: %s",o,utils.formatByWan(e[gc.dsConsts.UserRankEntity.rankValue])),i==gc.c_prop.rankTypeKey.guildRank?t.label_rankBy.text=mo.STR.format("%s: %s","会长",utils.formatByWan(e[gc.dsConsts.UserRankEntity.userName])):i==gc.c_prop.rankTypeKey.paTaRank&&(t.label_rankBy.text=mo.STR.format("%s: %s层",o,e[gc.dsConsts.UserRankEntity.rankValue]))):t.label_rankBy.text="",3>=r?(t.ico_rank.source="ico_arena_"+s[r-1],t.ico_rank.visible=!0,t.label_rank.visible=!1):(t.label_rank.text=r,t.ico_rank.visible=!1,t.label_rank.visible=!0),t.ico_head.setData({icoId:e[gc.dsConsts.UserRankEntity.iconId],vip:e[gc.dsConsts.UserRankEntity.pkWinCount]});var l;if(i==gc.c_prop.rankTypeKey.guildRank){var k=n[e[gc.dsConsts.UserRankEntity.userId]];l=e[gc.dsConsts.UserRankEntity.rankValue],t.label_name.text=mo.STR.format("[ubb color=#9900cd]%s[/ubb]",mo.trans4UBB(k)),t.label_level.text=mo.STR.format("[ubb color=#fff000]Lv.%s[/ubb]",l)}else l=e[gc.dsConsts.UserRankEntity.userLvl],t.label_name.text=e[gc.dsConsts.UserRankEntity.userName],t.label_level.text=mo.STR.format("Lv.%s",l)}},n.getDescByType=function(a){var t="";return 1==a?t="":2==a?t="战力":3==a?t="累充元宝":4==a?t="总阶数":5==a?t="PK积分":6==a?t="":7==a?t="战士战力":8==a?t="法师战力":9==a?t="道士战力":10==a?t="行会等级":13==a&&(t="镇妖塔战绩"),t},t}(mo.gui.ItemRenderer);a.RankItem=t,egret.registerClass(t,"g_rank.RankItem")}(g_rank||(g_rank={}));var g_rank;!function(a){var t=function(t){function e(){t.apply(this,arguments),this.ranks=[]}__extends(e,t);var n=(__define,e),r=n.prototype;return r._initProp=function(){var e=this;t.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1,e._Item_list_ranks=a.RankItem,e.rankTypeList=[2,1,4,5,6,7,8,9,13]},r.onEnter=function(){t.prototype.onEnter.call(this)},r._childrenCreated=function(){t.prototype._childrenCreated.call(this);var a=this;a.moduleParam&&a.moduleParam.rankData&&(a.setData({rankData:a.moduleParam.rankData}),a.moduleParam.rankType&&(a.tab_rank.selectedIndex=a.rankTypeList.indexOf(a.moduleParam.rankType)))},r.dataChanged=function(){t.prototype.dataChanged.call(this);var a=this,e=a.data.rankData,n=e[0]?e[0]:0,r=e[1],s=e[2],i=e[3],o=a.firstRank=s[0],l=e[4];a.ranks.length=0;for(var k=0;k<s.length;++k)a.ranks[k]={rank:k+1,userData:s[k],guildNames:l};a.ranks.shift(),a.refreshList("list_ranks");var c,_=["1st","2nd","3rd"],d=r[gc.dsConsts.UserRankEntity.rankType];0==n?(a.label_rank.text="未上榜",a.ico_rank.visible=!1,a.label_rank.visible=!0,a.label_rankByDesc.text="",a.label_rankBy.text=""):(3>=n?(a.ico_rank.source="ico_arena_"+_[n-1],a.ico_rank.visible=!0,a.label_rank.visible=!1):(a.label_rank.text=n,a.ico_rank.visible=!1,a.label_rank.visible=!0),c=a.getDescByType(d),a.label_rankByDesc.text=c,""!=c?a.label_rankBy.text=mo.STR.format("%s",utils.formatByWan(r[gc.dsConsts.UserRankEntity.rankValue])):a.label_rankBy.text=""),a.ico_head.setData({icoId:r[gc.dsConsts.UserRankEntity.iconId],vip:gd.userCtrl.getVip()}),a.ico_rankNameFirst.source="ico_rank_name_"+d,c=a.getDescByType(d),""!=c?(a.label_rankByFirst.text=mo.STR.format("%s: %s",c,utils.formatByWan(o[gc.dsConsts.UserRankEntity.rankValue])),a.ico_bgRed.visible=!0,d==gc.c_prop.rankTypeKey.guildRank?a.label_rankByFirst.text=mo.STR.format("%s: %s","会长",utils.formatByWan(o[gc.dsConsts.UserRankEntity.userName])):d==gc.c_prop.rankTypeKey.paTaRank&&(a.label_rankByFirst.text=mo.STR.format("%s: %s层",c,o[gc.dsConsts.UserRankEntity.rankValue]))):(a.label_rankByFirst.text="",a.ico_bgRed.visible=!1);var u;if(d==gc.c_prop.rankTypeKey.guildRank){var g=l[o[gc.dsConsts.UserRankEntity.userId]];u=o[gc.dsConsts.UserRankEntity.rankValue],a.label_nameFirst.text=mo.STR.format("[ubb color=#9900cd]%s[/ubb]",g),a.label_levelFirst.text=mo.STR.format("[ubb color=#fff000]Lv.%s[/ubb]",u)}else u=o[gc.dsConsts.UserRankEntity.userLvl],a.label_nameFirst.text=o[gc.dsConsts.UserRankEntity.userName],a.label_levelFirst.text=mo.STR.format("Lv.%s",u);var y=o[gc.dsConsts.UserRankEntity.pkWinCount];d==gc.c_prop.rankTypeKey.guildRank&&(y=0),a.label_vipLvFirst.text=y.toString(),y>0?a.label_nameFirst.parent.addElementAt(a.grp_vipFirst,0):a.grp_vipFirst.parent&&a.grp_vipFirst.parent.removeElement(a.grp_vipFirst),a.ico_avatarFirst.setData({clothesID:i[0],weaponID:i[1],wingID:i[2],sex:i[3],isKing:i[4]})},r.getRankList=function(a){var t=this;gd.rankCtrl.getAllRankArr(a,function(a){a&&t.setData({rankData:a})},t)},r._data_list_ranks=function(){var a=this;return a.ranks},r.getDescByType=function(a){var t="";return 1==a?t="":2==a?t="战力":3==a?t="累充元宝":4==a?t="总阶数":5==a?t="PK积分":6==a?t="":7==a?t="战士战力":8==a?t="法师战力":9==a?t="道士战力":10==a?t="行会等级":13==a&&(t="镇妖塔战绩"),t},r._tap_tab_rank=function(){var a=this,t=a.tab_rank.selectedIndex;a.getRankList(a.rankTypeList[t])},r._click_list_ranks=function(a){var t=a.item,e=t.userData[gc.dsConsts.UserRankEntity.userId];mo.moduleMgr.pushModule(g_consts.moduleId.roleEnemyInfo,{userId:e})},r._tap_ico_avatarFirst=function(){var a=this,t=a.data.rankData,e=t[2],n=e[0];mo.moduleMgr.pushModule(g_consts.moduleId.roleEnemyInfo,{userId:n[gc.dsConsts.UserRankEntity.userId]})},e}(mo.gui.Dlg);a.Rank=t,egret.registerClass(t,"g_rank.Rank"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var a=new mo.ModuleCfgItem;a.targetClass=t,a.fullScr=!0,mo.moduleMgr.registerModule(a),a.onPreAsync(function(a,t){var e=a.rankType?a.rankType:gc.c_prop.rankTypeKey.combatRank;gd.rankCtrl.getAllRankArr(e,function(e){return e?(a.rankData=e,void t()):t("error")},this)})})}(g_rank||(g_rank={}));