var g_lotus;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var a=(__define,o),n=a.prototype;return n._initProp=function(){var t=this;e.prototype._initProp.call(this),t._layerOpt.shownWithAction=!1,t._comps=[],t.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.redPointData.toString(),t._checkRed)},n._childrenCreated=function(){e.prototype._childrenCreated.call(this);var o=this;o.tab_btn.selectedIndex=0,o._comps.push(t.LotusDetail.create().setData({tray:o.container}).show()),o._comps.push(t.LotusLvUp.create().setData({tray:o.container}).show()),o._comps.push(t.LotusAdvUp.create().setData({tray:o.container}).show()),o._comps.push(t.LotusTrea.create().setData({tray:o.container}).show()),process.nextTick(function(){o._tap_tab_btn()}),o._checkRed()},n._checkRed=function(){var t=this;t.red0.visible=gd.pointCtrl.isShow(gc.c_prop.pointRedKey.demonLotus_1),t.red3.visible=gd.pointCtrl.isShow(gc.c_prop.pointRedKey.demonLotus_2)},n.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;t._tap_tab_btn()},n._tap_tab_btn=function(){for(var t=this,e=t.tab_btn.selectedIndex,o=t._comps[e],a=0,n=t._comps.length;n>a;a++)t._comps[a].visible=e==a;3>e?t.grp_lotus.visible=!0:t.grp_lotus.visible=!1,o&&o.dataChanged()},n._tap_btn_back=function(){mo.moduleMgr.runModule(g_consts.moduleId.fight)},n._tap_btn_help=function(){var t=this,e=t.tab_btn.selectedIndex,o=mo.getJSONWithFileName(gc.cfg_c_demonLotus)[0];if(0==e){var a=mo.getJSONWithFileNameAndID(gc.cfg_c_open,gc.id_c_open.expBox);g_base.BaseShowTip.create().setData({id:31,param1:a[gc.c_open_lvlRequired]}).show()}else 1==e?g_base.BaseShowTip.create().setData({id:47,param1:o[gc.c_demonLotus_advNeedLvl]}).show():2==e?g_base.BaseShowTip.create().setData({id:48}).show():3==e&&g_base.BaseShowTip.create().setData({id:49}).show()},o}(mo.gui.Layer);t.LotusLayer=e,egret.registerClass(e,"g_lotus.LotusLayer")}(g_lotus||(g_lotus={}));var g_lotus;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var a=(__define,o),n=a.prototype;return n._initProp=function(){var t=this;e.prototype._initProp.call(this),t._layerOpt.shownWithAction=!1,t.registerClassByKey(gd.DemonLotusCtrl,gc.dsConsts.DemonLotusEntity.lvl.toString(),t.dataChanged),t.registerClassByKey(gd.DemonLotusCtrl,gc.dsConsts.DemonLotusEntity.advanceLvl.toString(),t.dataChanged)},n._childrenCreated=function(){e.prototype._childrenCreated.call(this)},n.onEnter=function(){e.prototype.onEnter.call(this);var t=this;t._timerId=setInterval(function(){var e=gd.demonLotusCtrl.getData(),o=e[gc.dsConsts.DemonLotusEntity.lvl],a=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,o),n=e[gc.dsConsts.DemonLotusEntity.advanceLvl]||0,l=mo.getJSONWithFileNameAndID(gc.cfg_c_demonLotus,n);t.label_expTotal.text=utils.formatByWan(gd.demonLotusCtrl.calNowGet()>>0,1)+"/"+utils.formatByWan(a[gc.c_lvl_storeLimit]+l[gc.c_demonLotus_expcAccLimit],1)},1e3)},n.onExit=function(){e.prototype.onExit.call(this);var t=this;clearInterval(t._timerId)},n.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,o=gd.demonLotusCtrl.getData(),a=!1,n=!1,l=o[gc.dsConsts.DemonLotusEntity.lvl],i=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,l),s=mo.getJSONWithFileNameAndID(gc.cfg_t_otherBuff,3),r=mo.getJSONWithFileNameAndID(gc.cfg_t_otherBuff,4),c=o[gc.dsConsts.DemonLotusEntity.advanceLvl]||0,_=mo.getJSONWithFileNameAndID(gc.cfg_c_demonLotus,c);t.label_zhou.textColor=a?2549774:9737107,t.label_yue.textColor=n?2549774:9737107,t.label_zhou.text=mo.STR.format("产量提升%s%",Math.floor(s[gc.t_otherBuff_addHurt]/100))+(a?"（已激活）":"（未激活）"),t.label_yue.text=mo.STR.format("产量提升%s%",Math.floor(r[gc.t_otherBuff_addHurt]/100))+(n?"（已激活）":"（未激活）"),t.label_lv.text=l.toString(),t.label_expTotal.text=utils.formatByWan(gd.demonLotusCtrl.calNowGet()>>0,1)+"/"+utils.formatByWan(i[gc.c_lvl_storeLimit]+_[gc.c_demonLotus_expcAccLimit],1),t.label_expPerHour.text=utils.formatByWan(Math.floor(60*(i[gc.c_lvl_expOutput]+_[gc.c_demonLotus_expOutput])),0)+"/分钟"},n._tap_btn_get=function(){var t=this,e=gd.demonLotusCtrl.getData(),o=e[gc.dsConsts.DemonLotusEntity.lvl],a=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,o);gd.demonLotusCtrl.getRevenue(function(){var o=e[gc.dsConsts.DemonLotusEntity.advanceLvl]||0,n=mo.getJSONWithFileNameAndID(gc.cfg_c_demonLotus,o);t.label_expTotal.text="0/"+utils.formatByWan(a[gc.c_lvl_storeLimit]+n[gc.c_demonLotus_expcAccLimit],1)},t)},n._tap_btn_opening=function(){t.LotusOpeningDlg.create().show()},n._tap_btn_back=function(){mo.moduleMgr.runModule(g_consts.moduleId.fight)},n._tap_btn_help=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_open,gc.id_c_open.expBox);g_base.BaseShowTip.create().setData({id:31,param1:t[gc.c_open_lvlRequired]}).show()},o}(mo.gui.Layer);t.LotusDetail=e,egret.registerClass(e,"g_lotus.LotusDetail")}(g_lotus||(g_lotus={}));var g_lotus;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),a=o.prototype;return a._initProp=function(){var e=this;t.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e._winEfxPlayer=uiHelper.EfxPlayer.create(e.effect_win)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,o=gd.demonLotusCtrl.getData(),a=o[gc.dsConsts.DemonLotusEntity.lvl],n=a,l=n+1,i=mo.getJSONWithFileNameAndID(gc.cfg_c_lvl,n),s=mo.getJSONWithFileName(gc.cfg_c_lvl)[l],r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.demonLotusCfg),c=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r[0]),_=r[1];e.label_curLv.text=n.toString(),e.label_curAdd.text=utils.formatByWan(Math.floor(60*i[gc.c_lvl_expOutput]),0)+"/分钟",e.label_curTotal.text=utils.formatByWan(i[gc.c_lvl_storeLimit],1),n>=_?(e.label_cannotLvUp.visible=!0,e.label_cannotLvUp.text=mo.STR.format("已升至最高级"),e.grp_next.visible=!1,e.grp_lvUp.visible=!1,e.label_cannotLvUp.visible=!0):(e.grp_next.visible=!0,e.label_nextLv.text=l.toString(),e.label_nextAdd.text=utils.formatByWan(Math.floor(60*s[gc.c_lvl_expOutput]),0)+"/分钟",e.label_nextTotal.text=utils.formatByWan(s[gc.c_lvl_storeLimit],1),e.label_itemName.text=c[gc.t_item_name],e.ico_item.source=resHelper.getItemIconPath(r[0]),gd.userCtrl.getLvl()<s[gc.c_lvl_needLvl]?(e.label_cannotLvUp.visible=!0,e.grp_lvUp.visible=!1,e.label_cannotLvUp.text=mo.STR.format("%s级可继续升级",s[gc.c_lvl_needLvl])):(e.label_cannotLvUp.visible=!1,e.grp_lvUp.visible=!0,e.label_itemNum.text=gd.userCtrl.getItemNum(r[0])+"/"+s[gc.c_lvl_upLotusNum],e.label_cannotLvUp.visible=!1))},a._tap_btn_lvUp=function(){var t=this;gd.demonLotusCtrl.upLotus(function(e){t._winEfxPlayer.play(),t.dataChanged()},t)},e}(mo.gui.Layer);t.LotusLvUp=e,egret.registerClass(e,"g_lotus.LotusLvUp")}(g_lotus||(g_lotus={}));var g_lotus;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),a=o.prototype;return a._initProp=function(){var e=this;t.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1,e.registerClassByKey(gd.DemonLotusCtrl,gc.dsConsts.DemonLotusEntity.lvl.toString(),e.dataChanged)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e._winEfxPlayer=uiHelper.EfxPlayer.create(e.effect_win),e._failEfxPlayer=uiHelper.EfxPlayer.create(e.effect_fail)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,o=gd.demonLotusCtrl.getData(),a=o[gc.dsConsts.DemonLotusEntity.lvl]||0,n=o[gc.dsConsts.DemonLotusEntity.advanceLvl]||0,l=n+1,i=mo.getJSONWithFileNameAndID(gc.cfg_c_demonLotus,n),s=mo.getJSONWithFileName(gc.cfg_c_demonLotus)[l],r=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.demonLotusCfg),c=mo.getJSONWithFileNameAndID(gc.cfg_t_item,r[0]),_=null==s;e.label_curLv.text=n.toString(),e.label_curAdd.text=Math.floor(i[gc.c_demonLotus_genqiAccLimit])+"",e.label_curTotal.text=i[gc.c_demonLotus_expcAccLimit]+"",e.label_curExpAdd.text=utils.formatByWan(Math.floor(60*i[gc.c_demonLotus_expOutput]),0)+"/分钟",_?(e.label_cannotLvUp.visible=!0,e.label_cannotLvUp.text=mo.STR.format("已升至最高阶"),e.grp_next.visible=!1,e.grp_lvUp.visible=!1,e.label_cannotLvUp.visible=!0):(e.grp_next.visible=!0,e.ico_item.source=resHelper.getItemIconPath(r[0]),e.label_nextLv.text=l.toString(),e.label_nextAdd.text=Math.floor(s[gc.c_demonLotus_genqiAccLimit]),e.label_nextTotal.text=s[gc.c_demonLotus_expcAccLimit],e.label_nextExpAdd.text=utils.formatByWan(Math.floor(60*s[gc.c_demonLotus_expOutput]),0)+"/分钟",a<i[gc.c_demonLotus_advNeedLvl]?(e.label_cannotLvUp.visible=!0,e.grp_lvUp.visible=!1,e.label_cannotLvUp.text=mo.STR.format("妖莲升至%s级可进阶",i[gc.c_demonLotus_advNeedLvl])):(e.label_cannotLvUp.visible=!1,e.grp_lvUp.visible=!0,e.label_itemName.text=c[gc.t_item_name],e.label_itemNum.text=gd.userCtrl.getItemNum(r[0])+"/"+i[gc.c_demonLotus_advCosLotus]))},a._tap_btn_lvUp=function(){var t=this;gd.demonLotusCtrl.lotusAdvance(function(e){e[0]?t._winEfxPlayer.play():t._failEfxPlayer.play(),t.dataChanged()},t)},e}(mo.gui.Layer);t.LotusAdvUp=e,egret.registerClass(e,"g_lotus.LotusAdvUp")}(g_lotus||(g_lotus={}));var g_lotus;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),a=o.prototype;return a._initProp=function(){var e=this;t.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1,e.registerClassByKey(gd.DemonLotusCtrl,gc.dsConsts.DemonLotusEntity.advanceLvl.toString(),e.dataChanged)},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e._winEfxPlayer=uiHelper.EfxPlayer.create(e.effect_win),e._failEfxPlayer=uiHelper.EfxPlayer.create(e.effect_fail)},a.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,o=gd.demonLotusCtrl.getData(),a=(o[gc.dsConsts.DemonLotusEntity.advanceLvl]||0,o[gc.dsConsts.DemonLotusEntity.treasureLvl]||0),n=a+1,l=mo.getJSONWithFileNameAndID(gc.cfg_c_demonLotus,a),i=mo.getJSONWithFileName(gc.cfg_c_demonLotus)[n],s=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.demonLotusCfg),r=mo.getJSONWithFileNameAndID(gc.cfg_t_item,s[0]),c=null==i;if(e.label_curLv.text="Lv."+a.toString(),e.label_curProp.text=e.getPropStr(l[gc.c_demonLotus_treaPropertys]),c)e.label_cannotLvUp.visible=!0,e.label_cannotLvUp.text=mo.STR.format("已升至最高阶"),e.grp_next.visible=!1,e.grp_lvUp.visible=!1,e.label_cannotLvUp.visible=!0;else{e.grp_next.visible=!0;var _=gc.c_prop.spItemIdKey.genuineQi;if(e.ico_item0.source=resHelper.getItemIconPath(s[0]),e.ico_item1.source=resHelper.getItemIconPath(_),e.label_nextLv.text="Lv."+n.toString(),e.label_nextProp.text=e.getPropStr(i[gc.c_demonLotus_treaPropertys]),gd.userCtrl.getLvl()<l[gc.c_demonLotus_treaNeedUserLvl])e.label_cannotLvUp.visible=!0,e.grp_lvUp.visible=!1,e.label_cannotLvUp.text=mo.STR.format("人物升至%s级可培养莲宝",l[gc.c_demonLotus_treaNeedUserLvl]);else{e.label_cannotLvUp.visible=!1,e.grp_lvUp.visible=!0,e.label_itemName0.text=r[gc.t_item_name],e.label_itemNum0.text=gd.userCtrl.getItemNum(s[0])+"/"+l[gc.c_demonLotus_treaCosLotus],e.label_itemName1.text=mo.getJSONWithFileNameAndID(gc.cfg_t_item,_)[gc.t_item_name];var g=gd.demonLotusCtrl.calGenuineQi();e.label_itemNum1.text=+g[0]+"/"+l[gc.c_demonLotus_treaCosGenqi]}}},a.getPropStr=function(t){for(var e="",o=0;o<t.length;++o){var a=mo.STR.format("%s %s",gc.c_prop.heroProp[t[o][0]],t[o][1]);a+="[/br]",e+=a}return e},a._tap_btn_trea=function(){var t=this;gd.demonLotusCtrl.treasureTrain(function(e){e[0]?t._winEfxPlayer.play():t._failEfxPlayer.play(),t.dataChanged()},t)},e}(mo.gui.Layer);t.LotusTrea=e,egret.registerClass(e,"g_lotus.LotusTrea")}(g_lotus||(g_lotus={}));var g_lotus;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),a=o.prototype;return a._initProp=function(){var e=this;t.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1},a._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e._refreshUi(),e.openingEfxPlayer=uiHelper.EfxPlayer.create(e.efx_opening)},a._refreshUi=function(){var t=this,e=gd.demonLotusCtrl.getOpeningData();t.label_lotusLvl.text=e.lotusLvl,t.label_openingDay.text=e.conDays,t.label_add.text=e.addMult/100,t.label_lmt.text=e.maxMult/100,t.label_cost.text=e.cost,t.label_exp.text=e.exp/1e4,t.label_leftNum.text=[e.vip,e.leftNum,e.openingCount]},a._upOpening=function(){var t=this;t._refreshUi(),t.openingEfxPlayer.play()},a._tap_btn_opening=function(){var t=this;gd.demonLotusCtrl.opening(t._upOpening,t)},a._tap_btn_help=function(){g_base.BaseShowTip.create().setData({id:38}).show()},e}(mo.gui.Dlg);t.LotusOpeningDlg=e,egret.registerClass(e,"g_lotus.LotusOpeningDlg")}(g_lotus||(g_lotus={}));var g_lotus;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var a=(__define,o),n=a.prototype;return n.show=function(){var o=this;e.prototype.show.call(this),t.LotusLayer.create().setData(o.moduleParam.data).show()},o}(mo.gui.UIScene);t.LotusScene=e,egret.registerClass(e,"g_lotus.LotusScene"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.fullScr=!0,t.targetClass=e,t.sysId=gc.id_c_open.expBox,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){gd.demonLotusCtrl.getInfo(function(o){t.data=o,e()},this)})})}(g_lotus||(g_lotus={}));