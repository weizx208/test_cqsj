var g_copy;!function(t){t.vipBg={7:["icon_linyunsmg","tit_txt_g_linyunsm"],10:["icon_ditumeixindongfu","tit_txt_g_meixindongfu"],14:["icon_ditufengmoshendian","tit_txt_g_fengmosendian"],17:["icon_dituhuangquangk","tit_txt_g_huangquanguiku"],19:["icon_dituhaidimizen","tit_txt_g_haidimizen"],20:["icon_jiqinqidaidixin","tit_txt_g_haidimizen"]}}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var i=(__define,o),a=i.prototype;return a._initProp=function(){var o=this;e.prototype._initProp.call(this),o._layerOpt.shownWithAction=!1,o._Item_list_items=g_base.BaseItemCell,o._Item_list_copys=t.BossCopyItem},a._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;t.bossAP=new g_base.ActionPlayer,t.bossAP.scaleX=t.bossAP.scaleY=1.6,t.ico_monster.source=t.bossAP,t.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,t.click_btn_close,t),t.moduleParam&&t.setData(t.moduleParam)},a.dataChanged=function(){e.prototype.dataChanged.call(this);var o=this;o.data.copyList;o.copyId=t.curBossCopyId||gd.copyCtrl.getCurBossCopyId(),o.list_copys.selectedItem=o.copyId,o.setCopyInfo(o.copyId)},a._tap_btn_enter=function(){var t=this,e=gd.copyCtrl.getBoosCopyEnterCost(),o=e[0],i=e[1];if(gd.userCtrl.getItemNum(o)<i){var a=gc.c_prop.spItemIdKey.bossTessera;return void(g_base.GainWay.canBuyFromShop(a)?g_base.GainWayShop.create().setData({itemId:a}).show().onClose(function(){t.dataChanged()}):g_base.GainWay.create().setData({itemId:a}).show())}gd.fightCtrl.enterCopy(this.copyId)},a._data_list_items=function(){var t=this;return gd.userUtils.getLoots(t.copyId?gd.copyCtrl.getCopyLootList(t.copyId):[])},a._data_list_copys=function(){var t=this,e=[].concat(t.data.copyList),o=e.length,i=gd.copyCtrl.getBossCopyTempList();if(e.length<3)for(var a=0,s=3-o;s>a;a++)e.push(i[o+a]);else e=e.length==i.length?e:e.concat(i[e.length]);return e},a._click_list_copys=function(t){var e=this,o=t.item;e.setCopyInfo(o)},a.setCopyInfo=function(e){var o=this;o.copyId=e,t.curBossCopyId=e;mo.getJSONWithFileNameAndID(gc.cfg_t_copy,e);o.refreshList("list_items"),o.label_rest.text=gd.copyCtrl.getCopyCount(o.copyId);var i=gd.copyCtrl.getBoosCopyEnterCost();uiHelper.setResGrp(o.grp_res,i[0],i[1]);var a=gc.c_prop.spItemIdKey.bossTessera,s=gc.c_prop.spItemIdKey.bossTesseraReplace;uiHelper.setResGrp(o.grp_boss_token,a,gd.userCtrl.getItemNum(a)),uiHelper.setResGrp(o.grp_boss_token2,s,gd.userCtrl.getItemNum(s));var r=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,o.copyId),p=(gd.copyCtrl.getPassCon(e),mo.getJSONWithFileNameAndID(gc.cfg_t_monster,r[gc.t_copy_bossID]));o.titleDisplay.text=[p[gc.t_monster_name],mo.STR.format("%s级",p[gc.t_monster_level])],o.label_bossHp.text=utils.formatByWan(p[gc.t_monster_maxHp]),o.label_combat.text=utils.formatByWan(p[gc.t_monster_combat]);var c=p[gc.t_monster_displayID];o.bossAP.loadRes("m"+c+"_4s",!0),o.bossAP.playAction(),process.nextTick(function(){process.nextTick(function(){var t=o.list_copys.dataProvider.getItemIndex(o.copyId),e=130*(t>0?t-1:t);o.list_copys.scroller.throwHorizontally(e)})})},a._tap_btn_left=function(){var t=this,e=t.list_copys.dataGroup.horizontalScrollPosition;e-=130,t.list_copys.scroller.throwHorizontally(e)},a._tap_btn_right=function(){var t=this,e=t.list_copys.dataGroup.horizontalScrollPosition;e+=130,t.list_copys.scroller.throwHorizontally(e)},a.click_btn_close=function(){var e=this;t.curBossCopyId=null,e.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,e.click_btn_close,e)},a._tap_btn_buy_bossTicket=function(){var t=this,e=gc.c_prop.spItemIdKey.bossTessera;g_base.GainWay.canBuyFromShop(e)?g_base.GainWayShop.create().setData({itemId:e}).show().onClose(function(){t.dataChanged()}):g_base.GainWay.create().setData({itemId:e}).show()},a._tap_btn_info=function(){var t=mo.getJSONWithFileNameAndID(gc.cfg_c_game,gc.id_c_game.bossTesseraReplace),e=t[0],o=t[1],i=gd.userCtrl.getTodayCount(gc.c_prop.userRefreshCountKey.bossTesseraReplace);g_base.BaseShowTip.create().setData({id:14,param1:e,param2:o,param3:i}).show()},o}(mo.gui.Dlg);t.BossCopy=e,egret.registerClass(e,"g_copy.BossCopy"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.fullScr=!0,t.targetClass=e,t.sysId=gc.id_c_open.bossCopy,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){gd.copyCtrl.getCopyBossList(function(o){t.copyList=o,e()},this)})})}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),i=o.prototype;return i._childrenCreated=function(){t.prototype._childrenCreated.call(this)},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,o=e.data,i=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,o);e.label_name.text=i[gc.t_copy_name];var a=i[gc.t_copy_bossID];e.img_boss.source=resHelper.getMonsterHeadIconPath(a),e.enabled=!gd.copyCtrl.isCopyLocked(o);var s=gd.copyCtrl.checkPassCon(o);e.enabled||(e.label_name.text=mo.STR.format("%s级解锁",s[1])),e.invalidateSkinState()},e}(mo.gui.ItemRenderer);t.BossCopyItem=e,egret.registerClass(e,"g_copy.BossCopyItem")}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),i=o.prototype;return i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.img_new.visible=!1,e.btn_plus.visible=!1,e.label_note.visible=!1,e.registerClassByKey(gd.CopyCtrl,gd.CopyCtrl.ON_CHALLENGE_NUM,e._updateRestStatus)},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,o=e.data,i=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,o);e.label_name.text=i[gc.t_copy_name],e.enabled=!gd.copyCtrl.isCopyLocked(o),e._updateRestStatus();var a=gd.copyCtrl.getCopyStar(o);uiHelper.setStarGrp(e.grp_star,a);var s=gd.copyCtrl.checkPassCon(o);if(s){var r,p;if(1==s[0])r="等级",p=s[1];else if(2==s[0]){r="通关";var c=s[1];p=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,c)[gc.t_copy_name]}else 3==s[0]&&s[1]>0&&(r="元神",p=s[1]+"级");e.label_note.visible=!e.enabled,e.label_note.text=mo.STR.format("%s%s开启",r,p)}},i._updateRestStatus=function(){var t=this,e=t.data,o=gd.copyCtrl.getCopyCount(e);t.label_rest.text=o,t.btn_plus.visible=0>=o},i._tap_btn_plus=function(){var t=this,e=t.data;gd.copyCtrl.buyCopyCount1(e,function(){t._updateRestStatus()},t)},i._tap_touch_rect=function(){var t=this;t.emitter.emit(t.__class.ON_ITEM_CLICK,t.data,t)},e.ON_ITEM_CLICK="oick",e}(mo.gui.ItemRenderer);t.CopyItem=e,egret.registerClass(e,"g_copy.CopyItem")}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var i=(__define,o),a=i.prototype;return a._initProp=function(){var o=this;e.prototype._initProp.call(this),o._layerOpt.shownWithAction=!1,o._Item_list_copys=t.CopyItem,o.registerClassByKey(gd.CopyCtrl,gd.CopyCtrl.ON_CHALLENGE_NUM,o.dataChanged)},a._childrenCreated=function(){var t=this;e.prototype._childrenCreated.call(this),t.moduleParam&&t.setData(t.moduleParam)},a._data_list_copys=function(){var t=this;return t.data.copyList},a.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this;t.img_title.source=t.data.copyType==gc.c_prop.copyTypeKey.equip?"tit_txt_g_equipCopy":"tit_txt_g_stateCopy";var o=t.data.copyType==gc.c_prop.copyTypeKey.equip?gc.c_prop.spItemIdKey.equipTessera:gc.c_prop.spItemIdKey.realmTessera;t.label_ticket.text=mo.STR.format("[ubb color=0x6deb82]%s[/ubb]: %s",gc.c_prop.spItemId[o],gd.copyCtrl.getTesseraCount(o))},a._initItem_list_copys=function(e){var o=this;e.emitter.on(t.CopyItem.ON_ITEM_CLICK,function(t){g_base.CopyLoot.create().setData({copyId:t}).show()},o)},a._tap_btn_buy_ticket=function(){var t=this,e=t.data.copyType==gc.c_prop.copyTypeKey.equip?gc.c_prop.spItemIdKey.equipTessera:gc.c_prop.spItemIdKey.realmTessera;gd.copyCtrl.buyTessera(e,t.dataChanged,t)},o}(mo.gui.Dlg);t.Copy=e,egret.registerClass(e,"g_copy.Copy"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.fullScr=!0,t.targetClass=e,t.sysId=gc.id_c_open.equipCopy,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){t.copyType=gc.c_prop.copyTypeKey.equip,gd.copyCtrl.getCopyEquipList(function(o){var i=[].concat(o).reverse();t.copyList=i,e()},this)})})}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var i=(__define,o),a=i.prototype;return a._initProp=function(){var o=this;e.prototype._initProp.call(this),mo.gui.helper.setSkinName(o,t.Copy.__className)},o}(t.Copy);t.StateCopy=e,egret.registerClass(e,"g_copy.StateCopy"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.fullScr=!0,t.targetClass=e,t.sysId=gc.id_c_open.reamCopy,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){t.copyType=gc.c_prop.copyTypeKey.state,gd.copyCtrl.getCopyStateList(function(o){var i=[].concat(o).reverse();t.copyList=i,e()},this)})})}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var o=(__define,e),i=o.prototype;return i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;e.label_rest.visible=!1,e.label_openLvl.visible=!1,e.label_loot.visible=!1,e.img_shadow.visible=!1;var o=e.data,i=o[0];e.img_icon.source=o[1],e.img_title.source=o[2];var a=!0;if(i==gc.c_prop.copyTypeKey.vip){var s=o[3];e.img_shadow.visible=!0,e.label_rest.visible=!0,20>s?e.label_loot.visible=!0:e.label_rest.visible=!1,e.label_loot.text=gd.copyCtrl.getVipLootDesc(s),gd.userCtrl.getVip()>=s&&20>s?e.label_rest.text=mo.STR.format("今日剩余通关次数: %s",gd.copyCtrl.getVipCopyReTimes(s)):e.label_rest.text=mo.STR.format("VIP%s开启",s)}else a=gd.userCtrl.getLvl()>=gd.copyCtrl.getOpenLvl(i),e.label_openLvl.visible=!a,e.label_openLvl.text=mo.STR.format("%s级开启",gd.copyCtrl.getOpenLvl(i));e.rect_mask.visible=!a},e}(mo.gui.ItemRenderer);t.CopyEntryItem=e,egret.registerClass(e,"g_copy.CopyEntryItem")}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var i=(__define,o),a=i.prototype;return a._initProp=function(){var o=this;e.prototype._initProp.call(this),o._layerOpt.shownWithAction=!1,o._Item_list_copys=t.CopyEntryItem,o.registerClassByKey(gd.UserCtrl,gc.dsConsts.UserEntity.vip.toString(),function(){o.checkVipCopy(),o.refreshList("list_copys")})},a._childrenCreated=function(){var t=this;e.prototype._childrenCreated.call(this),t.registerClassByKey(gd.RechargeCtrl,gd.RechargeCtrl.ON_RECHARGE_SUCC,function(){t.checkVipCopy(),t.refreshList("list_copys")}),t.moduleParam&&t.setData(t.moduleParam),t.checkVipCopy(),t.refreshList("list_copys")},a.checkVipCopy=function(){var e=this,o=gd.userCtrl.getVip();e._copys=[[gc.c_prop.copyTypeKey.equip,"ico_maoxianf","ico_zhuangbeifubeng"],[gc.c_prop.copyTypeKey.state,"ico_yuanshengfu","ico_yuanshenbeifubeng"],[gc.c_prop.copyTypeKey.hell,"ico_ylianyugfu","ico_lianyufubeng"]],e._copys.push([gc.c_prop.copyTypeKey.vip,t.vipBg[7][0],"ico_linyusmf",7]),o>=7&&e._copys.push([gc.c_prop.copyTypeKey.vip,t.vipBg[10][0],"ico_meixindonfu",10]),o>=10&&e._copys.push([gc.c_prop.copyTypeKey.vip,t.vipBg[14][0],"ico_fengmosengdian",14]),o>=14&&e._copys.push([gc.c_prop.copyTypeKey.vip,t.vipBg[17][0],"ico_huangquanguiku",17]),o>=17&&e._copys.push([gc.c_prop.copyTypeKey.vip,t.vipBg[19][0],"ico_haidimizeng",19]),o>=19&&e._copys.push([gc.c_prop.copyTypeKey.vip,t.vipBg[20][0],"ico_jinqinqidait",20])},a._data_list_copys=function(){var t=this;return t._copys},a.dataChanged=function(){e.prototype.dataChanged.call(this)},a._click_list_copys=function(t){var e=t.item,o=e[0];switch(o){case gc.c_prop.copyTypeKey.equip:mo.moduleMgr.runModule(g_consts.moduleId.equipCopy);break;case gc.c_prop.copyTypeKey.state:mo.moduleMgr.runModule(g_consts.moduleId.stateCopy);break;case gc.c_prop.copyTypeKey.hell:mo.moduleMgr.runModule(g_consts.moduleId.bossCopy);break;case gc.c_prop.copyTypeKey.vip:var i=e[3];if(i>=20)return;mo.moduleMgr.runModule(g_consts.moduleId.vipCopy,{vip:i})}},o}(mo.gui.Dlg);t.CopyEntry=e,egret.registerClass(e,"g_copy.CopyEntry"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){gd.copyCtrl.getInfo(function(){e()},this)})})}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var i=(__define,o),a=i.prototype;return a._childrenCreated=function(){e.prototype._childrenCreated.call(this)},a.dataChanged=function(){e.prototype.dataChanged.call(this);var o=this;o.img_txt_bg.visible=!1;var i=o.data,a=mo.getJSONWithFileNameAndID(gc.cfg_t_copy,i);o.label_name.text=a[gc.t_copy_name],o.img_icon.source=t.vipBg[gd.copyCtrl.getCopyVip(i)][0];var s=gd.copyCtrl.getCopyStar(i);uiHelper.setStarGrp(o.grp_star,s),o.grp_star.visible=s>0,o.img_txt_bg.visible=s>0;var r=gd.copyCtrl.checkPassCon(i);r&&(o.label_unlockLvl.text=r[1],o.img_txt_bg.visible=!0),o.enabled=null==r,o.invalidateSkinState()},a._tap_touch_rect=function(){var t=this;t.delegate.onCopyItemClick(t.data)},o}(mo.gui.ItemRenderer);t.VipCopyItem=e,egret.registerClass(e,"g_copy.VipCopyItem")}(g_copy||(g_copy={}));var g_copy;!function(t){var e=function(e){function o(){e.apply(this,arguments)}__extends(o,e);var i=(__define,o),a=i.prototype;return a._initProp=function(){var o=this;e.prototype._initProp.call(this),o._layerOpt.shownWithAction=!1,o._Item_list_copys=t.VipCopyItem},a._childrenCreated=function(){var t=this;e.prototype._childrenCreated.call(this),t.moduleParam&&t.setData(t.moduleParam)},a._data_list_copys=function(){var t=this;return t.data.copyList},a.dataChanged=function(){e.prototype.dataChanged.call(this);var o=this;o.label_left_times.text=[gd.copyCtrl.getVipCopyReTimes(o.moduleParam.vip),gd.copyCtrl.getMaxVipCopyTimes(o.moduleParam.vip)],o.img_title.source=t.vipBg[o.moduleParam.vip][1]},a.onCopyItemClick=function(t){g_base.VipCopyLoot.create().setData({copyId:t}).show()},a._tap_btn_help=function(){var t=this,e=t.moduleParam.vip;g_base.BaseShowTip.create().setData({id:59,param1:e,param2:gd.copyCtrl.getMaxVipCopyTimes(e)}).show()},o}(mo.gui.Dlg);t.VipCopy=e,egret.registerClass(e,"g_copy.VipCopy"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.fullScr=!0,t.targetClass=e,t.onValid(function(t){return t.vip>gd.userCtrl.getVip()?(mo.showMsg(gc.id_c_msgCode.vipRequire,t.vip),!1):!0}),mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){gd.copyCtrl.getInfo(function(){t.copyList=gd.copyCtrl.getVipCopyList(t.vip),e()},this)})})}(g_copy||(g_copy={}));