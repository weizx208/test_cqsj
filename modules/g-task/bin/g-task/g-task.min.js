var g_task;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var a=(__define,e),i=a.prototype;return i._initProp=function(){var e=this;t.prototype._initProp.call(this),e._layerOpt.shownWithAction=!1,e._Item_list_items=g_base.BaseItemCell},i._data_list_items=function(){var t=this;return gd.userUtils.getLoots(utils.itemObj2ObjArr(gd.taskCtrl.queryVitalityBoxReward(t.index)[1]))},i._childrenCreated=function(){t.prototype._childrenCreated.call(this)},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this;e.index=e.data.index;for(var a=utils.itemObj2ObjArr(gd.taskCtrl.queryVitalityBoxReward(e.index)[0]),i=0,s=2;s>i;i++){var r=e["grp_res"+i],n=a[i];r.visible=null!=n,n&&uiHelper.setResGrp(r,n.itemId,n.count)}var o=gd.taskCtrl.getVitalityBoxState(e.index),_=o[0],l=o[1];e.btn_do.icon=_&&!l?"btn_txt_g_get":"btn_txt_g_back"},i._tap_btn_do=function(){var t=this,e=gd.taskCtrl.getVitalityBoxState(t.index),a=e[0],i=e[1];a&&!i?gd.taskCtrl.getVitalityChest(t.index,t.close,t):t.close()},e}(mo.gui.Dlg);t.ActivityBoxReward=e,egret.registerClass(e,"g_task.ActivityBoxReward")}(g_task||(g_task={}));var g_task;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var a=(__define,e),i=a.prototype;return i._childrenCreated=function(){t.prototype._childrenCreated.call(this);var e=this;e.btn_get.visible=!1,e.btn_go.visible=!1,e.img_done.visible=!1},i.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this,a=e.data,i=a[gc.c_task_id];e.label_title.text=a[gc.c_task_name],e.label_desc.text=a[gc.c_task_note],e.ico.source=resHelper.getTaskIconPath(a[gc.c_task_icon]);var s=utils.itemObj2ObjArr(gd.taskCtrl.getTaskReward(i));s.sort(function(t,e){return t.itemId==gc.c_prop.spItemIdKey.vitality?-1:1});for(var r=0,n=3;n>r;r++){var o=e["grp_res"+r],_=s[r];o&&(o.visible=null!=_),_&&o&&uiHelper.setResGrp(o,_.itemId,_.count)}var l=gd.taskCtrl.getTaskOpt(i);1!=l.type||4!=l.subType&&10!=l.subType&&12!=l.subType&&13!=l.subType?e.label_num.text=[l.value,l.targetValue]:e.label_num.text=l.value>=l.targetValue?[1,1]:[0,1];var d=a[gc.c_task_uiLink],c=d[0]>0,g=l.isComplete&&!l.isReceive;e.btn_get.visible=g,e.btn_go.visible=c&&!g,l.isComplete&&l.isReceive&&(e.btn_get.visible=!1,e.btn_go.visible=!1),e.enabled=!(l.isComplete&&l.isReceive),e.invalidateSkinState()},i._tap_btn_get=function(){var t=this,e=t.data,a=gd.taskCtrl.getTaskOpt(e[gc.c_task_id]);gd.taskCtrl.taskAward(a,function(){t.emitter.emit(t.__class.ON_BTN_GET,e[gc.c_task_id],t)},t)},i._tap_btn_go=function(){var t,e,a=this,i=a.data,s=i[gc.c_task_uiLink],e=s[0],r=s[1];switch(e){case 6:t={subModuleId:r},e=g_consts.moduleId.shop;break;case 4:t={subModuleId:r},e=g_consts.moduleId.forge;break;case 3:t={subModuleId:r},e=g_consts.moduleId.role;break;case 2:t={subModuleId:r},e=g_consts.moduleId.home;break;case 1:t={subModuleId:r},e=g_consts.moduleId.fight}e&&t&&mo.moduleMgr.runModule(e,t)},e.ON_BTN_GET="on_btn_get",e}(mo.gui.ItemRenderer);t.TaskItem=e,egret.registerClass(e,"g_task.TaskItem")}(g_task||(g_task={}));var g_task;!function(t){var e=function(e){function a(){e.apply(this,arguments)}__extends(a,e);var i=(__define,a),s=i.prototype;return s._initProp=function(){var a=this;e.prototype._initProp.call(this),a._layerOpt.shownWithAction=!1,a._Item_list_daily_tasks=t.TaskItem,a._Item_list_achivements=t.TaskItem,a.registerClassByKey(gd.TaskCtrl,gd.TaskCtrl.ON_RECIVED_BOX,a.dataChanged)},s._initItem_list_daily_tasks=function(e){var a=this;a.data.hec;e.emitter.on(t.TaskItem.ON_BTN_GET,function(t){a.refreshList("list_daily_tasks"),a.dataChanged()},a)},s._initItem_list_achivements=function(e){var a=this;a.data.hec;e.emitter.on(t.TaskItem.ON_BTN_GET,function(t){a.refreshList("list_achivements"),a.dataChanged()},a)},s._data_list_daily_tasks=function(){return gd.taskCtrl.getDailyTaskList()},s._data_list_achivements=function(){return gd.taskCtrl.getTasksList()},s._childrenCreated=function(){e.prototype._childrenCreated.call(this);var t=this;this.tab_task.dataProvider=t.viewStack,this.tab_task.selectedIndex=0,t.dataChanged()},s.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this,a=gd.taskCtrl.getVitalityProgress();t.label_act.text=[a.cur,a.max],t.pb_active.value=a.per;var i=gd.taskCtrl.isTaskReddot();t.img_red0.visible=i[0],t.img_red1.visible=i[1],t._showBoxEffect()},s._showBoxEffect=function(){for(var t=this,e=["ico_bronze_box","ico_silver_box","ico_gold_box"],a=0;3>a;a++){var i=t["efx"+a],s=t["btn_box"+a],r=gd.taskCtrl.getVitalityBoxState(a),n=r[0],o=r[1];s.source=o?e[a]+"_open":e[a];var _=n&&!o;_?(i.visible=!0,i.play(-1)):(i.gotoAndStop(1),i.visible=!1)}},s._showBox=function(e){t.ActivityBoxReward.create().setData({index:e}).show()},s._tap_btn_box0=function(){var t=this;t._showBox(0)},s._tap_btn_box1=function(){var t=this;t._showBox(1)},s._tap_btn_box2=function(){var t=this;t._showBox(2)},a}(mo.gui.Dlg);t.TaskDlg=e,egret.registerClass(e,"g_task.TaskDlg"),egret.Boot.once(egret.Boot.AFTER_CONFIG,function(){var t=new mo.ModuleCfgItem;t.targetClass=e,t.fullScr=!0,mo.moduleMgr.registerModule(t),t.onPreAsync(function(t,e){gd.taskCtrl.getInfo(function(){e()},this)})})}(g_task||(g_task={}));